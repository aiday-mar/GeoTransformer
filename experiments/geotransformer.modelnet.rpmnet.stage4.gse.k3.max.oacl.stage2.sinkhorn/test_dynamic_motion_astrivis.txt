005
src_points :  [[-0.09786658  0.03055858 -0.02895006]
 [-0.09594688  0.037482   -0.0293173 ]
 [-0.09450169  0.04346759 -0.03055806]
 ...
 [-0.02964062  0.13111581 -0.03717137]
 [-0.03074892  0.12950136 -0.04266921]
 [-0.05462684  0.09656644 -0.05567255]]
ref_points :  [[-0.09358168  0.0095829   0.02558826]
 [-0.0915698   0.01648219  0.02431526]
 [-0.09053364  0.02208063  0.02183219]
 ...
 [-0.06042172  0.04087735 -0.01665789]
 [-0.02160256  0.13472544 -0.01979673]
 [-0.06606782  0.10995544 -0.01683611]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([5887, 3])
lengths :  tensor([2886, 3001])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([3757, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([1192, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([601, 3])
ref_points_f.shape :  torch.Size([2886, 3])
src_points_c.shape :  torch.Size([591, 3])
src_points_f.shape :  torch.Size([3001, 3])
ref_node_masks.shape :  torch.Size([601])
ref_node_knn_indices.shape :  torch.Size([601, 5])
ref_node_knn_masks.shape :  torch.Size([601, 5])
src_node_masks.shape :  torch.Size([591])
src_node_knn_indices.shape :  torch.Size([591, 5])
src_node_knn_masks.shape :  torch.Size([591, 5])
ref_node_knn_points.shape :  torch.Size([601, 5, 3])
src_node_knn_points.shape :  torch.Size([591, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([1192, 512])
feats_f :  torch.Size([5887, 256])
k :  3
omegas.shape :  torch.Size([361201, 128, 1])
omegas.shape :  torch.Size([1083603, 128, 1])
k :  3
omegas.shape :  torch.Size([349281, 128, 1])
omegas.shape :  torch.Size([1047843, 128, 1])
ref_feats_c.shape :  torch.Size([1, 601, 256])
src_feats_c.shape :  torch.Size([1, 591, 256])
ref_feats_c_norm.shape :  torch.Size([601, 256])
src_feats_c_norm.shape :  torch.Size([591, 256])
ref_node_masks.shape :  torch.Size([601])
src_node_masks.shape :  torch.Size([591])
self.num_correspondences :  2000
matching_scores.numel() :  355191
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([19179])
ref_indices.shape :  torch.Size([19179])
src_indices.shape :  torch.Size([19179])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 4, 4, 4], device='cuda:0')
src_indices :  tensor([2, 3, 4,  ..., 0, 1, 2], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([19179, 3])
global_src_corr_points.shape :  torch.Size([19179, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([1965, 4, 4])
src_corr_points.shape :  torch.Size([19179, 3])
ref_corr_points.shape :  torch.Size([1, 19179, 3])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 19179, 3])
batch_corr_residuals.shape :  torch.Size([1965, 19179])
batch_inlier_masks.shape :  torch.Size([1965, 19179])
best_index :  tensor(843, device='cuda:0')
len(batch_transforms) :  1965
estimated_transform :  [[ 0.7848562   0.13437983  0.6049321  -0.01816391]
 [-0.24274126  0.9648602   0.10060486 -0.00652078]
 [-0.5701558  -0.22580251  0.78989595 -0.00159395]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [1439  630 1706 ... 1335 1448  843]
superpoint_src_corr_points.shape :  (19179, 3)
superpoint_ref_corr_points.shape :  (19179, 3)
batch_inlier_masks.shape :  (1965, 19179)
batch_transforms.shape :  (1965, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([19179, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 19179, 3])
batch_inlier_masks.shape :  torch.Size([1965, 19179])
best_index :  843
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (19179, 3)
transformed_src_superpoints.shape :  torch.Size([19179, 3])
residual.shape :  torch.Size([19179])
batch_inlier_masks.shape :  torch.Size([19179])
batch_outlier_masks.shape :  torch.Size([19179])
indices_inliers.shape :  torch.Size([114])
indices_outliers.shape :  torch.Size([19065])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([114, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 [ 0.05865671 -0.13002272  0.03322984]
 [ 0.06409369 -0.13082105  0.03001331]
 [-0.0688412  -0.14266108  0.03379423]
 [-0.05987869 -0.14416319  0.03023893]
 [-0.05693112 -0.14048307  0.0275293 ]
 [-0.06243759 -0.13869907  0.02912269]
 [-0.05987869 -0.14416319  0.03023893]
 [-0.06400242 -0.14632307  0.03295815]
 [-0.05693112 -0.14048307  0.0275293 ]
 [-0.00566406 -0.03963956  0.04611661]
 [-0.0575418  -0.12717794  0.02806726]
 [-0.0575418  -0.12717794  0.02806726]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.02197603 -0.03963404  0.05469598]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.02197603 -0.03963404  0.05469598]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.01545584 -0.04110082  0.05289632]
 [ 0.00068237 -0.05413906  0.04793929]
 [-0.00677244 -0.03339837  0.04332144]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00241171  0.02259507 -0.05067153]
 [-0.05168498 -0.13155507  0.02477531]
 [ 0.00769587  0.00805565 -0.05812374]
 [ 0.00177343  0.0078942  -0.05659277]
 [ 0.00614775 -0.00221008 -0.05595337]
 [ 0.00177343  0.0078942  -0.05659277]
 [-0.00019587  0.00224048 -0.05559123]
 [ 0.00769587  0.00805565 -0.05812374]
 [ 0.00177343  0.0078942  -0.05659277]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00241171  0.02259507 -0.05067153]
 [ 0.00241171  0.02259507 -0.05067153]
 [-0.02770654 -0.09190547  0.0618809 ]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01587491 -0.00683671  0.03083937]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00512271  0.0013173  -0.05506705]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00512271  0.0013173  -0.05506705]
 [-0.01722543 -0.02832963  0.04707544]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01238832 -0.0274046   0.04395644]
 [-0.01138697 -0.03332953  0.04683894]
 [-0.01238832 -0.0274046   0.04395644]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01722543 -0.02832963  0.04707544]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01898138 -0.02283034  0.04425756]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.0004451   0.08390476 -0.06581885]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.02643657 -0.04212166 -0.05128226]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.02089846 -0.03862336 -0.04694999]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02643657 -0.04212166 -0.05128226]
 [ 0.02089846 -0.03862336 -0.04694999]
 [ 0.0261184  -0.04174077 -0.04599131]
 [-0.04074053 -0.12724331  0.02365168]
 [-0.03368619 -0.12849733  0.02553063]
 [-0.03809875 -0.13278046  0.02561154]
 [-0.03368619 -0.12849733  0.02553063]
 [-0.03809875 -0.13278046  0.02561154]
 [-0.04074053 -0.12724331  0.02365168]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.045078   -0.12250467  0.02318637]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02774133 -0.01124226  0.03976112]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02072618 -0.00723351  0.03396001]
 [-0.01587491 -0.00683671  0.03083937]
 [ 0.00177343  0.0078942  -0.05659277]
 [-0.00019587  0.00224048 -0.05559123]
 [-0.0004451   0.08390476 -0.06581885]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01490012 -0.02746991 -0.05291076]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01490012 -0.02746991 -0.05291076]
 [ 0.01490012 -0.02746991 -0.05291076]
 [-0.01587491 -0.00683671  0.03083937]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]]
len(transformed_superpoints_pcd) :  114
copy_superpoint_src_corr_points.shape :  (19065, 3)
mask.shape :  (19065,)
copy_superpoint_src_corr_points.shape :  (14609, 3)
copy_superpoint_ref_corr_points.shape :  (14609, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([14609, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 14609, 3])
batch_inlier_masks.shape :  torch.Size([1965, 14609])
best_index :  1147
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (14609, 3)
transformed_src_superpoints.shape :  torch.Size([14609, 3])
residual.shape :  torch.Size([14609])
batch_inlier_masks.shape :  torch.Size([14609])
batch_outlier_masks.shape :  torch.Size([14609])
indices_inliers.shape :  torch.Size([67])
indices_outliers.shape :  torch.Size([14542])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([67, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 [ 0.05865671 -0.13002272  0.03322984]
 [ 0.06409369 -0.13082105  0.03001331]
 [-0.0688412  -0.14266108  0.03379423]
 [-0.05987869 -0.14416319  0.03023893]
 [-0.05693112 -0.14048307  0.0275293 ]
 [-0.06243759 -0.13869907  0.02912269]
 [-0.05987869 -0.14416319  0.03023893]
 [-0.06400242 -0.14632307  0.03295815]
 [-0.05693112 -0.14048307  0.0275293 ]
 [-0.00566406 -0.03963956  0.04611661]
 [-0.0575418  -0.12717794  0.02806726]
 [-0.0575418  -0.12717794  0.02806726]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.02197603 -0.03963404  0.05469598]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.02197603 -0.03963404  0.05469598]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.01545584 -0.04110082  0.05289632]
 [ 0.00068237 -0.05413906  0.04793929]
 [-0.00677244 -0.03339837  0.04332144]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00241171  0.02259507 -0.05067153]
 [-0.05168498 -0.13155507  0.02477531]
 [ 0.00769587  0.00805565 -0.05812374]
 [ 0.00177343  0.0078942  -0.05659277]
 [ 0.00614775 -0.00221008 -0.05595337]
 [ 0.00177343  0.0078942  -0.05659277]
 [-0.00019587  0.00224048 -0.05559123]
 [ 0.00769587  0.00805565 -0.05812374]
 [ 0.00177343  0.0078942  -0.05659277]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00241171  0.02259507 -0.05067153]
 [ 0.00241171  0.02259507 -0.05067153]
 [-0.02770654 -0.09190547  0.0618809 ]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01587491 -0.00683671  0.03083937]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00512271  0.0013173  -0.05506705]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00512271  0.0013173  -0.05506705]
 [-0.01722543 -0.02832963  0.04707544]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01238832 -0.0274046   0.04395644]
 [-0.01138697 -0.03332953  0.04683894]
 [-0.01238832 -0.0274046   0.04395644]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01722543 -0.02832963  0.04707544]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01898138 -0.02283034  0.04425756]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.0004451   0.08390476 -0.06581885]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.02643657 -0.04212166 -0.05128226]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.02089846 -0.03862336 -0.04694999]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02643657 -0.04212166 -0.05128226]
 [ 0.02089846 -0.03862336 -0.04694999]
 [ 0.0261184  -0.04174077 -0.04599131]
 [-0.04074053 -0.12724331  0.02365168]
 [-0.03368619 -0.12849733  0.02553063]
 [-0.03809875 -0.13278046  0.02561154]
 [-0.03368619 -0.12849733  0.02553063]
 [-0.03809875 -0.13278046  0.02561154]
 [-0.04074053 -0.12724331  0.02365168]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.045078   -0.12250467  0.02318637]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02774133 -0.01124226  0.03976112]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02072618 -0.00723351  0.03396001]
 [-0.01587491 -0.00683671  0.03083937]
 [ 0.00177343  0.0078942  -0.05659277]
 [-0.00019587  0.00224048 -0.05559123]
 [-0.0004451   0.08390476 -0.06581885]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01490012 -0.02746991 -0.05291076]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01490012 -0.02746991 -0.05291076]
 [ 0.01490012 -0.02746991 -0.05291076]
 [-0.01587491 -0.00683671  0.03083937]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [-0.01721309 -0.09221327  0.05402019]
 [ 0.07927147 -0.12766016  0.03516544]
 [ 0.07927147 -0.12766016  0.03516544]
 [ 0.08337816 -0.13908187  0.0245749 ]
 [ 0.07954869 -0.13128331  0.02876544]
 [ 0.07826672 -0.1388868   0.02019636]
 [ 0.07442202 -0.12609753  0.03063668]
 [ 0.07707766 -0.13372758  0.0234783 ]
 [ 0.07954869 -0.13128331  0.02876544]
 [ 0.07442202 -0.12609753  0.03063668]
 [ 0.07707766 -0.13372758  0.0234783 ]
 [ 0.07826672 -0.1388868   0.02019636]
 [ 0.07707766 -0.13372758  0.0234783 ]
 [ 0.07954869 -0.13128331  0.02876544]
 [ 0.07442202 -0.12609753  0.03063668]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.04337429 -0.12651128  0.0358494 ]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04337429 -0.12651128  0.0358494 ]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.04337429 -0.12651128  0.0358494 ]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.02946882 -0.08361915  0.05224239]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.02237315 -0.08886147  0.05404834]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03819939 -0.08577004  0.05191713]
 [-0.02946882 -0.08361915  0.05224239]
 [-0.0257936  -0.07954311  0.05002978]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.02237315 -0.08886147  0.05404834]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03862233 -0.0786012   0.04882094]
 [-0.03541877 -0.07368567  0.04727324]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03258999 -0.12588117  0.03008476]
 [-0.03258999 -0.12588117  0.03008476]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03541877 -0.07368567  0.04727324]
 [ 0.0048273   0.02792214 -0.0639488 ]
 [ 0.00732484  0.02068848 -0.0648047 ]
 [-0.03862233 -0.0786012   0.04882094]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03541877 -0.07368567  0.04727324]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03819939 -0.08577004  0.05191713]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.03862233 -0.0786012   0.04882094]
 [-0.03819939 -0.08577004  0.05191713]
 [-0.02946882 -0.08361915  0.05224239]
 [-0.02946882 -0.08361915  0.05224239]]
len(transformed_superpoints_pcd) :  181
copy_superpoint_src_corr_points.shape :  (14542, 3)
mask.shape :  (14542,)
copy_superpoint_src_corr_points.shape :  (13730, 3)
copy_superpoint_ref_corr_points.shape :  (13730, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13730, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 13730, 3])
batch_inlier_masks.shape :  torch.Size([1965, 13730])
best_index :  11
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13730, 3)
transformed_src_superpoints.shape :  torch.Size([13730, 3])
residual.shape :  torch.Size([13730])
batch_inlier_masks.shape :  torch.Size([13730])
batch_outlier_masks.shape :  torch.Size([13730])
indices_inliers.shape :  torch.Size([61])
indices_outliers.shape :  torch.Size([13669])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([61, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 [ 0.05865671 -0.13002272  0.03322984]
 [ 0.06409369 -0.13082105  0.03001331]
 [-0.0688412  -0.14266108  0.03379423]
 [-0.05987869 -0.14416319  0.03023893]
 [-0.05693112 -0.14048307  0.0275293 ]
 [-0.06243759 -0.13869907  0.02912269]
 [-0.05987869 -0.14416319  0.03023893]
 [-0.06400242 -0.14632307  0.03295815]
 [-0.05693112 -0.14048307  0.0275293 ]
 [-0.00566406 -0.03963956  0.04611661]
 [-0.0575418  -0.12717794  0.02806726]
 [-0.0575418  -0.12717794  0.02806726]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.02197603 -0.03963404  0.05469598]
 [-0.01545584 -0.04110082  0.05289632]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.02197603 -0.03963404  0.05469598]
 [-0.01037333 -0.03972342  0.04966874]
 [-0.01545584 -0.04110082  0.05289632]
 [ 0.00068237 -0.05413906  0.04793929]
 [-0.00677244 -0.03339837  0.04332144]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00241171  0.02259507 -0.05067153]
 [-0.05168498 -0.13155507  0.02477531]
 [ 0.00769587  0.00805565 -0.05812374]
 [ 0.00177343  0.0078942  -0.05659277]
 [ 0.00614775 -0.00221008 -0.05595337]
 [ 0.00177343  0.0078942  -0.05659277]
 [-0.00019587  0.00224048 -0.05559123]
 [ 0.00769587  0.00805565 -0.05812374]
 [ 0.00177343  0.0078942  -0.05659277]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [ 0.00241171  0.02259507 -0.05067153]
 [ 0.00241171  0.02259507 -0.05067153]
 [-0.02770654 -0.09190547  0.0618809 ]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01587491 -0.00683671  0.03083937]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00512271  0.0013173  -0.05506705]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.00797186  0.00962656 -0.05529935]
 [-0.00406897  0.01284317 -0.0549841 ]
 [-0.00370615  0.00619817 -0.0556633 ]
 [-0.00512271  0.0013173  -0.05506705]
 [-0.01722543 -0.02832963  0.04707544]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01238832 -0.0274046   0.04395644]
 [-0.01138697 -0.03332953  0.04683894]
 [-0.01238832 -0.0274046   0.04395644]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01722543 -0.02832963  0.04707544]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.01898138 -0.02283034  0.04425756]
 [-0.01648548 -0.03445181  0.05004014]
 [-0.0004451   0.08390476 -0.06581885]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.02643657 -0.04212166 -0.05128226]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.02089846 -0.03862336 -0.04694999]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02643657 -0.04212166 -0.05128226]
 [ 0.02089846 -0.03862336 -0.04694999]
 [ 0.0261184  -0.04174077 -0.04599131]
 [-0.04074053 -0.12724331  0.02365168]
 [-0.03368619 -0.12849733  0.02553063]
 [-0.03809875 -0.13278046  0.02561154]
 [-0.03368619 -0.12849733  0.02553063]
 [-0.03809875 -0.13278046  0.02561154]
 [-0.04074053 -0.12724331  0.02365168]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.045078   -0.12250467  0.02318637]
 [-0.04588318 -0.13190164  0.02422521]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02774133 -0.01124226  0.03976112]
 [-0.02176532 -0.01251516  0.03837131]
 [-0.02625528 -0.00554776  0.03545638]
 [-0.02072618 -0.00723351  0.03396001]
 [-0.01587491 -0.00683671  0.03083937]
 [ 0.00177343  0.0078942  -0.05659277]
 [-0.00019587  0.00224048 -0.05559123]
 [-0.0004451   0.08390476 -0.06581885]
 [ 0.0164199  -0.035748   -0.05134133]
 [ 0.02086402 -0.03929642 -0.05200038]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01490012 -0.02746991 -0.05291076]
 [ 0.01812508 -0.03188318 -0.05549021]
 [ 0.01490012 -0.02746991 -0.05291076]
 [ 0.01490012 -0.02746991 -0.05291076]
 [-0.01587491 -0.00683671  0.03083937]
 [ 0.00357776  0.0174522  -0.05452624]
 [ 0.00628467  0.01359915 -0.05661006]
 [-0.01721309 -0.09221327  0.05402019]
 [ 0.07927147 -0.12766016  0.03516544]
 [ 0.07927147 -0.12766016  0.03516544]
 [ 0.08337816 -0.13908187  0.0245749 ]
 [ 0.07954869 -0.13128331  0.02876544]
 [ 0.07826672 -0.1388868   0.02019636]
 [ 0.07442202 -0.12609753  0.03063668]
 [ 0.07707766 -0.13372758  0.0234783 ]
 [ 0.07954869 -0.13128331  0.02876544]
 [ 0.07442202 -0.12609753  0.03063668]
 [ 0.07707766 -0.13372758  0.0234783 ]
 [ 0.07826672 -0.1388868   0.02019636]
 [ 0.07707766 -0.13372758  0.0234783 ]
 [ 0.07954869 -0.13128331  0.02876544]
 [ 0.07442202 -0.12609753  0.03063668]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.04337429 -0.12651128  0.0358494 ]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04337429 -0.12651128  0.0358494 ]
 [-0.03924527 -0.13215938  0.03526564]
 [-0.04661055 -0.13704965  0.04042288]
 [-0.04337429 -0.12651128  0.0358494 ]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.02946882 -0.08361915  0.05224239]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.02237315 -0.08886147  0.05404834]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03819939 -0.08577004  0.05191713]
 [-0.02946882 -0.08361915  0.05224239]
 [-0.0257936  -0.07954311  0.05002978]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.02237315 -0.08886147  0.05404834]
 [-0.02125475 -0.08446126  0.05156704]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03862233 -0.0786012   0.04882094]
 [-0.03541877 -0.07368567  0.04727324]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03839683 -0.12727532  0.03319136]
 [-0.03258999 -0.12588117  0.03008476]
 [-0.03258999 -0.12588117  0.03008476]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03541877 -0.07368567  0.04727324]
 [ 0.0048273   0.02792214 -0.0639488 ]
 [ 0.00732484  0.02068848 -0.0648047 ]
 [-0.03862233 -0.0786012   0.04882094]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03541877 -0.07368567  0.04727324]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.0314797  -0.0763834   0.0490361 ]
 [-0.03819939 -0.08577004  0.05191713]
 [-0.03469826 -0.081262    0.0510262 ]
 [-0.03862233 -0.0786012   0.04882094]
 [-0.03819939 -0.08577004  0.05191713]
 [-0.02946882 -0.08361915  0.05224239]
 [-0.02946882 -0.08361915  0.05224239]
 [ 0.05559238 -0.13926531  0.04140149]
 [ 0.06022223 -0.1374274   0.04034287]
 [ 0.049366   -0.13978913  0.0426782 ]
 [ 0.05559238 -0.13926531  0.04140149]
 [ 0.06022223 -0.1374274   0.04034287]
 [ 0.05881657 -0.13258797  0.04257197]
 [ 0.05434992 -0.13483423  0.0437547 ]
 [ 0.05881657 -0.13258797  0.04257197]
 [ 0.05434992 -0.13483423  0.0437547 ]
 [ 0.05881657 -0.13258797  0.04257197]
 [ 0.05559238 -0.13926531  0.04140149]
 [ 0.049366   -0.13978913  0.0426782 ]
 [ 0.049366   -0.13978913  0.0426782 ]
 [ 0.049366   -0.13978913  0.0426782 ]
 [ 0.04072909 -0.12973447  0.04389014]
 [ 0.04072909 -0.12973447  0.04389014]
 [ 0.04072909 -0.12973447  0.04389014]
 [ 0.04072909 -0.12973447  0.04389014]
 [ 0.06022223 -0.1374274   0.04034287]
 [ 0.05881657 -0.13258797  0.04257197]
 [ 0.05434992 -0.13483423  0.0437547 ]
 [ 0.05881657 -0.13258797  0.04257197]
 [ 0.07098454 -0.12532009  0.03354138]
 [ 0.07098454 -0.12532009  0.03354138]
 [ 0.06872393 -0.13736051  0.03398777]
 [ 0.07240286 -0.13463959  0.03163712]
 [ 0.07431357 -0.12281895  0.02831762]
 [-0.01860538 -0.10597014  0.01408274]
 [-0.01860538 -0.10597014  0.01408274]
 [-0.01860538 -0.10597014  0.01408274]
 [-0.01860538 -0.10597014  0.01408274]
 [-0.01860538 -0.10597014  0.01408274]
 [ 0.07046236 -0.1301117   0.03527762]
 [ 0.07240286 -0.13463959  0.03163712]
 [ 0.07046236 -0.1301117   0.03527762]
 [ 0.07728666 -0.13281557  0.02383603]
 [ 0.07728666 -0.13281557  0.02383603]
 [ 0.0747792  -0.1358684   0.02694716]
 [ 0.07413906 -0.12984015  0.03070112]
 [ 0.07728666 -0.13281557  0.02383603]
 [ 0.0747792  -0.1358684   0.02694716]
 [ 0.07413906 -0.12984015  0.03070112]
 [ 0.0747792  -0.1358684   0.02694716]
 [ 0.07769081 -0.12839274  0.02730657]
 [ 0.07413906 -0.12984015  0.03070112]
 [ 0.07769081 -0.12839274  0.02730657]
 [ 0.07413906 -0.12984015  0.03070112]
 [ 0.07413906 -0.12984015  0.03070112]
 [ 0.07769081 -0.12839274  0.02730657]
 [ 0.0104188   0.02187928 -0.05537362]
 [ 0.07431357 -0.12281895  0.02831762]
 [ 0.0718016  -0.11818232  0.02618148]
 [ 0.0718016  -0.11818232  0.02618148]
 [ 0.07431357 -0.12281895  0.02831762]
 [ 0.07431357 -0.12281895  0.02831762]
 [ 0.0718016  -0.11818232  0.02618148]
 [ 0.07098454 -0.12532009  0.03354138]
 [ 0.06559795 -0.12615034  0.0387091 ]
 [ 0.0667107  -0.12118246  0.03517157]
 [ 0.07098454 -0.12532009  0.03354138]
 [ 0.07098454 -0.12532009  0.03354138]]
len(transformed_superpoints_pcd) :  242
copy_superpoint_src_corr_points.shape :  (13669, 3)
mask.shape :  (13669,)
copy_superpoint_src_corr_points.shape :  (12634, 3)
copy_superpoint_ref_corr_points.shape :  (12634, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12634, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 12634, 3])
batch_inlier_masks.shape :  torch.Size([1965, 12634])
best_index :  482
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12634, 3)
transformed_src_superpoints.shape :  torch.Size([12634, 3])
residual.shape :  torch.Size([12634])
batch_inlier_masks.shape :  torch.Size([12634])
batch_outlier_masks.shape :  torch.Size([12634])
indices_inliers.shape :  torch.Size([54])
indices_outliers.shape :  torch.Size([12580])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([54, 3])
transformed_superpoints_pcd :  [[ 5.77475801e-02 -1.35756925e-01  3.37714180e-02]
 [ 6.29961640e-02 -1.35849729e-01  3.03197242e-02]
 [ 5.86567149e-02 -1.30022720e-01  3.32298428e-02]
 [ 5.86567149e-02 -1.30022720e-01  3.32298428e-02]
 [ 6.40936866e-02 -1.30821049e-01  3.00133079e-02]
 [-6.88411966e-02 -1.42661080e-01  3.37942280e-02]
 [-5.98786920e-02 -1.44163191e-01  3.02389264e-02]
 [-5.69311231e-02 -1.40483066e-01  2.75292974e-02]
 [-6.24375939e-02 -1.38699070e-01  2.91226897e-02]
 [-5.98786920e-02 -1.44163191e-01  3.02389264e-02]
 [-6.40024170e-02 -1.46323070e-01  3.29581462e-02]
 [-5.69311231e-02 -1.40483066e-01  2.75292974e-02]
 [-5.66405617e-03 -3.96395624e-02  4.61166129e-02]
 [-5.75418025e-02 -1.27177939e-01  2.80672554e-02]
 [-5.75418025e-02 -1.27177939e-01  2.80672554e-02]
 [-3.70615348e-03  6.19817432e-03 -5.56633025e-02]
 [-4.06897441e-03  1.28431721e-02 -5.49841039e-02]
 [-1.54558439e-02 -4.11008187e-02  5.28963208e-02]
 [-1.03733316e-02 -3.97234224e-02  4.96687368e-02]
 [-1.54558439e-02 -4.11008187e-02  5.28963208e-02]
 [-1.03733316e-02 -3.97234224e-02  4.96687368e-02]
 [-2.19760258e-02 -3.96340378e-02  5.46959750e-02]
 [-1.54558439e-02 -4.11008187e-02  5.28963208e-02]
 [-1.03733316e-02 -3.97234224e-02  4.96687368e-02]
 [-2.19760258e-02 -3.96340378e-02  5.46959750e-02]
 [-1.03733316e-02 -3.97234224e-02  4.96687368e-02]
 [-1.54558439e-02 -4.11008187e-02  5.28963208e-02]
 [ 6.82370737e-04 -5.41390553e-02  4.79392856e-02]
 [-6.77243806e-03 -3.33983712e-02  4.33214419e-02]
 [ 3.57775949e-03  1.74522027e-02 -5.45262434e-02]
 [ 6.28467463e-03  1.35991545e-02 -5.66100627e-02]
 [ 6.28467463e-03  1.35991545e-02 -5.66100627e-02]
 [ 6.28467463e-03  1.35991545e-02 -5.66100627e-02]
 [ 2.41171382e-03  2.25950703e-02 -5.06715290e-02]
 [-5.16849831e-02 -1.31555066e-01  2.47753076e-02]
 [ 7.69587047e-03  8.05564690e-03 -5.81237376e-02]
 [ 1.77343003e-03  7.89420027e-03 -5.65927736e-02]
 [ 6.14775158e-03 -2.21008062e-03 -5.59533723e-02]
 [ 1.77343003e-03  7.89420027e-03 -5.65927736e-02]
 [-1.95868313e-04  2.24047992e-03 -5.55912331e-02]
 [ 7.69587047e-03  8.05564690e-03 -5.81237376e-02]
 [ 1.77343003e-03  7.89420027e-03 -5.65927736e-02]
 [ 1.64198969e-02 -3.57480049e-02 -5.13413288e-02]
 [ 3.57775949e-03  1.74522027e-02 -5.45262434e-02]
 [ 6.28467463e-03  1.35991545e-02 -5.66100627e-02]
 [ 2.41171382e-03  2.25950703e-02 -5.06715290e-02]
 [ 2.41171382e-03  2.25950703e-02 -5.06715290e-02]
 [-2.77065355e-02 -9.19054672e-02  6.18808977e-02]
 [-1.64854825e-02 -3.44518051e-02  5.00401407e-02]
 [-1.58749055e-02 -6.83670770e-03  3.08393724e-02]
 [-7.97185861e-03  9.62656271e-03 -5.52993529e-02]
 [-5.12271188e-03  1.31729804e-03 -5.50670549e-02]
 [-3.70615348e-03  6.19817432e-03 -5.56633025e-02]
 [-7.97185861e-03  9.62656271e-03 -5.52993529e-02]
 [-4.06897441e-03  1.28431721e-02 -5.49841039e-02]
 [-7.97185861e-03  9.62656271e-03 -5.52993529e-02]
 [-4.06897441e-03  1.28431721e-02 -5.49841039e-02]
 [-3.70615348e-03  6.19817432e-03 -5.56633025e-02]
 [-5.12271188e-03  1.31729804e-03 -5.50670549e-02]
 [-1.72254331e-02 -2.83296332e-02  4.70754355e-02]
 [-1.64854825e-02 -3.44518051e-02  5.00401407e-02]
 [-1.23883169e-02 -2.74046026e-02  4.39564399e-02]
 [-1.13869682e-02 -3.33295278e-02  4.68389429e-02]
 [-1.23883169e-02 -2.74046026e-02  4.39564399e-02]
 [-1.64854825e-02 -3.44518051e-02  5.00401407e-02]
 [-1.72254331e-02 -2.83296332e-02  4.70754355e-02]
 [-1.64854825e-02 -3.44518051e-02  5.00401407e-02]
 [-1.89813767e-02 -2.28303373e-02  4.42575626e-02]
 [-1.64854825e-02 -3.44518051e-02  5.00401407e-02]
 [-4.45095822e-04  8.39047581e-02 -6.58188462e-02]
 [ 2.08640192e-02 -3.92964222e-02 -5.20003811e-02]
 [ 1.64198969e-02 -3.57480049e-02 -5.13413288e-02]
 [ 2.08640192e-02 -3.92964222e-02 -5.20003811e-02]
 [ 2.64365692e-02 -4.21216600e-02 -5.12822568e-02]
 [ 1.64198969e-02 -3.57480049e-02 -5.13413288e-02]
 [ 2.08640192e-02 -3.92964222e-02 -5.20003811e-02]
 [ 2.08984558e-02 -3.86233591e-02 -4.69499864e-02]
 [ 1.64198969e-02 -3.57480049e-02 -5.13413288e-02]
 [ 2.64365692e-02 -4.21216600e-02 -5.12822568e-02]
 [ 2.08984558e-02 -3.86233591e-02 -4.69499864e-02]
 [ 2.61183959e-02 -4.17407677e-02 -4.59913127e-02]
 [-4.07405347e-02 -1.27243310e-01  2.36516837e-02]
 [-3.36861871e-02 -1.28497332e-01  2.55306307e-02]
 [-3.80987488e-02 -1.32780463e-01  2.56115422e-02]
 [-3.36861871e-02 -1.28497332e-01  2.55306307e-02]
 [-3.80987488e-02 -1.32780463e-01  2.56115422e-02]
 [-4.07405347e-02 -1.27243310e-01  2.36516837e-02]
 [-4.58831824e-02 -1.31901637e-01  2.42252089e-02]
 [-4.58831824e-02 -1.31901637e-01  2.42252089e-02]
 [-4.50779982e-02 -1.22504666e-01  2.31863670e-02]
 [-4.58831824e-02 -1.31901637e-01  2.42252089e-02]
 [-2.17653178e-02 -1.25151612e-02  3.83713134e-02]
 [-2.62552798e-02 -5.54776238e-03  3.54563780e-02]
 [-2.17653178e-02 -1.25151612e-02  3.83713134e-02]
 [-2.62552798e-02 -5.54776238e-03  3.54563780e-02]
 [-2.77413297e-02 -1.12422649e-02  3.97611223e-02]
 [-2.17653178e-02 -1.25151612e-02  3.83713134e-02]
 [-2.62552798e-02 -5.54776238e-03  3.54563780e-02]
 [-2.07261797e-02 -7.23351212e-03  3.39600109e-02]
 [-1.58749055e-02 -6.83670770e-03  3.08393724e-02]
 [ 1.77343003e-03  7.89420027e-03 -5.65927736e-02]
 [-1.95868313e-04  2.24047992e-03 -5.55912331e-02]
 [-4.45095822e-04  8.39047581e-02 -6.58188462e-02]
 [ 1.64198969e-02 -3.57480049e-02 -5.13413288e-02]
 [ 2.08640192e-02 -3.92964222e-02 -5.20003811e-02]
 [ 1.81250777e-02 -3.18831801e-02 -5.54902069e-02]
 [ 1.81250777e-02 -3.18831801e-02 -5.54902069e-02]
 [ 1.49001237e-02 -2.74699107e-02 -5.29107638e-02]
 [ 1.81250777e-02 -3.18831801e-02 -5.54902069e-02]
 [ 1.49001237e-02 -2.74699107e-02 -5.29107638e-02]
 [ 1.49001237e-02 -2.74699107e-02 -5.29107638e-02]
 [-1.58749055e-02 -6.83670770e-03  3.08393724e-02]
 [ 3.57775949e-03  1.74522027e-02 -5.45262434e-02]
 [ 6.28467463e-03  1.35991545e-02 -5.66100627e-02]
 [-1.72130857e-02 -9.22132656e-02  5.40201925e-02]
 [ 7.92714730e-02 -1.27660155e-01  3.51654403e-02]
 [ 7.92714730e-02 -1.27660155e-01  3.51654403e-02]
 [ 8.33781585e-02 -1.39081866e-01  2.45749019e-02]
 [ 7.95486867e-02 -1.31283313e-01  2.87654437e-02]
 [ 7.82667249e-02 -1.38886794e-01  2.01963596e-02]
 [ 7.44220167e-02 -1.26097530e-01  3.06366794e-02]
 [ 7.70776644e-02 -1.33727580e-01  2.34782957e-02]
 [ 7.95486867e-02 -1.31283313e-01  2.87654437e-02]
 [ 7.44220167e-02 -1.26097530e-01  3.06366794e-02]
 [ 7.70776644e-02 -1.33727580e-01  2.34782957e-02]
 [ 7.82667249e-02 -1.38886794e-01  2.01963596e-02]
 [ 7.70776644e-02 -1.33727580e-01  2.34782957e-02]
 [ 7.95486867e-02 -1.31283313e-01  2.87654437e-02]
 [ 7.44220167e-02 -1.26097530e-01  3.06366794e-02]
 [-4.66105491e-02 -1.37049645e-01  4.04228829e-02]
 [-3.92452665e-02 -1.32159382e-01  3.52656431e-02]
 [-4.66105491e-02 -1.37049645e-01  4.04228829e-02]
 [-3.92452665e-02 -1.32159382e-01  3.52656431e-02]
 [-3.92452665e-02 -1.32159382e-01  3.52656431e-02]
 [-4.66105491e-02 -1.37049645e-01  4.04228829e-02]
 [-4.33742851e-02 -1.26511276e-01  3.58494036e-02]
 [-3.92452665e-02 -1.32159382e-01  3.52656431e-02]
 [-4.33742851e-02 -1.26511276e-01  3.58494036e-02]
 [-3.92452665e-02 -1.32159382e-01  3.52656431e-02]
 [-4.66105491e-02 -1.37049645e-01  4.04228829e-02]
 [-4.33742851e-02 -1.26511276e-01  3.58494036e-02]
 [-2.12547481e-02 -8.44612643e-02  5.15670441e-02]
 [-2.94688176e-02 -8.36191550e-02  5.22423945e-02]
 [-2.12547481e-02 -8.44612643e-02  5.15670441e-02]
 [-2.23731548e-02 -8.88614655e-02  5.40483408e-02]
 [-2.12547481e-02 -8.44612643e-02  5.15670441e-02]
 [-3.83968279e-02 -1.27275318e-01  3.31913568e-02]
 [-3.83968279e-02 -1.27275318e-01  3.31913568e-02]
 [-3.46982628e-02 -8.12619999e-02  5.10261990e-02]
 [-3.14796977e-02 -7.63833970e-02  4.90360968e-02]
 [-3.81993949e-02 -8.57700408e-02  5.19171320e-02]
 [-2.94688176e-02 -8.36191550e-02  5.22423945e-02]
 [-2.57935971e-02 -7.95431063e-02  5.00297807e-02]
 [-2.12547481e-02 -8.44612643e-02  5.15670441e-02]
 [-2.23731548e-02 -8.88614655e-02  5.40483408e-02]
 [-2.12547481e-02 -8.44612643e-02  5.15670441e-02]
 [-3.46982628e-02 -8.12619999e-02  5.10261990e-02]
 [-3.14796977e-02 -7.63833970e-02  4.90360968e-02]
 [-3.86223346e-02 -7.86012039e-02  4.88209389e-02]
 [-3.54187712e-02 -7.36856684e-02  4.72732447e-02]
 [-3.14796977e-02 -7.63833970e-02  4.90360968e-02]
 [-3.83968279e-02 -1.27275318e-01  3.31913568e-02]
 [-3.83968279e-02 -1.27275318e-01  3.31913568e-02]
 [-3.25899944e-02 -1.25881165e-01  3.00847553e-02]
 [-3.25899944e-02 -1.25881165e-01  3.00847553e-02]
 [-3.14796977e-02 -7.63833970e-02  4.90360968e-02]
 [-3.14796977e-02 -7.63833970e-02  4.90360968e-02]
 [-3.54187712e-02 -7.36856684e-02  4.72732447e-02]
 [ 4.82729729e-03  2.79221386e-02 -6.39487952e-02]
 [ 7.32483529e-03  2.06884816e-02 -6.48046955e-02]
 [-3.86223346e-02 -7.86012039e-02  4.88209389e-02]
 [-3.14796977e-02 -7.63833970e-02  4.90360968e-02]
 [-3.54187712e-02 -7.36856684e-02  4.72732447e-02]
 [-3.46982628e-02 -8.12619999e-02  5.10261990e-02]
 [-3.14796977e-02 -7.63833970e-02  4.90360968e-02]
 [-3.81993949e-02 -8.57700408e-02  5.19171320e-02]
 [-3.46982628e-02 -8.12619999e-02  5.10261990e-02]
 [-3.86223346e-02 -7.86012039e-02  4.88209389e-02]
 [-3.81993949e-02 -8.57700408e-02  5.19171320e-02]
 [-2.94688176e-02 -8.36191550e-02  5.22423945e-02]
 [-2.94688176e-02 -8.36191550e-02  5.22423945e-02]
 [ 5.55923805e-02 -1.39265314e-01  4.14014906e-02]
 [ 6.02222346e-02 -1.37427405e-01  4.03428748e-02]
 [ 4.93660010e-02 -1.39789134e-01  4.26781997e-02]
 [ 5.55923805e-02 -1.39265314e-01  4.14014906e-02]
 [ 6.02222346e-02 -1.37427405e-01  4.03428748e-02]
 [ 5.88165708e-02 -1.32587969e-01  4.25719731e-02]
 [ 5.43499216e-02 -1.34834230e-01  4.37547043e-02]
 [ 5.88165708e-02 -1.32587969e-01  4.25719731e-02]
 [ 5.43499216e-02 -1.34834230e-01  4.37547043e-02]
 [ 5.88165708e-02 -1.32587969e-01  4.25719731e-02]
 [ 5.55923805e-02 -1.39265314e-01  4.14014906e-02]
 [ 4.93660010e-02 -1.39789134e-01  4.26781997e-02]
 [ 4.93660010e-02 -1.39789134e-01  4.26781997e-02]
 [ 4.93660010e-02 -1.39789134e-01  4.26781997e-02]
 [ 4.07290943e-02 -1.29734471e-01  4.38901447e-02]
 [ 4.07290943e-02 -1.29734471e-01  4.38901447e-02]
 [ 4.07290943e-02 -1.29734471e-01  4.38901447e-02]
 [ 4.07290943e-02 -1.29734471e-01  4.38901447e-02]
 [ 6.02222346e-02 -1.37427405e-01  4.03428748e-02]
 [ 5.88165708e-02 -1.32587969e-01  4.25719731e-02]
 [ 5.43499216e-02 -1.34834230e-01  4.37547043e-02]
 [ 5.88165708e-02 -1.32587969e-01  4.25719731e-02]
 [ 7.09845424e-02 -1.25320092e-01  3.35413814e-02]
 [ 7.09845424e-02 -1.25320092e-01  3.35413814e-02]
 [ 6.87239319e-02 -1.37360513e-01  3.39877680e-02]
 [ 7.24028647e-02 -1.34639591e-01  3.16371210e-02]
 [ 7.43135661e-02 -1.22818947e-01  2.83176228e-02]
 [-1.86053794e-02 -1.05970144e-01  1.40827410e-02]
 [-1.86053794e-02 -1.05970144e-01  1.40827410e-02]
 [-1.86053794e-02 -1.05970144e-01  1.40827410e-02]
 [-1.86053794e-02 -1.05970144e-01  1.40827410e-02]
 [-1.86053794e-02 -1.05970144e-01  1.40827410e-02]
 [ 7.04623610e-02 -1.30111694e-01  3.52776162e-02]
 [ 7.24028647e-02 -1.34639591e-01  3.16371210e-02]
 [ 7.04623610e-02 -1.30111694e-01  3.52776162e-02]
 [ 7.72866607e-02 -1.32815570e-01  2.38360278e-02]
 [ 7.72866607e-02 -1.32815570e-01  2.38360278e-02]
 [ 7.47791976e-02 -1.35868400e-01  2.69471556e-02]
 [ 7.41390586e-02 -1.29840150e-01  3.07011232e-02]
 [ 7.72866607e-02 -1.32815570e-01  2.38360278e-02]
 [ 7.47791976e-02 -1.35868400e-01  2.69471556e-02]
 [ 7.41390586e-02 -1.29840150e-01  3.07011232e-02]
 [ 7.47791976e-02 -1.35868400e-01  2.69471556e-02]
 [ 7.76908100e-02 -1.28392741e-01  2.73065716e-02]
 [ 7.41390586e-02 -1.29840150e-01  3.07011232e-02]
 [ 7.76908100e-02 -1.28392741e-01  2.73065716e-02]
 [ 7.41390586e-02 -1.29840150e-01  3.07011232e-02]
 [ 7.41390586e-02 -1.29840150e-01  3.07011232e-02]
 [ 7.76908100e-02 -1.28392741e-01  2.73065716e-02]
 [ 1.04188044e-02  2.18792763e-02 -5.53736240e-02]
 [ 7.43135661e-02 -1.22818947e-01  2.83176228e-02]
 [ 7.18016028e-02 -1.18182324e-01  2.61814781e-02]
 [ 7.18016028e-02 -1.18182324e-01  2.61814781e-02]
 [ 7.43135661e-02 -1.22818947e-01  2.83176228e-02]
 [ 7.43135661e-02 -1.22818947e-01  2.83176228e-02]
 [ 7.18016028e-02 -1.18182324e-01  2.61814781e-02]
 [ 7.09845424e-02 -1.25320092e-01  3.35413814e-02]
 [ 6.55979514e-02 -1.26150340e-01  3.87091041e-02]
 [ 6.67106956e-02 -1.21182457e-01  3.51715684e-02]
 [ 7.09845424e-02 -1.25320092e-01  3.35413814e-02]
 [ 7.09845424e-02 -1.25320092e-01  3.35413814e-02]
 [-1.48094594e-02  6.04560897e-02  2.75438651e-02]
 [-1.65568367e-02  6.54182658e-02  2.80364379e-02]
 [-1.20831709e-02  6.76314831e-02  2.75483802e-02]
 [-1.20831709e-02  6.76314831e-02  2.75483802e-02]
 [-1.65568367e-02  6.54182658e-02  2.80364379e-02]
 [-1.48094594e-02  6.04560897e-02  2.75438651e-02]
 [-1.20831709e-02  6.76314831e-02  2.75483802e-02]
 [ 6.60526007e-03  7.92639852e-02 -7.19953477e-02]
 [ 8.49667192e-03  6.95400238e-02 -7.04355091e-02]
 [ 4.54172119e-03  7.25682303e-02 -7.16027245e-02]
 [ 6.60526007e-03  7.92639852e-02 -7.19953477e-02]
 [ 1.17131695e-03  7.79869184e-02 -7.29446635e-02]
 [ 8.49667192e-03  6.95400238e-02 -7.04355091e-02]
 [ 4.54172119e-03  7.25682303e-02 -7.16027245e-02]
 [ 1.23893879e-02  7.53045827e-02 -7.06083030e-02]
 [ 1.17131695e-03  7.79869184e-02 -7.29446635e-02]
 [ 4.54172119e-03  7.25682303e-02 -7.16027245e-02]
 [ 1.23893879e-02  7.53045827e-02 -7.06083030e-02]
 [ 1.17131695e-03  7.79869184e-02 -7.29446635e-02]
 [ 7.19621405e-03  6.46642148e-02 -6.95594102e-02]
 [-2.82950699e-04  6.49100393e-02 -7.38422275e-02]
 [ 7.19621405e-03  6.46642148e-02 -6.95594102e-02]
 [-3.59524228e-03  6.22091405e-02  2.60446146e-02]
 [-7.92850181e-03  6.47537261e-02  2.69089565e-02]
 [-3.59524228e-03  6.22091405e-02  2.60446146e-02]
 [-7.92850181e-03  6.47537261e-02  2.69089565e-02]
 [-7.92850181e-03  6.47537261e-02  2.69089565e-02]
 [-3.90320085e-03  7.80619979e-02 -7.39292651e-02]
 [-3.90320085e-03  7.80619979e-02 -7.39292651e-02]
 [-1.65568367e-02  6.54182658e-02  2.80364379e-02]
 [-1.20831709e-02  6.76314831e-02  2.75483802e-02]
 [ 1.23893879e-02  7.53045827e-02 -7.06083030e-02]
 [ 1.17131695e-03  7.79869184e-02 -7.29446635e-02]
 [ 1.04857571e-02  9.08556208e-02 -6.67967200e-02]
 [ 5.87474182e-03  8.91247243e-02 -6.89781830e-02]
 [ 1.04857571e-02  9.08556208e-02 -6.67967200e-02]
 [ 1.04857571e-02  9.08556208e-02 -6.67967200e-02]
 [ 5.87474182e-03  8.91247243e-02 -6.89781830e-02]
 [ 5.87474182e-03  8.91247243e-02 -6.89781830e-02]
 [-1.04867853e-02  5.62701300e-02  2.68028006e-02]
 [-3.59524228e-03  6.22091405e-02  2.60446146e-02]
 [-7.92850181e-03  6.47537261e-02  2.69089565e-02]
 [-1.04867853e-02  5.62701300e-02  2.68028006e-02]
 [-5.60942851e-03  7.22989142e-02  2.56544277e-02]
 [-1.60567723e-02  7.10896403e-02  2.78479233e-02]
 [-5.60942851e-03  7.22989142e-02  2.56544277e-02]
 [-1.60567723e-02  7.10896403e-02  2.78479233e-02]
 [-3.90320085e-03  7.80619979e-02 -7.39292651e-02]
 [-6.29127771e-03  8.52753296e-02 -7.17005283e-02]
 [-4.96171415e-05  9.11068916e-02 -6.72522634e-02]
 [ 4.50813025e-03  9.25535038e-02 -6.51491433e-02]
 [ 5.69820404e-04  8.55890885e-02 -7.13915005e-02]
 [ 5.69820404e-04  8.55890885e-02 -7.13915005e-02]
 [ 5.69820404e-04  8.55890885e-02 -7.13915005e-02]]
len(transformed_superpoints_pcd) :  296
copy_superpoint_src_corr_points.shape :  (12580, 3)
mask.shape :  (12580,)
copy_superpoint_src_corr_points.shape :  (11419, 3)
copy_superpoint_ref_corr_points.shape :  (11419, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([11419, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 11419, 3])
batch_inlier_masks.shape :  torch.Size([1965, 11419])
best_index :  806
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (11419, 3)
transformed_src_superpoints.shape :  torch.Size([11419, 3])
residual.shape :  torch.Size([11419])
batch_inlier_masks.shape :  torch.Size([11419])
batch_outlier_masks.shape :  torch.Size([11419])
indices_inliers.shape :  torch.Size([53])
indices_outliers.shape :  torch.Size([11366])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([53, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.03298072  0.07982614  0.00616923]
 [-0.0379991   0.09763663  0.00490059]
 [-0.03898489  0.08970778  0.00482364]]
len(transformed_superpoints_pcd) :  349
copy_superpoint_src_corr_points.shape :  (11366, 3)
mask.shape :  (11366,)
copy_superpoint_src_corr_points.shape :  (10742, 3)
copy_superpoint_ref_corr_points.shape :  (10742, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10742, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 10742, 3])
batch_inlier_masks.shape :  torch.Size([1965, 10742])
best_index :  1477
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10742, 3)
transformed_src_superpoints.shape :  torch.Size([10742, 3])
residual.shape :  torch.Size([10742])
batch_inlier_masks.shape :  torch.Size([10742])
batch_outlier_masks.shape :  torch.Size([10742])
indices_inliers.shape :  torch.Size([48])
indices_outliers.shape :  torch.Size([10694])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([48, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.03990333 -0.13752179  0.0297424 ]
 [-0.03795514 -0.14399703  0.0315505 ]
 [-0.04310565 -0.1419853   0.03273621]]
len(transformed_superpoints_pcd) :  397
copy_superpoint_src_corr_points.shape :  (10694, 3)
mask.shape :  (10694,)
copy_superpoint_src_corr_points.shape :  (9268, 3)
copy_superpoint_ref_corr_points.shape :  (9268, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9268, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 9268, 3])
batch_inlier_masks.shape :  torch.Size([1965, 9268])
best_index :  1335
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9268, 3)
transformed_src_superpoints.shape :  torch.Size([9268, 3])
residual.shape :  torch.Size([9268])
batch_inlier_masks.shape :  torch.Size([9268])
batch_outlier_masks.shape :  torch.Size([9268])
indices_inliers.shape :  torch.Size([46])
indices_outliers.shape :  torch.Size([9222])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([46, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.0577215   0.01734173  0.00453974]
 [-0.00375904  0.08134843 -0.07214995]
 [ 0.01838587  0.09710541 -0.0727951 ]]
len(transformed_superpoints_pcd) :  443
copy_superpoint_src_corr_points.shape :  (9222, 3)
mask.shape :  (9222,)
copy_superpoint_src_corr_points.shape :  (8438, 3)
copy_superpoint_ref_corr_points.shape :  (8438, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8438, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 8438, 3])
batch_inlier_masks.shape :  torch.Size([1965, 8438])
best_index :  469
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8438, 3)
transformed_src_superpoints.shape :  torch.Size([8438, 3])
residual.shape :  torch.Size([8438])
batch_inlier_masks.shape :  torch.Size([8438])
batch_outlier_masks.shape :  torch.Size([8438])
indices_inliers.shape :  torch.Size([45])
indices_outliers.shape :  torch.Size([8393])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([45, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.02853082 -0.09484872  0.05943231]
 [-0.0258678  -0.08841736  0.05464201]
 [-0.0315718  -0.09083252  0.05733592]]
len(transformed_superpoints_pcd) :  488
copy_superpoint_src_corr_points.shape :  (8393, 3)
mask.shape :  (8393,)
copy_superpoint_src_corr_points.shape :  (7515, 3)
copy_superpoint_ref_corr_points.shape :  (7515, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7515, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 7515, 3])
batch_inlier_masks.shape :  torch.Size([1965, 7515])
best_index :  1648
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7515, 3)
transformed_src_superpoints.shape :  torch.Size([7515, 3])
residual.shape :  torch.Size([7515])
batch_inlier_masks.shape :  torch.Size([7515])
batch_outlier_masks.shape :  torch.Size([7515])
indices_inliers.shape :  torch.Size([42])
indices_outliers.shape :  torch.Size([7473])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([42, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.01787144  0.08930448 -0.07410056]
 [ 0.01483736  0.0829839  -0.07319678]
 [ 0.01787144  0.08930448 -0.07410056]]
len(transformed_superpoints_pcd) :  530
copy_superpoint_src_corr_points.shape :  (7473, 3)
mask.shape :  (7473,)
copy_superpoint_src_corr_points.shape :  (7279, 3)
copy_superpoint_ref_corr_points.shape :  (7279, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7279, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 7279, 3])
batch_inlier_masks.shape :  torch.Size([1965, 7279])
best_index :  218
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7279, 3)
transformed_src_superpoints.shape :  torch.Size([7279, 3])
residual.shape :  torch.Size([7279])
batch_inlier_masks.shape :  torch.Size([7279])
batch_outlier_masks.shape :  torch.Size([7279])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([7241])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.04626067  0.09406802 -0.00396751]
 [-0.04333272  0.09405791  0.00083471]
 [-0.07857922 -0.01293503  0.00515767]]
len(transformed_superpoints_pcd) :  568
copy_superpoint_src_corr_points.shape :  (7241, 3)
mask.shape :  (7241,)
copy_superpoint_src_corr_points.shape :  (6907, 3)
copy_superpoint_ref_corr_points.shape :  (6907, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6907, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 6907, 3])
batch_inlier_masks.shape :  torch.Size([1965, 6907])
best_index :  1324
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6907, 3)
transformed_src_superpoints.shape :  torch.Size([6907, 3])
residual.shape :  torch.Size([6907])
batch_inlier_masks.shape :  torch.Size([6907])
batch_outlier_masks.shape :  torch.Size([6907])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([6869])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.02370978  0.08054446  0.01522131]
 [-0.02713414  0.09107859  0.01358595]
 [-0.02189758  0.09283101  0.01565377]]
len(transformed_superpoints_pcd) :  606
copy_superpoint_src_corr_points.shape :  (6869, 3)
mask.shape :  (6869,)
copy_superpoint_src_corr_points.shape :  (6548, 3)
copy_superpoint_ref_corr_points.shape :  (6548, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6548, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 6548, 3])
batch_inlier_masks.shape :  torch.Size([1965, 6548])
best_index :  632
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6548, 3)
transformed_src_superpoints.shape :  torch.Size([6548, 3])
residual.shape :  torch.Size([6548])
batch_inlier_masks.shape :  torch.Size([6548])
batch_outlier_masks.shape :  torch.Size([6548])
indices_inliers.shape :  torch.Size([35])
indices_outliers.shape :  torch.Size([6513])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([35, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00480337  0.0135184  -0.05872762]
 [ 0.0025515   0.00935975 -0.0570896 ]
 [ 0.00403006  0.00489042 -0.05268341]]
len(transformed_superpoints_pcd) :  641
copy_superpoint_src_corr_points.shape :  (6513, 3)
mask.shape :  (6513,)
copy_superpoint_src_corr_points.shape :  (5986, 3)
copy_superpoint_ref_corr_points.shape :  (5986, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5986, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 5986, 3])
batch_inlier_masks.shape :  torch.Size([1965, 5986])
best_index :  757
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5986, 3)
transformed_src_superpoints.shape :  torch.Size([5986, 3])
residual.shape :  torch.Size([5986])
batch_inlier_masks.shape :  torch.Size([5986])
batch_outlier_masks.shape :  torch.Size([5986])
indices_inliers.shape :  torch.Size([34])
indices_outliers.shape :  torch.Size([5952])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([34, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.04100688 -0.13317627  0.02806585]
 [-0.04100688 -0.13317627  0.02806585]
 [-0.04100688 -0.13317627  0.02806585]]
len(transformed_superpoints_pcd) :  675
copy_superpoint_src_corr_points.shape :  (5952, 3)
mask.shape :  (5952,)
copy_superpoint_src_corr_points.shape :  (4984, 3)
copy_superpoint_ref_corr_points.shape :  (4984, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4984, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 4984, 3])
batch_inlier_masks.shape :  torch.Size([1965, 4984])
best_index :  239
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4984, 3)
transformed_src_superpoints.shape :  torch.Size([4984, 3])
residual.shape :  torch.Size([4984])
batch_inlier_masks.shape :  torch.Size([4984])
batch_outlier_masks.shape :  torch.Size([4984])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([4953])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.02903734 -0.08162429  0.05207977]
 [-0.07561083  0.00493189  0.00199503]
 [-0.01782426 -0.07641527  0.04440674]]
len(transformed_superpoints_pcd) :  706
copy_superpoint_src_corr_points.shape :  (4953, 3)
mask.shape :  (4953,)
copy_superpoint_src_corr_points.shape :  (4089, 3)
copy_superpoint_ref_corr_points.shape :  (4089, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4089, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 4089, 3])
batch_inlier_masks.shape :  torch.Size([1965, 4089])
best_index :  851
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4089, 3)
transformed_src_superpoints.shape :  torch.Size([4089, 3])
residual.shape :  torch.Size([4089])
batch_inlier_masks.shape :  torch.Size([4089])
batch_outlier_masks.shape :  torch.Size([4089])
indices_inliers.shape :  torch.Size([30])
indices_outliers.shape :  torch.Size([4059])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([30, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.04781788  0.09535206  0.00123518]
 [-0.0449089   0.08983021  0.00039314]
 [-0.0419465   0.07893984 -0.00552292]]
len(transformed_superpoints_pcd) :  736
copy_superpoint_src_corr_points.shape :  (4059, 3)
mask.shape :  (4059,)
copy_superpoint_src_corr_points.shape :  (3736, 3)
copy_superpoint_ref_corr_points.shape :  (3736, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3736, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 3736, 3])
batch_inlier_masks.shape :  torch.Size([1965, 3736])
best_index :  1737
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3736, 3)
transformed_src_superpoints.shape :  torch.Size([3736, 3])
residual.shape :  torch.Size([3736])
batch_inlier_masks.shape :  torch.Size([3736])
batch_outlier_masks.shape :  torch.Size([3736])
indices_inliers.shape :  torch.Size([30])
indices_outliers.shape :  torch.Size([3706])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([30, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.0464167  -0.13340373  0.0271214 ]
 [-0.04134911 -0.13192445  0.0272907 ]
 [-0.05038202 -0.12959671  0.02228105]]
len(transformed_superpoints_pcd) :  766
copy_superpoint_src_corr_points.shape :  (3706, 3)
mask.shape :  (3706,)
copy_superpoint_src_corr_points.shape :  (3627, 3)
copy_superpoint_ref_corr_points.shape :  (3627, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3627, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 3627, 3])
batch_inlier_masks.shape :  torch.Size([1965, 3627])
best_index :  1249
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3627, 3)
transformed_src_superpoints.shape :  torch.Size([3627, 3])
residual.shape :  torch.Size([3627])
batch_inlier_masks.shape :  torch.Size([3627])
batch_outlier_masks.shape :  torch.Size([3627])
indices_inliers.shape :  torch.Size([26])
indices_outliers.shape :  torch.Size([3601])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([26, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.06462143  0.01031421  0.00796423]
 [-0.06462143  0.01031421  0.00796423]
 [-0.07145913  0.00373746  0.01398997]]
len(transformed_superpoints_pcd) :  792
copy_superpoint_src_corr_points.shape :  (3601, 3)
mask.shape :  (3601,)
copy_superpoint_src_corr_points.shape :  (3195, 3)
copy_superpoint_ref_corr_points.shape :  (3195, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3195, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 3195, 3])
batch_inlier_masks.shape :  torch.Size([1965, 3195])
best_index :  518
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3195, 3)
transformed_src_superpoints.shape :  torch.Size([3195, 3])
residual.shape :  torch.Size([3195])
batch_inlier_masks.shape :  torch.Size([3195])
batch_outlier_masks.shape :  torch.Size([3195])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([3171])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.0419804   0.08531994  0.00182234]
 [-0.0442467   0.09308463 -0.00183724]
 [-0.0419804   0.08531994  0.00182234]]
len(transformed_superpoints_pcd) :  816
copy_superpoint_src_corr_points.shape :  (3171, 3)
mask.shape :  (3171,)
copy_superpoint_src_corr_points.shape :  (2972, 3)
copy_superpoint_ref_corr_points.shape :  (2972, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2972, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 2972, 3])
batch_inlier_masks.shape :  torch.Size([1965, 2972])
best_index :  1432
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2972, 3)
transformed_src_superpoints.shape :  torch.Size([2972, 3])
residual.shape :  torch.Size([2972])
batch_inlier_masks.shape :  torch.Size([2972])
batch_outlier_masks.shape :  torch.Size([2972])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([2948])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.05116728  0.1031025  -0.0030597 ]
 [-0.052393    0.09781202 -0.00419369]
 [-0.04775635  0.09658632  0.00267848]]
len(transformed_superpoints_pcd) :  840
copy_superpoint_src_corr_points.shape :  (2948, 3)
mask.shape :  (2948,)
copy_superpoint_src_corr_points.shape :  (2885, 3)
copy_superpoint_ref_corr_points.shape :  (2885, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2885, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 2885, 3])
batch_inlier_masks.shape :  torch.Size([1965, 2885])
best_index :  1281
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2885, 3)
transformed_src_superpoints.shape :  torch.Size([2885, 3])
residual.shape :  torch.Size([2885])
batch_inlier_masks.shape :  torch.Size([2885])
batch_outlier_masks.shape :  torch.Size([2885])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([2863])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00979462  0.02477521 -0.05071183]
 [ 0.00979462  0.02477521 -0.05071183]
 [ 0.00979462  0.02477521 -0.05071183]]
len(transformed_superpoints_pcd) :  862
copy_superpoint_src_corr_points.shape :  (2863, 3)
mask.shape :  (2863,)
copy_superpoint_src_corr_points.shape :  (2827, 3)
copy_superpoint_ref_corr_points.shape :  (2827, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2827, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 2827, 3])
batch_inlier_masks.shape :  torch.Size([1965, 2827])
best_index :  241
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2827, 3)
transformed_src_superpoints.shape :  torch.Size([2827, 3])
residual.shape :  torch.Size([2827])
batch_inlier_masks.shape :  torch.Size([2827])
batch_outlier_masks.shape :  torch.Size([2827])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([2808])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[ 5.7747580e-02 -1.3575692e-01  3.3771418e-02]
 [ 6.2996164e-02 -1.3584973e-01  3.0319724e-02]
 [ 5.8656715e-02 -1.3002272e-01  3.3229843e-02]
 ...
 [-7.0878357e-02 -7.8689307e-05 -1.2744121e-02]
 [-7.2665371e-02 -6.3566463e-03 -1.5172429e-02]
 [-7.0878357e-02 -7.8689307e-05 -1.2744121e-02]]
len(transformed_superpoints_pcd) :  881
copy_superpoint_src_corr_points.shape :  (2808, 3)
mask.shape :  (2808,)
copy_superpoint_src_corr_points.shape :  (2274, 3)
copy_superpoint_ref_corr_points.shape :  (2274, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2274, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 2274, 3])
batch_inlier_masks.shape :  torch.Size([1965, 2274])
best_index :  437
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2274, 3)
transformed_src_superpoints.shape :  torch.Size([2274, 3])
residual.shape :  torch.Size([2274])
batch_inlier_masks.shape :  torch.Size([2274])
batch_outlier_masks.shape :  torch.Size([2274])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([2256])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.0868333   0.01251331 -0.06276682]
 [ 0.0868333   0.01251331 -0.06276682]
 [ 0.05103066  0.09769316 -0.06383248]]
len(transformed_superpoints_pcd) :  899
copy_superpoint_src_corr_points.shape :  (2256, 3)
mask.shape :  (2256,)
copy_superpoint_src_corr_points.shape :  (1743, 3)
copy_superpoint_ref_corr_points.shape :  (1743, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1743, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1743, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1743])
best_index :  759
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1743, 3)
transformed_src_superpoints.shape :  torch.Size([1743, 3])
residual.shape :  torch.Size([1743])
batch_inlier_masks.shape :  torch.Size([1743])
batch_outlier_masks.shape :  torch.Size([1743])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1726])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.02098712 -0.07972179  0.04435504]
 [-0.02564409 -0.08243193  0.04819832]
 [-0.02017162 -0.08455285  0.04969582]]
len(transformed_superpoints_pcd) :  916
copy_superpoint_src_corr_points.shape :  (1726, 3)
mask.shape :  (1726,)
copy_superpoint_src_corr_points.shape :  (1563, 3)
copy_superpoint_ref_corr_points.shape :  (1563, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1563, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1563, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1563])
best_index :  1832
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1563, 3)
transformed_src_superpoints.shape :  torch.Size([1563, 3])
residual.shape :  torch.Size([1563])
batch_inlier_masks.shape :  torch.Size([1563])
batch_outlier_masks.shape :  torch.Size([1563])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1546])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.05172718 -0.14374818  0.03836168]
 [-0.05850803 -0.12915552  0.03480218]
 [-0.051852   -0.13846801  0.03870195]]
len(transformed_superpoints_pcd) :  933
copy_superpoint_src_corr_points.shape :  (1546, 3)
mask.shape :  (1546,)
copy_superpoint_src_corr_points.shape :  (1480, 3)
copy_superpoint_ref_corr_points.shape :  (1480, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1480, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1480, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1480])
best_index :  208
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1480, 3)
transformed_src_superpoints.shape :  torch.Size([1480, 3])
residual.shape :  torch.Size([1480])
batch_inlier_masks.shape :  torch.Size([1480])
batch_outlier_masks.shape :  torch.Size([1480])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1464])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[ 5.7747580e-02 -1.3575692e-01  3.3771418e-02]
 [ 6.2996164e-02 -1.3584973e-01  3.0319724e-02]
 [ 5.8656715e-02 -1.3002272e-01  3.3229843e-02]
 ...
 [-4.4074368e-02  1.0850279e-01 -1.5292317e-06]
 [-3.8271014e-02  1.0394117e-01 -3.6916323e-04]
 [-4.4074368e-02  1.0850279e-01 -1.5292317e-06]]
len(transformed_superpoints_pcd) :  949
copy_superpoint_src_corr_points.shape :  (1464, 3)
mask.shape :  (1464,)
copy_superpoint_src_corr_points.shape :  (1374, 3)
copy_superpoint_ref_corr_points.shape :  (1374, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1374, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1374, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1374])
best_index :  1497
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1374, 3)
transformed_src_superpoints.shape :  torch.Size([1374, 3])
residual.shape :  torch.Size([1374])
batch_inlier_masks.shape :  torch.Size([1374])
batch_outlier_masks.shape :  torch.Size([1374])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1358])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.09201841  0.00325954 -0.02774514]
 [ 0.09093246  0.00404797 -0.02168556]
 [ 0.09575483 -0.00045406 -0.02965065]]
len(transformed_superpoints_pcd) :  965
copy_superpoint_src_corr_points.shape :  (1358, 3)
mask.shape :  (1358,)
copy_superpoint_src_corr_points.shape :  (1155, 3)
copy_superpoint_ref_corr_points.shape :  (1155, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1155, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1155, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1155])
best_index :  1334
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1155, 3)
transformed_src_superpoints.shape :  torch.Size([1155, 3])
residual.shape :  torch.Size([1155])
batch_inlier_masks.shape :  torch.Size([1155])
batch_outlier_masks.shape :  torch.Size([1155])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1140])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.0108313  -0.03720767  0.04905476]
 [-0.01747657 -0.0283614   0.04506472]
 [-0.01747657 -0.0283614   0.04506472]]
len(transformed_superpoints_pcd) :  980
copy_superpoint_src_corr_points.shape :  (1140, 3)
mask.shape :  (1140,)
copy_superpoint_src_corr_points.shape :  (1103, 3)
copy_superpoint_ref_corr_points.shape :  (1103, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1103, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1103, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1103])
best_index :  1358
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1103, 3)
transformed_src_superpoints.shape :  torch.Size([1103, 3])
residual.shape :  torch.Size([1103])
batch_inlier_masks.shape :  torch.Size([1103])
batch_outlier_masks.shape :  torch.Size([1103])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1088])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00423842 -0.07884445  0.00511724]
 [ 0.01460097 -0.09480509  0.01689485]
 [ 0.01507703 -0.08740181  0.02147223]]
len(transformed_superpoints_pcd) :  995
copy_superpoint_src_corr_points.shape :  (1088, 3)
mask.shape :  (1088,)
copy_superpoint_src_corr_points.shape :  (1068, 3)
copy_superpoint_ref_corr_points.shape :  (1068, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1068, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1068, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1068])
best_index :  1623
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1068, 3)
transformed_src_superpoints.shape :  torch.Size([1068, 3])
residual.shape :  torch.Size([1068])
batch_inlier_masks.shape :  torch.Size([1068])
batch_outlier_masks.shape :  torch.Size([1068])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1053])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.01155472  0.08538681 -0.07333565]
 [ 0.00568578  0.08516366 -0.0736186 ]
 [ 0.00568578  0.08516366 -0.0736186 ]]
len(transformed_superpoints_pcd) :  1010
copy_superpoint_src_corr_points.shape :  (1053, 3)
mask.shape :  (1053,)
copy_superpoint_src_corr_points.shape :  (1009, 3)
copy_superpoint_ref_corr_points.shape :  (1009, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1009, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 1009, 3])
batch_inlier_masks.shape :  torch.Size([1965, 1009])
best_index :  22
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1009, 3)
transformed_src_superpoints.shape :  torch.Size([1009, 3])
residual.shape :  torch.Size([1009])
batch_inlier_masks.shape :  torch.Size([1009])
batch_outlier_masks.shape :  torch.Size([1009])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([996])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.05102168 -0.12055682  0.08048725]
 [ 0.04398614 -0.09428748  0.0119408 ]
 [ 0.04398614 -0.09428748  0.0119408 ]]
len(transformed_superpoints_pcd) :  1023
copy_superpoint_src_corr_points.shape :  (996, 3)
mask.shape :  (996,)
copy_superpoint_src_corr_points.shape :  (823, 3)
copy_superpoint_ref_corr_points.shape :  (823, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([823, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 823, 3])
batch_inlier_masks.shape :  torch.Size([1965, 823])
best_index :  1651
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (823, 3)
transformed_src_superpoints.shape :  torch.Size([823, 3])
residual.shape :  torch.Size([823])
batch_inlier_masks.shape :  torch.Size([823])
batch_outlier_masks.shape :  torch.Size([823])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([810])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 5.7747580e-02 -1.3575692e-01  3.3771418e-02]
 [ 6.2996164e-02 -1.3584973e-01  3.0319724e-02]
 [ 5.8656715e-02 -1.3002272e-01  3.3229843e-02]
 ...
 [-4.4336751e-02  8.5250914e-02  2.0030886e-05]
 [-4.4060633e-02  9.0320550e-02 -4.5568496e-04]
 [-4.7728822e-02  9.2294246e-02 -5.9726760e-03]]
len(transformed_superpoints_pcd) :  1036
copy_superpoint_src_corr_points.shape :  (810, 3)
mask.shape :  (810,)
copy_superpoint_src_corr_points.shape :  (774, 3)
copy_superpoint_ref_corr_points.shape :  (774, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([774, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 774, 3])
batch_inlier_masks.shape :  torch.Size([1965, 774])
best_index :  1825
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (774, 3)
transformed_src_superpoints.shape :  torch.Size([774, 3])
residual.shape :  torch.Size([774])
batch_inlier_masks.shape :  torch.Size([774])
batch_outlier_masks.shape :  torch.Size([774])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([761])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00778185  0.08253509 -0.07335463]
 [ 0.00772639  0.08828212 -0.07394727]
 [ 0.00863563  0.09356579 -0.07393564]]
len(transformed_superpoints_pcd) :  1049
copy_superpoint_src_corr_points.shape :  (761, 3)
mask.shape :  (761,)
copy_superpoint_src_corr_points.shape :  (739, 3)
copy_superpoint_ref_corr_points.shape :  (739, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([739, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 739, 3])
batch_inlier_masks.shape :  torch.Size([1965, 739])
best_index :  1746
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (739, 3)
transformed_src_superpoints.shape :  torch.Size([739, 3])
residual.shape :  torch.Size([739])
batch_inlier_masks.shape :  torch.Size([739])
batch_outlier_masks.shape :  torch.Size([739])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([727])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00582373  0.08046724 -0.07389912]
 [ 0.01106096  0.07767422 -0.07217879]
 [ 0.00582373  0.08046724 -0.07389912]]
len(transformed_superpoints_pcd) :  1061
copy_superpoint_src_corr_points.shape :  (727, 3)
mask.shape :  (727,)
copy_superpoint_src_corr_points.shape :  (669, 3)
copy_superpoint_ref_corr_points.shape :  (669, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([669, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 669, 3])
batch_inlier_masks.shape :  torch.Size([1965, 669])
best_index :  1760
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (669, 3)
transformed_src_superpoints.shape :  torch.Size([669, 3])
residual.shape :  torch.Size([669])
batch_inlier_masks.shape :  torch.Size([669])
batch_outlier_masks.shape :  torch.Size([669])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([657])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.04064484  0.09115642  0.00189362]
 [-0.03487688  0.09099231  0.00716968]
 [-0.01705908  0.07644363  0.02010637]]
len(transformed_superpoints_pcd) :  1073
copy_superpoint_src_corr_points.shape :  (657, 3)
mask.shape :  (657,)
copy_superpoint_src_corr_points.shape :  (620, 3)
copy_superpoint_ref_corr_points.shape :  (620, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([620, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 620, 3])
batch_inlier_masks.shape :  torch.Size([1965, 620])
best_index :  1820
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (620, 3)
transformed_src_superpoints.shape :  torch.Size([620, 3])
residual.shape :  torch.Size([620])
batch_inlier_masks.shape :  torch.Size([620])
batch_outlier_masks.shape :  torch.Size([620])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([608])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.04399728 -0.13034251  0.0719958 ]
 [-0.04496203 -0.13526239  0.07243226]
 [-0.03887739 -0.13344967  0.06387498]]
len(transformed_superpoints_pcd) :  1085
copy_superpoint_src_corr_points.shape :  (608, 3)
mask.shape :  (608,)
copy_superpoint_src_corr_points.shape :  (596, 3)
copy_superpoint_ref_corr_points.shape :  (596, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([596, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 596, 3])
batch_inlier_masks.shape :  torch.Size([1965, 596])
best_index :  1667
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (596, 3)
transformed_src_superpoints.shape :  torch.Size([596, 3])
residual.shape :  torch.Size([596])
batch_inlier_masks.shape :  torch.Size([596])
batch_outlier_masks.shape :  torch.Size([596])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([585])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.0444182   0.09102838 -0.00082617]
 [-0.049731    0.09186881 -0.00579653]
 [-0.04248804  0.08562718 -0.00073721]]
len(transformed_superpoints_pcd) :  1096
copy_superpoint_src_corr_points.shape :  (585, 3)
mask.shape :  (585,)
copy_superpoint_src_corr_points.shape :  (585, 3)
copy_superpoint_ref_corr_points.shape :  (585, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([585, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 585, 3])
batch_inlier_masks.shape :  torch.Size([1965, 585])
best_index :  421
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (585, 3)
transformed_src_superpoints.shape :  torch.Size([585, 3])
residual.shape :  torch.Size([585])
batch_inlier_masks.shape :  torch.Size([585])
batch_outlier_masks.shape :  torch.Size([585])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([575])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.08007834 -0.12867253  0.02187949]
 [ 0.07479845 -0.12539735  0.02661165]
 [ 0.08007834 -0.12867253  0.02187949]]
len(transformed_superpoints_pcd) :  1106
copy_superpoint_src_corr_points.shape :  (575, 3)
mask.shape :  (575,)
copy_superpoint_src_corr_points.shape :  (574, 3)
copy_superpoint_ref_corr_points.shape :  (574, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([574, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 574, 3])
batch_inlier_masks.shape :  torch.Size([1965, 574])
best_index :  1507
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (574, 3)
transformed_src_superpoints.shape :  torch.Size([574, 3])
residual.shape :  torch.Size([574])
batch_inlier_masks.shape :  torch.Size([574])
batch_outlier_masks.shape :  torch.Size([574])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([564])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.07772356 -0.00595332  0.00396208]
 [-0.07172348  0.00078788  0.00386651]
 [-0.06542575  0.00077914  0.00964619]]
len(transformed_superpoints_pcd) :  1116
copy_superpoint_src_corr_points.shape :  (564, 3)
mask.shape :  (564,)
copy_superpoint_src_corr_points.shape :  (563, 3)
copy_superpoint_ref_corr_points.shape :  (563, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([563, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 563, 3])
batch_inlier_masks.shape :  torch.Size([1965, 563])
best_index :  1932
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (563, 3)
transformed_src_superpoints.shape :  torch.Size([563, 3])
residual.shape :  torch.Size([563])
batch_inlier_masks.shape :  torch.Size([563])
batch_outlier_masks.shape :  torch.Size([563])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([553])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.04173262  0.1080389  -0.05885167]
 [ 0.03681594  0.09933556 -0.06429438]
 [ 0.04132943  0.09732361 -0.06200396]]
len(transformed_superpoints_pcd) :  1126
copy_superpoint_src_corr_points.shape :  (553, 3)
mask.shape :  (553,)
copy_superpoint_src_corr_points.shape :  (553, 3)
copy_superpoint_ref_corr_points.shape :  (553, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([553, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 553, 3])
batch_inlier_masks.shape :  torch.Size([1965, 553])
best_index :  959
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (553, 3)
transformed_src_superpoints.shape :  torch.Size([553, 3])
residual.shape :  torch.Size([553])
batch_inlier_masks.shape :  torch.Size([553])
batch_outlier_masks.shape :  torch.Size([553])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([544])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.07012533 -0.11672826  0.02265524]
 [ 0.0734145  -0.12068494  0.02483282]
 [ 0.07646979 -0.12200534  0.02061198]]
len(transformed_superpoints_pcd) :  1135
copy_superpoint_src_corr_points.shape :  (544, 3)
mask.shape :  (544,)
copy_superpoint_src_corr_points.shape :  (537, 3)
copy_superpoint_ref_corr_points.shape :  (537, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([537, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 537, 3])
batch_inlier_masks.shape :  torch.Size([1965, 537])
best_index :  1821
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (537, 3)
transformed_src_superpoints.shape :  torch.Size([537, 3])
residual.shape :  torch.Size([537])
batch_inlier_masks.shape :  torch.Size([537])
batch_outlier_masks.shape :  torch.Size([537])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([528])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.04631338 -0.11803527  0.07987097]
 [-0.05156289 -0.11960543  0.08044828]
 [-0.04952414 -0.11262556  0.07966055]]
len(transformed_superpoints_pcd) :  1144
copy_superpoint_src_corr_points.shape :  (528, 3)
mask.shape :  (528,)
copy_superpoint_src_corr_points.shape :  (528, 3)
copy_superpoint_ref_corr_points.shape :  (528, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([528, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 528, 3])
batch_inlier_masks.shape :  torch.Size([1965, 528])
best_index :  1909
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (528, 3)
transformed_src_superpoints.shape :  torch.Size([528, 3])
residual.shape :  torch.Size([528])
batch_inlier_masks.shape :  torch.Size([528])
batch_outlier_masks.shape :  torch.Size([528])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([519])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.10117322 -0.00830712  0.00456384]
 [-0.10577598 -0.00497997  0.00368501]
 [-0.10518117 -0.00825396  0.00799678]]
len(transformed_superpoints_pcd) :  1153
copy_superpoint_src_corr_points.shape :  (519, 3)
mask.shape :  (519,)
copy_superpoint_src_corr_points.shape :  (519, 3)
copy_superpoint_ref_corr_points.shape :  (519, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([519, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 519, 3])
batch_inlier_masks.shape :  torch.Size([1965, 519])
best_index :  1757
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (519, 3)
transformed_src_superpoints.shape :  torch.Size([519, 3])
residual.shape :  torch.Size([519])
batch_inlier_masks.shape :  torch.Size([519])
batch_outlier_masks.shape :  torch.Size([519])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([511])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.04789149  0.08698625 -0.00564203]
 [-0.0459118   0.08227384 -0.00269387]
 [-0.04789149  0.08698625 -0.00564203]]
len(transformed_superpoints_pcd) :  1161
copy_superpoint_src_corr_points.shape :  (511, 3)
mask.shape :  (511,)
copy_superpoint_src_corr_points.shape :  (498, 3)
copy_superpoint_ref_corr_points.shape :  (498, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([498, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 498, 3])
batch_inlier_masks.shape :  torch.Size([1965, 498])
best_index :  1962
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (498, 3)
transformed_src_superpoints.shape :  torch.Size([498, 3])
residual.shape :  torch.Size([498])
batch_inlier_masks.shape :  torch.Size([498])
batch_outlier_masks.shape :  torch.Size([498])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([490])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00496204  0.08628913 -0.07385508]
 [ 0.00648198  0.09138682 -0.07420474]
 [ 0.01075372  0.09421094 -0.07395346]]
len(transformed_superpoints_pcd) :  1169
copy_superpoint_src_corr_points.shape :  (490, 3)
mask.shape :  (490,)
copy_superpoint_src_corr_points.shape :  (490, 3)
copy_superpoint_ref_corr_points.shape :  (490, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([490, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 490, 3])
batch_inlier_masks.shape :  torch.Size([1965, 490])
best_index :  93
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (490, 3)
transformed_src_superpoints.shape :  torch.Size([490, 3])
residual.shape :  torch.Size([490])
batch_inlier_masks.shape :  torch.Size([490])
batch_outlier_masks.shape :  torch.Size([490])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([483])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.03337348 -0.14199477  0.01493023]
 [ 0.04222659 -0.14056304  0.04198482]
 [ 0.00456267  0.03842108 -0.06306149]]
len(transformed_superpoints_pcd) :  1176
copy_superpoint_src_corr_points.shape :  (483, 3)
mask.shape :  (483,)
copy_superpoint_src_corr_points.shape :  (409, 3)
copy_superpoint_ref_corr_points.shape :  (409, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([409, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 409, 3])
batch_inlier_masks.shape :  torch.Size([1965, 409])
best_index :  1581
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (409, 3)
transformed_src_superpoints.shape :  torch.Size([409, 3])
residual.shape :  torch.Size([409])
batch_inlier_masks.shape :  torch.Size([409])
batch_outlier_masks.shape :  torch.Size([409])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([402])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.01135391 -0.08947587  0.01452748]
 [ 0.01140564 -0.0919235   0.00968288]
 [ 0.01135391 -0.08947587  0.01452748]]
len(transformed_superpoints_pcd) :  1183
copy_superpoint_src_corr_points.shape :  (402, 3)
mask.shape :  (402,)
copy_superpoint_src_corr_points.shape :  (401, 3)
copy_superpoint_ref_corr_points.shape :  (401, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([401, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 401, 3])
batch_inlier_masks.shape :  torch.Size([1965, 401])
best_index :  1645
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (401, 3)
transformed_src_superpoints.shape :  torch.Size([401, 3])
residual.shape :  torch.Size([401])
batch_inlier_masks.shape :  torch.Size([401])
batch_outlier_masks.shape :  torch.Size([401])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([394])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.0069963   0.09268168 -0.07397501]
 [ 0.00755868  0.085866   -0.07341133]
 [ 0.00755868  0.085866   -0.07341133]]
len(transformed_superpoints_pcd) :  1190
copy_superpoint_src_corr_points.shape :  (394, 3)
mask.shape :  (394,)
copy_superpoint_src_corr_points.shape :  (386, 3)
copy_superpoint_ref_corr_points.shape :  (386, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([386, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 386, 3])
batch_inlier_masks.shape :  torch.Size([1965, 386])
best_index :  1751
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (386, 3)
transformed_src_superpoints.shape :  torch.Size([386, 3])
residual.shape :  torch.Size([386])
batch_inlier_masks.shape :  torch.Size([386])
batch_outlier_masks.shape :  torch.Size([386])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([379])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.11157487  0.03626774 -0.03179171]
 [ 0.11361074  0.02909777 -0.03049266]
 [ 0.11210287  0.02996155 -0.02453298]]
len(transformed_superpoints_pcd) :  1197
copy_superpoint_src_corr_points.shape :  (379, 3)
mask.shape :  (379,)
copy_superpoint_src_corr_points.shape :  (358, 3)
copy_superpoint_ref_corr_points.shape :  (358, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([358, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 358, 3])
batch_inlier_masks.shape :  torch.Size([1965, 358])
best_index :  1906
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (358, 3)
transformed_src_superpoints.shape :  torch.Size([358, 3])
residual.shape :  torch.Size([358])
batch_inlier_masks.shape :  torch.Size([358])
batch_outlier_masks.shape :  torch.Size([358])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([351])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.01123325 -0.0928259   0.00949807]
 [ 0.01123325 -0.0928259   0.00949807]
 [ 0.00670698 -0.08056538  0.01375703]]
len(transformed_superpoints_pcd) :  1204
copy_superpoint_src_corr_points.shape :  (351, 3)
mask.shape :  (351,)
copy_superpoint_src_corr_points.shape :  (351, 3)
copy_superpoint_ref_corr_points.shape :  (351, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([351, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 351, 3])
batch_inlier_masks.shape :  torch.Size([1965, 351])
best_index :  1917
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (351, 3)
transformed_src_superpoints.shape :  torch.Size([351, 3])
residual.shape :  torch.Size([351])
batch_inlier_masks.shape :  torch.Size([351])
batch_outlier_masks.shape :  torch.Size([351])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([344])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.11435858  0.03539608 -0.0301974 ]
 [ 0.11465365  0.03067306 -0.02630576]
 [ 0.1094603   0.02920295 -0.03015246]]
len(transformed_superpoints_pcd) :  1211
copy_superpoint_src_corr_points.shape :  (344, 3)
mask.shape :  (344,)
copy_superpoint_src_corr_points.shape :  (291, 3)
copy_superpoint_ref_corr_points.shape :  (291, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([291, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 291, 3])
batch_inlier_masks.shape :  torch.Size([1965, 291])
best_index :  1213
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (291, 3)
transformed_src_superpoints.shape :  torch.Size([291, 3])
residual.shape :  torch.Size([291])
batch_inlier_masks.shape :  torch.Size([291])
batch_outlier_masks.shape :  torch.Size([291])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([285])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.03891566 -0.13577656  0.03333732]
 [-0.03891566 -0.13577656  0.03333732]
 [-0.03891566 -0.13577656  0.03333732]]
len(transformed_superpoints_pcd) :  1217
copy_superpoint_src_corr_points.shape :  (285, 3)
mask.shape :  (285,)
copy_superpoint_src_corr_points.shape :  (256, 3)
copy_superpoint_ref_corr_points.shape :  (256, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([256, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 256, 3])
batch_inlier_masks.shape :  torch.Size([1965, 256])
best_index :  1448
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (256, 3)
transformed_src_superpoints.shape :  torch.Size([256, 3])
residual.shape :  torch.Size([256])
batch_inlier_masks.shape :  torch.Size([256])
batch_outlier_masks.shape :  torch.Size([256])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([250])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.02141563 -0.03628574  0.04546575]
 [-0.01417381 -0.03733478  0.04562034]
 [-0.02141563 -0.03628574  0.04546575]]
len(transformed_superpoints_pcd) :  1223
copy_superpoint_src_corr_points.shape :  (250, 3)
mask.shape :  (250,)
copy_superpoint_src_corr_points.shape :  (239, 3)
copy_superpoint_ref_corr_points.shape :  (239, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([239, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 239, 3])
batch_inlier_masks.shape :  torch.Size([1965, 239])
best_index :  1647
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (239, 3)
transformed_src_superpoints.shape :  torch.Size([239, 3])
residual.shape :  torch.Size([239])
batch_inlier_masks.shape :  torch.Size([239])
batch_outlier_masks.shape :  torch.Size([239])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([233])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.07816073 -0.12892728  0.0242196 ]
 [ 0.07670088 -0.13659164  0.02817303]
 [ 0.07816073 -0.12892728  0.0242196 ]]
len(transformed_superpoints_pcd) :  1229
copy_superpoint_src_corr_points.shape :  (233, 3)
mask.shape :  (233,)
copy_superpoint_src_corr_points.shape :  (233, 3)
copy_superpoint_ref_corr_points.shape :  (233, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([233, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 233, 3])
batch_inlier_masks.shape :  torch.Size([1965, 233])
best_index :  1787
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (233, 3)
transformed_src_superpoints.shape :  torch.Size([233, 3])
residual.shape :  torch.Size([233])
batch_inlier_masks.shape :  torch.Size([233])
batch_outlier_masks.shape :  torch.Size([233])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([227])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00918338  0.08595672 -0.07325055]
 [ 0.00426796  0.08379489 -0.07379854]
 [ 0.00289141  0.08938525 -0.07430239]]
len(transformed_superpoints_pcd) :  1235
copy_superpoint_src_corr_points.shape :  (227, 3)
mask.shape :  (227,)
copy_superpoint_src_corr_points.shape :  (223, 3)
copy_superpoint_ref_corr_points.shape :  (223, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([223, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 223, 3])
batch_inlier_masks.shape :  torch.Size([1965, 223])
best_index :  318
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (223, 3)
transformed_src_superpoints.shape :  torch.Size([223, 3])
residual.shape :  torch.Size([223])
batch_inlier_masks.shape :  torch.Size([223])
batch_outlier_masks.shape :  torch.Size([223])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([218])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [-0.02148543  0.07060126  0.0202892 ]
 [-0.02148543  0.07060126  0.0202892 ]
 [-0.02148543  0.07060126  0.0202892 ]]
len(transformed_superpoints_pcd) :  1240
copy_superpoint_src_corr_points.shape :  (218, 3)
mask.shape :  (218,)
copy_superpoint_src_corr_points.shape :  (106, 3)
copy_superpoint_ref_corr_points.shape :  (106, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([106, 3])
batch_transforms.shape :  torch.Size([1965, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1965, 106, 3])
batch_inlier_masks.shape :  torch.Size([1965, 106])
best_index :  1356
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (106, 3)
transformed_src_superpoints.shape :  torch.Size([106, 3])
residual.shape :  torch.Size([106])
batch_inlier_masks.shape :  torch.Size([106])
batch_outlier_masks.shape :  torch.Size([106])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([101])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.05774758 -0.13575692  0.03377142]
 [ 0.06299616 -0.13584973  0.03031972]
 [ 0.05865671 -0.13002272  0.03322984]
 ...
 [ 0.00207822  0.08729894 -0.07434349]
 [ 0.00284953  0.09702905 -0.07563438]
 [ 0.00284953  0.09702905 -0.07563438]]
len(transformed_superpoints_pcd) :  1245
copy_superpoint_src_corr_points.shape :  (101, 3)
mask.shape :  (101,)
copy_superpoint_src_corr_points.shape :  (81, 3)
copy_superpoint_ref_corr_points.shape :  (81, 3)
number of unique points in pcd :  474
number of rotations used :  56
transformed_superpoints_pcd.shape :  (1326, 3)
Line set updated
018
src_points :  [[-0.05612603  0.04111234  0.02084226]
 [ 0.08121344  0.02995192  0.05954541]
 [-0.03132085  0.08111735  0.06126589]
 ...
 [-0.03253588  0.10505184 -0.02717747]
 [-0.02834034  0.10908385 -0.03193679]
 [-0.04037454  0.07713161 -0.03701858]]
ref_points :  [[-0.06900056 -0.06036752  0.08121154]
 [-0.06911958 -0.05642227  0.07687786]
 [-0.07019074 -0.05470399  0.07166376]
 ...
 [-0.05713997  0.09542115  0.00709036]
 [-0.05020939  0.10248142  0.0032893 ]
 [-0.05305742  0.10285855 -0.0014981 ]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([5394, 3])
lengths :  tensor([2631, 2763])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([3541, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([1106, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([532, 3])
ref_points_f.shape :  torch.Size([2631, 3])
src_points_c.shape :  torch.Size([574, 3])
src_points_f.shape :  torch.Size([2763, 3])
ref_node_masks.shape :  torch.Size([532])
ref_node_knn_indices.shape :  torch.Size([532, 5])
ref_node_knn_masks.shape :  torch.Size([532, 5])
src_node_masks.shape :  torch.Size([574])
src_node_knn_indices.shape :  torch.Size([574, 5])
src_node_knn_masks.shape :  torch.Size([574, 5])
ref_node_knn_points.shape :  torch.Size([532, 5, 3])
src_node_knn_points.shape :  torch.Size([574, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([1106, 512])
feats_f :  torch.Size([5394, 256])
k :  3
omegas.shape :  torch.Size([283024, 128, 1])
omegas.shape :  torch.Size([849072, 128, 1])
k :  3
omegas.shape :  torch.Size([329476, 128, 1])
omegas.shape :  torch.Size([988428, 128, 1])
ref_feats_c.shape :  torch.Size([1, 532, 256])
src_feats_c.shape :  torch.Size([1, 574, 256])
ref_feats_c_norm.shape :  torch.Size([532, 256])
src_feats_c_norm.shape :  torch.Size([574, 256])
ref_node_masks.shape :  torch.Size([532])
src_node_masks.shape :  torch.Size([574])
self.num_correspondences :  2000
matching_scores.numel() :  305368
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([20418])
ref_indices.shape :  torch.Size([20418])
src_indices.shape :  torch.Size([20418])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 4, 4, 4], device='cuda:0')
src_indices :  tensor([1, 2, 3,  ..., 0, 2, 4], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([20418, 3])
global_src_corr_points.shape :  torch.Size([20418, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([2000, 4, 4])
src_corr_points.shape :  torch.Size([20418, 3])
ref_corr_points.shape :  torch.Size([1, 20418, 3])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 20418, 3])
batch_corr_residuals.shape :  torch.Size([2000, 20418])
batch_inlier_masks.shape :  torch.Size([2000, 20418])
best_index :  tensor(1681, device='cuda:0')
len(batch_transforms) :  2000
estimated_transform :  [[ 0.5581996  -0.09148636 -0.8246474  -0.03863436]
 [-0.6099618   0.62851906 -0.48260772 -0.02760018]
 [ 0.5624587   0.77239484  0.2950358  -0.02501503]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [1632 1344 1742 ... 1085   88 1681]
superpoint_src_corr_points.shape :  (20418, 3)
superpoint_ref_corr_points.shape :  (20418, 3)
batch_inlier_masks.shape :  (2000, 20418)
batch_transforms.shape :  (2000, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([20418, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 20418, 3])
batch_inlier_masks.shape :  torch.Size([2000, 20418])
best_index :  6
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (20418, 3)
transformed_src_superpoints.shape :  torch.Size([20418, 3])
residual.shape :  torch.Size([20418])
batch_inlier_masks.shape :  torch.Size([20418])
batch_outlier_masks.shape :  torch.Size([20418])
indices_inliers.shape :  torch.Size([80])
indices_outliers.shape :  torch.Size([20338])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([80, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.04816635 -0.0540766   0.06442335]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.04380054 -0.09926523  0.05707964]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.03928924 -0.06931174  0.07830155]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.05482036 -0.05713788  0.06221731]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.05631644 -0.05458515  0.0666853 ]
 [-0.05467309 -0.05289581  0.07431665]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04471483 -0.09494416  0.06065029]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03707744 -0.10371484  0.04949885]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03319854 -0.07749867  0.06287734]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03462827 -0.08978413  0.04541345]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03994192 -0.07735039  0.04936113]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03658766 -0.08592673  0.05057369]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.05980056 -0.05616727  0.07667761]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.06454539 -0.05720835  0.07489586]
 [-0.05163543 -0.08868423  0.06718506]
 [-0.0459595  -0.10528241  0.0526198 ]]
len(transformed_superpoints_pcd) :  80
copy_superpoint_src_corr_points.shape :  (20338, 3)
mask.shape :  (20338,)
copy_superpoint_src_corr_points.shape :  (19227, 3)
copy_superpoint_ref_corr_points.shape :  (19227, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([19227, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 19227, 3])
batch_inlier_masks.shape :  torch.Size([2000, 19227])
best_index :  1753
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (19227, 3)
transformed_src_superpoints.shape :  torch.Size([19227, 3])
residual.shape :  torch.Size([19227])
batch_inlier_masks.shape :  torch.Size([19227])
batch_outlier_masks.shape :  torch.Size([19227])
indices_inliers.shape :  torch.Size([73])
indices_outliers.shape :  torch.Size([19154])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([73, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.04816635 -0.0540766   0.06442335]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.04380054 -0.09926523  0.05707964]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.03928924 -0.06931174  0.07830155]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.05482036 -0.05713788  0.06221731]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.05631644 -0.05458515  0.0666853 ]
 [-0.05467309 -0.05289581  0.07431665]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04471483 -0.09494416  0.06065029]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03707744 -0.10371484  0.04949885]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03319854 -0.07749867  0.06287734]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03462827 -0.08978413  0.04541345]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03994192 -0.07735039  0.04936113]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03658766 -0.08592673  0.05057369]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.05980056 -0.05616727  0.07667761]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.06454539 -0.05720835  0.07489586]
 [-0.05163543 -0.08868423  0.06718506]
 [-0.0459595  -0.10528241  0.0526198 ]
 [ 0.02949494 -0.12453133  0.03369156]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.04538897 -0.11728723  0.02894683]
 [ 0.0383873  -0.11931495  0.0279767 ]
 [ 0.02685118 -0.11514352  0.02938361]
 [ 0.04538897 -0.11728723  0.02894683]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.02208197 -0.11858383  0.03117026]
 [ 0.02685118 -0.11514352  0.02938361]
 [ 0.0198151  -0.11285967  0.03180249]
 [ 0.03707692 -0.11192808  0.03466564]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.03134952 -0.11152814  0.03406668]
 [ 0.03134952 -0.11152814  0.03406668]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.04169883 -0.12837695  0.03376607]
 [ 0.03707692 -0.11192808  0.03466564]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.03707692 -0.11192808  0.03466564]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.0489533  -0.06973232  0.04156614]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.04066933 -0.07388358  0.04707773]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.03407137 -0.07555217  0.0353455 ]
 [-0.03139437 -0.07652021  0.03038538]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.05869904 -0.06636235  0.075666  ]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.05869904 -0.06636235  0.075666  ]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.05741512 -0.06185335  0.07967176]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.03600513 -0.07930826  0.05064888]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.05040615 -0.12268388  0.04019474]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.05040615 -0.12268388  0.04019474]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.0479584  -0.1191434   0.03525466]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.03754825 -0.07027451  0.0184825 ]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.03754825 -0.07027451  0.0184825 ]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.0461559  -0.06832393  0.02981842]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.04066933 -0.07388358  0.04707773]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.03785609 -0.07454597  0.0422349 ]]
len(transformed_superpoints_pcd) :  153
copy_superpoint_src_corr_points.shape :  (19154, 3)
mask.shape :  (19154,)
copy_superpoint_src_corr_points.shape :  (17607, 3)
copy_superpoint_ref_corr_points.shape :  (17607, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([17607, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 17607, 3])
batch_inlier_masks.shape :  torch.Size([2000, 17607])
best_index :  792
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (17607, 3)
transformed_src_superpoints.shape :  torch.Size([17607, 3])
residual.shape :  torch.Size([17607])
batch_inlier_masks.shape :  torch.Size([17607])
batch_outlier_masks.shape :  torch.Size([17607])
indices_inliers.shape :  torch.Size([67])
indices_outliers.shape :  torch.Size([17540])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([67, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.04816635 -0.0540766   0.06442335]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.04380054 -0.09926523  0.05707964]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.03928924 -0.06931174  0.07830155]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.05482036 -0.05713788  0.06221731]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.05631644 -0.05458515  0.0666853 ]
 [-0.05467309 -0.05289581  0.07431665]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04471483 -0.09494416  0.06065029]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03707744 -0.10371484  0.04949885]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03319854 -0.07749867  0.06287734]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03462827 -0.08978413  0.04541345]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03994192 -0.07735039  0.04936113]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03658766 -0.08592673  0.05057369]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.05980056 -0.05616727  0.07667761]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.06454539 -0.05720835  0.07489586]
 [-0.05163543 -0.08868423  0.06718506]
 [-0.0459595  -0.10528241  0.0526198 ]
 [ 0.02949494 -0.12453133  0.03369156]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.04538897 -0.11728723  0.02894683]
 [ 0.0383873  -0.11931495  0.0279767 ]
 [ 0.02685118 -0.11514352  0.02938361]
 [ 0.04538897 -0.11728723  0.02894683]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.02208197 -0.11858383  0.03117026]
 [ 0.02685118 -0.11514352  0.02938361]
 [ 0.0198151  -0.11285967  0.03180249]
 [ 0.03707692 -0.11192808  0.03466564]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.03134952 -0.11152814  0.03406668]
 [ 0.03134952 -0.11152814  0.03406668]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.04169883 -0.12837695  0.03376607]
 [ 0.03707692 -0.11192808  0.03466564]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.03707692 -0.11192808  0.03466564]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.0489533  -0.06973232  0.04156614]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.04066933 -0.07388358  0.04707773]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.03407137 -0.07555217  0.0353455 ]
 [-0.03139437 -0.07652021  0.03038538]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.05869904 -0.06636235  0.075666  ]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.05869904 -0.06636235  0.075666  ]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.05741512 -0.06185335  0.07967176]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.03600513 -0.07930826  0.05064888]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.05040615 -0.12268388  0.04019474]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.05040615 -0.12268388  0.04019474]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.0479584  -0.1191434   0.03525466]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.03754825 -0.07027451  0.0184825 ]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.03754825 -0.07027451  0.0184825 ]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.0461559  -0.06832393  0.02981842]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.04066933 -0.07388358  0.04707773]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.03785609 -0.07454597  0.0422349 ]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01704638 -0.02062959 -0.09225931]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.00243351 -0.00547609 -0.09260278]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00243351 -0.00547609 -0.09260278]
 [-0.00235025 -0.01111527 -0.08482019]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00767324 -0.0136271  -0.09211021]
 [-0.00235025 -0.01111527 -0.08482019]
 [-0.01852064 -0.05533931 -0.0524402 ]
 [-0.0173955  -0.05526254 -0.06027117]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.01852064 -0.05533931 -0.0524402 ]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.0173955  -0.05526254 -0.06027117]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.02375278 -0.05512647 -0.03868315]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02567642 -0.052958   -0.03456029]
 [-0.02158489 -0.05479382 -0.04673303]
 [-0.0175132  -0.05837595 -0.04369657]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02567642 -0.052958   -0.03456029]
 [-0.02158489 -0.05479382 -0.04673303]
 [-0.0175132  -0.05837595 -0.04369657]
 [ 0.02413119 -0.01418252 -0.09766003]
 [ 0.02125264 -0.01878959 -0.09477481]
 [ 0.02125264 -0.01878959 -0.09477481]
 [ 0.02414052 -0.02271761 -0.09201588]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.02064097  0.00152925  0.02557393]
 [ 0.01944107  0.00269026  0.01601925]
 [ 0.02064097  0.00152925  0.02557393]
 [ 0.01944107  0.00269026  0.01601925]
 [ 0.01647676  0.00713913  0.01766872]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.01647676  0.00713913  0.01766872]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.02064097  0.00152925  0.02557393]
 [-0.0099116  -0.06033752 -0.04204307]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.01941963 -0.05914589 -0.03684133]
 [-0.01709016 -0.06063941 -0.03027668]
 [-0.01339321 -0.06162343 -0.03644862]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02567642 -0.052958   -0.03456029]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00767324 -0.0136271  -0.09211021]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00767324 -0.0136271  -0.09211021]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.0111577  -0.01052171 -0.09677491]
 [ 0.01704638 -0.02062959 -0.09225931]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.0111577  -0.01052171 -0.09677491]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.00777084  0.03100167  0.03045083]
 [ 0.00777084  0.03100167  0.03045083]
 [ 0.01704638 -0.02062959 -0.09225931]]
len(transformed_superpoints_pcd) :  220
copy_superpoint_src_corr_points.shape :  (17540, 3)
mask.shape :  (17540,)
copy_superpoint_src_corr_points.shape :  (16004, 3)
copy_superpoint_ref_corr_points.shape :  (16004, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([16004, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 16004, 3])
batch_inlier_masks.shape :  torch.Size([2000, 16004])
best_index :  343
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (16004, 3)
transformed_src_superpoints.shape :  torch.Size([16004, 3])
residual.shape :  torch.Size([16004])
batch_inlier_masks.shape :  torch.Size([16004])
batch_outlier_masks.shape :  torch.Size([16004])
indices_inliers.shape :  torch.Size([63])
indices_outliers.shape :  torch.Size([15941])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([63, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04372019 -0.08737977  0.06816619]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.04816635 -0.0540766   0.06442335]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.03987348 -0.08605969  0.06413594]
 [-0.04088176 -0.08347581  0.0698977 ]
 [-0.03723783 -0.07932948  0.06549869]
 [-0.03840847 -0.07875117  0.07066146]
 [-0.04380054 -0.09926523  0.05707964]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.03928924 -0.06931174  0.07830155]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.0456562  -0.07017387  0.07989016]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.033425   -0.06934858  0.07212168]
 [-0.0360166  -0.0738785   0.07126509]
 [-0.05482036 -0.05713788  0.06221731]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.05631644 -0.05458515  0.0666853 ]
 [-0.05467309 -0.05289581  0.07431665]
 [-0.05129141 -0.05235902  0.06956367]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04471483 -0.09494416  0.06065029]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04067329 -0.09731655  0.06282915]
 [-0.04000156 -0.09120084  0.05922416]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03707744 -0.10371484  0.04949885]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03319854 -0.07749867  0.06287734]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03462827 -0.08978413  0.04541345]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03666429 -0.07865317  0.05885937]
 [-0.03994192 -0.07735039  0.04936113]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.04039094 -0.10225192  0.05349141]
 [-0.0394083  -0.09701226  0.05556921]
 [-0.03639589 -0.09820178  0.05117726]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03746562 -0.09195305  0.05448836]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.03658766 -0.08592673  0.05057369]
 [-0.03804866 -0.08623777  0.0581973 ]
 [-0.05980056 -0.05616727  0.07667761]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.05199227 -0.0597619   0.08169048]
 [-0.05058628 -0.05336405  0.07953409]
 [-0.06454539 -0.05720835  0.07489586]
 [-0.05163543 -0.08868423  0.06718506]
 [-0.0459595  -0.10528241  0.0526198 ]
 [ 0.02949494 -0.12453133  0.03369156]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.0318277  -0.11951155  0.03012038]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.04538897 -0.11728723  0.02894683]
 [ 0.0383873  -0.11931495  0.0279767 ]
 [ 0.02685118 -0.11514352  0.02938361]
 [ 0.04538897 -0.11728723  0.02894683]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.03958008 -0.11424477  0.03091231]
 [ 0.0440533  -0.11475709  0.03420594]
 [ 0.02208197 -0.11858383  0.03117026]
 [ 0.02685118 -0.11514352  0.02938361]
 [ 0.0198151  -0.11285967  0.03180249]
 [ 0.03707692 -0.11192808  0.03466564]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.03134952 -0.11152814  0.03406668]
 [ 0.03134952 -0.11152814  0.03406668]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.04169883 -0.12837695  0.03376607]
 [ 0.03707692 -0.11192808  0.03466564]
 [ 0.03463144 -0.11521928  0.03021707]
 [ 0.03707692 -0.11192808  0.03466564]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.0489533  -0.06973232  0.04156614]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.04066933 -0.07388358  0.04707773]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.03407137 -0.07555217  0.0353455 ]
 [-0.03139437 -0.07652021  0.03038538]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.03932411 -0.07203364  0.03248002]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.05869904 -0.06636235  0.075666  ]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.05869904 -0.06636235  0.075666  ]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.05741512 -0.06185335  0.07967176]
 [-0.05574785 -0.06602763  0.07065286]
 [-0.03600513 -0.07930826  0.05064888]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.05040615 -0.12268388  0.04019474]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.05040615 -0.12268388  0.04019474]
 [ 0.04962806 -0.1176007   0.04019019]
 [ 0.0479584  -0.1191434   0.03525466]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.03754825 -0.07027451  0.0184825 ]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.03754825 -0.07027451  0.0184825 ]
 [-0.04055755 -0.06968734  0.0261282 ]
 [-0.04194832 -0.06875698  0.02122372]
 [-0.03621337 -0.07248285  0.02807394]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.0461559  -0.06832393  0.02981842]
 [-0.04479298 -0.07015879  0.03557527]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.04066933 -0.07388358  0.04707773]
 [-0.0449728  -0.07088821  0.04649037]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.04233205 -0.07199092  0.0412277 ]
 [-0.03785609 -0.07454597  0.0422349 ]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01704638 -0.02062959 -0.09225931]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.00243351 -0.00547609 -0.09260278]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00243351 -0.00547609 -0.09260278]
 [-0.00235025 -0.01111527 -0.08482019]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00767324 -0.0136271  -0.09211021]
 [-0.00235025 -0.01111527 -0.08482019]
 [-0.01852064 -0.05533931 -0.0524402 ]
 [-0.0173955  -0.05526254 -0.06027117]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.01852064 -0.05533931 -0.0524402 ]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.0173955  -0.05526254 -0.06027117]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.02375278 -0.05512647 -0.03868315]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02567642 -0.052958   -0.03456029]
 [-0.02158489 -0.05479382 -0.04673303]
 [-0.0175132  -0.05837595 -0.04369657]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02567642 -0.052958   -0.03456029]
 [-0.02158489 -0.05479382 -0.04673303]
 [-0.0175132  -0.05837595 -0.04369657]
 [ 0.02413119 -0.01418252 -0.09766003]
 [ 0.02125264 -0.01878959 -0.09477481]
 [ 0.02125264 -0.01878959 -0.09477481]
 [ 0.02414052 -0.02271761 -0.09201588]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.02064097  0.00152925  0.02557393]
 [ 0.01944107  0.00269026  0.01601925]
 [ 0.02064097  0.00152925  0.02557393]
 [ 0.01944107  0.00269026  0.01601925]
 [ 0.01647676  0.00713913  0.01766872]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.01647676  0.00713913  0.01766872]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.02064097  0.00152925  0.02557393]
 [-0.0099116  -0.06033752 -0.04204307]
 [-0.02323859 -0.05245482 -0.05364373]
 [-0.01941963 -0.05914589 -0.03684133]
 [-0.01709016 -0.06063941 -0.03027668]
 [-0.01339321 -0.06162343 -0.03644862]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02654865 -0.05057917 -0.04110838]
 [-0.02567642 -0.052958   -0.03456029]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00767324 -0.0136271  -0.09211021]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.00767324 -0.0136271  -0.09211021]
 [ 0.00319127 -0.01152405 -0.08978207]
 [ 0.01204728 -0.01539867 -0.09397378]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.0111577  -0.01052171 -0.09677491]
 [ 0.01704638 -0.02062959 -0.09225931]
 [ 0.01078132 -0.02102909 -0.08961838]
 [ 0.0111577  -0.01052171 -0.09677491]
 [ 0.01827362  0.00600675  0.02221706]
 [ 0.00777084  0.03100167  0.03045083]
 [ 0.00777084  0.03100167  0.03045083]
 [ 0.01704638 -0.02062959 -0.09225931]
 [-0.0504739  -0.09884425  0.05089943]
 [-0.04753231 -0.09674694  0.04678161]
 [-0.0430529  -0.09146684  0.0543914 ]
 [-0.04530581 -0.09411572  0.05058779]
 [-0.04753231 -0.09674694  0.04678161]
 [-0.0430529  -0.09146684  0.0543914 ]
 [-0.04530581 -0.09411572  0.05058779]
 [-0.0430529  -0.09146684  0.0543914 ]
 [-0.04530581 -0.09411572  0.05058779]
 [-0.04034024 -0.08924486  0.05038674]
 [-0.03815696 -0.08650583  0.0542582 ]
 [-0.04034024 -0.08924486  0.05038674]
 [-0.03641546 -0.08317721  0.04723533]
 [-0.03815696 -0.08650583  0.0542582 ]
 [-0.03617619 -0.08352422  0.05827471]
 [-0.04034024 -0.08924486  0.05038674]
 [-0.03815696 -0.08650583  0.0542582 ]
 [-0.04034024 -0.08924486  0.05038674]
 [-0.03815696 -0.08650583  0.0542582 ]
 [-0.03617619 -0.08352422  0.05827471]
 [-0.03617619 -0.08352422  0.05827471]
 [-0.03445574 -0.08014788  0.05124323]
 [-0.04477873 -0.09452388  0.04280256]
 [-0.04477873 -0.09452388  0.04280256]
 [-0.03893929 -0.08567118  0.06239212]
 [-0.03893929 -0.08567118  0.06239212]
 [-0.04078011 -0.08883836  0.05817347]
 [-0.03533114 -0.07909583  0.06332622]
 [-0.03893929 -0.08567118  0.06239212]
 [-0.03533114 -0.07909583  0.06332622]
 [-0.04228647 -0.08715484  0.06700916]
 [-0.03818079 -0.08120732  0.0676019 ]
 [-0.04228647 -0.08715484  0.06700916]
 [-0.03818079 -0.08120732  0.0676019 ]
 [-0.04228647 -0.08715484  0.06700916]
 [-0.03818079 -0.08120732  0.0676019 ]
 [-0.03893929 -0.08567118  0.06239212]
 [-0.04078011 -0.08883836  0.05817347]
 [-0.03893929 -0.08567118  0.06239212]
 [-0.04078011 -0.08883836  0.05817347]
 [-0.03533114 -0.07909583  0.06332622]
 [-0.04412653 -0.09052061  0.06275464]
 [-0.03981919 -0.07759924  0.07337416]
 [-0.04419209 -0.0853636   0.07241578]
 [-0.04701123 -0.0846248   0.07664976]
 [-0.04419209 -0.0853636   0.07241578]
 [-0.03981919 -0.07759924  0.07337416]
 [-0.03725038 -0.0758709   0.06931752]
 [-0.04419209 -0.0853636   0.07241578]
 [-0.03533114 -0.07909583  0.06332622]
 [-0.03533114 -0.07909583  0.06332622]
 [-0.04218409 -0.07782538  0.07782824]
 [-0.04228647 -0.08715484  0.06700916]
 [-0.04228647 -0.08715484  0.06700916]
 [-0.03818079 -0.08120732  0.0676019 ]
 [-0.03818079 -0.08120732  0.0676019 ]
 [-0.03981919 -0.07759924  0.07337416]
 [-0.03725038 -0.0758709   0.06931752]
 [-0.04218409 -0.07782538  0.07782824]
 [-0.03725038 -0.0758709   0.06931752]
 [-0.03981919 -0.07759924  0.07337416]
 [-0.03725038 -0.0758709   0.06931752]
 [-0.04218409 -0.07782538  0.07782824]]
len(transformed_superpoints_pcd) :  283
copy_superpoint_src_corr_points.shape :  (15941, 3)
mask.shape :  (15941,)
copy_superpoint_src_corr_points.shape :  (15276, 3)
copy_superpoint_ref_corr_points.shape :  (15276, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([15276, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 15276, 3])
batch_inlier_masks.shape :  torch.Size([2000, 15276])
best_index :  1069
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (15276, 3)
transformed_src_superpoints.shape :  torch.Size([15276, 3])
residual.shape :  torch.Size([15276])
batch_inlier_masks.shape :  torch.Size([15276])
batch_outlier_masks.shape :  torch.Size([15276])
indices_inliers.shape :  torch.Size([61])
indices_outliers.shape :  torch.Size([15215])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([61, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.03022872  0.00478733 -0.0606223 ]
 [ 0.02679651  0.00566704 -0.06489281]
 [ 0.03022872  0.00478733 -0.0606223 ]]
len(transformed_superpoints_pcd) :  344
copy_superpoint_src_corr_points.shape :  (15215, 3)
mask.shape :  (15215,)
copy_superpoint_src_corr_points.shape :  (13302, 3)
copy_superpoint_ref_corr_points.shape :  (13302, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13302, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 13302, 3])
batch_inlier_masks.shape :  torch.Size([2000, 13302])
best_index :  89
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13302, 3)
transformed_src_superpoints.shape :  torch.Size([13302, 3])
residual.shape :  torch.Size([13302])
batch_inlier_masks.shape :  torch.Size([13302])
batch_outlier_masks.shape :  torch.Size([13302])
indices_inliers.shape :  torch.Size([58])
indices_outliers.shape :  torch.Size([13244])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([58, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.05117391 -0.10129604  0.04784892]
 [ 0.05414313 -0.09595706  0.04409599]
 [ 0.05117391 -0.10129604  0.04784892]]
len(transformed_superpoints_pcd) :  402
copy_superpoint_src_corr_points.shape :  (13244, 3)
mask.shape :  (13244,)
copy_superpoint_src_corr_points.shape :  (12575, 3)
copy_superpoint_ref_corr_points.shape :  (12575, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12575, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 12575, 3])
batch_inlier_masks.shape :  torch.Size([2000, 12575])
best_index :  833
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12575, 3)
transformed_src_superpoints.shape :  torch.Size([12575, 3])
residual.shape :  torch.Size([12575])
batch_inlier_masks.shape :  torch.Size([12575])
batch_outlier_masks.shape :  torch.Size([12575])
indices_inliers.shape :  torch.Size([55])
indices_outliers.shape :  torch.Size([12520])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([55, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02318007 -0.12249033 -0.00045036]
 [ 0.02297149 -0.11865214  0.00291253]
 [ 0.02706977 -0.1124111   0.00249143]]
len(transformed_superpoints_pcd) :  457
copy_superpoint_src_corr_points.shape :  (12520, 3)
mask.shape :  (12520,)
copy_superpoint_src_corr_points.shape :  (12182, 3)
copy_superpoint_ref_corr_points.shape :  (12182, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12182, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 12182, 3])
batch_inlier_masks.shape :  torch.Size([2000, 12182])
best_index :  970
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12182, 3)
transformed_src_superpoints.shape :  torch.Size([12182, 3])
residual.shape :  torch.Size([12182])
batch_inlier_masks.shape :  torch.Size([12182])
batch_outlier_masks.shape :  torch.Size([12182])
indices_inliers.shape :  torch.Size([52])
indices_outliers.shape :  torch.Size([12130])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([52, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.04325345 -0.06687191  0.04050727]
 [-0.04325345 -0.06687191  0.04050727]
 [-0.04325345 -0.06687191  0.04050727]]
len(transformed_superpoints_pcd) :  509
copy_superpoint_src_corr_points.shape :  (12130, 3)
mask.shape :  (12130,)
copy_superpoint_src_corr_points.shape :  (11338, 3)
copy_superpoint_ref_corr_points.shape :  (11338, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([11338, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 11338, 3])
batch_inlier_masks.shape :  torch.Size([2000, 11338])
best_index :  450
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (11338, 3)
transformed_src_superpoints.shape :  torch.Size([11338, 3])
residual.shape :  torch.Size([11338])
batch_inlier_masks.shape :  torch.Size([11338])
batch_outlier_masks.shape :  torch.Size([11338])
indices_inliers.shape :  torch.Size([51])
indices_outliers.shape :  torch.Size([11287])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([51, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02821683  0.02555159  0.01285135]
 [ 0.02597414  0.01204409  0.01956774]
 [ 0.02597414  0.01204409  0.01956774]]
len(transformed_superpoints_pcd) :  560
copy_superpoint_src_corr_points.shape :  (11287, 3)
mask.shape :  (11287,)
copy_superpoint_src_corr_points.shape :  (10713, 3)
copy_superpoint_ref_corr_points.shape :  (10713, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10713, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 10713, 3])
batch_inlier_masks.shape :  torch.Size([2000, 10713])
best_index :  1717
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10713, 3)
transformed_src_superpoints.shape :  torch.Size([10713, 3])
residual.shape :  torch.Size([10713])
batch_inlier_masks.shape :  torch.Size([10713])
batch_outlier_masks.shape :  torch.Size([10713])
indices_inliers.shape :  torch.Size([51])
indices_outliers.shape :  torch.Size([10662])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([51, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.03732131  0.08826099  0.01947572]
 [-0.04027515  0.08455326  0.01787383]
 [-0.03236816  0.09199701  0.02130804]]
len(transformed_superpoints_pcd) :  611
copy_superpoint_src_corr_points.shape :  (10662, 3)
mask.shape :  (10662,)
copy_superpoint_src_corr_points.shape :  (10201, 3)
copy_superpoint_ref_corr_points.shape :  (10201, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10201, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 10201, 3])
batch_inlier_masks.shape :  torch.Size([2000, 10201])
best_index :  148
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10201, 3)
transformed_src_superpoints.shape :  torch.Size([10201, 3])
residual.shape :  torch.Size([10201])
batch_inlier_masks.shape :  torch.Size([10201])
batch_outlier_masks.shape :  torch.Size([10201])
indices_inliers.shape :  torch.Size([47])
indices_outliers.shape :  torch.Size([10154])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([47, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.0425292  -0.07065605  0.02889583]
 [-0.04602893 -0.06777431  0.03109928]
 [-0.0425292  -0.07065605  0.02889583]]
len(transformed_superpoints_pcd) :  658
copy_superpoint_src_corr_points.shape :  (10154, 3)
mask.shape :  (10154,)
copy_superpoint_src_corr_points.shape :  (9503, 3)
copy_superpoint_ref_corr_points.shape :  (9503, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9503, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 9503, 3])
batch_inlier_masks.shape :  torch.Size([2000, 9503])
best_index :  508
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9503, 3)
transformed_src_superpoints.shape :  torch.Size([9503, 3])
residual.shape :  torch.Size([9503])
batch_inlier_masks.shape :  torch.Size([9503])
batch_outlier_masks.shape :  torch.Size([9503])
indices_inliers.shape :  torch.Size([44])
indices_outliers.shape :  torch.Size([9459])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([44, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02982133  0.00615665 -0.06257345]
 [ 0.03227756  0.00088475 -0.05214319]
 [ 0.03075677  0.00210712 -0.05833118]]
len(transformed_superpoints_pcd) :  702
copy_superpoint_src_corr_points.shape :  (9459, 3)
mask.shape :  (9459,)
copy_superpoint_src_corr_points.shape :  (8669, 3)
copy_superpoint_ref_corr_points.shape :  (8669, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8669, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 8669, 3])
batch_inlier_masks.shape :  torch.Size([2000, 8669])
best_index :  1151
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8669, 3)
transformed_src_superpoints.shape :  torch.Size([8669, 3])
residual.shape :  torch.Size([8669])
batch_inlier_masks.shape :  torch.Size([8669])
batch_outlier_masks.shape :  torch.Size([8669])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([8631])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08056654 -0.08805371  0.0238797 ]
 [-0.08341621 -0.08564887  0.02862511]
 [-0.08194119 -0.09141186  0.0295884 ]]
len(transformed_superpoints_pcd) :  740
copy_superpoint_src_corr_points.shape :  (8631, 3)
mask.shape :  (8631,)
copy_superpoint_src_corr_points.shape :  (8392, 3)
copy_superpoint_ref_corr_points.shape :  (8392, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8392, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 8392, 3])
batch_inlier_masks.shape :  torch.Size([2000, 8392])
best_index :  909
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8392, 3)
transformed_src_superpoints.shape :  torch.Size([8392, 3])
residual.shape :  torch.Size([8392])
batch_inlier_masks.shape :  torch.Size([8392])
batch_outlier_masks.shape :  torch.Size([8392])
indices_inliers.shape :  torch.Size([34])
indices_outliers.shape :  torch.Size([8358])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([34, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.01369683  0.01119357  0.0281122 ]
 [ 0.01862936  0.00178996  0.02637886]
 [ 0.00788581 -0.00671886  0.02950312]]
len(transformed_superpoints_pcd) :  774
copy_superpoint_src_corr_points.shape :  (8358, 3)
mask.shape :  (8358,)
copy_superpoint_src_corr_points.shape :  (7977, 3)
copy_superpoint_ref_corr_points.shape :  (7977, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7977, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7977, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7977])
best_index :  1996
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7977, 3)
transformed_src_superpoints.shape :  torch.Size([7977, 3])
residual.shape :  torch.Size([7977])
batch_inlier_masks.shape :  torch.Size([7977])
batch_outlier_masks.shape :  torch.Size([7977])
indices_inliers.shape :  torch.Size([34])
indices_outliers.shape :  torch.Size([7943])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([34, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.06933109  0.06022588  0.0120567 ]
 [ 0.06600732  0.05611057  0.01081078]
 [ 0.07036499  0.05132238  0.00884786]]
len(transformed_superpoints_pcd) :  808
copy_superpoint_src_corr_points.shape :  (7943, 3)
mask.shape :  (7943,)
copy_superpoint_src_corr_points.shape :  (7903, 3)
copy_superpoint_ref_corr_points.shape :  (7903, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7903, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7903, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7903])
best_index :  605
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7903, 3)
transformed_src_superpoints.shape :  torch.Size([7903, 3])
residual.shape :  torch.Size([7903])
batch_inlier_masks.shape :  torch.Size([7903])
batch_outlier_masks.shape :  torch.Size([7903])
indices_inliers.shape :  torch.Size([33])
indices_outliers.shape :  torch.Size([7870])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([33, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08163207 -0.08539981  0.02425025]
 [-0.07080953 -0.08466618  0.01502728]
 [-0.06864105 -0.07817972  0.01712619]]
len(transformed_superpoints_pcd) :  841
copy_superpoint_src_corr_points.shape :  (7870, 3)
mask.shape :  (7870,)
copy_superpoint_src_corr_points.shape :  (7782, 3)
copy_superpoint_ref_corr_points.shape :  (7782, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7782, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7782, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7782])
best_index :  513
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7782, 3)
transformed_src_superpoints.shape :  torch.Size([7782, 3])
residual.shape :  torch.Size([7782])
batch_inlier_masks.shape :  torch.Size([7782])
batch_outlier_masks.shape :  torch.Size([7782])
indices_inliers.shape :  torch.Size([32])
indices_outliers.shape :  torch.Size([7750])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([32, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.08723798  0.04917123  0.00638107]
 [ 0.09051971  0.05353856  0.00827702]
 [ 0.04126847  0.00117172 -0.05987051]]
len(transformed_superpoints_pcd) :  873
copy_superpoint_src_corr_points.shape :  (7750, 3)
mask.shape :  (7750,)
copy_superpoint_src_corr_points.shape :  (7531, 3)
copy_superpoint_ref_corr_points.shape :  (7531, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7531, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7531, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7531])
best_index :  1112
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7531, 3)
transformed_src_superpoints.shape :  torch.Size([7531, 3])
residual.shape :  torch.Size([7531])
batch_inlier_masks.shape :  torch.Size([7531])
batch_outlier_masks.shape :  torch.Size([7531])
indices_inliers.shape :  torch.Size([32])
indices_outliers.shape :  torch.Size([7499])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([32, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02077149  0.00965374  0.02400675]
 [ 0.02407146  0.0143861   0.0220794 ]
 [ 0.02930063  0.01322778  0.0189071 ]]
len(transformed_superpoints_pcd) :  905
copy_superpoint_src_corr_points.shape :  (7499, 3)
mask.shape :  (7499,)
copy_superpoint_src_corr_points.shape :  (6777, 3)
copy_superpoint_ref_corr_points.shape :  (6777, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6777, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6777, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6777])
best_index :  1989
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6777, 3)
transformed_src_superpoints.shape :  torch.Size([6777, 3])
residual.shape :  torch.Size([6777])
batch_inlier_masks.shape :  torch.Size([6777])
batch_outlier_masks.shape :  torch.Size([6777])
indices_inliers.shape :  torch.Size([32])
indices_outliers.shape :  torch.Size([6745])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([32, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.04325119 -0.0669112   0.03824641]
 [-0.03983651 -0.06982343  0.0431871 ]
 [-0.04325119 -0.0669112   0.03824641]]
len(transformed_superpoints_pcd) :  937
copy_superpoint_src_corr_points.shape :  (6745, 3)
mask.shape :  (6745,)
copy_superpoint_src_corr_points.shape :  (6405, 3)
copy_superpoint_ref_corr_points.shape :  (6405, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6405, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6405, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6405])
best_index :  338
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6405, 3)
transformed_src_superpoints.shape :  torch.Size([6405, 3])
residual.shape :  torch.Size([6405])
batch_inlier_masks.shape :  torch.Size([6405])
batch_outlier_masks.shape :  torch.Size([6405])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([6374])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09455905  0.06424911 -0.00650267]
 [ 0.0964058   0.05874208 -0.0058492 ]
 [ 0.09856702  0.06288531 -0.01061133]]
len(transformed_superpoints_pcd) :  968
copy_superpoint_src_corr_points.shape :  (6374, 3)
mask.shape :  (6374,)
copy_superpoint_src_corr_points.shape :  (6231, 3)
copy_superpoint_ref_corr_points.shape :  (6231, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6231, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6231, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6231])
best_index :  232
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6231, 3)
transformed_src_superpoints.shape :  torch.Size([6231, 3])
residual.shape :  torch.Size([6231])
batch_inlier_masks.shape :  torch.Size([6231])
batch_outlier_masks.shape :  torch.Size([6231])
indices_inliers.shape :  torch.Size([30])
indices_outliers.shape :  torch.Size([6201])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([30, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.01344591  0.00746848  0.02038559]
 [ 0.01482201  0.00542526  0.02856618]
 [ 0.0182832   0.01179018  0.02933286]]
len(transformed_superpoints_pcd) :  998
copy_superpoint_src_corr_points.shape :  (6201, 3)
mask.shape :  (6201,)
copy_superpoint_src_corr_points.shape :  (5843, 3)
copy_superpoint_ref_corr_points.shape :  (5843, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5843, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5843, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5843])
best_index :  1957
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5843, 3)
transformed_src_superpoints.shape :  torch.Size([5843, 3])
residual.shape :  torch.Size([5843])
batch_inlier_masks.shape :  torch.Size([5843])
batch_outlier_masks.shape :  torch.Size([5843])
indices_inliers.shape :  torch.Size([30])
indices_outliers.shape :  torch.Size([5813])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([30, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.00527399 -0.05474402 -0.01270653]
 [ 0.00298102 -0.05193581 -0.00511624]
 [ 0.0006477  -0.05452424 -0.01039367]]
len(transformed_superpoints_pcd) :  1028
copy_superpoint_src_corr_points.shape :  (5813, 3)
mask.shape :  (5813,)
copy_superpoint_src_corr_points.shape :  (5369, 3)
copy_superpoint_ref_corr_points.shape :  (5369, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5369, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5369, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5369])
best_index :  675
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5369, 3)
transformed_src_superpoints.shape :  torch.Size([5369, 3])
residual.shape :  torch.Size([5369])
batch_inlier_masks.shape :  torch.Size([5369])
batch_outlier_masks.shape :  torch.Size([5369])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([5341])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.04189555 -0.05571861  0.04861104]
 [-0.04662935 -0.06378503  0.05038192]
 [-0.04436369 -0.06039144  0.04446854]]
len(transformed_superpoints_pcd) :  1056
copy_superpoint_src_corr_points.shape :  (5341, 3)
mask.shape :  (5341,)
copy_superpoint_src_corr_points.shape :  (5207, 3)
copy_superpoint_ref_corr_points.shape :  (5207, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5207, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5207, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5207])
best_index :  947
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5207, 3)
transformed_src_superpoints.shape :  torch.Size([5207, 3])
residual.shape :  torch.Size([5207])
batch_inlier_masks.shape :  torch.Size([5207])
batch_outlier_masks.shape :  torch.Size([5207])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([5179])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.0443901  -0.06405079  0.0395433 ]
 [-0.04095051 -0.06881952  0.04350628]
 [-0.0443901  -0.06405079  0.0395433 ]]
len(transformed_superpoints_pcd) :  1084
copy_superpoint_src_corr_points.shape :  (5179, 3)
mask.shape :  (5179,)
copy_superpoint_src_corr_points.shape :  (4625, 3)
copy_superpoint_ref_corr_points.shape :  (4625, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4625, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4625, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4625])
best_index :  462
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4625, 3)
transformed_src_superpoints.shape :  torch.Size([4625, 3])
residual.shape :  torch.Size([4625])
batch_inlier_masks.shape :  torch.Size([4625])
batch_outlier_masks.shape :  torch.Size([4625])
indices_inliers.shape :  torch.Size([27])
indices_outliers.shape :  torch.Size([4598])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([27, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.02575914  0.09187376  0.02732778]
 [-0.02277717  0.08691379  0.02175396]
 [-0.0324024   0.09187518  0.02721674]]
len(transformed_superpoints_pcd) :  1111
copy_superpoint_src_corr_points.shape :  (4598, 3)
mask.shape :  (4598,)
copy_superpoint_src_corr_points.shape :  (4272, 3)
copy_superpoint_ref_corr_points.shape :  (4272, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4272, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4272, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4272])
best_index :  497
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4272, 3)
transformed_src_superpoints.shape :  torch.Size([4272, 3])
residual.shape :  torch.Size([4272])
batch_inlier_masks.shape :  torch.Size([4272])
batch_outlier_masks.shape :  torch.Size([4272])
indices_inliers.shape :  torch.Size([26])
indices_outliers.shape :  torch.Size([4246])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([26, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02824766 -0.11964199  0.01082085]
 [ 0.03387484 -0.12170216  0.01025483]
 [ 0.02824766 -0.11964199  0.01082085]]
len(transformed_superpoints_pcd) :  1137
copy_superpoint_src_corr_points.shape :  (4246, 3)
mask.shape :  (4246,)
copy_superpoint_src_corr_points.shape :  (4089, 3)
copy_superpoint_ref_corr_points.shape :  (4089, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4089, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4089, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4089])
best_index :  1360
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4089, 3)
transformed_src_superpoints.shape :  torch.Size([4089, 3])
residual.shape :  torch.Size([4089])
batch_inlier_masks.shape :  torch.Size([4089])
batch_outlier_masks.shape :  torch.Size([4089])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([4065])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.02058942 -0.05805288 -0.04277992]
 [-0.0006097  -0.06795236 -0.07008147]
 [-0.01625772 -0.06141372 -0.06997505]]
len(transformed_superpoints_pcd) :  1161
copy_superpoint_src_corr_points.shape :  (4065, 3)
mask.shape :  (4065,)
copy_superpoint_src_corr_points.shape :  (3562, 3)
copy_superpoint_ref_corr_points.shape :  (3562, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3562, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3562, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3562])
best_index :  963
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3562, 3)
transformed_src_superpoints.shape :  torch.Size([3562, 3])
residual.shape :  torch.Size([3562])
batch_inlier_masks.shape :  torch.Size([3562])
batch_outlier_masks.shape :  torch.Size([3562])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([3541])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08674543 -0.08078122  0.02966434]
 [-0.0828421  -0.08401117  0.03483878]
 [-0.0815132  -0.0894022   0.03001246]]
len(transformed_superpoints_pcd) :  1182
copy_superpoint_src_corr_points.shape :  (3541, 3)
mask.shape :  (3541,)
copy_superpoint_src_corr_points.shape :  (3485, 3)
copy_superpoint_ref_corr_points.shape :  (3485, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3485, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3485, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3485])
best_index :  1405
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3485, 3)
transformed_src_superpoints.shape :  torch.Size([3485, 3])
residual.shape :  torch.Size([3485])
batch_inlier_masks.shape :  torch.Size([3485])
batch_outlier_masks.shape :  torch.Size([3485])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([3465])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.04154306 -0.01478432 -0.06195375]
 [ 0.04734664 -0.01440266 -0.06179422]
 [ 0.03605246 -0.03306694 -0.05565969]]
len(transformed_superpoints_pcd) :  1202
copy_superpoint_src_corr_points.shape :  (3465, 3)
mask.shape :  (3465,)
copy_superpoint_src_corr_points.shape :  (3220, 3)
copy_superpoint_ref_corr_points.shape :  (3220, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3220, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3220, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3220])
best_index :  1915
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3220, 3)
transformed_src_superpoints.shape :  torch.Size([3220, 3])
residual.shape :  torch.Size([3220])
batch_inlier_masks.shape :  torch.Size([3220])
batch_outlier_masks.shape :  torch.Size([3220])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([3201])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.02245406 -0.05429137 -0.03582571]
 [-0.02169613 -0.05570533 -0.04444274]
 [-0.01909984 -0.05732904 -0.04031859]]
len(transformed_superpoints_pcd) :  1221
copy_superpoint_src_corr_points.shape :  (3201, 3)
mask.shape :  (3201,)
copy_superpoint_src_corr_points.shape :  (2994, 3)
copy_superpoint_ref_corr_points.shape :  (2994, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2994, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2994, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2994])
best_index :  1125
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2994, 3)
transformed_src_superpoints.shape :  torch.Size([2994, 3])
residual.shape :  torch.Size([2994])
batch_inlier_masks.shape :  torch.Size([2994])
batch_outlier_masks.shape :  torch.Size([2994])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([2976])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02842046 -0.11093816  0.00209935]
 [ 0.02490183 -0.11278625  0.01056759]
 [ 0.02490183 -0.11278625  0.01056759]]
len(transformed_superpoints_pcd) :  1239
copy_superpoint_src_corr_points.shape :  (2976, 3)
mask.shape :  (2976,)
copy_superpoint_src_corr_points.shape :  (2877, 3)
copy_superpoint_ref_corr_points.shape :  (2877, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2877, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2877, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2877])
best_index :  1948
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2877, 3)
transformed_src_superpoints.shape :  torch.Size([2877, 3])
residual.shape :  torch.Size([2877])
batch_inlier_masks.shape :  torch.Size([2877])
batch_outlier_masks.shape :  torch.Size([2877])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([2859])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08924717 -0.08806445  0.04227413]
 [-0.09204105 -0.08331958  0.04307956]
 [-0.0879609  -0.08274803  0.03643126]]
len(transformed_superpoints_pcd) :  1257
copy_superpoint_src_corr_points.shape :  (2859, 3)
mask.shape :  (2859,)
copy_superpoint_src_corr_points.shape :  (2826, 3)
copy_superpoint_ref_corr_points.shape :  (2826, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2826, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2826, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2826])
best_index :  306
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2826, 3)
transformed_src_superpoints.shape :  torch.Size([2826, 3])
residual.shape :  torch.Size([2826])
batch_inlier_masks.shape :  torch.Size([2826])
batch_outlier_masks.shape :  torch.Size([2826])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([2809])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08139418 -0.08997525  0.02425208]
 [-0.07700343 -0.09114628  0.02052278]
 [-0.08139418 -0.08997525  0.02425208]]
len(transformed_superpoints_pcd) :  1274
copy_superpoint_src_corr_points.shape :  (2809, 3)
mask.shape :  (2809,)
copy_superpoint_src_corr_points.shape :  (2713, 3)
copy_superpoint_ref_corr_points.shape :  (2713, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2713, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2713, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2713])
best_index :  917
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2713, 3)
transformed_src_superpoints.shape :  torch.Size([2713, 3])
residual.shape :  torch.Size([2713])
batch_inlier_masks.shape :  torch.Size([2713])
batch_outlier_masks.shape :  torch.Size([2713])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([2696])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09482282  0.06522451 -0.00374731]
 [ 0.09080161  0.0696706  -0.00191811]
 [ 0.09215141  0.06113503 -0.00985721]]
len(transformed_superpoints_pcd) :  1291
copy_superpoint_src_corr_points.shape :  (2696, 3)
mask.shape :  (2696,)
copy_superpoint_src_corr_points.shape :  (2518, 3)
copy_superpoint_ref_corr_points.shape :  (2518, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2518, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2518, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2518])
best_index :  1287
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2518, 3)
transformed_src_superpoints.shape :  torch.Size([2518, 3])
residual.shape :  torch.Size([2518])
batch_inlier_masks.shape :  torch.Size([2518])
batch_outlier_masks.shape :  torch.Size([2518])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([2501])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08320077 -0.09320119  0.03178538]
 [-0.07529566 -0.09557478  0.0321569 ]
 [-0.07529566 -0.09557478  0.0321569 ]]
len(transformed_superpoints_pcd) :  1308
copy_superpoint_src_corr_points.shape :  (2501, 3)
mask.shape :  (2501,)
copy_superpoint_src_corr_points.shape :  (2465, 3)
copy_superpoint_ref_corr_points.shape :  (2465, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2465, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2465, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2465])
best_index :  1795
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2465, 3)
transformed_src_superpoints.shape :  torch.Size([2465, 3])
residual.shape :  torch.Size([2465])
batch_inlier_masks.shape :  torch.Size([2465])
batch_outlier_masks.shape :  torch.Size([2465])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([2448])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.0361008  -0.01916714 -0.05723303]
 [ 0.03675251 -0.02267002 -0.05324622]
 [ 0.0361008  -0.01916714 -0.05723303]]
len(transformed_superpoints_pcd) :  1325
copy_superpoint_src_corr_points.shape :  (2448, 3)
mask.shape :  (2448,)
copy_superpoint_src_corr_points.shape :  (2341, 3)
copy_superpoint_ref_corr_points.shape :  (2341, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2341, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2341, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2341])
best_index :  661
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2341, 3)
transformed_src_superpoints.shape :  torch.Size([2341, 3])
residual.shape :  torch.Size([2341])
batch_inlier_masks.shape :  torch.Size([2341])
batch_outlier_masks.shape :  torch.Size([2341])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([2325])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09566038  0.05962405 -0.00364722]
 [ 0.09428388  0.06420293 -0.00762838]
 [ 0.09428388  0.06420293 -0.00762838]]
len(transformed_superpoints_pcd) :  1341
copy_superpoint_src_corr_points.shape :  (2325, 3)
mask.shape :  (2325,)
copy_superpoint_src_corr_points.shape :  (2303, 3)
copy_superpoint_ref_corr_points.shape :  (2303, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2303, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2303, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2303])
best_index :  1008
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2303, 3)
transformed_src_superpoints.shape :  torch.Size([2303, 3])
residual.shape :  torch.Size([2303])
batch_inlier_masks.shape :  torch.Size([2303])
batch_outlier_masks.shape :  torch.Size([2303])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([2287])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.0281844  -0.1126394   0.01115817]
 [ 0.0281844  -0.1126394   0.01115817]
 [ 0.03018092 -0.11460914  0.00668915]]
len(transformed_superpoints_pcd) :  1357
copy_superpoint_src_corr_points.shape :  (2287, 3)
mask.shape :  (2287,)
copy_superpoint_src_corr_points.shape :  (2272, 3)
copy_superpoint_ref_corr_points.shape :  (2272, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2272, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2272, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2272])
best_index :  1616
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2272, 3)
transformed_src_superpoints.shape :  torch.Size([2272, 3])
residual.shape :  torch.Size([2272])
batch_inlier_masks.shape :  torch.Size([2272])
batch_outlier_masks.shape :  torch.Size([2272])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([2256])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08111166 -0.09127345  0.02706943]
 [-0.08301564 -0.08712447  0.02916939]
 [-0.08111166 -0.09127345  0.02706943]]
len(transformed_superpoints_pcd) :  1373
copy_superpoint_src_corr_points.shape :  (2256, 3)
mask.shape :  (2256,)
copy_superpoint_src_corr_points.shape :  (2215, 3)
copy_superpoint_ref_corr_points.shape :  (2215, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2215, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2215, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2215])
best_index :  1768
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2215, 3)
transformed_src_superpoints.shape :  torch.Size([2215, 3])
residual.shape :  torch.Size([2215])
batch_inlier_masks.shape :  torch.Size([2215])
batch_outlier_masks.shape :  torch.Size([2215])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([2200])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.04231962 -0.02236184 -0.0498672 ]
 [ 0.04231962 -0.02236184 -0.0498672 ]
 [ 0.04231962 -0.02236184 -0.0498672 ]]
len(transformed_superpoints_pcd) :  1388
copy_superpoint_src_corr_points.shape :  (2200, 3)
mask.shape :  (2200,)
copy_superpoint_src_corr_points.shape :  (2030, 3)
copy_superpoint_ref_corr_points.shape :  (2030, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2030, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2030, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2030])
best_index :  1822
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2030, 3)
transformed_src_superpoints.shape :  torch.Size([2030, 3])
residual.shape :  torch.Size([2030])
batch_inlier_masks.shape :  torch.Size([2030])
batch_outlier_masks.shape :  torch.Size([2030])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([2015])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02717705  0.01210622  0.02044403]
 [ 0.02717705  0.01210622  0.02044403]
 [ 0.02717705  0.01210622  0.02044403]]
len(transformed_superpoints_pcd) :  1403
copy_superpoint_src_corr_points.shape :  (2015, 3)
mask.shape :  (2015,)
copy_superpoint_src_corr_points.shape :  (1988, 3)
copy_superpoint_ref_corr_points.shape :  (1988, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1988, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1988, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1988])
best_index :  1910
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1988, 3)
transformed_src_superpoints.shape :  torch.Size([1988, 3])
residual.shape :  torch.Size([1988])
batch_inlier_masks.shape :  torch.Size([1988])
batch_outlier_masks.shape :  torch.Size([1988])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1973])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02494982  0.00541534  0.02216061]
 [ 0.02144815  0.00208873  0.02466129]
 [ 0.01962568  0.00921319  0.0245388 ]]
len(transformed_superpoints_pcd) :  1418
copy_superpoint_src_corr_points.shape :  (1973, 3)
mask.shape :  (1973,)
copy_superpoint_src_corr_points.shape :  (1874, 3)
copy_superpoint_ref_corr_points.shape :  (1874, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1874, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1874, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1874])
best_index :  714
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1874, 3)
transformed_src_superpoints.shape :  torch.Size([1874, 3])
residual.shape :  torch.Size([1874])
batch_inlier_masks.shape :  torch.Size([1874])
batch_outlier_masks.shape :  torch.Size([1874])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1860])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09656855  0.06486318  0.00836785]
 [ 0.09037957  0.06252153  0.01359522]
 [ 0.09661672  0.0611443   0.01451191]]
len(transformed_superpoints_pcd) :  1432
copy_superpoint_src_corr_points.shape :  (1860, 3)
mask.shape :  (1860,)
copy_superpoint_src_corr_points.shape :  (1838, 3)
copy_superpoint_ref_corr_points.shape :  (1838, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1838, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1838, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1838])
best_index :  1248
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1838, 3)
transformed_src_superpoints.shape :  torch.Size([1838, 3])
residual.shape :  torch.Size([1838])
batch_inlier_masks.shape :  torch.Size([1838])
batch_outlier_masks.shape :  torch.Size([1838])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1824])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02727658 -0.11405972  0.00491183]
 [ 0.02716679 -0.11107583  0.01274379]
 [ 0.02829535 -0.11857358 -0.00217827]]
len(transformed_superpoints_pcd) :  1446
copy_superpoint_src_corr_points.shape :  (1824, 3)
mask.shape :  (1824,)
copy_superpoint_src_corr_points.shape :  (1793, 3)
copy_superpoint_ref_corr_points.shape :  (1793, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1793, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1793, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1793])
best_index :  1888
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1793, 3)
transformed_src_superpoints.shape :  torch.Size([1793, 3])
residual.shape :  torch.Size([1793])
batch_inlier_masks.shape :  torch.Size([1793])
batch_outlier_masks.shape :  torch.Size([1793])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1779])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.02372304 -0.05747492 -0.07260273]
 [-0.02372304 -0.05747492 -0.07260273]
 [-0.01943509 -0.06068016 -0.06976745]]
len(transformed_superpoints_pcd) :  1460
copy_superpoint_src_corr_points.shape :  (1779, 3)
mask.shape :  (1779,)
copy_superpoint_src_corr_points.shape :  (1642, 3)
copy_superpoint_ref_corr_points.shape :  (1642, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1642, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1642, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1642])
best_index :  2
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1642, 3)
transformed_src_superpoints.shape :  torch.Size([1642, 3])
residual.shape :  torch.Size([1642])
batch_inlier_masks.shape :  torch.Size([1642])
batch_outlier_masks.shape :  torch.Size([1642])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1629])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.03618173 -0.08786159  0.05914078]
 [-0.03618173 -0.08786159  0.05914078]
 [-0.03618173 -0.08786159  0.05914078]]
len(transformed_superpoints_pcd) :  1473
copy_superpoint_src_corr_points.shape :  (1629, 3)
mask.shape :  (1629,)
copy_superpoint_src_corr_points.shape :  (1535, 3)
copy_superpoint_ref_corr_points.shape :  (1535, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1535, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1535, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1535])
best_index :  1038
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1535, 3)
transformed_src_superpoints.shape :  torch.Size([1535, 3])
residual.shape :  torch.Size([1535])
batch_inlier_masks.shape :  torch.Size([1535])
batch_outlier_masks.shape :  torch.Size([1535])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1522])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.00615203  0.08856118 -0.04715122]
 [ 0.00130048  0.08751093 -0.04883627]
 [-0.00439748  0.09134006 -0.05064218]]
len(transformed_superpoints_pcd) :  1486
copy_superpoint_src_corr_points.shape :  (1522, 3)
mask.shape :  (1522,)
copy_superpoint_src_corr_points.shape :  (1399, 3)
copy_superpoint_ref_corr_points.shape :  (1399, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1399, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1399, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1399])
best_index :  1117
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1399, 3)
transformed_src_superpoints.shape :  torch.Size([1399, 3])
residual.shape :  torch.Size([1399])
batch_inlier_masks.shape :  torch.Size([1399])
batch_outlier_masks.shape :  torch.Size([1399])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1386])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08348858 -0.07999688  0.02799618]
 [-0.08961666 -0.08464717  0.03203353]
 [-0.07817324 -0.0843014   0.02710844]]
len(transformed_superpoints_pcd) :  1499
copy_superpoint_src_corr_points.shape :  (1386, 3)
mask.shape :  (1386,)
copy_superpoint_src_corr_points.shape :  (1385, 3)
copy_superpoint_ref_corr_points.shape :  (1385, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1385, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1385, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1385])
best_index :  1505
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1385, 3)
transformed_src_superpoints.shape :  torch.Size([1385, 3])
residual.shape :  torch.Size([1385])
batch_inlier_masks.shape :  torch.Size([1385])
batch_outlier_masks.shape :  torch.Size([1385])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1372])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.07244509  0.00098591  0.05142264]
 [-0.07516181  0.006783    0.05112485]
 [-0.06881966  0.00414853  0.04974809]]
len(transformed_superpoints_pcd) :  1512
copy_superpoint_src_corr_points.shape :  (1372, 3)
mask.shape :  (1372,)
copy_superpoint_src_corr_points.shape :  (1328, 3)
copy_superpoint_ref_corr_points.shape :  (1328, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1328, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1328, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1328])
best_index :  1779
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1328, 3)
transformed_src_superpoints.shape :  torch.Size([1328, 3])
residual.shape :  torch.Size([1328])
batch_inlier_masks.shape :  torch.Size([1328])
batch_outlier_masks.shape :  torch.Size([1328])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1315])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.00796371 -0.06946224 -0.07361473]
 [ 0.00619865 -0.07429606 -0.07582273]
 [ 0.00869952 -0.06700791 -0.08055463]]
len(transformed_superpoints_pcd) :  1525
copy_superpoint_src_corr_points.shape :  (1315, 3)
mask.shape :  (1315,)
copy_superpoint_src_corr_points.shape :  (1277, 3)
copy_superpoint_ref_corr_points.shape :  (1277, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1277, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1277, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1277])
best_index :  1874
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1277, 3)
transformed_src_superpoints.shape :  torch.Size([1277, 3])
residual.shape :  torch.Size([1277])
batch_inlier_masks.shape :  torch.Size([1277])
batch_outlier_masks.shape :  torch.Size([1277])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1264])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.00700482 -0.06993728 -0.07961808]
 [ 0.00581118 -0.06986659 -0.07432543]
 [ 0.01206692 -0.07064879 -0.07148235]]
len(transformed_superpoints_pcd) :  1538
copy_superpoint_src_corr_points.shape :  (1264, 3)
mask.shape :  (1264,)
copy_superpoint_src_corr_points.shape :  (1220, 3)
copy_superpoint_ref_corr_points.shape :  (1220, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1220, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1220, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1220])
best_index :  1540
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1220, 3)
transformed_src_superpoints.shape :  torch.Size([1220, 3])
residual.shape :  torch.Size([1220])
batch_inlier_masks.shape :  torch.Size([1220])
batch_outlier_masks.shape :  torch.Size([1220])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1208])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.01416089  0.0639855   0.05849338]
 [ 0.00965927  0.06370883  0.05526138]
 [ 0.00576217  0.06726876  0.05705119]]
len(transformed_superpoints_pcd) :  1550
copy_superpoint_src_corr_points.shape :  (1208, 3)
mask.shape :  (1208,)
copy_superpoint_src_corr_points.shape :  (1207, 3)
copy_superpoint_ref_corr_points.shape :  (1207, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1207, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1207, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1207])
best_index :  1603
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1207, 3)
transformed_src_superpoints.shape :  torch.Size([1207, 3])
residual.shape :  torch.Size([1207])
batch_inlier_masks.shape :  torch.Size([1207])
batch_outlier_masks.shape :  torch.Size([1207])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1195])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02326458  0.00083884  0.02175937]
 [ 0.0286451   0.0016168   0.02483747]
 [ 0.01912361  0.01241463  0.02465791]]
len(transformed_superpoints_pcd) :  1562
copy_superpoint_src_corr_points.shape :  (1195, 3)
mask.shape :  (1195,)
copy_superpoint_src_corr_points.shape :  (1170, 3)
copy_superpoint_ref_corr_points.shape :  (1170, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1170, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1170, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1170])
best_index :  1015
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1170, 3)
transformed_src_superpoints.shape :  torch.Size([1170, 3])
residual.shape :  torch.Size([1170])
batch_inlier_masks.shape :  torch.Size([1170])
batch_outlier_masks.shape :  torch.Size([1170])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([1159])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.07969742 -0.08650632  0.023601  ]
 [-0.07969742 -0.08650632  0.023601  ]
 [-0.07209779 -0.07842906  0.01533685]]
len(transformed_superpoints_pcd) :  1573
copy_superpoint_src_corr_points.shape :  (1159, 3)
mask.shape :  (1159,)
copy_superpoint_src_corr_points.shape :  (1144, 3)
copy_superpoint_ref_corr_points.shape :  (1144, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1144, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1144, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1144])
best_index :  1097
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1144, 3)
transformed_src_superpoints.shape :  torch.Size([1144, 3])
residual.shape :  torch.Size([1144])
batch_inlier_masks.shape :  torch.Size([1144])
batch_outlier_masks.shape :  torch.Size([1144])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([1133])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08085847 -0.08927433  0.02677394]
 [-0.08347084 -0.09096147  0.03082851]
 [-0.08286801 -0.08065196  0.02391738]]
len(transformed_superpoints_pcd) :  1584
copy_superpoint_src_corr_points.shape :  (1133, 3)
mask.shape :  (1133,)
copy_superpoint_src_corr_points.shape :  (1086, 3)
copy_superpoint_ref_corr_points.shape :  (1086, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1086, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1086, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1086])
best_index :  1618
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1086, 3)
transformed_src_superpoints.shape :  torch.Size([1086, 3])
residual.shape :  torch.Size([1086])
batch_inlier_masks.shape :  torch.Size([1086])
batch_outlier_masks.shape :  torch.Size([1086])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([1075])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.07792414 -0.0930731   0.02102779]
 [-0.07736316 -0.08383833  0.01702957]
 [-0.07453845 -0.07793486  0.01915431]]
len(transformed_superpoints_pcd) :  1595
copy_superpoint_src_corr_points.shape :  (1075, 3)
mask.shape :  (1075,)
copy_superpoint_src_corr_points.shape :  (1070, 3)
copy_superpoint_ref_corr_points.shape :  (1070, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1070, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1070, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1070])
best_index :  1631
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1070, 3)
transformed_src_superpoints.shape :  torch.Size([1070, 3])
residual.shape :  torch.Size([1070])
batch_inlier_masks.shape :  torch.Size([1070])
batch_outlier_masks.shape :  torch.Size([1070])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([1059])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.02756552 -0.05104384 -0.06041182]
 [-0.02206529 -0.05723725 -0.06134613]
 [-0.02756552 -0.05104384 -0.06041182]]
len(transformed_superpoints_pcd) :  1606
copy_superpoint_src_corr_points.shape :  (1059, 3)
mask.shape :  (1059,)
copy_superpoint_src_corr_points.shape :  (925, 3)
copy_superpoint_ref_corr_points.shape :  (925, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([925, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 925, 3])
batch_inlier_masks.shape :  torch.Size([2000, 925])
best_index :  1693
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (925, 3)
transformed_src_superpoints.shape :  torch.Size([925, 3])
residual.shape :  torch.Size([925])
batch_inlier_masks.shape :  torch.Size([925])
batch_outlier_masks.shape :  torch.Size([925])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([914])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02480334  0.01008029  0.02206146]
 [ 0.01918291  0.00457435  0.02532184]
 [ 0.01716631  0.00915444  0.02580098]]
len(transformed_superpoints_pcd) :  1617
copy_superpoint_src_corr_points.shape :  (914, 3)
mask.shape :  (914,)
copy_superpoint_src_corr_points.shape :  (914, 3)
copy_superpoint_ref_corr_points.shape :  (914, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([914, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 914, 3])
batch_inlier_masks.shape :  torch.Size([2000, 914])
best_index :  1799
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (914, 3)
transformed_src_superpoints.shape :  torch.Size([914, 3])
residual.shape :  torch.Size([914])
batch_inlier_masks.shape :  torch.Size([914])
batch_outlier_masks.shape :  torch.Size([914])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([903])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.02753579 -0.05706014 -0.07530381]
 [-0.02257657 -0.0565545  -0.07426846]
 [-0.02285992 -0.06005994 -0.06972727]]
len(transformed_superpoints_pcd) :  1628
copy_superpoint_src_corr_points.shape :  (903, 3)
mask.shape :  (903,)
copy_superpoint_src_corr_points.shape :  (882, 3)
copy_superpoint_ref_corr_points.shape :  (882, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([882, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 882, 3])
batch_inlier_masks.shape :  torch.Size([2000, 882])
best_index :  1985
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (882, 3)
transformed_src_superpoints.shape :  torch.Size([882, 3])
residual.shape :  torch.Size([882])
batch_inlier_masks.shape :  torch.Size([882])
batch_outlier_masks.shape :  torch.Size([882])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([871])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09486576  0.066282   -0.00331623]
 [ 0.09425829  0.05991651 -0.00137728]
 [ 0.09697694  0.05658393 -0.00616805]]
len(transformed_superpoints_pcd) :  1639
copy_superpoint_src_corr_points.shape :  (871, 3)
mask.shape :  (871,)
copy_superpoint_src_corr_points.shape :  (870, 3)
copy_superpoint_ref_corr_points.shape :  (870, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([870, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 870, 3])
batch_inlier_masks.shape :  torch.Size([2000, 870])
best_index :  201
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (870, 3)
transformed_src_superpoints.shape :  torch.Size([870, 3])
residual.shape :  torch.Size([870])
batch_inlier_masks.shape :  torch.Size([870])
batch_outlier_masks.shape :  torch.Size([870])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([860])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.06967555  0.00791928  0.05051477]
 [-0.07396165  0.00713959  0.05398111]
 [-0.06967555  0.00791928  0.05051477]]
len(transformed_superpoints_pcd) :  1649
copy_superpoint_src_corr_points.shape :  (860, 3)
mask.shape :  (860,)
copy_superpoint_src_corr_points.shape :  (809, 3)
copy_superpoint_ref_corr_points.shape :  (809, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([809, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 809, 3])
batch_inlier_masks.shape :  torch.Size([2000, 809])
best_index :  276
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (809, 3)
transformed_src_superpoints.shape :  torch.Size([809, 3])
residual.shape :  torch.Size([809])
batch_inlier_masks.shape :  torch.Size([809])
batch_outlier_masks.shape :  torch.Size([809])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([799])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.03162551 -0.11737319  0.01562143]
 [ 0.03097016 -0.12296722  0.01732864]
 [ 0.03162551 -0.11737319  0.01562143]]
len(transformed_superpoints_pcd) :  1659
copy_superpoint_src_corr_points.shape :  (799, 3)
mask.shape :  (799,)
copy_superpoint_src_corr_points.shape :  (732, 3)
copy_superpoint_ref_corr_points.shape :  (732, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([732, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 732, 3])
batch_inlier_masks.shape :  torch.Size([2000, 732])
best_index :  1013
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (732, 3)
transformed_src_superpoints.shape :  torch.Size([732, 3])
residual.shape :  torch.Size([732])
batch_inlier_masks.shape :  torch.Size([732])
batch_outlier_masks.shape :  torch.Size([732])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([722])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.05174701 -0.12367354 -0.00804411]
 [-0.04398448 -0.09699315  0.05534755]
 [ 0.05598738 -0.12247808 -0.0106283 ]]
len(transformed_superpoints_pcd) :  1669
copy_superpoint_src_corr_points.shape :  (722, 3)
mask.shape :  (722,)
copy_superpoint_src_corr_points.shape :  (665, 3)
copy_superpoint_ref_corr_points.shape :  (665, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([665, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 665, 3])
batch_inlier_masks.shape :  torch.Size([2000, 665])
best_index :  1583
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (665, 3)
transformed_src_superpoints.shape :  torch.Size([665, 3])
residual.shape :  torch.Size([665])
batch_inlier_masks.shape :  torch.Size([665])
batch_outlier_masks.shape :  torch.Size([665])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([655])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02449998  0.00989604  0.02261612]
 [ 0.02350435  0.00301435  0.02230842]
 [ 0.01973056  0.0075734   0.02579012]]
len(transformed_superpoints_pcd) :  1679
copy_superpoint_src_corr_points.shape :  (655, 3)
mask.shape :  (655,)
copy_superpoint_src_corr_points.shape :  (655, 3)
copy_superpoint_ref_corr_points.shape :  (655, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([655, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 655, 3])
batch_inlier_masks.shape :  torch.Size([2000, 655])
best_index :  735
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (655, 3)
transformed_src_superpoints.shape :  torch.Size([655, 3])
residual.shape :  torch.Size([655])
batch_inlier_masks.shape :  torch.Size([655])
batch_outlier_masks.shape :  torch.Size([655])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([646])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.03437294 -0.06854308  0.02968078]
 [-0.03437294 -0.06854308  0.02968078]
 [-0.07607195 -0.08295274  0.01913774]]
len(transformed_superpoints_pcd) :  1688
copy_superpoint_src_corr_points.shape :  (646, 3)
mask.shape :  (646,)
copy_superpoint_src_corr_points.shape :  (562, 3)
copy_superpoint_ref_corr_points.shape :  (562, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([562, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 562, 3])
batch_inlier_masks.shape :  torch.Size([2000, 562])
best_index :  808
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (562, 3)
transformed_src_superpoints.shape :  torch.Size([562, 3])
residual.shape :  torch.Size([562])
batch_inlier_masks.shape :  torch.Size([562])
batch_outlier_masks.shape :  torch.Size([562])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([553])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09258582  0.05881806 -0.00493444]
 [ 0.09352463  0.05877649  0.00032019]
 [ 0.09828158  0.0629205   0.00102827]]
len(transformed_superpoints_pcd) :  1697
copy_superpoint_src_corr_points.shape :  (553, 3)
mask.shape :  (553,)
copy_superpoint_src_corr_points.shape :  (529, 3)
copy_superpoint_ref_corr_points.shape :  (529, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([529, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 529, 3])
batch_inlier_masks.shape :  torch.Size([2000, 529])
best_index :  1207
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (529, 3)
transformed_src_superpoints.shape :  torch.Size([529, 3])
residual.shape :  torch.Size([529])
batch_inlier_masks.shape :  torch.Size([529])
batch_outlier_masks.shape :  torch.Size([529])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([520])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.01919648  0.00544177  0.02482397]
 [ 0.02251133  0.01342047  0.02289842]
 [ 0.02009565 -0.0005262   0.02571437]]
len(transformed_superpoints_pcd) :  1706
copy_superpoint_src_corr_points.shape :  (520, 3)
mask.shape :  (520,)
copy_superpoint_src_corr_points.shape :  (513, 3)
copy_superpoint_ref_corr_points.shape :  (513, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([513, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 513, 3])
batch_inlier_masks.shape :  torch.Size([2000, 513])
best_index :  1652
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (513, 3)
transformed_src_superpoints.shape :  torch.Size([513, 3])
residual.shape :  torch.Size([513])
batch_inlier_masks.shape :  torch.Size([513])
batch_outlier_masks.shape :  torch.Size([513])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([504])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.01115347  0.07205814  0.06210283]
 [ 0.0132556   0.0669499   0.05940969]
 [ 0.00945045  0.06456463  0.05649915]]
len(transformed_superpoints_pcd) :  1715
copy_superpoint_src_corr_points.shape :  (504, 3)
mask.shape :  (504,)
copy_superpoint_src_corr_points.shape :  (504, 3)
copy_superpoint_ref_corr_points.shape :  (504, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([504, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 504, 3])
batch_inlier_masks.shape :  torch.Size([2000, 504])
best_index :  1690
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (504, 3)
transformed_src_superpoints.shape :  torch.Size([504, 3])
residual.shape :  torch.Size([504])
batch_inlier_masks.shape :  torch.Size([504])
batch_outlier_masks.shape :  torch.Size([504])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([495])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09471767  0.0585088   0.0059721 ]
 [ 0.092228    0.06344948  0.00855651]
 [ 0.09847571  0.05880151  0.00130948]]
len(transformed_superpoints_pcd) :  1724
copy_superpoint_src_corr_points.shape :  (495, 3)
mask.shape :  (495,)
copy_superpoint_src_corr_points.shape :  (495, 3)
copy_superpoint_ref_corr_points.shape :  (495, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([495, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 495, 3])
batch_inlier_masks.shape :  torch.Size([2000, 495])
best_index :  1800
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (495, 3)
transformed_src_superpoints.shape :  torch.Size([495, 3])
residual.shape :  torch.Size([495])
batch_inlier_masks.shape :  torch.Size([495])
batch_outlier_masks.shape :  torch.Size([495])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([486])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.07715574 -0.09078121  0.02051156]
 [-0.08006658 -0.08855322  0.02518018]
 [-0.07621933 -0.08289785  0.01917965]]
len(transformed_superpoints_pcd) :  1733
copy_superpoint_src_corr_points.shape :  (486, 3)
mask.shape :  (486,)
copy_superpoint_src_corr_points.shape :  (485, 3)
copy_superpoint_ref_corr_points.shape :  (485, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([485, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 485, 3])
batch_inlier_masks.shape :  torch.Size([2000, 485])
best_index :  53
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (485, 3)
transformed_src_superpoints.shape :  torch.Size([485, 3])
residual.shape :  torch.Size([485])
batch_inlier_masks.shape :  torch.Size([485])
batch_outlier_masks.shape :  torch.Size([485])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([477])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.04508325 -0.12419589  0.04385652]
 [ 0.0278025  -0.11281595  0.01011784]
 [ 0.0278025  -0.11281595  0.01011784]]
len(transformed_superpoints_pcd) :  1741
copy_superpoint_src_corr_points.shape :  (477, 3)
mask.shape :  (477,)
copy_superpoint_src_corr_points.shape :  (434, 3)
copy_superpoint_ref_corr_points.shape :  (434, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([434, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 434, 3])
batch_inlier_masks.shape :  torch.Size([2000, 434])
best_index :  891
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (434, 3)
transformed_src_superpoints.shape :  torch.Size([434, 3])
residual.shape :  torch.Size([434])
batch_inlier_masks.shape :  torch.Size([434])
batch_outlier_masks.shape :  torch.Size([434])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([426])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02191127  0.00171574 -0.07143995]
 [ 0.02630123 -0.00245797 -0.07425354]
 [ 0.02630123 -0.00245797 -0.07425354]]
len(transformed_superpoints_pcd) :  1749
copy_superpoint_src_corr_points.shape :  (426, 3)
mask.shape :  (426,)
copy_superpoint_src_corr_points.shape :  (394, 3)
copy_superpoint_ref_corr_points.shape :  (394, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([394, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 394, 3])
batch_inlier_masks.shape :  torch.Size([2000, 394])
best_index :  1059
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (394, 3)
transformed_src_superpoints.shape :  torch.Size([394, 3])
residual.shape :  torch.Size([394])
batch_inlier_masks.shape :  torch.Size([394])
batch_outlier_masks.shape :  torch.Size([394])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([386])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08520581 -0.08870369  0.03262091]
 [-0.08308987 -0.08544169  0.02582221]
 [-0.08520581 -0.08870369  0.03262091]]
len(transformed_superpoints_pcd) :  1757
copy_superpoint_src_corr_points.shape :  (386, 3)
mask.shape :  (386,)
copy_superpoint_src_corr_points.shape :  (385, 3)
copy_superpoint_ref_corr_points.shape :  (385, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([385, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 385, 3])
batch_inlier_masks.shape :  torch.Size([2000, 385])
best_index :  1306
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (385, 3)
transformed_src_superpoints.shape :  torch.Size([385, 3])
residual.shape :  torch.Size([385])
batch_inlier_masks.shape :  torch.Size([385])
batch_outlier_masks.shape :  torch.Size([385])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([377])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.01419689  0.0634886   0.05755763]
 [ 0.0090513   0.06356447  0.05694683]
 [ 0.01419689  0.0634886   0.05755763]]
len(transformed_superpoints_pcd) :  1765
copy_superpoint_src_corr_points.shape :  (377, 3)
mask.shape :  (377,)
copy_superpoint_src_corr_points.shape :  (352, 3)
copy_superpoint_ref_corr_points.shape :  (352, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([352, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 352, 3])
batch_inlier_masks.shape :  torch.Size([2000, 352])
best_index :  1137
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (352, 3)
transformed_src_superpoints.shape :  torch.Size([352, 3])
residual.shape :  torch.Size([352])
batch_inlier_masks.shape :  torch.Size([352])
batch_outlier_masks.shape :  torch.Size([352])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([345])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.08562025  0.05333451  0.00869894]
 [ 0.08562025  0.05333451  0.00869894]
 [ 0.08562025  0.05333451  0.00869894]]
len(transformed_superpoints_pcd) :  1772
copy_superpoint_src_corr_points.shape :  (345, 3)
mask.shape :  (345,)
copy_superpoint_src_corr_points.shape :  (332, 3)
copy_superpoint_ref_corr_points.shape :  (332, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([332, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 332, 3])
batch_inlier_masks.shape :  torch.Size([2000, 332])
best_index :  1847
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (332, 3)
transformed_src_superpoints.shape :  torch.Size([332, 3])
residual.shape :  torch.Size([332])
batch_inlier_masks.shape :  torch.Size([332])
batch_outlier_masks.shape :  torch.Size([332])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([325])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.07963029 -0.08276862  0.02862445]
 [-0.0850537  -0.09246308  0.02886495]
 [-0.08486418 -0.08564657  0.02948911]]
len(transformed_superpoints_pcd) :  1779
copy_superpoint_src_corr_points.shape :  (325, 3)
mask.shape :  (325,)
copy_superpoint_src_corr_points.shape :  (323, 3)
copy_superpoint_ref_corr_points.shape :  (323, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([323, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 323, 3])
batch_inlier_masks.shape :  torch.Size([2000, 323])
best_index :  1897
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (323, 3)
transformed_src_superpoints.shape :  torch.Size([323, 3])
residual.shape :  torch.Size([323])
batch_inlier_masks.shape :  torch.Size([323])
batch_outlier_masks.shape :  torch.Size([323])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([316])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02778422  0.06769968  0.05831527]
 [ 0.01882356  0.06962168  0.06196789]
 [ 0.04209438  0.06125104  0.05251939]]
len(transformed_superpoints_pcd) :  1786
copy_superpoint_src_corr_points.shape :  (316, 3)
mask.shape :  (316,)
copy_superpoint_src_corr_points.shape :  (308, 3)
copy_superpoint_ref_corr_points.shape :  (308, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([308, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 308, 3])
batch_inlier_masks.shape :  torch.Size([2000, 308])
best_index :  871
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (308, 3)
transformed_src_superpoints.shape :  torch.Size([308, 3])
residual.shape :  torch.Size([308])
batch_inlier_masks.shape :  torch.Size([308])
batch_outlier_masks.shape :  torch.Size([308])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([302])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.02791959 -0.05072653 -0.04332817]
 [-0.02791959 -0.05072653 -0.04332817]
 [-0.02791959 -0.05072653 -0.04332817]]
len(transformed_superpoints_pcd) :  1792
copy_superpoint_src_corr_points.shape :  (302, 3)
mask.shape :  (302,)
copy_superpoint_src_corr_points.shape :  (260, 3)
copy_superpoint_ref_corr_points.shape :  (260, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([260, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 260, 3])
batch_inlier_masks.shape :  torch.Size([2000, 260])
best_index :  1260
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (260, 3)
transformed_src_superpoints.shape :  torch.Size([260, 3])
residual.shape :  torch.Size([260])
batch_inlier_masks.shape :  torch.Size([260])
batch_outlier_masks.shape :  torch.Size([260])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([254])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09852133  0.06109614  0.00089776]
 [ 0.09475587  0.06391611  0.00557343]
 [ 0.09161064  0.06144296  0.00937239]]
len(transformed_superpoints_pcd) :  1798
copy_superpoint_src_corr_points.shape :  (254, 3)
mask.shape :  (254,)
copy_superpoint_src_corr_points.shape :  (254, 3)
copy_superpoint_ref_corr_points.shape :  (254, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([254, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 254, 3])
batch_inlier_masks.shape :  torch.Size([2000, 254])
best_index :  1387
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (254, 3)
transformed_src_superpoints.shape :  torch.Size([254, 3])
residual.shape :  torch.Size([254])
batch_inlier_masks.shape :  torch.Size([254])
batch_outlier_masks.shape :  torch.Size([254])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([248])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.096636    0.05555797 -0.00461877]
 [ 0.09578389  0.05832062  0.00042065]
 [ 0.09578389  0.05832062  0.00042065]]
len(transformed_superpoints_pcd) :  1804
copy_superpoint_src_corr_points.shape :  (248, 3)
mask.shape :  (248,)
copy_superpoint_src_corr_points.shape :  (247, 3)
copy_superpoint_ref_corr_points.shape :  (247, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([247, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 247, 3])
batch_inlier_masks.shape :  torch.Size([2000, 247])
best_index :  171
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (247, 3)
transformed_src_superpoints.shape :  torch.Size([247, 3])
residual.shape :  torch.Size([247])
batch_inlier_masks.shape :  torch.Size([247])
batch_outlier_masks.shape :  torch.Size([247])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([242])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.03038893 -0.11133271  0.00836899]
 [ 0.03038893 -0.11133271  0.00836899]
 [ 0.03038893 -0.11133271  0.00836899]]
len(transformed_superpoints_pcd) :  1809
copy_superpoint_src_corr_points.shape :  (242, 3)
mask.shape :  (242,)
copy_superpoint_src_corr_points.shape :  (226, 3)
copy_superpoint_ref_corr_points.shape :  (226, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([226, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 226, 3])
batch_inlier_masks.shape :  torch.Size([2000, 226])
best_index :  383
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (226, 3)
transformed_src_superpoints.shape :  torch.Size([226, 3])
residual.shape :  torch.Size([226])
batch_inlier_masks.shape :  torch.Size([226])
batch_outlier_masks.shape :  torch.Size([226])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([221])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.03052504 -0.11661705  0.03019763]
 [ 0.03052504 -0.11661705  0.03019763]
 [ 0.03052504 -0.11661705  0.03019763]]
len(transformed_superpoints_pcd) :  1814
copy_superpoint_src_corr_points.shape :  (221, 3)
mask.shape :  (221,)
copy_superpoint_src_corr_points.shape :  (192, 3)
copy_superpoint_ref_corr_points.shape :  (192, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([192, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 192, 3])
batch_inlier_masks.shape :  torch.Size([2000, 192])
best_index :  1286
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (192, 3)
transformed_src_superpoints.shape :  torch.Size([192, 3])
residual.shape :  torch.Size([192])
batch_inlier_masks.shape :  torch.Size([192])
batch_outlier_masks.shape :  torch.Size([192])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([187])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.00188333  0.01341242  0.02994706]
 [ 0.02590347  0.01206158  0.01832956]
 [ 0.00188333  0.01341242  0.02994706]]
len(transformed_superpoints_pcd) :  1819
copy_superpoint_src_corr_points.shape :  (187, 3)
mask.shape :  (187,)
copy_superpoint_src_corr_points.shape :  (176, 3)
copy_superpoint_ref_corr_points.shape :  (176, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([176, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 176, 3])
batch_inlier_masks.shape :  torch.Size([2000, 176])
best_index :  1487
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (176, 3)
transformed_src_superpoints.shape :  torch.Size([176, 3])
residual.shape :  torch.Size([176])
batch_inlier_masks.shape :  torch.Size([176])
batch_outlier_masks.shape :  torch.Size([176])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([171])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09714023  0.06363066 -0.00375244]
 [ 0.09480707  0.06457937 -0.00846876]
 [ 0.09714023  0.06363066 -0.00375244]]
len(transformed_superpoints_pcd) :  1824
copy_superpoint_src_corr_points.shape :  (171, 3)
mask.shape :  (171,)
copy_superpoint_src_corr_points.shape :  (166, 3)
copy_superpoint_ref_corr_points.shape :  (166, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([166, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 166, 3])
batch_inlier_masks.shape :  torch.Size([2000, 166])
best_index :  1442
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (166, 3)
transformed_src_superpoints.shape :  torch.Size([166, 3])
residual.shape :  torch.Size([166])
batch_inlier_masks.shape :  torch.Size([166])
batch_outlier_masks.shape :  torch.Size([166])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([162])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.01921537 -0.0044     -0.08397649]
 [ 0.01921537 -0.0044     -0.08397649]
 [ 0.01921537 -0.0044     -0.08397649]]
len(transformed_superpoints_pcd) :  1828
copy_superpoint_src_corr_points.shape :  (162, 3)
mask.shape :  (162,)
copy_superpoint_src_corr_points.shape :  (154, 3)
copy_superpoint_ref_corr_points.shape :  (154, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([154, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 154, 3])
batch_inlier_masks.shape :  torch.Size([2000, 154])
best_index :  1461
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (154, 3)
transformed_src_superpoints.shape :  torch.Size([154, 3])
residual.shape :  torch.Size([154])
batch_inlier_masks.shape :  torch.Size([154])
batch_outlier_masks.shape :  torch.Size([154])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([150])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08217214 -0.08425984  0.02609567]
 [-0.08217214 -0.08425984  0.02609567]
 [-0.08217214 -0.08425984  0.02609567]]
len(transformed_superpoints_pcd) :  1832
copy_superpoint_src_corr_points.shape :  (150, 3)
mask.shape :  (150,)
copy_superpoint_src_corr_points.shape :  (148, 3)
copy_superpoint_ref_corr_points.shape :  (148, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([148, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 148, 3])
batch_inlier_masks.shape :  torch.Size([2000, 148])
best_index :  384
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (148, 3)
transformed_src_superpoints.shape :  torch.Size([148, 3])
residual.shape :  torch.Size([148])
batch_inlier_masks.shape :  torch.Size([148])
batch_outlier_masks.shape :  torch.Size([148])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([145])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [-0.08563853 -0.08468692  0.0262698 ]
 [-0.08563853 -0.08468692  0.0262698 ]
 [-0.08563853 -0.08468692  0.0262698 ]]
len(transformed_superpoints_pcd) :  1835
copy_superpoint_src_corr_points.shape :  (145, 3)
mask.shape :  (145,)
copy_superpoint_src_corr_points.shape :  (144, 3)
copy_superpoint_ref_corr_points.shape :  (144, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([144, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 144, 3])
batch_inlier_masks.shape :  torch.Size([2000, 144])
best_index :  440
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (144, 3)
transformed_src_superpoints.shape :  torch.Size([144, 3])
residual.shape :  torch.Size([144])
batch_inlier_masks.shape :  torch.Size([144])
batch_outlier_masks.shape :  torch.Size([144])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([141])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.09124713  0.05266891  0.00282656]
 [ 0.01878771  0.00749801  0.03265188]
 [ 0.03464058  0.00079361  0.0269507 ]]
len(transformed_superpoints_pcd) :  1838
copy_superpoint_src_corr_points.shape :  (141, 3)
mask.shape :  (141,)
copy_superpoint_src_corr_points.shape :  (132, 3)
copy_superpoint_ref_corr_points.shape :  (132, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([132, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 132, 3])
batch_inlier_masks.shape :  torch.Size([2000, 132])
best_index :  444
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (132, 3)
transformed_src_superpoints.shape :  torch.Size([132, 3])
residual.shape :  torch.Size([132])
batch_inlier_masks.shape :  torch.Size([132])
batch_outlier_masks.shape :  torch.Size([132])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([129])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.0167065  -0.0869313   0.02917875]
 [ 0.01989284  0.0345412   0.02647648]
 [ 0.01989284  0.0345412   0.02647648]]
len(transformed_superpoints_pcd) :  1841
copy_superpoint_src_corr_points.shape :  (129, 3)
mask.shape :  (129,)
copy_superpoint_src_corr_points.shape :  (125, 3)
copy_superpoint_ref_corr_points.shape :  (125, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([125, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 125, 3])
batch_inlier_masks.shape :  torch.Size([2000, 125])
best_index :  592
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (125, 3)
transformed_src_superpoints.shape :  torch.Size([125, 3])
residual.shape :  torch.Size([125])
batch_inlier_masks.shape :  torch.Size([125])
batch_outlier_masks.shape :  torch.Size([125])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([122])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[-0.04593253 -0.08256139  0.0741253 ]
 [-0.0526786  -0.07888283  0.0763255 ]
 [-0.05339218 -0.07647459  0.0810395 ]
 ...
 [ 0.02537771  0.00139845 -0.07672649]
 [ 0.02537771  0.00139845 -0.07672649]
 [-0.02981444 -0.05109949 -0.04835451]]
len(transformed_superpoints_pcd) :  1844
copy_superpoint_src_corr_points.shape :  (122, 3)
mask.shape :  (122,)
copy_superpoint_src_corr_points.shape :  (83, 3)
copy_superpoint_ref_corr_points.shape :  (83, 3)
number of unique points in pcd :  774
number of rotations used :  90
transformed_superpoints_pcd.shape :  (1927, 3)
Line set updated
036
src_points :  [[-0.10931003 -0.10141863  0.0673503 ]
 [-0.10935324 -0.09643052  0.0659241 ]
 [-0.10768001 -0.09064054  0.06474888]
 ...
 [-0.02292109  0.14682567 -0.01770549]
 [-0.02003447  0.14883472 -0.02182882]
 [-0.0225388   0.14687747 -0.02576336]]
ref_points :  [[-0.09125754  0.02906448  0.00440016]
 [-0.08924531  0.03626937  0.00376527]
 [-0.08811104  0.04209228  0.00166642]
 ...
 [-0.03232959  0.13594091 -0.0423042 ]
 [-0.11572736  0.04941409 -0.03751559]
 [-0.04300697  0.13807701 -0.05651807]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([7969, 3])
lengths :  tensor([4072, 3897])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([5182, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([1636, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([828, 3])
ref_points_f.shape :  torch.Size([4072, 3])
src_points_c.shape :  torch.Size([808, 3])
src_points_f.shape :  torch.Size([3897, 3])
ref_node_masks.shape :  torch.Size([828])
ref_node_knn_indices.shape :  torch.Size([828, 5])
ref_node_knn_masks.shape :  torch.Size([828, 5])
src_node_masks.shape :  torch.Size([808])
src_node_knn_indices.shape :  torch.Size([808, 5])
src_node_knn_masks.shape :  torch.Size([808, 5])
ref_node_knn_points.shape :  torch.Size([828, 5, 3])
src_node_knn_points.shape :  torch.Size([808, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([1636, 512])
feats_f :  torch.Size([7969, 256])
k :  3
omegas.shape :  torch.Size([685584, 128, 1])
omegas.shape :  torch.Size([2056752, 128, 1])
k :  3
omegas.shape :  torch.Size([652864, 128, 1])
omegas.shape :  torch.Size([1958592, 128, 1])
053
src_points :  [[-0.07946833  0.02892575  0.00252644]
 [-0.07736973  0.03557226  0.00279175]
 [-0.07633814  0.04048339  0.00129564]
 ...
 [-0.04437811  0.03945482  0.00084974]
 [-0.07998187  0.04971722 -0.00537066]
 [-0.04078033  0.09662018 -0.02711728]]
ref_points :  [[-0.07498657  0.01310941  0.0408493 ]
 [-0.07341053  0.02056967  0.04006272]
 [-0.07257404  0.02726517  0.03722647]
 ...
 [-0.0066904   0.1204854  -0.01018859]
 [-0.05850039  0.11168049 -0.01147643]
 [-0.05130646  0.07567883 -0.01944721]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([5901, 3])
lengths :  tensor([2906, 2995])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([3648, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([1132, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([569, 3])
ref_points_f.shape :  torch.Size([2906, 3])
src_points_c.shape :  torch.Size([563, 3])
src_points_f.shape :  torch.Size([2995, 3])
ref_node_masks.shape :  torch.Size([569])
ref_node_knn_indices.shape :  torch.Size([569, 5])
ref_node_knn_masks.shape :  torch.Size([569, 5])
src_node_masks.shape :  torch.Size([563])
src_node_knn_indices.shape :  torch.Size([563, 5])
src_node_knn_masks.shape :  torch.Size([563, 5])
ref_node_knn_points.shape :  torch.Size([569, 5, 3])
src_node_knn_points.shape :  torch.Size([563, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([1132, 512])
feats_f :  torch.Size([5901, 256])
k :  3
omegas.shape :  torch.Size([323761, 128, 1])
omegas.shape :  torch.Size([971283, 128, 1])
k :  3
omegas.shape :  torch.Size([316969, 128, 1])
omegas.shape :  torch.Size([950907, 128, 1])
ref_feats_c.shape :  torch.Size([1, 569, 256])
src_feats_c.shape :  torch.Size([1, 563, 256])
ref_feats_c_norm.shape :  torch.Size([569, 256])
src_feats_c_norm.shape :  torch.Size([563, 256])
ref_node_masks.shape :  torch.Size([569])
src_node_masks.shape :  torch.Size([563])
self.num_correspondences :  2000
matching_scores.numel() :  320347
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([20793])
ref_indices.shape :  torch.Size([20793])
src_indices.shape :  torch.Size([20793])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 1,  ..., 2, 2, 2], device='cuda:0')
src_indices :  tensor([0, 2, 1,  ..., 1, 2, 3], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([20793, 3])
global_src_corr_points.shape :  torch.Size([20793, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([1984, 4, 4])
src_corr_points.shape :  torch.Size([20793, 3])
ref_corr_points.shape :  torch.Size([1, 20793, 3])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 20793, 3])
batch_corr_residuals.shape :  torch.Size([1984, 20793])
batch_inlier_masks.shape :  torch.Size([1984, 20793])
best_index :  tensor(1531, device='cuda:0')
len(batch_transforms) :  1984
estimated_transform :  [[ 9.1195291e-01  1.0127272e-01  3.9760023e-01  6.2560104e-04]
 [-1.6492601e-01  9.7780389e-01  1.2922482e-01 -1.6265906e-02]
 [-3.7568799e-01 -1.8342160e-01  9.0841353e-01 -6.9753360e-03]
 [ 0.0000000e+00  0.0000000e+00  0.0000000e+00  1.0000000e+00]]
sorted_indices :  [1410 1758 1969 ...  155  807 1531]
superpoint_src_corr_points.shape :  (20793, 3)
superpoint_ref_corr_points.shape :  (20793, 3)
batch_inlier_masks.shape :  (1984, 20793)
batch_transforms.shape :  (1984, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([20793, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 20793, 3])
batch_inlier_masks.shape :  torch.Size([1984, 20793])
best_index :  194
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (20793, 3)
transformed_src_superpoints.shape :  torch.Size([20793, 3])
residual.shape :  torch.Size([20793])
batch_inlier_masks.shape :  torch.Size([20793])
batch_outlier_masks.shape :  torch.Size([20793])
indices_inliers.shape :  torch.Size([118])
indices_outliers.shape :  torch.Size([20675])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([118, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06833489 -0.11567745 -0.00042291]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06592397 -0.12088777  0.02473416]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06592397 -0.12088777  0.02473416]
 [-0.06417379 -0.11606683  0.0346479 ]
 [-0.0699057  -0.1158542   0.03018196]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.0790759  -0.09656557  0.02963352]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07152653 -0.09620609  0.03713341]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.07152653 -0.09620609  0.03713341]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.04899416 -0.08020055  0.03853204]
 [-0.05399381 -0.08237151  0.03909604]
 [-0.0821117  -0.09674717  0.02543128]
 [-0.0790759  -0.09656557  0.02963352]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.0699057  -0.1158542   0.03018196]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08810718 -0.00485876  0.01964846]
 [-0.09092937 -0.01408361  0.01669772]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.06280163 -0.11181206  0.0383669 ]
 [-0.06054435 -0.107382    0.04110994]
 [-0.05690588 -0.11137868  0.04022724]
 [-0.06280163 -0.11181206  0.0383669 ]
 [-0.06054435 -0.107382    0.04110994]
 [-0.06500492 -0.10400265  0.0398561 ]
 [-0.05690588 -0.11137868  0.04022724]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.08460586 -0.00100076  0.02159666]
 [-0.07879889 -0.00418393  0.02476569]
 [-0.08460586 -0.00100076  0.02159666]
 [-0.02603568 -0.06250338  0.03158408]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02603568 -0.06250338  0.03158408]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02569026 -0.06737337  0.03318068]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.07345808 -0.11710456  0.012098  ]
 [-0.09339125 -0.00156056  0.01807294]
 [-0.09339125 -0.00156056  0.01807294]
 [-0.06054435 -0.107382    0.04110994]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.06500492 -0.10400265  0.0398561 ]
 [-0.03869915 -0.07535592  0.03870315]
 [-0.06240234 -0.09112391  0.04069177]
 [-0.06075399 -0.08513862  0.03989611]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.06240234 -0.09112391  0.04069177]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.07242075 -0.11497803  0.00310452]
 [-0.06833489 -0.11567745 -0.00042291]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.08810718 -0.00485876  0.01964846]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.09092937 -0.01408361  0.01669772]
 [-0.06718346 -0.09352066  0.03966892]
 [-0.03985717 -0.096798    0.03986947]
 [-0.04370685 -0.08960506  0.0394532 ]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.04748057 -0.09084944 -0.02578846]
 [-0.05300837 -0.09231745 -0.02362812]
 [-0.04748057 -0.09084944 -0.02578846]
 [-0.07802077 -0.01186377  0.02430221]
 [-0.07879889 -0.00418393  0.02476569]
 [-0.0369991  -0.06849961  0.03682904]
 [ 0.0513169  -0.00178068  0.02094554]
 [-0.03856057 -0.09106233 -0.02595406]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.0429946  -0.09321146 -0.02467034]
 [-0.03734323 -0.08228125 -0.03024251]
 [-0.0429946  -0.09321146 -0.02467034]
 [-0.03856057 -0.09106233 -0.02595406]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.03734323 -0.08228125 -0.03024251]
 [ 0.0513169  -0.00178068  0.02094554]]
len(transformed_superpoints_pcd) :  118
copy_superpoint_src_corr_points.shape :  (20675, 3)
mask.shape :  (20675,)
copy_superpoint_src_corr_points.shape :  (16037, 3)
copy_superpoint_ref_corr_points.shape :  (16037, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([16037, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 16037, 3])
batch_inlier_masks.shape :  torch.Size([1984, 16037])
best_index :  87
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (16037, 3)
transformed_src_superpoints.shape :  torch.Size([16037, 3])
residual.shape :  torch.Size([16037])
batch_inlier_masks.shape :  torch.Size([16037])
batch_outlier_masks.shape :  torch.Size([16037])
indices_inliers.shape :  torch.Size([94])
indices_outliers.shape :  torch.Size([15943])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([94, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06833489 -0.11567745 -0.00042291]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06592397 -0.12088777  0.02473416]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06592397 -0.12088777  0.02473416]
 [-0.06417379 -0.11606683  0.0346479 ]
 [-0.0699057  -0.1158542   0.03018196]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.0790759  -0.09656557  0.02963352]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07152653 -0.09620609  0.03713341]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.07152653 -0.09620609  0.03713341]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.04899416 -0.08020055  0.03853204]
 [-0.05399381 -0.08237151  0.03909604]
 [-0.0821117  -0.09674717  0.02543128]
 [-0.0790759  -0.09656557  0.02963352]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.0699057  -0.1158542   0.03018196]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08810718 -0.00485876  0.01964846]
 [-0.09092937 -0.01408361  0.01669772]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.06280163 -0.11181206  0.0383669 ]
 [-0.06054435 -0.107382    0.04110994]
 [-0.05690588 -0.11137868  0.04022724]
 [-0.06280163 -0.11181206  0.0383669 ]
 [-0.06054435 -0.107382    0.04110994]
 [-0.06500492 -0.10400265  0.0398561 ]
 [-0.05690588 -0.11137868  0.04022724]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.08460586 -0.00100076  0.02159666]
 [-0.07879889 -0.00418393  0.02476569]
 [-0.08460586 -0.00100076  0.02159666]
 [-0.02603568 -0.06250338  0.03158408]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02603568 -0.06250338  0.03158408]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02569026 -0.06737337  0.03318068]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.07345808 -0.11710456  0.012098  ]
 [-0.09339125 -0.00156056  0.01807294]
 [-0.09339125 -0.00156056  0.01807294]
 [-0.06054435 -0.107382    0.04110994]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.06500492 -0.10400265  0.0398561 ]
 [-0.03869915 -0.07535592  0.03870315]
 [-0.06240234 -0.09112391  0.04069177]
 [-0.06075399 -0.08513862  0.03989611]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.06240234 -0.09112391  0.04069177]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.07242075 -0.11497803  0.00310452]
 [-0.06833489 -0.11567745 -0.00042291]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.08810718 -0.00485876  0.01964846]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.09092937 -0.01408361  0.01669772]
 [-0.06718346 -0.09352066  0.03966892]
 [-0.03985717 -0.096798    0.03986947]
 [-0.04370685 -0.08960506  0.0394532 ]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.04748057 -0.09084944 -0.02578846]
 [-0.05300837 -0.09231745 -0.02362812]
 [-0.04748057 -0.09084944 -0.02578846]
 [-0.07802077 -0.01186377  0.02430221]
 [-0.07879889 -0.00418393  0.02476569]
 [-0.0369991  -0.06849961  0.03682904]
 [ 0.0513169  -0.00178068  0.02094554]
 [-0.03856057 -0.09106233 -0.02595406]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.0429946  -0.09321146 -0.02467034]
 [-0.03734323 -0.08228125 -0.03024251]
 [-0.0429946  -0.09321146 -0.02467034]
 [-0.03856057 -0.09106233 -0.02595406]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.03734323 -0.08228125 -0.03024251]
 [ 0.0513169  -0.00178068  0.02094554]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.03445441 -0.09515715  0.04341274]
 [-0.03445441 -0.09515715  0.04341274]
 [-0.03512543 -0.1005123   0.04265269]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.04752697 -0.10313232  0.04483299]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.04752697 -0.10313232  0.04483299]
 [-0.04752697 -0.10313232  0.04483299]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.05475489 -0.1141732   0.04129597]
 [-0.04186992 -0.11628126  0.0403921 ]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.04687455 -0.11598556  0.04113207]
 [-0.04186992 -0.11628126  0.0403921 ]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04186992 -0.11628126  0.0403921 ]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.04752697 -0.10313232  0.04483299]
 [ 0.0651999  -0.07674025 -0.02288003]
 [ 0.0636595  -0.08153284 -0.02211477]
 [ 0.0678765  -0.08015562 -0.01980125]
 [ 0.0457947  -0.08170098 -0.02477146]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03082281 -0.05620587  0.03879607]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03082281 -0.05620587  0.03879607]
 [-0.03674883 -0.04657167  0.03892969]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.00113188 -0.06046181  0.02560505]
 [-0.08210208 -0.01785732  0.02989813]
 [ 0.06739828 -0.07302017  0.02351056]
 [ 0.06253908 -0.07089671  0.02639128]
 [-0.05721556 -0.07876109  0.04546644]
 [-0.05437481 -0.08324935  0.04585217]
 [-0.05437481 -0.08324935  0.04585217]
 [-0.05095913 -0.07936163  0.04565097]
 [-0.05437481 -0.08324935  0.04585217]
 [-0.06272665 -0.11604865  0.03965978]
 [-0.0591404  -0.10812204  0.04225343]
 [-0.06463857 -0.11138154  0.03969054]
 [-0.06820378 -0.11527659  0.03805828]
 [-0.0591404  -0.10812204  0.04225343]
 [-0.0579986  -0.11786071  0.04026017]
 [-0.0579986  -0.11786071  0.04026017]
 [-0.06272665 -0.11604865  0.03965978]
 [-0.0579986  -0.11786071  0.04026017]
 [-0.06820378 -0.11527659  0.03805828]
 [-0.06563063 -0.06324881  0.04177867]
 [-0.06280839 -0.0579684   0.0419041 ]
 [-0.05737175 -0.06272727  0.04366172]
 [-0.08210208 -0.01785732  0.02989813]
 [-0.06463857 -0.11138154  0.03969054]
 [-0.02620633 -0.09685355  0.03860598]
 [ 0.05635486 -0.07812341  0.03152847]
 [ 0.05601902 -0.08335467  0.03159654]
 [ 0.05635486 -0.07812341  0.03152847]
 [ 0.06119569 -0.08513276  0.02840579]
 [-0.02620633 -0.09685355  0.03860598]
 [-0.02914065 -0.10222477  0.03945008]
 [-0.05475489 -0.1141732   0.04129597]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.05073034 -0.10802357  0.04329029]
 [ 0.02339055 -0.06029242  0.03119542]
 [ 0.02346611 -0.06618635  0.03331502]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03674883 -0.04657167  0.03892969]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03674883 -0.04657167  0.03892969]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.04373252 -0.05138347  0.0419008 ]
 [-0.03981227 -0.05476632  0.04163623]
 [-0.04373252 -0.05138347  0.0419008 ]
 [-0.03981227 -0.05476632  0.04163623]
 [-0.04995076 -0.05169655  0.04257809]
 [-0.04373252 -0.05138347  0.0419008 ]
 [-0.04673611 -0.09422471 -0.0204088 ]
 [-0.0495768  -0.09006192 -0.02085931]]
len(transformed_superpoints_pcd) :  212
copy_superpoint_src_corr_points.shape :  (15943, 3)
mask.shape :  (15943,)
copy_superpoint_src_corr_points.shape :  (12134, 3)
copy_superpoint_ref_corr_points.shape :  (12134, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12134, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 12134, 3])
batch_inlier_masks.shape :  torch.Size([1984, 12134])
best_index :  1303
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12134, 3)
transformed_src_superpoints.shape :  torch.Size([12134, 3])
residual.shape :  torch.Size([12134])
batch_inlier_masks.shape :  torch.Size([12134])
batch_outlier_masks.shape :  torch.Size([12134])
indices_inliers.shape :  torch.Size([78])
indices_outliers.shape :  torch.Size([12056])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([78, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.06833489 -0.11567745 -0.00042291]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06592397 -0.12088777  0.02473416]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06592397 -0.12088777  0.02473416]
 [-0.06417379 -0.11606683  0.0346479 ]
 [-0.0699057  -0.1158542   0.03018196]
 [-0.06561673 -0.11878563  0.03017685]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.0790759  -0.09656557  0.02963352]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07152653 -0.09620609  0.03713341]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.07152653 -0.09620609  0.03713341]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.04899416 -0.08020055  0.03853204]
 [-0.05399381 -0.08237151  0.03909604]
 [-0.0821117  -0.09674717  0.02543128]
 [-0.0790759  -0.09656557  0.02963352]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07590637 -0.10581794  0.0314923 ]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07483968 -0.09862433  0.03418946]
 [-0.06940602 -0.10119758  0.03806391]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.07136713 -0.10638585  0.03555647]
 [-0.0699057  -0.1158542   0.03018196]
 [-0.06876345 -0.11265171  0.03395541]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08810718 -0.00485876  0.01964846]
 [-0.09092937 -0.01408361  0.01669772]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.08800581 -0.01071305  0.01920698]
 [-0.08325523 -0.007717    0.0219616 ]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.06280163 -0.11181206  0.0383669 ]
 [-0.06054435 -0.107382    0.04110994]
 [-0.05690588 -0.11137868  0.04022724]
 [-0.06280163 -0.11181206  0.0383669 ]
 [-0.06054435 -0.107382    0.04110994]
 [-0.06500492 -0.10400265  0.0398561 ]
 [-0.05690588 -0.11137868  0.04022724]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.08460586 -0.00100076  0.02159666]
 [-0.07879889 -0.00418393  0.02476569]
 [-0.08460586 -0.00100076  0.02159666]
 [-0.02603568 -0.06250338  0.03158408]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02603568 -0.06250338  0.03158408]
 [-0.02623948 -0.05733433  0.02958925]
 [-0.02569026 -0.06737337  0.03318068]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.06915393 -0.11981342  0.0130454 ]
 [-0.07053646 -0.11808361  0.0077722 ]
 [-0.07345808 -0.11710456  0.012098  ]
 [-0.09339125 -0.00156056  0.01807294]
 [-0.09339125 -0.00156056  0.01807294]
 [-0.06054435 -0.107382    0.04110994]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.06500492 -0.10400265  0.0398561 ]
 [-0.03869915 -0.07535592  0.03870315]
 [-0.06240234 -0.09112391  0.04069177]
 [-0.06075399 -0.08513862  0.03989611]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.06240234 -0.09112391  0.04069177]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.0570054  -0.08886484  0.04050365]
 [-0.07242075 -0.11497803  0.00310452]
 [-0.06833489 -0.11567745 -0.00042291]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.08810718 -0.00485876  0.01964846]
 [-0.09386259 -0.00760589  0.01741582]
 [-0.09092937 -0.01408361  0.01669772]
 [-0.06718346 -0.09352066  0.03966892]
 [-0.03985717 -0.096798    0.03986947]
 [-0.04370685 -0.08960506  0.0394532 ]
 [-0.0671315  -0.1088134   0.03721201]
 [-0.04748057 -0.09084944 -0.02578846]
 [-0.05300837 -0.09231745 -0.02362812]
 [-0.04748057 -0.09084944 -0.02578846]
 [-0.07802077 -0.01186377  0.02430221]
 [-0.07879889 -0.00418393  0.02476569]
 [-0.0369991  -0.06849961  0.03682904]
 [ 0.0513169  -0.00178068  0.02094554]
 [-0.03856057 -0.09106233 -0.02595406]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.0429946  -0.09321146 -0.02467034]
 [-0.03734323 -0.08228125 -0.03024251]
 [-0.0429946  -0.09321146 -0.02467034]
 [-0.03856057 -0.09106233 -0.02595406]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.03523249 -0.08749828 -0.02760726]
 [-0.04351515 -0.08692944 -0.02800204]
 [-0.03734323 -0.08228125 -0.03024251]
 [ 0.0513169  -0.00178068  0.02094554]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.03445441 -0.09515715  0.04341274]
 [-0.03445441 -0.09515715  0.04341274]
 [-0.03512543 -0.1005123   0.04265269]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.04752697 -0.10313232  0.04483299]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.04752697 -0.10313232  0.04483299]
 [-0.04752697 -0.10313232  0.04483299]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.05475489 -0.1141732   0.04129597]
 [-0.04186992 -0.11628126  0.0403921 ]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.04687455 -0.11598556  0.04113207]
 [-0.04186992 -0.11628126  0.0403921 ]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04186992 -0.11628126  0.0403921 ]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.03959184 -0.10724818  0.04279142]
 [-0.04752697 -0.10313232  0.04483299]
 [ 0.0651999  -0.07674025 -0.02288003]
 [ 0.0636595  -0.08153284 -0.02211477]
 [ 0.0678765  -0.08015562 -0.01980125]
 [ 0.0457947  -0.08170098 -0.02477146]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03082281 -0.05620587  0.03879607]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03082281 -0.05620587  0.03879607]
 [-0.03674883 -0.04657167  0.03892969]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.00113188 -0.06046181  0.02560505]
 [-0.08210208 -0.01785732  0.02989813]
 [ 0.06739828 -0.07302017  0.02351056]
 [ 0.06253908 -0.07089671  0.02639128]
 [-0.05721556 -0.07876109  0.04546644]
 [-0.05437481 -0.08324935  0.04585217]
 [-0.05437481 -0.08324935  0.04585217]
 [-0.05095913 -0.07936163  0.04565097]
 [-0.05437481 -0.08324935  0.04585217]
 [-0.06272665 -0.11604865  0.03965978]
 [-0.0591404  -0.10812204  0.04225343]
 [-0.06463857 -0.11138154  0.03969054]
 [-0.06820378 -0.11527659  0.03805828]
 [-0.0591404  -0.10812204  0.04225343]
 [-0.0579986  -0.11786071  0.04026017]
 [-0.0579986  -0.11786071  0.04026017]
 [-0.06272665 -0.11604865  0.03965978]
 [-0.0579986  -0.11786071  0.04026017]
 [-0.06820378 -0.11527659  0.03805828]
 [-0.06563063 -0.06324881  0.04177867]
 [-0.06280839 -0.0579684   0.0419041 ]
 [-0.05737175 -0.06272727  0.04366172]
 [-0.08210208 -0.01785732  0.02989813]
 [-0.06463857 -0.11138154  0.03969054]
 [-0.02620633 -0.09685355  0.03860598]
 [ 0.05635486 -0.07812341  0.03152847]
 [ 0.05601902 -0.08335467  0.03159654]
 [ 0.05635486 -0.07812341  0.03152847]
 [ 0.06119569 -0.08513276  0.02840579]
 [-0.02620633 -0.09685355  0.03860598]
 [-0.02914065 -0.10222477  0.03945008]
 [-0.05475489 -0.1141732   0.04129597]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.04408442 -0.11066458  0.04225046]
 [-0.05073034 -0.10802357  0.04329029]
 [-0.05073034 -0.10802357  0.04329029]
 [ 0.02339055 -0.06029242  0.03119542]
 [ 0.02346611 -0.06618635  0.03331502]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03503688 -0.05170385  0.03951481]
 [-0.03674883 -0.04657167  0.03892969]
 [-0.03023607 -0.04988762  0.03697582]
 [-0.03674883 -0.04657167  0.03892969]
 [-0.03216145 -0.04369154  0.0368689 ]
 [-0.04373252 -0.05138347  0.0419008 ]
 [-0.03981227 -0.05476632  0.04163623]
 [-0.04373252 -0.05138347  0.0419008 ]
 [-0.03981227 -0.05476632  0.04163623]
 [-0.04995076 -0.05169655  0.04257809]
 [-0.04373252 -0.05138347  0.0419008 ]
 [-0.04673611 -0.09422471 -0.0204088 ]
 [-0.0495768  -0.09006192 -0.02085931]
 [-0.05214835 -0.10857143  0.05099573]
 [ 0.0625954  -0.04229373 -0.02179855]
 [ 0.06347129 -0.12358314  0.00299197]
 [ 0.04900198 -0.05384836 -0.02804833]
 [ 0.05341119 -0.04981279 -0.02625517]
 [ 0.04569968 -0.04945075 -0.02933503]
 [ 0.05341119 -0.04981279 -0.02625517]
 [ 0.04900198 -0.05384836 -0.02804833]
 [ 0.04569968 -0.04945075 -0.02933503]
 [ 0.04889913 -0.05998092 -0.02886658]
 [ 0.05341119 -0.04981279 -0.02625517]
 [ 0.06183624 -0.05901614 -0.01954023]
 [ 0.06405713 -0.049516   -0.01964599]
 [ 0.06147658 -0.05362706 -0.02096703]
 [ 0.058858   -0.04815243 -0.02371878]
 [ 0.05829167 -0.06214993 -0.02293796]
 [ 0.06183624 -0.05901614 -0.01954023]
 [ 0.0575092  -0.05484411 -0.02383644]
 [ 0.0575092  -0.05484411 -0.02383644]
 [ 0.04912012 -0.06705457 -0.02868878]
 [ 0.05474915 -0.06529067 -0.0262397 ]
 [ 0.0547024  -0.07076219 -0.02545423]
 [ 0.04912012 -0.06705457 -0.02868878]
 [ 0.0547024  -0.07076219 -0.02545423]
 [ 0.058858   -0.04815243 -0.02371878]
 [ 0.06147658 -0.05362706 -0.02096703]
 [ 0.058858   -0.04815243 -0.02371878]
 [ 0.058858   -0.04815243 -0.02371878]
 [ 0.06405713 -0.049516   -0.01964599]
 [ 0.06147658 -0.05362706 -0.02096703]
 [ 0.04912012 -0.06705457 -0.02868878]
 [ 0.04912012 -0.06705457 -0.02868878]
 [ 0.04374713 -0.06203581 -0.03068047]
 [ 0.05400667 -0.07680742 -0.02483113]
 [ 0.04898087 -0.07252572 -0.02796805]
 [ 0.04837264 -0.08371241 -0.02717396]
 [ 0.05281482 -0.08252133 -0.02429194]
 [ 0.05400667 -0.07680742 -0.02483113]
 [ 0.05400667 -0.07680742 -0.02483113]
 [ 0.04374713 -0.06203581 -0.03068047]
 [ 0.04367409 -0.06705914 -0.03015641]
 [ 0.04367409 -0.06705914 -0.03015641]
 [ 0.04374713 -0.06203581 -0.03068047]
 [ 0.04367409 -0.06705914 -0.03015641]
 [ 0.06821256 -0.1180954   0.0090811 ]
 [ 0.06626207 -0.11183847  0.00666643]
 [ 0.06476494 -0.11528429  0.0029003 ]
 [ 0.06821256 -0.1180954   0.0090811 ]
 [ 0.06626207 -0.11183847  0.00666643]
 [ 0.06476494 -0.11528429  0.0029003 ]
 [ 0.04912012 -0.06705457 -0.02868878]
 [ 0.06228709 -0.03652544 -0.02149175]
 [ 0.06616651 -0.03943915 -0.01814526]
 [ 0.06661542 -0.03433014 -0.01610054]
 [ 0.06228709 -0.03652544 -0.02149175]
 [ 0.06661542 -0.03433014 -0.01610054]
 [ 0.06228709 -0.03652544 -0.02149175]
 [ 0.06616651 -0.03943915 -0.01814526]
 [ 0.06661542 -0.03433014 -0.01610054]
 [ 0.06616651 -0.03943915 -0.01814526]
 [ 0.0625954  -0.04229373 -0.02179855]
 [ 0.05905462 -0.03951391 -0.02455069]
 [ 0.058858   -0.04815243 -0.02371878]
 [ 0.04860566 -0.07786463 -0.02775995]
 [ 0.04837264 -0.08371241 -0.02717396]
 [ 0.04292394 -0.07219948 -0.030017  ]
 [ 0.03888258 -0.05887179 -0.03342519]
 [ 0.04374713 -0.06203581 -0.03068047]
 [ 0.03788161 -0.06858854 -0.03292906]
 [ 0.04367409 -0.06705914 -0.03015641]
 [ 0.04374713 -0.06203581 -0.03068047]
 [ 0.03788161 -0.06858854 -0.03292906]
 [ 0.03888258 -0.05887179 -0.03342519]
 [ 0.04900198 -0.05384836 -0.02804833]
 [ 0.04569968 -0.04945075 -0.02933503]
 [ 0.0436971  -0.05543743 -0.03058004]
 [ 0.04900198 -0.05384836 -0.02804833]
 [ 0.0436971  -0.05543743 -0.03058004]]
len(transformed_superpoints_pcd) :  290
copy_superpoint_src_corr_points.shape :  (12056, 3)
mask.shape :  (12056,)
copy_superpoint_src_corr_points.shape :  (10079, 3)
copy_superpoint_ref_corr_points.shape :  (10079, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10079, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 10079, 3])
batch_inlier_masks.shape :  torch.Size([1984, 10079])
best_index :  1665
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10079, 3)
transformed_src_superpoints.shape :  torch.Size([10079, 3])
residual.shape :  torch.Size([10079])
batch_inlier_masks.shape :  torch.Size([10079])
batch_outlier_masks.shape :  torch.Size([10079])
indices_inliers.shape :  torch.Size([51])
indices_outliers.shape :  torch.Size([10028])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([51, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.02791955 -0.07943697  0.02750219]
 [ 0.02452125 -0.08469125  0.02441768]
 [ 0.03369861 -0.07891124  0.02932848]]
len(transformed_superpoints_pcd) :  341
copy_superpoint_src_corr_points.shape :  (10028, 3)
mask.shape :  (10028,)
copy_superpoint_src_corr_points.shape :  (8066, 3)
copy_superpoint_ref_corr_points.shape :  (8066, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8066, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 8066, 3])
batch_inlier_masks.shape :  torch.Size([1984, 8066])
best_index :  1
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8066, 3)
transformed_src_superpoints.shape :  torch.Size([8066, 3])
residual.shape :  torch.Size([8066])
batch_inlier_masks.shape :  torch.Size([8066])
batch_outlier_masks.shape :  torch.Size([8066])
indices_inliers.shape :  torch.Size([47])
indices_outliers.shape :  torch.Size([8019])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([47, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.04111796 -0.05635086  0.03175749]
 [-0.03771409 -0.06671711  0.03560322]
 [-0.04111796 -0.05635086  0.03175749]]
len(transformed_superpoints_pcd) :  388
copy_superpoint_src_corr_points.shape :  (8019, 3)
mask.shape :  (8019,)
copy_superpoint_src_corr_points.shape :  (6820, 3)
copy_superpoint_ref_corr_points.shape :  (6820, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6820, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 6820, 3])
batch_inlier_masks.shape :  torch.Size([1984, 6820])
best_index :  1438
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6820, 3)
transformed_src_superpoints.shape :  torch.Size([6820, 3])
residual.shape :  torch.Size([6820])
batch_inlier_masks.shape :  torch.Size([6820])
batch_outlier_masks.shape :  torch.Size([6820])
indices_inliers.shape :  torch.Size([43])
indices_outliers.shape :  torch.Size([6777])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([43, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.00095225  0.01564191  0.03693075]
 [-0.00263785  0.01832814  0.03312496]
 [-0.00532476  0.0158742   0.03803968]]
len(transformed_superpoints_pcd) :  431
copy_superpoint_src_corr_points.shape :  (6777, 3)
mask.shape :  (6777,)
copy_superpoint_src_corr_points.shape :  (6129, 3)
copy_superpoint_ref_corr_points.shape :  (6129, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6129, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 6129, 3])
batch_inlier_masks.shape :  torch.Size([1984, 6129])
best_index :  804
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6129, 3)
transformed_src_superpoints.shape :  torch.Size([6129, 3])
residual.shape :  torch.Size([6129])
batch_inlier_masks.shape :  torch.Size([6129])
batch_outlier_masks.shape :  torch.Size([6129])
indices_inliers.shape :  torch.Size([36])
indices_outliers.shape :  torch.Size([6093])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([36, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.05113223 -0.1081159  -0.03190719]
 [ 0.05841202 -0.10588732 -0.0333051 ]
 [ 0.05841202 -0.10588732 -0.0333051 ]]
len(transformed_superpoints_pcd) :  467
copy_superpoint_src_corr_points.shape :  (6093, 3)
mask.shape :  (6093,)
copy_superpoint_src_corr_points.shape :  (5077, 3)
copy_superpoint_ref_corr_points.shape :  (5077, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5077, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 5077, 3])
batch_inlier_masks.shape :  torch.Size([1984, 5077])
best_index :  1422
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5077, 3)
transformed_src_superpoints.shape :  torch.Size([5077, 3])
residual.shape :  torch.Size([5077])
batch_inlier_masks.shape :  torch.Size([5077])
batch_outlier_masks.shape :  torch.Size([5077])
indices_inliers.shape :  torch.Size([34])
indices_outliers.shape :  torch.Size([5043])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([34, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.0477334  -0.09884193 -0.0116681 ]
 [-0.04146558 -0.09888747 -0.0130276 ]
 [-0.04274673 -0.10365964 -0.00978138]]
len(transformed_superpoints_pcd) :  501
copy_superpoint_src_corr_points.shape :  (5043, 3)
mask.shape :  (5043,)
copy_superpoint_src_corr_points.shape :  (4340, 3)
copy_superpoint_ref_corr_points.shape :  (4340, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4340, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 4340, 3])
batch_inlier_masks.shape :  torch.Size([1984, 4340])
best_index :  1192
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4340, 3)
transformed_src_superpoints.shape :  torch.Size([4340, 3])
residual.shape :  torch.Size([4340])
batch_inlier_masks.shape :  torch.Size([4340])
batch_outlier_masks.shape :  torch.Size([4340])
indices_inliers.shape :  torch.Size([32])
indices_outliers.shape :  torch.Size([4308])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([32, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.06141168 -0.01126327  0.01495367]
 [ 0.05588678 -0.00951919  0.01730749]
 [ 0.06141168 -0.01126327  0.01495367]]
len(transformed_superpoints_pcd) :  533
copy_superpoint_src_corr_points.shape :  (4308, 3)
mask.shape :  (4308,)
copy_superpoint_src_corr_points.shape :  (3452, 3)
copy_superpoint_ref_corr_points.shape :  (3452, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3452, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 3452, 3])
batch_inlier_masks.shape :  torch.Size([1984, 3452])
best_index :  1841
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3452, 3)
transformed_src_superpoints.shape :  torch.Size([3452, 3])
residual.shape :  torch.Size([3452])
batch_inlier_masks.shape :  torch.Size([3452])
batch_outlier_masks.shape :  torch.Size([3452])
indices_inliers.shape :  torch.Size([25])
indices_outliers.shape :  torch.Size([3427])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([25, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.0558454  -0.07227544 -0.03125156]
 [ 0.0520773  -0.07887135 -0.03128409]
 [ 0.0601654  -0.0766215  -0.03140557]]
len(transformed_superpoints_pcd) :  558
copy_superpoint_src_corr_points.shape :  (3427, 3)
mask.shape :  (3427,)
copy_superpoint_src_corr_points.shape :  (3029, 3)
copy_superpoint_ref_corr_points.shape :  (3029, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3029, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 3029, 3])
batch_inlier_masks.shape :  torch.Size([1984, 3029])
best_index :  1389
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3029, 3)
transformed_src_superpoints.shape :  torch.Size([3029, 3])
residual.shape :  torch.Size([3029])
batch_inlier_masks.shape :  torch.Size([3029])
batch_outlier_masks.shape :  torch.Size([3029])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([3007])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.04419031  0.0544874  -0.03511338]
 [ 0.04419031  0.0544874  -0.03511338]
 [ 0.04632017  0.05251082 -0.03946107]]
len(transformed_superpoints_pcd) :  580
copy_superpoint_src_corr_points.shape :  (3007, 3)
mask.shape :  (3007,)
copy_superpoint_src_corr_points.shape :  (2887, 3)
copy_superpoint_ref_corr_points.shape :  (2887, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2887, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 2887, 3])
batch_inlier_masks.shape :  torch.Size([1984, 2887])
best_index :  1594
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2887, 3)
transformed_src_superpoints.shape :  torch.Size([2887, 3])
residual.shape :  torch.Size([2887])
batch_inlier_masks.shape :  torch.Size([2887])
batch_outlier_masks.shape :  torch.Size([2887])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2866])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.02934513 -0.05299783  0.02834193]
 [-0.02444881 -0.05148305  0.03157332]
 [-0.02934513 -0.05299783  0.02834193]]
len(transformed_superpoints_pcd) :  601
copy_superpoint_src_corr_points.shape :  (2866, 3)
mask.shape :  (2866,)
copy_superpoint_src_corr_points.shape :  (2529, 3)
copy_superpoint_ref_corr_points.shape :  (2529, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2529, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 2529, 3])
batch_inlier_masks.shape :  torch.Size([1984, 2529])
best_index :  1808
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2529, 3)
transformed_src_superpoints.shape :  torch.Size([2529, 3])
residual.shape :  torch.Size([2529])
batch_inlier_masks.shape :  torch.Size([2529])
batch_outlier_masks.shape :  torch.Size([2529])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2508])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.03680261 -0.03874107  0.0351145 ]
 [-0.03709624 -0.04423419  0.03399448]
 [-0.03166708 -0.03647946  0.03148519]]
len(transformed_superpoints_pcd) :  622
copy_superpoint_src_corr_points.shape :  (2508, 3)
mask.shape :  (2508,)
copy_superpoint_src_corr_points.shape :  (2322, 3)
copy_superpoint_ref_corr_points.shape :  (2322, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2322, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 2322, 3])
batch_inlier_masks.shape :  torch.Size([1984, 2322])
best_index :  399
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2322, 3)
transformed_src_superpoints.shape :  torch.Size([2322, 3])
residual.shape :  torch.Size([2322])
batch_inlier_masks.shape :  torch.Size([2322])
batch_outlier_masks.shape :  torch.Size([2322])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([2303])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.0254618  -0.05533785  0.03513862]
 [-0.03118105 -0.04998071  0.0356988 ]
 [-0.03118105 -0.04998071  0.0356988 ]]
len(transformed_superpoints_pcd) :  641
copy_superpoint_src_corr_points.shape :  (2303, 3)
mask.shape :  (2303,)
copy_superpoint_src_corr_points.shape :  (1930, 3)
copy_superpoint_ref_corr_points.shape :  (1930, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1930, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1930, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1930])
best_index :  1521
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1930, 3)
transformed_src_superpoints.shape :  torch.Size([1930, 3])
residual.shape :  torch.Size([1930])
batch_inlier_masks.shape :  torch.Size([1930])
batch_outlier_masks.shape :  torch.Size([1930])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1913])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.06168345  0.01431321 -0.05209128]
 [ 0.06357715  0.01941075 -0.050583  ]
 [ 0.06168345  0.01431321 -0.05209128]]
len(transformed_superpoints_pcd) :  658
copy_superpoint_src_corr_points.shape :  (1913, 3)
mask.shape :  (1913,)
copy_superpoint_src_corr_points.shape :  (1678, 3)
copy_superpoint_ref_corr_points.shape :  (1678, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1678, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1678, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1678])
best_index :  1796
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1678, 3)
transformed_src_superpoints.shape :  torch.Size([1678, 3])
residual.shape :  torch.Size([1678])
batch_inlier_masks.shape :  torch.Size([1678])
batch_outlier_masks.shape :  torch.Size([1678])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1661])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.02506787 -0.1141952  -0.01892682]
 [ 0.02843983 -0.12143092 -0.01481633]
 [ 0.03315063 -0.12394043 -0.0153472 ]]
len(transformed_superpoints_pcd) :  675
copy_superpoint_src_corr_points.shape :  (1661, 3)
mask.shape :  (1661,)
copy_superpoint_src_corr_points.shape :  (1431, 3)
copy_superpoint_ref_corr_points.shape :  (1431, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1431, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1431, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1431])
best_index :  1896
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1431, 3)
transformed_src_superpoints.shape :  torch.Size([1431, 3])
residual.shape :  torch.Size([1431])
batch_inlier_masks.shape :  torch.Size([1431])
batch_outlier_masks.shape :  torch.Size([1431])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1415])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.05431111  0.05355982 -0.03993252]
 [ 0.05277951  0.05503986 -0.0344386 ]
 [ 0.0494161   0.05249955 -0.04110073]]
len(transformed_superpoints_pcd) :  691
copy_superpoint_src_corr_points.shape :  (1415, 3)
mask.shape :  (1415,)
copy_superpoint_src_corr_points.shape :  (1400, 3)
copy_superpoint_ref_corr_points.shape :  (1400, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1400, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1400, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1400])
best_index :  1492
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1400, 3)
transformed_src_superpoints.shape :  torch.Size([1400, 3])
residual.shape :  torch.Size([1400])
batch_inlier_masks.shape :  torch.Size([1400])
batch_outlier_masks.shape :  torch.Size([1400])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1385])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.08028257 -0.0114697   0.02519611]
 [-0.08028257 -0.0114697   0.02519611]
 [-0.08882476 -0.01533005  0.01357615]]
len(transformed_superpoints_pcd) :  706
copy_superpoint_src_corr_points.shape :  (1385, 3)
mask.shape :  (1385,)
copy_superpoint_src_corr_points.shape :  (1202, 3)
copy_superpoint_ref_corr_points.shape :  (1202, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1202, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1202, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1202])
best_index :  1834
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1202, 3)
transformed_src_superpoints.shape :  torch.Size([1202, 3])
residual.shape :  torch.Size([1202])
batch_inlier_masks.shape :  torch.Size([1202])
batch_outlier_masks.shape :  torch.Size([1202])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1187])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.06071892 -0.00857171  0.01522513]
 [ 0.06071892 -0.00857171  0.01522513]
 [ 0.05450737 -0.0079295   0.01787994]]
len(transformed_superpoints_pcd) :  721
copy_superpoint_src_corr_points.shape :  (1187, 3)
mask.shape :  (1187,)
copy_superpoint_src_corr_points.shape :  (1149, 3)
copy_superpoint_ref_corr_points.shape :  (1149, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1149, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1149, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1149])
best_index :  1837
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1149, 3)
transformed_src_superpoints.shape :  torch.Size([1149, 3])
residual.shape :  torch.Size([1149])
batch_inlier_masks.shape :  torch.Size([1149])
batch_outlier_masks.shape :  torch.Size([1149])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1134])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.05845056 -0.00725446  0.01446106]
 [ 0.05845056 -0.00725446  0.01446106]
 [ 0.05887462 -0.00157823  0.01365176]]
len(transformed_superpoints_pcd) :  736
copy_superpoint_src_corr_points.shape :  (1134, 3)
mask.shape :  (1134,)
copy_superpoint_src_corr_points.shape :  (1119, 3)
copy_superpoint_ref_corr_points.shape :  (1119, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1119, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1119, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1119])
best_index :  774
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1119, 3)
transformed_src_superpoints.shape :  torch.Size([1119, 3])
residual.shape :  torch.Size([1119])
batch_inlier_masks.shape :  torch.Size([1119])
batch_outlier_masks.shape :  torch.Size([1119])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1105])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.06107628 -0.10710095 -0.03261915]
 [ 0.05593923 -0.10598354 -0.03316679]
 [ 0.05593923 -0.10598354 -0.03316679]]
len(transformed_superpoints_pcd) :  750
copy_superpoint_src_corr_points.shape :  (1105, 3)
mask.shape :  (1105,)
copy_superpoint_src_corr_points.shape :  (1089, 3)
copy_superpoint_ref_corr_points.shape :  (1089, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1089, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 1089, 3])
batch_inlier_masks.shape :  torch.Size([1984, 1089])
best_index :  929
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1089, 3)
transformed_src_superpoints.shape :  torch.Size([1089, 3])
residual.shape :  torch.Size([1089])
batch_inlier_masks.shape :  torch.Size([1089])
batch_outlier_masks.shape :  torch.Size([1089])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1075])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.04618347 -0.04817891 -0.02852944]
 [ 0.05422834 -0.04931807 -0.0269732 ]
 [ 0.05422834 -0.04931807 -0.0269732 ]]
len(transformed_superpoints_pcd) :  764
copy_superpoint_src_corr_points.shape :  (1075, 3)
mask.shape :  (1075,)
copy_superpoint_src_corr_points.shape :  (918, 3)
copy_superpoint_ref_corr_points.shape :  (918, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([918, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 918, 3])
batch_inlier_masks.shape :  torch.Size([1984, 918])
best_index :  1341
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (918, 3)
transformed_src_superpoints.shape :  torch.Size([918, 3])
residual.shape :  torch.Size([918])
batch_inlier_masks.shape :  torch.Size([918])
batch_outlier_masks.shape :  torch.Size([918])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([904])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.04979929 -0.00531981  0.0189376 ]
 [ 0.04979929 -0.00531981  0.0189376 ]
 [ 0.04979929 -0.00531981  0.0189376 ]]
len(transformed_superpoints_pcd) :  778
copy_superpoint_src_corr_points.shape :  (904, 3)
mask.shape :  (904,)
copy_superpoint_src_corr_points.shape :  (842, 3)
copy_superpoint_ref_corr_points.shape :  (842, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([842, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 842, 3])
batch_inlier_masks.shape :  torch.Size([1984, 842])
best_index :  1504
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (842, 3)
transformed_src_superpoints.shape :  torch.Size([842, 3])
residual.shape :  torch.Size([842])
batch_inlier_masks.shape :  torch.Size([842])
batch_outlier_masks.shape :  torch.Size([842])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([828])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.08867149 -0.01233331  0.01847493]
 [-0.08436924 -0.01055525  0.02468871]
 [-0.08467904 -0.00619643  0.02754993]]
len(transformed_superpoints_pcd) :  792
copy_superpoint_src_corr_points.shape :  (828, 3)
mask.shape :  (828,)
copy_superpoint_src_corr_points.shape :  (719, 3)
copy_superpoint_ref_corr_points.shape :  (719, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([719, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 719, 3])
batch_inlier_masks.shape :  torch.Size([1984, 719])
best_index :  1760
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (719, 3)
transformed_src_superpoints.shape :  torch.Size([719, 3])
residual.shape :  torch.Size([719])
batch_inlier_masks.shape :  torch.Size([719])
batch_outlier_masks.shape :  torch.Size([719])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([705])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.08602926 -0.00971943  0.02313413]
 [-0.08763053 -0.00496558  0.02632661]
 [-0.08326089 -0.00685467  0.02906775]]
len(transformed_superpoints_pcd) :  806
copy_superpoint_src_corr_points.shape :  (705, 3)
mask.shape :  (705,)
copy_superpoint_src_corr_points.shape :  (683, 3)
copy_superpoint_ref_corr_points.shape :  (683, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([683, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 683, 3])
batch_inlier_masks.shape :  torch.Size([1984, 683])
best_index :  1902
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (683, 3)
transformed_src_superpoints.shape :  torch.Size([683, 3])
residual.shape :  torch.Size([683])
batch_inlier_masks.shape :  torch.Size([683])
batch_outlier_masks.shape :  torch.Size([683])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([669])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.05693234 -0.01394176  0.01784012]
 [ 0.05799131 -0.00878009  0.01577449]
 [ 0.05421682 -0.01779057  0.02074019]]
len(transformed_superpoints_pcd) :  820
copy_superpoint_src_corr_points.shape :  (669, 3)
mask.shape :  (669,)
copy_superpoint_src_corr_points.shape :  (665, 3)
copy_superpoint_ref_corr_points.shape :  (665, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([665, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 665, 3])
batch_inlier_masks.shape :  torch.Size([1984, 665])
best_index :  1939
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (665, 3)
transformed_src_superpoints.shape :  torch.Size([665, 3])
residual.shape :  torch.Size([665])
batch_inlier_masks.shape :  torch.Size([665])
batch_outlier_masks.shape :  torch.Size([665])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([651])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.07171907  0.03809937 -0.03817321]
 [ 0.07610834  0.03286792 -0.04211651]
 [ 0.07696727  0.03782205 -0.03856586]]
len(transformed_superpoints_pcd) :  834
copy_superpoint_src_corr_points.shape :  (651, 3)
mask.shape :  (651,)
copy_superpoint_src_corr_points.shape :  (602, 3)
copy_superpoint_ref_corr_points.shape :  (602, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([602, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 602, 3])
batch_inlier_masks.shape :  torch.Size([1984, 602])
best_index :  1655
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (602, 3)
transformed_src_superpoints.shape :  torch.Size([602, 3])
residual.shape :  torch.Size([602])
batch_inlier_masks.shape :  torch.Size([602])
batch_outlier_masks.shape :  torch.Size([602])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([590])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.03707033  0.09796178 -0.02641498]
 [-0.03669523  0.10299297 -0.02362593]
 [-0.03707033  0.09796178 -0.02641498]]
len(transformed_superpoints_pcd) :  846
copy_superpoint_src_corr_points.shape :  (590, 3)
mask.shape :  (590,)
copy_superpoint_src_corr_points.shape :  (570, 3)
copy_superpoint_ref_corr_points.shape :  (570, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([570, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 570, 3])
batch_inlier_masks.shape :  torch.Size([1984, 570])
best_index :  1765
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (570, 3)
transformed_src_superpoints.shape :  torch.Size([570, 3])
residual.shape :  torch.Size([570])
batch_inlier_masks.shape :  torch.Size([570])
batch_outlier_masks.shape :  torch.Size([570])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([558])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.01833918 -0.06969535  0.02709283]
 [ 0.02929334 -0.0728455   0.02697184]
 [ 0.02606414 -0.07677982  0.02623347]]
len(transformed_superpoints_pcd) :  858
copy_superpoint_src_corr_points.shape :  (558, 3)
mask.shape :  (558,)
copy_superpoint_src_corr_points.shape :  (557, 3)
copy_superpoint_ref_corr_points.shape :  (557, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([557, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 557, 3])
batch_inlier_masks.shape :  torch.Size([1984, 557])
best_index :  1583
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (557, 3)
transformed_src_superpoints.shape :  torch.Size([557, 3])
residual.shape :  torch.Size([557])
batch_inlier_masks.shape :  torch.Size([557])
batch_outlier_masks.shape :  torch.Size([557])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([546])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.03929403  0.02097243 -0.06222904]
 [ 0.0399645   0.0262763  -0.06101923]
 [ 0.04722527  0.02859602 -0.05601478]]
len(transformed_superpoints_pcd) :  869
copy_superpoint_src_corr_points.shape :  (546, 3)
mask.shape :  (546,)
copy_superpoint_src_corr_points.shape :  (540, 3)
copy_superpoint_ref_corr_points.shape :  (540, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([540, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 540, 3])
batch_inlier_masks.shape :  torch.Size([1984, 540])
best_index :  1238
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (540, 3)
transformed_src_superpoints.shape :  torch.Size([540, 3])
residual.shape :  torch.Size([540])
batch_inlier_masks.shape :  torch.Size([540])
batch_outlier_masks.shape :  torch.Size([540])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([531])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.08802276 -0.00741189  0.02421415]
 [-0.09177875 -0.00769984  0.01958507]
 [-0.09038777 -0.00340121  0.0260644 ]]
len(transformed_superpoints_pcd) :  878
copy_superpoint_src_corr_points.shape :  (531, 3)
mask.shape :  (531,)
copy_superpoint_src_corr_points.shape :  (450, 3)
copy_superpoint_ref_corr_points.shape :  (450, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([450, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 450, 3])
batch_inlier_masks.shape :  torch.Size([1984, 450])
best_index :  1476
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (450, 3)
transformed_src_superpoints.shape :  torch.Size([450, 3])
residual.shape :  torch.Size([450])
batch_inlier_masks.shape :  torch.Size([450])
batch_outlier_masks.shape :  torch.Size([450])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([441])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.01675311 -0.04564467  0.03382567]
 [ 0.01816725 -0.05032374  0.03027877]
 [ 0.02262563 -0.05152832  0.03351729]]
len(transformed_superpoints_pcd) :  887
copy_superpoint_src_corr_points.shape :  (441, 3)
mask.shape :  (441,)
copy_superpoint_src_corr_points.shape :  (441, 3)
copy_superpoint_ref_corr_points.shape :  (441, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([441, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 441, 3])
batch_inlier_masks.shape :  torch.Size([1984, 441])
best_index :  1735
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (441, 3)
transformed_src_superpoints.shape :  torch.Size([441, 3])
residual.shape :  torch.Size([441])
batch_inlier_masks.shape :  torch.Size([441])
batch_outlier_masks.shape :  torch.Size([441])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([432])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.05932291  0.05597016 -0.03467157]
 [ 0.05057009  0.05547486 -0.03464396]
 [ 0.05098433  0.05252251 -0.04103959]]
len(transformed_superpoints_pcd) :  896
copy_superpoint_src_corr_points.shape :  (432, 3)
mask.shape :  (432,)
copy_superpoint_src_corr_points.shape :  (432, 3)
copy_superpoint_ref_corr_points.shape :  (432, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([432, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 432, 3])
batch_inlier_masks.shape :  torch.Size([1984, 432])
best_index :  1091
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (432, 3)
transformed_src_superpoints.shape :  torch.Size([432, 3])
residual.shape :  torch.Size([432])
batch_inlier_masks.shape :  torch.Size([432])
batch_outlier_masks.shape :  torch.Size([432])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([424])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.04785998 -0.11767378  0.00725769]
 [-0.04566611 -0.12128262  0.01297624]
 [-0.04272387 -0.11763896  0.00951714]]
len(transformed_superpoints_pcd) :  904
copy_superpoint_src_corr_points.shape :  (424, 3)
mask.shape :  (424,)
copy_superpoint_src_corr_points.shape :  (416, 3)
copy_superpoint_ref_corr_points.shape :  (416, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([416, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 416, 3])
batch_inlier_masks.shape :  torch.Size([1984, 416])
best_index :  158
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (416, 3)
transformed_src_superpoints.shape :  torch.Size([416, 3])
residual.shape :  torch.Size([416])
batch_inlier_masks.shape :  torch.Size([416])
batch_outlier_masks.shape :  torch.Size([416])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([409])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.06188606 -0.12222537  0.01611876]
 [-0.06188606 -0.12222537  0.01611876]
 [-0.06188606 -0.12222537  0.01611876]]
len(transformed_superpoints_pcd) :  911
copy_superpoint_src_corr_points.shape :  (409, 3)
mask.shape :  (409,)
copy_superpoint_src_corr_points.shape :  (365, 3)
copy_superpoint_ref_corr_points.shape :  (365, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([365, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 365, 3])
batch_inlier_masks.shape :  torch.Size([1984, 365])
best_index :  868
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (365, 3)
transformed_src_superpoints.shape :  torch.Size([365, 3])
residual.shape :  torch.Size([365])
batch_inlier_masks.shape :  torch.Size([365])
batch_outlier_masks.shape :  torch.Size([365])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([358])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.02801696 -0.12104335 -0.01494017]
 [ 0.02801696 -0.12104335 -0.01494017]
 [ 0.02801696 -0.12104335 -0.01494017]]
len(transformed_superpoints_pcd) :  918
copy_superpoint_src_corr_points.shape :  (358, 3)
mask.shape :  (358,)
copy_superpoint_src_corr_points.shape :  (313, 3)
copy_superpoint_ref_corr_points.shape :  (313, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([313, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 313, 3])
batch_inlier_masks.shape :  torch.Size([1984, 313])
best_index :  1256
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (313, 3)
transformed_src_superpoints.shape :  torch.Size([313, 3])
residual.shape :  torch.Size([313])
batch_inlier_masks.shape :  torch.Size([313])
batch_outlier_masks.shape :  torch.Size([313])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([306])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.07065403  0.03223873 -0.04267105]
 [ 0.03973759  0.09010118 -0.0375424 ]
 [ 0.03973759  0.09010118 -0.0375424 ]]
len(transformed_superpoints_pcd) :  925
copy_superpoint_src_corr_points.shape :  (306, 3)
mask.shape :  (306,)
copy_superpoint_src_corr_points.shape :  (264, 3)
copy_superpoint_ref_corr_points.shape :  (264, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([264, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 264, 3])
batch_inlier_masks.shape :  torch.Size([1984, 264])
best_index :  1105
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (264, 3)
transformed_src_superpoints.shape :  torch.Size([264, 3])
residual.shape :  torch.Size([264])
batch_inlier_masks.shape :  torch.Size([264])
batch_outlier_masks.shape :  torch.Size([264])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([258])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [-0.06158753 -0.12018971  0.0233289 ]
 [-0.06158753 -0.12018971  0.0233289 ]
 [-0.03211511 -0.03521188  0.03489979]]
len(transformed_superpoints_pcd) :  931
copy_superpoint_src_corr_points.shape :  (258, 3)
mask.shape :  (258,)
copy_superpoint_src_corr_points.shape :  (103, 3)
copy_superpoint_ref_corr_points.shape :  (103, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([103, 3])
batch_transforms.shape :  torch.Size([1984, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1984, 103, 3])
batch_inlier_masks.shape :  torch.Size([1984, 103])
best_index :  1953
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (103, 3)
transformed_src_superpoints.shape :  torch.Size([103, 3])
residual.shape :  torch.Size([103])
batch_inlier_masks.shape :  torch.Size([103])
batch_outlier_masks.shape :  torch.Size([103])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([97])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.07053646 -0.11808361  0.0077722 ]
 [-0.0667886  -0.11857376  0.00420497]
 [-0.06915393 -0.11981342  0.0130454 ]
 ...
 [ 0.05876062  0.05765665 -0.03242257]
 [ 0.05701056  0.05339453 -0.03826579]
 [ 0.05876062  0.05765665 -0.03242257]]
len(transformed_superpoints_pcd) :  937
copy_superpoint_src_corr_points.shape :  (97, 3)
mask.shape :  (97,)
copy_superpoint_src_corr_points.shape :  (97, 3)
copy_superpoint_ref_corr_points.shape :  (97, 3)
number of unique points in pcd :  391
number of rotations used :  39
transformed_superpoints_pcd.shape :  (1034, 3)
Line set updated
057
src_points :  [[-0.04853019  0.05818512  0.09039323]
 [-0.04876055  0.06194214  0.08590282]
 [-0.04606336  0.06652246  0.08557361]
 ...
 [-0.02816299  0.0032754  -0.01846991]
 [-0.03583273  0.10096792  0.00384813]
 [-0.05408567 -0.01049634 -0.01920958]]
ref_points :  [[-0.06571028 -0.06228185  0.03820498]
 [-0.06607899 -0.0590632   0.03333826]
 [-0.06109532 -0.05710736  0.03488975]
 ...
 [-0.02588987  0.04808679 -0.01765596]
 [-0.00442635  0.10816476 -0.01024699]
 [-0.03269596  0.01427848 -0.01790975]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([3262, 3])
lengths :  tensor([1648, 1614])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([2115, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([651, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([322, 3])
ref_points_f.shape :  torch.Size([1648, 3])
src_points_c.shape :  torch.Size([329, 3])
src_points_f.shape :  torch.Size([1614, 3])
ref_node_masks.shape :  torch.Size([322])
ref_node_knn_indices.shape :  torch.Size([322, 5])
ref_node_knn_masks.shape :  torch.Size([322, 5])
src_node_masks.shape :  torch.Size([329])
src_node_knn_indices.shape :  torch.Size([329, 5])
src_node_knn_masks.shape :  torch.Size([329, 5])
ref_node_knn_points.shape :  torch.Size([322, 5, 3])
src_node_knn_points.shape :  torch.Size([329, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([651, 512])
feats_f :  torch.Size([3262, 256])
k :  3
omegas.shape :  torch.Size([103684, 128, 1])
omegas.shape :  torch.Size([311052, 128, 1])
k :  3
omegas.shape :  torch.Size([108241, 128, 1])
omegas.shape :  torch.Size([324723, 128, 1])
ref_feats_c.shape :  torch.Size([1, 322, 256])
src_feats_c.shape :  torch.Size([1, 329, 256])
ref_feats_c_norm.shape :  torch.Size([322, 256])
src_feats_c_norm.shape :  torch.Size([329, 256])
ref_node_masks.shape :  torch.Size([322])
src_node_masks.shape :  torch.Size([329])
self.num_correspondences :  2000
matching_scores.numel() :  105938
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([19416])
ref_indices.shape :  torch.Size([19416])
src_indices.shape :  torch.Size([19416])
batch_indices :  tensor([   0,    0,    1,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 2, 2, 2], device='cuda:0')
src_indices :  tensor([0, 3, 3,  ..., 0, 1, 2], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([19416, 3])
global_src_corr_points.shape :  torch.Size([19416, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([1999, 4, 4])
src_corr_points.shape :  torch.Size([19416, 3])
ref_corr_points.shape :  torch.Size([1, 19416, 3])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 19416, 3])
batch_corr_residuals.shape :  torch.Size([1999, 19416])
batch_inlier_masks.shape :  torch.Size([1999, 19416])
best_index :  tensor(479, device='cuda:0')
len(batch_transforms) :  1999
estimated_transform :  [[ 0.08125955  0.03931465  0.9959177   0.02016552]
 [ 0.09324121 -0.9951395   0.03167617  0.0193441 ]
 [ 0.99232227  0.09028652 -0.08452979  0.00714634]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [1891  405 1565 ...  583  772  479]
superpoint_src_corr_points.shape :  (19416, 3)
superpoint_ref_corr_points.shape :  (19416, 3)
batch_inlier_masks.shape :  (1999, 19416)
batch_transforms.shape :  (1999, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([19416, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 19416, 3])
batch_inlier_masks.shape :  torch.Size([1999, 19416])
best_index :  316
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (19416, 3)
transformed_src_superpoints.shape :  torch.Size([19416, 3])
residual.shape :  torch.Size([19416])
batch_inlier_masks.shape :  torch.Size([19416])
batch_outlier_masks.shape :  torch.Size([19416])
indices_inliers.shape :  torch.Size([180])
indices_outliers.shape :  torch.Size([19236])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([180, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01802307  0.05657454 -0.00513945]
 [-0.01471317  0.06145472 -0.00169412]
 [-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.00691874  0.02066056 -0.04756739]
 [-0.00518625  0.02410002 -0.04342967]
 [-0.00518625  0.02410002 -0.04342967]
 [ 0.02143214 -0.0373296   0.03268163]
 [ 0.00192583  0.01538979 -0.04899062]
 [-0.00691874  0.02066056 -0.04756739]
 [-0.00691874  0.02066056 -0.04756739]
 [-0.01196209  0.02102783 -0.04775106]
 [ 0.02958596  0.04669956 -0.03134783]
 [ 0.02691884  0.04207499 -0.03113702]
 [ 0.02691884  0.04207499 -0.03113702]
 [-0.01358083 -0.0067585   0.03564326]
 [-0.01646715 -0.00327746  0.03300748]
 [-0.01945235 -0.01439524  0.03147684]
 [-0.0189069  -0.009051    0.03149255]
 [-0.01358083 -0.0067585   0.03564326]
 [-0.01646715 -0.00327746  0.03300748]
 [ 0.00061708 -0.01625003  0.04164684]
 [ 0.00394755 -0.02427674  0.04313696]
 [ 0.00584647 -0.01959521  0.04139677]
 [ 0.00584647 -0.01959521  0.04139677]
 [ 0.00061708 -0.01625003  0.04164684]
 [-0.00075112 -0.02126528  0.04236055]
 [ 0.03499875  0.03131815 -0.02800292]
 [ 0.03946989  0.02778053 -0.02593797]
 [ 0.01567928 -0.01791554  0.03611654]
 [ 0.01617081 -0.02369327  0.0367577 ]
 [ 0.01781761 -0.01311162  0.03435213]
 [ 0.01567928 -0.01791554  0.03611654]
 [ 0.01567928 -0.01791554  0.03611654]
 [ 0.02029768 -0.02164133  0.03412362]
 [ 0.01781761 -0.01311162  0.03435213]
 [ 0.00192583  0.01538979 -0.04899062]
 [-0.00476202  0.01322291 -0.05209888]
 [ 0.00051325  0.01117359 -0.05175282]
 [ 0.00192583  0.01538979 -0.04899062]
 [-0.00476202  0.01322291 -0.05209888]
 [ 0.00051325  0.01117359 -0.05175282]
 [ 0.00061708 -0.01625003  0.04164684]
 [ 0.00061708 -0.01625003  0.04164684]
 [-0.00756236 -0.00516604  0.03955479]
 [-0.00756236 -0.00516604  0.03955479]
 [-0.01120168 -0.00082984  0.03697978]
 [-0.00756236 -0.00516604  0.03955479]
 [-0.00756236 -0.00516604  0.03955479]
 [-0.01358083 -0.0067585   0.03564326]
 [-0.01384747 -0.01244149  0.03555574]
 [-0.01646715 -0.00327746  0.03300748]
 [-0.0189069  -0.009051    0.03149255]
 [-0.01358083 -0.0067585   0.03564326]
 [-0.01384747 -0.01244149  0.03555574]
 [-0.01120168 -0.00082984  0.03697978]
 [ 0.00061708 -0.01625003  0.04164684]
 [ 0.00384646 -0.01260445  0.04012159]
 [-0.00417532 -0.01248485  0.04066812]
 [-0.00465638 -0.0179781   0.04081182]
 [ 0.02029768 -0.02164133  0.03412362]
 [-0.00691874  0.02066056 -0.04756739]
 [-0.01196209  0.02102783 -0.04775106]
 [-0.00518625  0.02410002 -0.04342967]
 [-0.00691874  0.02066056 -0.04756739]
 [-0.01196209  0.02102783 -0.04775106]
 [-0.00518625  0.02410002 -0.04342967]
 [-0.00691874  0.02066056 -0.04756739]
 [-0.00518625  0.02410002 -0.04342967]
 [-0.00986129 -0.01749679  0.03821521]
 [-0.00465638 -0.0179781   0.04081182]
 [-0.00963544 -0.01161261  0.03822815]
 [-0.00417532 -0.01248485  0.04066812]
 [-0.00465638 -0.0179781   0.04081182]
 [-0.00963544 -0.01161261  0.03822815]
 [-0.00986129 -0.01749679  0.03821521]
 [ 0.03006845 -0.03570446  0.02741833]
 [ 0.02561448 -0.03847619  0.02935933]
 [ 0.03006845 -0.03570446  0.02741833]
 [ 0.02561448 -0.03847619  0.02935933]
 [ 0.02561448 -0.03847619  0.02935933]
 [ 0.02680037 -0.04320362  0.02524249]
 [ 0.03006845 -0.03570446  0.02741833]
 [ 0.03368469 -0.03802728  0.02248714]
 [ 0.01135213 -0.02181393  0.03918308]
 [ 0.01567928 -0.01791554  0.03611654]
 [ 0.02029768 -0.02164133  0.03412362]
 [ 0.01781761 -0.01311162  0.03435213]
 [ 0.01567928 -0.01791554  0.03611654]
 [ 0.01135213 -0.02181393  0.03918308]
 [-0.01120168 -0.00082984  0.03697978]
 [-0.01452298 -0.02443446  0.03542251]
 [-0.01079698 -0.02958049  0.03825172]
 [-0.01427234 -0.01809633  0.0355124 ]
 [-0.00544118 -0.0231965   0.04096359]
 [-0.01043953 -0.0234572   0.03813766]
 [-0.00544118 -0.0231965   0.04096359]
 [-0.01427234 -0.01809633  0.0355124 ]
 [-0.01452298 -0.02443446  0.03542251]
 [-0.01427234 -0.01809633  0.0355124 ]
 [-0.00417532 -0.01248485  0.04066812]
 [-0.02908511  0.0172926   0.01024072]
 [-0.02732771  0.02017574  0.00436383]
 [-0.02908511  0.0172926   0.01024072]
 [-0.02893755  0.0112428   0.00946657]
 [-0.02732771  0.02017574  0.00436383]
 [-0.02732771  0.02017574  0.00436383]
 [-0.02504631  0.01558565  0.00169712]
 [ 0.02858153  0.03401258 -0.03015991]
 [-0.00963544 -0.01161261  0.03822815]
 [-0.00417532 -0.01248485  0.04066812]
 [-0.00465638 -0.0179781   0.04081182]
 [-0.00963544 -0.01161261  0.03822815]
 [-0.00963544 -0.01161261  0.03822815]
 [-0.00417532 -0.01248485  0.04066812]
 [-0.01646715 -0.00327746  0.03300748]
 [-0.01945235 -0.01439524  0.03147684]
 [-0.01945235 -0.01439524  0.03147684]
 [-0.0189069  -0.009051    0.03149255]
 [-0.01646715 -0.00327746  0.03300748]
 [ 0.02178948 -0.02853978  0.03330924]
 [-0.01945235 -0.01439524  0.03147684]
 [-0.01945235 -0.01439524  0.03147684]
 [ 0.03006845 -0.03570446  0.02741833]
 [ 0.02561448 -0.03847619  0.02935933]
 [ 0.03006845 -0.03570446  0.02741833]
 [ 0.00384646 -0.01260445  0.04012159]
 [ 0.00061708 -0.01625003  0.04164684]
 [ 0.00384646 -0.01260445  0.04012159]
 [-0.00476202  0.01322291 -0.05209888]
 [ 0.00051325  0.01117359 -0.05175282]
 [-0.00476202  0.01322291 -0.05209888]
 [ 0.00051325  0.01117359 -0.05175282]
 [ 0.00192583  0.01538979 -0.04899062]
 [-0.00476202  0.01322291 -0.05209888]
 [ 0.00051325  0.01117359 -0.05175282]
 [ 0.00192583  0.01538979 -0.04899062]
 [ 0.03996803  0.03359908 -0.02247838]
 [ 0.04046492  0.0358143  -0.01788588]
 [-0.00011514 -0.00429629  0.03963488]
 [-0.00011514 -0.00429629  0.03963488]
 [-0.00011514 -0.00429629  0.03963488]
 [ 0.00531206 -0.00711624  0.03797863]
 [ 0.00531206 -0.00711624  0.03797863]
 [ 0.02507712 -0.0222039   0.03112623]
 [ 0.02507712 -0.0222039   0.03112623]
 [ 0.02507712 -0.0222039   0.03112623]
 [ 0.02627564 -0.01725812  0.02983605]
 [-0.01427234 -0.01809633  0.0355124 ]
 [ 0.02143214 -0.0373296   0.03268163]
 [ 0.02178948 -0.02853978  0.03330924]
 [ 0.02627564 -0.01725812  0.02983605]
 [ 0.02507712 -0.0222039   0.03112623]
 [ 0.02627564 -0.01725812  0.02983605]
 [ 0.02507712 -0.0222039   0.03112623]
 [ 0.02726125 -0.01224338  0.02864534]
 [ 0.02507712 -0.0222039   0.03112623]
 [ 0.03470042 -0.03216656  0.02582406]
 [ 0.03470042 -0.03216656  0.02582406]
 [ 0.03730388 -0.02812489  0.02405324]
 [ 0.03055259 -0.02763882  0.02827325]
 [ 0.00051325  0.01117359 -0.05175282]
 [-0.00476202  0.01322291 -0.05209888]
 [ 0.00051325  0.01117359 -0.05175282]
 [ 0.00192583  0.01538979 -0.04899062]
 [ 0.00051325  0.01117359 -0.05175282]
 [ 0.00192583  0.01538979 -0.04899062]
 [-0.01802307  0.05657454 -0.00513945]
 [-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01802307  0.05657454 -0.00513945]
 [-0.01802307  0.05657454 -0.00513945]
 [-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01115339  0.05678253 -0.00413364]
 [ 0.01135213 -0.02181393  0.03918308]]
len(transformed_superpoints_pcd) :  180
copy_superpoint_src_corr_points.shape :  (19236, 3)
mask.shape :  (19236,)
copy_superpoint_src_corr_points.shape :  (15687, 3)
copy_superpoint_ref_corr_points.shape :  (15687, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([15687, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 15687, 3])
batch_inlier_masks.shape :  torch.Size([1999, 15687])
best_index :  1514
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (15687, 3)
transformed_src_superpoints.shape :  torch.Size([15687, 3])
residual.shape :  torch.Size([15687])
batch_inlier_masks.shape :  torch.Size([15687])
batch_outlier_masks.shape :  torch.Size([15687])
indices_inliers.shape :  torch.Size([138])
indices_outliers.shape :  torch.Size([15549])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([138, 3])
transformed_superpoints_pcd :  [[-1.47131719e-02  6.14547245e-02 -1.69412140e-03]
 [-1.53263491e-02  6.35918453e-02 -6.64778799e-03]
 [-1.47131719e-02  6.14547245e-02 -1.69412140e-03]
 [-1.53263491e-02  6.35918453e-02 -6.64778799e-03]
 [-1.80230681e-02  5.65745421e-02 -5.13944961e-03]
 [-1.47131719e-02  6.14547245e-02 -1.69412140e-03]
 [-1.47131719e-02  6.14547245e-02 -1.69412140e-03]
 [-1.53263491e-02  6.35918453e-02 -6.64778799e-03]
 [-6.91874046e-03  2.06605569e-02 -4.75673936e-02]
 [-5.18624950e-03  2.41000168e-02 -4.34296690e-02]
 [-5.18624950e-03  2.41000168e-02 -4.34296690e-02]
 [ 2.14321446e-02 -3.73295993e-02  3.26816328e-02]
 [ 1.92582980e-03  1.53897880e-02 -4.89906184e-02]
 [-6.91874046e-03  2.06605569e-02 -4.75673936e-02]
 [-6.91874046e-03  2.06605569e-02 -4.75673936e-02]
 [-1.19620878e-02  2.10278295e-02 -4.77510579e-02]
 [ 2.95859557e-02  4.66995649e-02 -3.13478298e-02]
 [ 2.69188378e-02  4.20749895e-02 -3.11370250e-02]
 [ 2.69188378e-02  4.20749895e-02 -3.11370250e-02]
 [-1.35808345e-02 -6.75850175e-03  3.56432609e-02]
 [-1.64671484e-02 -3.27746011e-03  3.30074802e-02]
 [-1.94523521e-02 -1.43952444e-02  3.14768367e-02]
 [-1.89069025e-02 -9.05099511e-03  3.14925537e-02]
 [-1.35808345e-02 -6.75850175e-03  3.56432609e-02]
 [-1.64671484e-02 -3.27746011e-03  3.30074802e-02]
 [ 6.17081299e-04 -1.62500255e-02  4.16468419e-02]
 [ 3.94754671e-03 -2.42767371e-02  4.31369580e-02]
 [ 5.84647246e-03 -1.95952095e-02  4.13967744e-02]
 [ 5.84647246e-03 -1.95952095e-02  4.13967744e-02]
 [ 6.17081299e-04 -1.62500255e-02  4.16468419e-02]
 [-7.51115382e-04 -2.12652832e-02  4.23605479e-02]
 [ 3.49987485e-02  3.13181467e-02 -2.80029196e-02]
 [ 3.94698903e-02  2.77805254e-02 -2.59379670e-02]
 [ 1.56792775e-02 -1.79155432e-02  3.61165367e-02]
 [ 1.61708053e-02 -2.36932710e-02  3.67577039e-02]
 [ 1.78176053e-02 -1.31116211e-02  3.43521349e-02]
 [ 1.56792775e-02 -1.79155432e-02  3.61165367e-02]
 [ 1.56792775e-02 -1.79155432e-02  3.61165367e-02]
 [ 2.02976838e-02 -2.16413327e-02  3.41236182e-02]
 [ 1.78176053e-02 -1.31116211e-02  3.43521349e-02]
 [ 1.92582980e-03  1.53897880e-02 -4.89906184e-02]
 [-4.76201810e-03  1.32229058e-02 -5.20988777e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [ 1.92582980e-03  1.53897880e-02 -4.89906184e-02]
 [-4.76201810e-03  1.32229058e-02 -5.20988777e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [ 6.17081299e-04 -1.62500255e-02  4.16468419e-02]
 [ 6.17081299e-04 -1.62500255e-02  4.16468419e-02]
 [-7.56235979e-03 -5.16603515e-03  3.95547859e-02]
 [-7.56235979e-03 -5.16603515e-03  3.95547859e-02]
 [-1.12016778e-02 -8.29843804e-04  3.69797796e-02]
 [-7.56235979e-03 -5.16603515e-03  3.95547859e-02]
 [-7.56235979e-03 -5.16603515e-03  3.95547859e-02]
 [-1.35808345e-02 -6.75850175e-03  3.56432609e-02]
 [-1.38474721e-02 -1.24414880e-02  3.55557390e-02]
 [-1.64671484e-02 -3.27746011e-03  3.30074802e-02]
 [-1.89069025e-02 -9.05099511e-03  3.14925537e-02]
 [-1.35808345e-02 -6.75850175e-03  3.56432609e-02]
 [-1.38474721e-02 -1.24414880e-02  3.55557390e-02]
 [-1.12016778e-02 -8.29843804e-04  3.69797796e-02]
 [ 6.17081299e-04 -1.62500255e-02  4.16468419e-02]
 [ 3.84645537e-03 -1.26044471e-02  4.01215926e-02]
 [-4.17531841e-03 -1.24848485e-02  4.06681187e-02]
 [-4.65638377e-03 -1.79780982e-02  4.08118181e-02]
 [ 2.02976838e-02 -2.16413327e-02  3.41236182e-02]
 [-6.91874046e-03  2.06605569e-02 -4.75673936e-02]
 [-1.19620878e-02  2.10278295e-02 -4.77510579e-02]
 [-5.18624950e-03  2.41000168e-02 -4.34296690e-02]
 [-6.91874046e-03  2.06605569e-02 -4.75673936e-02]
 [-1.19620878e-02  2.10278295e-02 -4.77510579e-02]
 [-5.18624950e-03  2.41000168e-02 -4.34296690e-02]
 [-6.91874046e-03  2.06605569e-02 -4.75673936e-02]
 [-5.18624950e-03  2.41000168e-02 -4.34296690e-02]
 [-9.86129418e-03 -1.74967945e-02  3.82152051e-02]
 [-4.65638377e-03 -1.79780982e-02  4.08118181e-02]
 [-9.63544473e-03 -1.16126090e-02  3.82281505e-02]
 [-4.17531841e-03 -1.24848485e-02  4.06681187e-02]
 [-4.65638377e-03 -1.79780982e-02  4.08118181e-02]
 [-9.63544473e-03 -1.16126090e-02  3.82281505e-02]
 [-9.86129418e-03 -1.74967945e-02  3.82152051e-02]
 [ 3.00684478e-02 -3.57044637e-02  2.74183303e-02]
 [ 2.56144796e-02 -3.84761877e-02  2.93593295e-02]
 [ 3.00684478e-02 -3.57044637e-02  2.74183303e-02]
 [ 2.56144796e-02 -3.84761877e-02  2.93593295e-02]
 [ 2.56144796e-02 -3.84761877e-02  2.93593295e-02]
 [ 2.68003717e-02 -4.32036221e-02  2.52424926e-02]
 [ 3.00684478e-02 -3.57044637e-02  2.74183303e-02]
 [ 3.36846858e-02 -3.80272791e-02  2.24871412e-02]
 [ 1.13521256e-02 -2.18139309e-02  3.91830765e-02]
 [ 1.56792775e-02 -1.79155432e-02  3.61165367e-02]
 [ 2.02976838e-02 -2.16413327e-02  3.41236182e-02]
 [ 1.78176053e-02 -1.31116211e-02  3.43521349e-02]
 [ 1.56792775e-02 -1.79155432e-02  3.61165367e-02]
 [ 1.13521256e-02 -2.18139309e-02  3.91830765e-02]
 [-1.12016778e-02 -8.29843804e-04  3.69797796e-02]
 [-1.45229828e-02 -2.44344622e-02  3.54225077e-02]
 [-1.07969772e-02 -2.95804925e-02  3.82517166e-02]
 [-1.42723378e-02 -1.80963315e-02  3.55124027e-02]
 [-5.44117577e-03 -2.31964961e-02  4.09635901e-02]
 [-1.04395337e-02 -2.34571993e-02  3.81376557e-02]
 [-5.44117577e-03 -2.31964961e-02  4.09635901e-02]
 [-1.42723378e-02 -1.80963315e-02  3.55124027e-02]
 [-1.45229828e-02 -2.44344622e-02  3.54225077e-02]
 [-1.42723378e-02 -1.80963315e-02  3.55124027e-02]
 [-4.17531841e-03 -1.24848485e-02  4.06681187e-02]
 [-2.90851053e-02  1.72925964e-02  1.02407187e-02]
 [-2.73277145e-02  2.01757438e-02  4.36382741e-03]
 [-2.90851053e-02  1.72925964e-02  1.02407187e-02]
 [-2.89375540e-02  1.12427967e-02  9.46656987e-03]
 [-2.73277145e-02  2.01757438e-02  4.36382741e-03]
 [-2.73277145e-02  2.01757438e-02  4.36382741e-03]
 [-2.50463057e-02  1.55856470e-02  1.69711839e-03]
 [ 2.85815336e-02  3.40125822e-02 -3.01599149e-02]
 [-9.63544473e-03 -1.16126090e-02  3.82281505e-02]
 [-4.17531841e-03 -1.24848485e-02  4.06681187e-02]
 [-4.65638377e-03 -1.79780982e-02  4.08118181e-02]
 [-9.63544473e-03 -1.16126090e-02  3.82281505e-02]
 [-9.63544473e-03 -1.16126090e-02  3.82281505e-02]
 [-4.17531841e-03 -1.24848485e-02  4.06681187e-02]
 [-1.64671484e-02 -3.27746011e-03  3.30074802e-02]
 [-1.94523521e-02 -1.43952444e-02  3.14768367e-02]
 [-1.94523521e-02 -1.43952444e-02  3.14768367e-02]
 [-1.89069025e-02 -9.05099511e-03  3.14925537e-02]
 [-1.64671484e-02 -3.27746011e-03  3.30074802e-02]
 [ 2.17894819e-02 -2.85397768e-02  3.33092399e-02]
 [-1.94523521e-02 -1.43952444e-02  3.14768367e-02]
 [-1.94523521e-02 -1.43952444e-02  3.14768367e-02]
 [ 3.00684478e-02 -3.57044637e-02  2.74183303e-02]
 [ 2.56144796e-02 -3.84761877e-02  2.93593295e-02]
 [ 3.00684478e-02 -3.57044637e-02  2.74183303e-02]
 [ 3.84645537e-03 -1.26044471e-02  4.01215926e-02]
 [ 6.17081299e-04 -1.62500255e-02  4.16468419e-02]
 [ 3.84645537e-03 -1.26044471e-02  4.01215926e-02]
 [-4.76201810e-03  1.32229058e-02 -5.20988777e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [-4.76201810e-03  1.32229058e-02 -5.20988777e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [ 1.92582980e-03  1.53897880e-02 -4.89906184e-02]
 [-4.76201810e-03  1.32229058e-02 -5.20988777e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [ 1.92582980e-03  1.53897880e-02 -4.89906184e-02]
 [ 3.99680287e-02  3.35990824e-02 -2.24783756e-02]
 [ 4.04649153e-02  3.58142965e-02 -1.78858824e-02]
 [-1.15144998e-04 -4.29628510e-03  3.96348797e-02]
 [-1.15144998e-04 -4.29628510e-03  3.96348797e-02]
 [-1.15144998e-04 -4.29628510e-03  3.96348797e-02]
 [ 5.31206280e-03 -7.11624417e-03  3.79786268e-02]
 [ 5.31206280e-03 -7.11624417e-03  3.79786268e-02]
 [ 2.50771176e-02 -2.22039036e-02  3.11262310e-02]
 [ 2.50771176e-02 -2.22039036e-02  3.11262310e-02]
 [ 2.50771176e-02 -2.22039036e-02  3.11262310e-02]
 [ 2.62756404e-02 -1.72581188e-02  2.98360474e-02]
 [-1.42723378e-02 -1.80963315e-02  3.55124027e-02]
 [ 2.14321446e-02 -3.73295993e-02  3.26816328e-02]
 [ 2.17894819e-02 -2.85397768e-02  3.33092399e-02]
 [ 2.62756404e-02 -1.72581188e-02  2.98360474e-02]
 [ 2.50771176e-02 -2.22039036e-02  3.11262310e-02]
 [ 2.62756404e-02 -1.72581188e-02  2.98360474e-02]
 [ 2.50771176e-02 -2.22039036e-02  3.11262310e-02]
 [ 2.72612479e-02 -1.22433817e-02  2.86453441e-02]
 [ 2.50771176e-02 -2.22039036e-02  3.11262310e-02]
 [ 3.47004235e-02 -3.21665630e-02  2.58240625e-02]
 [ 3.47004235e-02 -3.21665630e-02  2.58240625e-02]
 [ 3.73038761e-02 -2.81248949e-02  2.40532383e-02]
 [ 3.05525903e-02 -2.76388191e-02  2.82732472e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [-4.76201810e-03  1.32229058e-02 -5.20988777e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [ 1.92582980e-03  1.53897880e-02 -4.89906184e-02]
 [ 5.13252802e-04  1.11735882e-02 -5.17528169e-02]
 [ 1.92582980e-03  1.53897880e-02 -4.89906184e-02]
 [-1.80230681e-02  5.65745421e-02 -5.13944961e-03]
 [-1.47131719e-02  6.14547245e-02 -1.69412140e-03]
 [-1.53263491e-02  6.35918453e-02 -6.64778799e-03]
 [-1.80230681e-02  5.65745421e-02 -5.13944961e-03]
 [-1.80230681e-02  5.65745421e-02 -5.13944961e-03]
 [-1.47131719e-02  6.14547245e-02 -1.69412140e-03]
 [-1.53263491e-02  6.35918453e-02 -6.64778799e-03]
 [-1.11533850e-02  5.67825250e-02 -4.13363986e-03]
 [ 1.13521256e-02 -2.18139309e-02  3.91830765e-02]
 [ 1.99036598e-02  6.78175762e-02 -3.91368642e-02]
 [ 1.57318860e-02  6.85068816e-02 -4.44661491e-02]
 [ 1.52072059e-02  6.57701418e-02 -3.94339636e-02]
 [ 2.01410018e-02  7.28927478e-02 -4.88133617e-02]
 [-7.68133104e-02 -5.55039793e-02  2.23633740e-02]
 [-7.69840106e-02 -6.24925718e-02  2.18289271e-02]
 [-7.68133104e-02 -5.55039793e-02  2.23633740e-02]
 [-7.69840106e-02 -6.24925718e-02  2.18289271e-02]
 [-7.68133104e-02 -5.55039793e-02  2.23633740e-02]
 [ 2.33052522e-02 -9.80237033e-03  2.80761719e-02]
 [ 2.33052522e-02 -9.80237033e-03  2.80761719e-02]
 [ 2.33052522e-02 -9.80237033e-03  2.80761719e-02]
 [ 4.11174297e-02  1.55939814e-02  1.43207647e-02]
 [ 4.11174297e-02  1.55939814e-02  1.43207647e-02]
 [ 1.02286590e-02 -3.35550029e-03  3.59229445e-02]
 [ 1.05560869e-02  3.59000359e-03  3.68257686e-02]
 [ 5.18865511e-03  1.66689325e-03  3.67516428e-02]
 [ 5.18865511e-03  1.66689325e-03  3.67516428e-02]
 [ 2.81026587e-05  5.68556599e-04  3.62817198e-02]
 [ 4.63017542e-03 -5.34183439e-03  3.63011882e-02]
 [ 4.11926676e-03 -2.36198045e-02  2.65490934e-02]
 [ 7.85461627e-04 -2.05848422e-02  2.93851458e-02]
 [ 7.85461627e-04 -2.05848422e-02  2.93851458e-02]
 [ 2.73418091e-02 -1.22795692e-02  2.42850687e-02]
 [ 2.33052522e-02 -9.80237033e-03  2.80761719e-02]
 [ 2.78281905e-02 -5.79919294e-03  2.53992267e-02]
 [ 2.73418091e-02 -1.22795692e-02  2.42850687e-02]
 [-6.23507332e-03 -2.12782118e-02  2.82877386e-02]
 [-7.90209323e-03 -2.47937422e-02  2.48785987e-02]
 [-1.33178486e-02 -2.12318171e-02  2.63590999e-02]
 [-6.23507332e-03 -2.12782118e-02  2.82877386e-02]
 [-9.03943181e-03 -1.71554461e-02  3.00550908e-02]
 [-9.03943181e-03 -1.71554461e-02  3.00550908e-02]
 [-1.33178486e-02 -2.12318171e-02  2.63590999e-02]
 [ 7.19733629e-03 -1.05957445e-02  3.48904058e-02]
 [ 1.02286590e-02 -3.35550029e-03  3.59229445e-02]
 [-2.32788734e-04 -1.20175024e-02  3.39765362e-02]
 [ 7.19733629e-03 -1.05957445e-02  3.48904058e-02]
 [ 1.30365165e-02 -8.06783326e-03  3.41222733e-02]
 [ 1.02286590e-02 -3.35550029e-03  3.59229445e-02]
 [ 7.19733629e-03 -1.05957445e-02  3.48904058e-02]
 [ 1.30365165e-02 -8.06783326e-03  3.41222733e-02]
 [ 1.30365165e-02 -8.06783326e-03  3.41222733e-02]
 [ 5.18865511e-03  1.66689325e-03  3.67516428e-02]
 [ 5.18865511e-03  1.66689325e-03  3.67516428e-02]
 [ 1.05560869e-02  3.59000359e-03  3.68257686e-02]
 [ 1.05560869e-02  3.59000359e-03  3.68257686e-02]
 [ 5.18865511e-03  1.66689325e-03  3.67516428e-02]
 [ 4.63017542e-03 -5.34183439e-03  3.63011882e-02]
 [ 1.05560869e-02  3.59000359e-03  3.68257686e-02]
 [-9.03943181e-03 -1.71554461e-02  3.00550908e-02]
 [-1.57587789e-02 -1.67375393e-02  2.79606245e-02]
 [ 1.02286590e-02 -3.35550029e-03  3.59229445e-02]
 [-7.69840106e-02 -6.24925718e-02  2.18289271e-02]
 [-6.67667910e-02 -5.29772714e-02  2.13835482e-02]
 [-6.55675679e-02 -5.82411513e-02  2.21449900e-02]
 [-6.10906295e-02 -5.25552481e-02  1.92178637e-02]
 [-6.67667910e-02 -5.29772714e-02  2.13835482e-02]
 [-6.55675679e-02 -5.82411513e-02  2.21449900e-02]
 [-6.10906295e-02 -5.25552481e-02  1.92178637e-02]
 [-6.55675679e-02 -5.82411513e-02  2.21449900e-02]
 [ 2.04530843e-02  1.23444684e-02  3.57210822e-02]
 [ 7.85461627e-04 -2.05848422e-02  2.93851458e-02]
 [-2.09621619e-03 -1.69090591e-02  3.16933244e-02]
 [-8.05386342e-04 -2.43557915e-02  2.60677282e-02]
 [ 1.30365165e-02 -8.06783326e-03  3.41222733e-02]
 [ 1.02286590e-02 -3.35550029e-03  3.59229445e-02]
 [ 1.30365165e-02 -8.06783326e-03  3.41222733e-02]
 [ 1.04185790e-02 -1.41493529e-02  3.23521420e-02]
 [ 2.04530843e-02  1.23444684e-02  3.57210822e-02]
 [ 2.48675235e-02  1.04694776e-02  3.14074382e-02]
 [ 2.48675235e-02  1.04694776e-02  3.14074382e-02]
 [ 2.04530843e-02  1.23444684e-02  3.57210822e-02]
 [-1.33178486e-02 -2.12318171e-02  2.63590999e-02]
 [-6.55675679e-02 -5.82411513e-02  2.21449900e-02]
 [-6.67667910e-02 -5.29772714e-02  2.13835482e-02]
 [-6.55675679e-02 -5.82411513e-02  2.21449900e-02]
 [-6.10906295e-02 -5.25552481e-02  1.92178637e-02]
 [-6.10906295e-02 -5.25552481e-02  1.92178637e-02]
 [ 1.64050870e-02 -3.09753790e-03  3.38838473e-02]
 [ 2.73418091e-02 -1.22795692e-02  2.42850687e-02]
 [ 2.41862722e-02 -1.86489969e-02  2.28334442e-02]
 [ 1.68982856e-02  3.68679687e-03  3.47822011e-02]
 [ 2.06143707e-02  7.21885450e-03  3.36463749e-02]
 [ 1.64050870e-02 -3.09753790e-03  3.38838473e-02]
 [ 2.02020891e-02 -1.32741407e-04  3.22426781e-02]
 [ 2.02020891e-02 -1.32741407e-04  3.22426781e-02]
 [ 2.06143707e-02  7.21885450e-03  3.36463749e-02]
 [ 1.68982856e-02  3.68679687e-03  3.47822011e-02]
 [ 2.44330727e-02  3.94119881e-03  3.00677940e-02]
 [ 1.68982856e-02  3.68679687e-03  3.47822011e-02]
 [ 2.06143707e-02  7.21885450e-03  3.36463749e-02]
 [ 1.42105380e-02 -1.90977510e-02  2.79659815e-02]
 [ 1.64339840e-02 -1.39387464e-02  3.03175598e-02]
 [ 1.64339840e-02 -1.39387464e-02  3.03175598e-02]
 [ 8.05868022e-03 -2.85144038e-02 -5.59407435e-02]
 [ 7.19733629e-03 -1.05957445e-02  3.48904058e-02]
 [ 7.19733629e-03 -1.05957445e-02  3.48904058e-02]
 [ 2.78281905e-02 -5.79919294e-03  2.53992267e-02]
 [-6.41721487e-02 -6.44634962e-02  2.46111806e-02]
 [-5.99385090e-02 -5.78743443e-02  1.99156273e-02]
 [-5.90618700e-02 -6.20791093e-02  2.25384831e-02]
 [-6.41721487e-02 -6.44634962e-02  2.46111806e-02]
 [-5.99385090e-02 -5.78743443e-02  1.99156273e-02]
 [-5.90618700e-02 -6.20791093e-02  2.25384831e-02]
 [-5.99385090e-02 -5.78743443e-02  1.99156273e-02]
 [-7.25220703e-03 -1.22654671e-02  3.24280448e-02]
 [-7.25220703e-03 -1.22654671e-02  3.24280448e-02]
 [-2.60195322e-03 -6.24299049e-03  3.48587520e-02]
 [-7.25220703e-03 -1.22654671e-02  3.24280448e-02]
 [ 1.64339840e-02 -1.39387464e-02  3.03175598e-02]
 [ 3.91042866e-02  8.64407327e-03  6.07468747e-03]
 [ 4.30899672e-02  1.56594422e-02  8.96062609e-03]
 [ 3.94978635e-02  1.09903133e-02  1.17152818e-02]
 [ 3.91042866e-02  8.64407327e-03  6.07468747e-03]
 [ 4.30899672e-02  1.56594422e-02  8.96062609e-03]
 [ 3.94978635e-02  1.09903133e-02  1.17152818e-02]
 [ 3.91042866e-02  8.64407327e-03  6.07468747e-03]
 [ 4.31473032e-02  1.47736873e-02  3.26889334e-03]
 [ 3.78276594e-02  7.96637405e-03 -8.46774317e-04]
 [-6.41721487e-02 -6.44634962e-02  2.46111806e-02]
 [-5.99385090e-02 -5.78743443e-02  1.99156273e-02]
 [-6.41721487e-02 -6.44634962e-02  2.46111806e-02]
 [-5.99385090e-02 -5.78743443e-02  1.99156273e-02]
 [-6.41721487e-02 -6.44634962e-02  2.46111806e-02]
 [ 1.64050870e-02 -3.09753790e-03  3.38838473e-02]
 [ 2.02020891e-02 -1.32741407e-04  3.22426781e-02]
 [-7.25220703e-03 -1.22654671e-02  3.24280448e-02]
 [-2.60195322e-03 -6.24299049e-03  3.48587520e-02]
 [-9.42813046e-03 -5.82767185e-03  3.27219628e-02]
 [-1.19673144e-02  1.75558962e-04  3.34223770e-02]
 [-9.42813046e-03 -5.82767185e-03  3.27219628e-02]
 [-1.19673144e-02  1.75558962e-04  3.34223770e-02]
 [-7.25220703e-03 -1.22654671e-02  3.24280448e-02]
 [-7.25220703e-03 -1.22654671e-02  3.24280448e-02]
 [-2.60195322e-03 -6.24299049e-03  3.48587520e-02]
 [ 2.06143707e-02  7.21885450e-03  3.36463749e-02]
 [ 1.68982856e-02  3.68679687e-03  3.47822011e-02]]
len(transformed_superpoints_pcd) :  318
copy_superpoint_src_corr_points.shape :  (15549, 3)
mask.shape :  (15549,)
copy_superpoint_src_corr_points.shape :  (13476, 3)
copy_superpoint_ref_corr_points.shape :  (13476, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13476, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 13476, 3])
batch_inlier_masks.shape :  torch.Size([1999, 13476])
best_index :  479
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13476, 3)
transformed_src_superpoints.shape :  torch.Size([13476, 3])
residual.shape :  torch.Size([13476])
batch_inlier_masks.shape :  torch.Size([13476])
batch_outlier_masks.shape :  torch.Size([13476])
indices_inliers.shape :  torch.Size([122])
indices_outliers.shape :  torch.Size([13354])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([122, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.014642   -0.00301827  0.03627304]
 [-0.01523987 -0.01249671  0.03601517]
 [-0.014642   -0.00301827  0.03627304]]
len(transformed_superpoints_pcd) :  440
copy_superpoint_src_corr_points.shape :  (13354, 3)
mask.shape :  (13354,)
copy_superpoint_src_corr_points.shape :  (11818, 3)
copy_superpoint_ref_corr_points.shape :  (11818, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([11818, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 11818, 3])
batch_inlier_masks.shape :  torch.Size([1999, 11818])
best_index :  1204
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (11818, 3)
transformed_src_superpoints.shape :  torch.Size([11818, 3])
residual.shape :  torch.Size([11818])
batch_inlier_masks.shape :  torch.Size([11818])
batch_outlier_masks.shape :  torch.Size([11818])
indices_inliers.shape :  torch.Size([94])
indices_outliers.shape :  torch.Size([11724])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([94, 3])
transformed_superpoints_pcd :  [[-1.4713172e-02  6.1454725e-02 -1.6941214e-03]
 [-1.5326349e-02  6.3591845e-02 -6.6477880e-03]
 [-1.4713172e-02  6.1454725e-02 -1.6941214e-03]
 ...
 [-1.4278304e-02  6.9982573e-02  4.7348440e-05]
 [-6.1269365e-03  8.3085917e-02  1.0209978e-02]
 [-4.0669702e-03  7.7376813e-02  7.7274293e-03]]
len(transformed_superpoints_pcd) :  534
copy_superpoint_src_corr_points.shape :  (11724, 3)
mask.shape :  (11724,)
copy_superpoint_src_corr_points.shape :  (9679, 3)
copy_superpoint_ref_corr_points.shape :  (9679, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9679, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 9679, 3])
batch_inlier_masks.shape :  torch.Size([1999, 9679])
best_index :  1328
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9679, 3)
transformed_src_superpoints.shape :  torch.Size([9679, 3])
residual.shape :  torch.Size([9679])
batch_inlier_masks.shape :  torch.Size([9679])
batch_outlier_masks.shape :  torch.Size([9679])
indices_inliers.shape :  torch.Size([64])
indices_outliers.shape :  torch.Size([9615])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([64, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.00209349 -0.01685338  0.03772908]
 [ 0.01822525 -0.01274394  0.03682772]
 [ 0.01822525 -0.01274394  0.03682772]]
len(transformed_superpoints_pcd) :  598
copy_superpoint_src_corr_points.shape :  (9615, 3)
mask.shape :  (9615,)
copy_superpoint_src_corr_points.shape :  (8752, 3)
copy_superpoint_ref_corr_points.shape :  (8752, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8752, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 8752, 3])
batch_inlier_masks.shape :  torch.Size([1999, 8752])
best_index :  32
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8752, 3)
transformed_src_superpoints.shape :  torch.Size([8752, 3])
residual.shape :  torch.Size([8752])
batch_inlier_masks.shape :  torch.Size([8752])
batch_outlier_masks.shape :  torch.Size([8752])
indices_inliers.shape :  torch.Size([59])
indices_outliers.shape :  torch.Size([8693])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([59, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.01182587  0.08346984  0.00783747]
 [ 0.03764383  0.02676302 -0.02226697]
 [ 0.02504605  0.03486893 -0.02868399]]
len(transformed_superpoints_pcd) :  657
copy_superpoint_src_corr_points.shape :  (8693, 3)
mask.shape :  (8693,)
copy_superpoint_src_corr_points.shape :  (6597, 3)
copy_superpoint_ref_corr_points.shape :  (6597, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6597, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 6597, 3])
batch_inlier_masks.shape :  torch.Size([1999, 6597])
best_index :  1472
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6597, 3)
transformed_src_superpoints.shape :  torch.Size([6597, 3])
residual.shape :  torch.Size([6597])
batch_inlier_masks.shape :  torch.Size([6597])
batch_outlier_masks.shape :  torch.Size([6597])
indices_inliers.shape :  torch.Size([47])
indices_outliers.shape :  torch.Size([6550])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([47, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00778205  0.08272336  0.00783829]
 [ 0.02390331 -0.03049006 -0.01960044]
 [ 0.02011744 -0.03486017 -0.0212847 ]]
len(transformed_superpoints_pcd) :  704
copy_superpoint_src_corr_points.shape :  (6550, 3)
mask.shape :  (6550,)
copy_superpoint_src_corr_points.shape :  (6044, 3)
copy_superpoint_ref_corr_points.shape :  (6044, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6044, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 6044, 3])
batch_inlier_masks.shape :  torch.Size([1999, 6044])
best_index :  1707
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6044, 3)
transformed_src_superpoints.shape :  torch.Size([6044, 3])
residual.shape :  torch.Size([6044])
batch_inlier_masks.shape :  torch.Size([6044])
batch_outlier_masks.shape :  torch.Size([6044])
indices_inliers.shape :  torch.Size([47])
indices_outliers.shape :  torch.Size([5997])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([47, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00560316  0.07375291  0.00602447]
 [-0.00799496  0.07905146  0.00678628]
 [ 0.01811087 -0.0332858  -0.00783247]]
len(transformed_superpoints_pcd) :  751
copy_superpoint_src_corr_points.shape :  (5997, 3)
mask.shape :  (5997,)
copy_superpoint_src_corr_points.shape :  (5334, 3)
copy_superpoint_ref_corr_points.shape :  (5334, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5334, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 5334, 3])
batch_inlier_masks.shape :  torch.Size([1999, 5334])
best_index :  972
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5334, 3)
transformed_src_superpoints.shape :  torch.Size([5334, 3])
residual.shape :  torch.Size([5334])
batch_inlier_masks.shape :  torch.Size([5334])
batch_outlier_masks.shape :  torch.Size([5334])
indices_inliers.shape :  torch.Size([45])
indices_outliers.shape :  torch.Size([5289])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([45, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.05012169 -0.08205482 -0.01710444]
 [ 0.04852419 -0.08505123 -0.01267249]
 [ 0.04417571 -0.08479831 -0.01543141]]
len(transformed_superpoints_pcd) :  796
copy_superpoint_src_corr_points.shape :  (5289, 3)
mask.shape :  (5289,)
copy_superpoint_src_corr_points.shape :  (5086, 3)
copy_superpoint_ref_corr_points.shape :  (5086, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5086, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 5086, 3])
batch_inlier_masks.shape :  torch.Size([1999, 5086])
best_index :  64
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5086, 3)
transformed_src_superpoints.shape :  torch.Size([5086, 3])
residual.shape :  torch.Size([5086])
batch_inlier_masks.shape :  torch.Size([5086])
batch_outlier_masks.shape :  torch.Size([5086])
indices_inliers.shape :  torch.Size([41])
indices_outliers.shape :  torch.Size([5045])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([41, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.03711092 -0.08031149 -0.01571624]
 [ 0.04193586 -0.08175759 -0.01811119]
 [ 0.04584966 -0.08315321 -0.01487524]]
len(transformed_superpoints_pcd) :  837
copy_superpoint_src_corr_points.shape :  (5045, 3)
mask.shape :  (5045,)
copy_superpoint_src_corr_points.shape :  (4917, 3)
copy_superpoint_ref_corr_points.shape :  (4917, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4917, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 4917, 3])
batch_inlier_masks.shape :  torch.Size([1999, 4917])
best_index :  1356
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4917, 3)
transformed_src_superpoints.shape :  torch.Size([4917, 3])
residual.shape :  torch.Size([4917])
batch_inlier_masks.shape :  torch.Size([4917])
batch_outlier_masks.shape :  torch.Size([4917])
indices_inliers.shape :  torch.Size([40])
indices_outliers.shape :  torch.Size([4877])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([40, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.07334096 -0.06439353  0.0315749 ]
 [-0.06843518 -0.06497809  0.02435596]
 [-0.06839575 -0.06873737  0.03504754]]
len(transformed_superpoints_pcd) :  877
copy_superpoint_src_corr_points.shape :  (4877, 3)
mask.shape :  (4877,)
copy_superpoint_src_corr_points.shape :  (4767, 3)
copy_superpoint_ref_corr_points.shape :  (4767, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4767, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 4767, 3])
batch_inlier_masks.shape :  torch.Size([1999, 4767])
best_index :  1453
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4767, 3)
transformed_src_superpoints.shape :  torch.Size([4767, 3])
residual.shape :  torch.Size([4767])
batch_inlier_masks.shape :  torch.Size([4767])
batch_outlier_masks.shape :  torch.Size([4767])
indices_inliers.shape :  torch.Size([39])
indices_outliers.shape :  torch.Size([4728])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([39, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02361503 -0.02661965  0.02996691]
 [ 0.01835974 -0.02782318  0.03058168]
 [ 0.03704061  0.00251125  0.02388326]]
len(transformed_superpoints_pcd) :  916
copy_superpoint_src_corr_points.shape :  (4728, 3)
mask.shape :  (4728,)
copy_superpoint_src_corr_points.shape :  (4255, 3)
copy_superpoint_ref_corr_points.shape :  (4255, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4255, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 4255, 3])
batch_inlier_masks.shape :  torch.Size([1999, 4255])
best_index :  393
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4255, 3)
transformed_src_superpoints.shape :  torch.Size([4255, 3])
residual.shape :  torch.Size([4255])
batch_inlier_masks.shape :  torch.Size([4255])
batch_outlier_masks.shape :  torch.Size([4255])
indices_inliers.shape :  torch.Size([34])
indices_outliers.shape :  torch.Size([4221])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([34, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.01189264  0.08325914  0.00422105]
 [-0.00663684  0.07846442  0.00637021]
 [-0.00663684  0.07846442  0.00637021]]
len(transformed_superpoints_pcd) :  950
copy_superpoint_src_corr_points.shape :  (4221, 3)
mask.shape :  (4221,)
copy_superpoint_src_corr_points.shape :  (3852, 3)
copy_superpoint_ref_corr_points.shape :  (3852, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3852, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 3852, 3])
batch_inlier_masks.shape :  torch.Size([1999, 3852])
best_index :  1325
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3852, 3)
transformed_src_superpoints.shape :  torch.Size([3852, 3])
residual.shape :  torch.Size([3852])
batch_inlier_masks.shape :  torch.Size([3852])
batch_outlier_masks.shape :  torch.Size([3852])
indices_inliers.shape :  torch.Size([32])
indices_outliers.shape :  torch.Size([3820])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([32, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00250195  0.06308293 -0.0082166 ]
 [-0.00534552  0.07226753 -0.00418244]
 [-0.00423667  0.07963412 -0.00199354]]
len(transformed_superpoints_pcd) :  982
copy_superpoint_src_corr_points.shape :  (3820, 3)
mask.shape :  (3820,)
copy_superpoint_src_corr_points.shape :  (3412, 3)
copy_superpoint_ref_corr_points.shape :  (3412, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3412, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 3412, 3])
batch_inlier_masks.shape :  torch.Size([1999, 3412])
best_index :  1168
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3412, 3)
transformed_src_superpoints.shape :  torch.Size([3412, 3])
residual.shape :  torch.Size([3412])
batch_inlier_masks.shape :  torch.Size([3412])
batch_outlier_masks.shape :  torch.Size([3412])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([3381])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.03445357 -0.01646908  0.02860578]
 [ 0.03768676 -0.01997     0.02670727]
 [ 0.02939209 -0.01579469  0.02830197]]
len(transformed_superpoints_pcd) :  1013
copy_superpoint_src_corr_points.shape :  (3381, 3)
mask.shape :  (3381,)
copy_superpoint_src_corr_points.shape :  (3148, 3)
copy_superpoint_ref_corr_points.shape :  (3148, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3148, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 3148, 3])
batch_inlier_masks.shape :  torch.Size([1999, 3148])
best_index :  1614
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3148, 3)
transformed_src_superpoints.shape :  torch.Size([3148, 3])
residual.shape :  torch.Size([3148])
batch_inlier_masks.shape :  torch.Size([3148])
batch_outlier_masks.shape :  torch.Size([3148])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([3120])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00179457  0.07538889  0.00627072]
 [ 0.00330934  0.07861196  0.00673877]
 [ 0.00330934  0.07861196  0.00673877]]
len(transformed_superpoints_pcd) :  1041
copy_superpoint_src_corr_points.shape :  (3120, 3)
mask.shape :  (3120,)
copy_superpoint_src_corr_points.shape :  (2786, 3)
copy_superpoint_ref_corr_points.shape :  (2786, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2786, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 2786, 3])
batch_inlier_masks.shape :  torch.Size([1999, 2786])
best_index :  1228
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2786, 3)
transformed_src_superpoints.shape :  torch.Size([2786, 3])
residual.shape :  torch.Size([2786])
batch_inlier_masks.shape :  torch.Size([2786])
batch_outlier_masks.shape :  torch.Size([2786])
indices_inliers.shape :  torch.Size([27])
indices_outliers.shape :  torch.Size([2759])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([27, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.03644141 -0.07742006  0.02333102]
 [-0.03069052 -0.07492716  0.0264189 ]
 [-0.03644141 -0.07742006  0.02333102]]
len(transformed_superpoints_pcd) :  1068
copy_superpoint_src_corr_points.shape :  (2759, 3)
mask.shape :  (2759,)
copy_superpoint_src_corr_points.shape :  (2521, 3)
copy_superpoint_ref_corr_points.shape :  (2521, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2521, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 2521, 3])
batch_inlier_masks.shape :  torch.Size([1999, 2521])
best_index :  1708
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2521, 3)
transformed_src_superpoints.shape :  torch.Size([2521, 3])
residual.shape :  torch.Size([2521])
batch_inlier_masks.shape :  torch.Size([2521])
batch_outlier_masks.shape :  torch.Size([2521])
indices_inliers.shape :  torch.Size([25])
indices_outliers.shape :  torch.Size([2496])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([25, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.04676103  0.03803056  0.02463115]
 [ 0.03262658 -0.00715318  0.03915701]
 [ 0.02357824 -0.01388193  0.03854813]]
len(transformed_superpoints_pcd) :  1093
copy_superpoint_src_corr_points.shape :  (2496, 3)
mask.shape :  (2496,)
copy_superpoint_src_corr_points.shape :  (2228, 3)
copy_superpoint_ref_corr_points.shape :  (2228, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2228, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 2228, 3])
batch_inlier_masks.shape :  torch.Size([1999, 2228])
best_index :  33
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2228, 3)
transformed_src_superpoints.shape :  torch.Size([2228, 3])
residual.shape :  torch.Size([2228])
batch_inlier_masks.shape :  torch.Size([2228])
batch_outlier_masks.shape :  torch.Size([2228])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([2204])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.03876103 -0.08779356 -0.00366077]
 [ 0.0423494  -0.08434185 -0.00837201]
 [ 0.03876103 -0.08779356 -0.00366077]]
len(transformed_superpoints_pcd) :  1117
copy_superpoint_src_corr_points.shape :  (2204, 3)
mask.shape :  (2204,)
copy_superpoint_src_corr_points.shape :  (2090, 3)
copy_superpoint_ref_corr_points.shape :  (2090, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2090, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 2090, 3])
batch_inlier_masks.shape :  torch.Size([1999, 2090])
best_index :  417
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2090, 3)
transformed_src_superpoints.shape :  torch.Size([2090, 3])
residual.shape :  torch.Size([2090])
batch_inlier_masks.shape :  torch.Size([2090])
batch_outlier_masks.shape :  torch.Size([2090])
indices_inliers.shape :  torch.Size([23])
indices_outliers.shape :  torch.Size([2067])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([23, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.0252624  -0.00266495  0.039111  ]
 [ 0.02066669 -0.004753    0.03620156]
 [ 0.01938142  0.00184524  0.03546716]]
len(transformed_superpoints_pcd) :  1140
copy_superpoint_src_corr_points.shape :  (2067, 3)
mask.shape :  (2067,)
copy_superpoint_src_corr_points.shape :  (1977, 3)
copy_superpoint_ref_corr_points.shape :  (1977, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1977, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1977, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1977])
best_index :  3
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1977, 3)
transformed_src_superpoints.shape :  torch.Size([1977, 3])
residual.shape :  torch.Size([1977])
batch_inlier_masks.shape :  torch.Size([1977])
batch_outlier_masks.shape :  torch.Size([1977])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([1955])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02336731 -0.03160609 -0.01415474]
 [ 0.00900666  0.02281247 -0.0427294 ]
 [ 0.02972908 -0.02560499 -0.00120922]]
len(transformed_superpoints_pcd) :  1162
copy_superpoint_src_corr_points.shape :  (1955, 3)
mask.shape :  (1955,)
copy_superpoint_src_corr_points.shape :  (1674, 3)
copy_superpoint_ref_corr_points.shape :  (1674, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1674, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1674, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1674])
best_index :  1216
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1674, 3)
transformed_src_superpoints.shape :  torch.Size([1674, 3])
residual.shape :  torch.Size([1674])
batch_inlier_masks.shape :  torch.Size([1674])
batch_outlier_masks.shape :  torch.Size([1674])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([1654])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.073659   -0.0530493   0.02365628]
 [-0.08218161 -0.058358    0.0221707 ]
 [-0.073659   -0.0530493   0.02365628]]
len(transformed_superpoints_pcd) :  1182
copy_superpoint_src_corr_points.shape :  (1654, 3)
mask.shape :  (1654,)
copy_superpoint_src_corr_points.shape :  (1544, 3)
copy_superpoint_ref_corr_points.shape :  (1544, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1544, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1544, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1544])
best_index :  1520
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1544, 3)
transformed_src_superpoints.shape :  torch.Size([1544, 3])
residual.shape :  torch.Size([1544])
batch_inlier_masks.shape :  torch.Size([1544])
batch_outlier_masks.shape :  torch.Size([1544])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([1524])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00799578 -0.02475406  0.03574095]
 [-0.00799578 -0.02475406  0.03574095]
 [-0.00280776 -0.02788482  0.0343228 ]]
len(transformed_superpoints_pcd) :  1202
copy_superpoint_src_corr_points.shape :  (1524, 3)
mask.shape :  (1524,)
copy_superpoint_src_corr_points.shape :  (1298, 3)
copy_superpoint_ref_corr_points.shape :  (1298, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1298, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1298, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1298])
best_index :  725
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1298, 3)
transformed_src_superpoints.shape :  torch.Size([1298, 3])
residual.shape :  torch.Size([1298])
batch_inlier_masks.shape :  torch.Size([1298])
batch_outlier_masks.shape :  torch.Size([1298])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([1280])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02907799 -0.0335063  -0.02262691]
 [ 0.0319362  -0.04226993 -0.02173856]
 [ 0.02392725 -0.03054257  0.02278354]]
len(transformed_superpoints_pcd) :  1220
copy_superpoint_src_corr_points.shape :  (1280, 3)
mask.shape :  (1280,)
copy_superpoint_src_corr_points.shape :  (1152, 3)
copy_superpoint_ref_corr_points.shape :  (1152, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1152, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1152, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1152])
best_index :  696
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1152, 3)
transformed_src_superpoints.shape :  torch.Size([1152, 3])
residual.shape :  torch.Size([1152])
batch_inlier_masks.shape :  torch.Size([1152])
batch_outlier_masks.shape :  torch.Size([1152])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1136])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.05834441  0.05633222  0.07059489]
 [ 0.06186856  0.05267853  0.07116877]
 [ 0.0576778   0.05687751  0.07910112]]
len(transformed_superpoints_pcd) :  1236
copy_superpoint_src_corr_points.shape :  (1136, 3)
mask.shape :  (1136,)
copy_superpoint_src_corr_points.shape :  (1085, 3)
copy_superpoint_ref_corr_points.shape :  (1085, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1085, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1085, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1085])
best_index :  1777
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1085, 3)
transformed_src_superpoints.shape :  torch.Size([1085, 3])
residual.shape :  torch.Size([1085])
batch_inlier_masks.shape :  torch.Size([1085])
batch_outlier_masks.shape :  torch.Size([1085])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1069])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.02680067  0.02923448  0.00301946]
 [-0.02611617  0.02430019  0.0068328 ]
 [-0.02680067  0.02923448  0.00301946]]
len(transformed_superpoints_pcd) :  1252
copy_superpoint_src_corr_points.shape :  (1069, 3)
mask.shape :  (1069,)
copy_superpoint_src_corr_points.shape :  (1017, 3)
copy_superpoint_ref_corr_points.shape :  (1017, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1017, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1017, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1017])
best_index :  1955
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1017, 3)
transformed_src_superpoints.shape :  torch.Size([1017, 3])
residual.shape :  torch.Size([1017])
batch_inlier_masks.shape :  torch.Size([1017])
batch_outlier_masks.shape :  torch.Size([1017])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1001])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.0280467  -0.05018613  0.01077745]
 [ 0.02294284 -0.04402844  0.00864105]
 [ 0.0280467  -0.05018613  0.01077745]]
len(transformed_superpoints_pcd) :  1268
copy_superpoint_src_corr_points.shape :  (1001, 3)
mask.shape :  (1001,)
copy_superpoint_src_corr_points.shape :  (843, 3)
copy_superpoint_ref_corr_points.shape :  (843, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([843, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 843, 3])
batch_inlier_masks.shape :  torch.Size([1999, 843])
best_index :  1997
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (843, 3)
transformed_src_superpoints.shape :  torch.Size([843, 3])
residual.shape :  torch.Size([843])
batch_inlier_masks.shape :  torch.Size([843])
batch_outlier_masks.shape :  torch.Size([843])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([827])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.0443159   0.00816064  0.0048377 ]
 [-0.03716307  0.01192599  0.01166546]
 [-0.0443159   0.00816064  0.0048377 ]]
len(transformed_superpoints_pcd) :  1284
copy_superpoint_src_corr_points.shape :  (827, 3)
mask.shape :  (827,)
copy_superpoint_src_corr_points.shape :  (801, 3)
copy_superpoint_ref_corr_points.shape :  (801, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([801, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 801, 3])
batch_inlier_masks.shape :  torch.Size([1999, 801])
best_index :  1936
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (801, 3)
transformed_src_superpoints.shape :  torch.Size([801, 3])
residual.shape :  torch.Size([801])
batch_inlier_masks.shape :  torch.Size([801])
batch_outlier_masks.shape :  torch.Size([801])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([787])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02512351 -0.01788216 -0.02727062]
 [ 0.02466315 -0.02271647 -0.02395628]
 [ 0.02745715 -0.01805107 -0.02278075]]
len(transformed_superpoints_pcd) :  1298
copy_superpoint_src_corr_points.shape :  (787, 3)
mask.shape :  (787,)
copy_superpoint_src_corr_points.shape :  (758, 3)
copy_superpoint_ref_corr_points.shape :  (758, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([758, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 758, 3])
batch_inlier_masks.shape :  torch.Size([1999, 758])
best_index :  1237
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (758, 3)
transformed_src_superpoints.shape :  torch.Size([758, 3])
residual.shape :  torch.Size([758])
batch_inlier_masks.shape :  torch.Size([758])
batch_outlier_masks.shape :  torch.Size([758])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([746])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.0133008  -0.01281372  0.0375396 ]
 [-0.01681461 -0.0102911   0.03385545]
 [-0.02068101 -0.01273462  0.0306633 ]]
len(transformed_superpoints_pcd) :  1310
copy_superpoint_src_corr_points.shape :  (746, 3)
mask.shape :  (746,)
copy_superpoint_src_corr_points.shape :  (651, 3)
copy_superpoint_ref_corr_points.shape :  (651, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([651, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 651, 3])
batch_inlier_masks.shape :  torch.Size([1999, 651])
best_index :  1452
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (651, 3)
transformed_src_superpoints.shape :  torch.Size([651, 3])
residual.shape :  torch.Size([651])
batch_inlier_masks.shape :  torch.Size([651])
batch_outlier_masks.shape :  torch.Size([651])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([639])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.00369659  0.06082011  0.00524289]
 [ 0.00369659  0.06082011  0.00524289]
 [ 0.00369659  0.06082011  0.00524289]]
len(transformed_superpoints_pcd) :  1322
copy_superpoint_src_corr_points.shape :  (639, 3)
mask.shape :  (639,)
copy_superpoint_src_corr_points.shape :  (606, 3)
copy_superpoint_ref_corr_points.shape :  (606, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([606, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 606, 3])
batch_inlier_masks.shape :  torch.Size([1999, 606])
best_index :  1798
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (606, 3)
transformed_src_superpoints.shape :  torch.Size([606, 3])
residual.shape :  torch.Size([606])
batch_inlier_masks.shape :  torch.Size([606])
batch_outlier_masks.shape :  torch.Size([606])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([595])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.02492828  0.02524094  0.00490315]
 [-0.03386966  0.02517167  0.00710327]
 [-0.01971842  0.02732555  0.00325934]]
len(transformed_superpoints_pcd) :  1333
copy_superpoint_src_corr_points.shape :  (595, 3)
mask.shape :  (595,)
copy_superpoint_src_corr_points.shape :  (593, 3)
copy_superpoint_ref_corr_points.shape :  (593, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([593, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 593, 3])
batch_inlier_masks.shape :  torch.Size([1999, 593])
best_index :  1944
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (593, 3)
transformed_src_superpoints.shape :  torch.Size([593, 3])
residual.shape :  torch.Size([593])
batch_inlier_masks.shape :  torch.Size([593])
batch_outlier_masks.shape :  torch.Size([593])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([582])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.03141552 -0.02382275 -0.012846  ]
 [ 0.02344022 -0.02961372 -0.01069504]
 [ 0.01714732 -0.0258704  -0.01285337]]
len(transformed_superpoints_pcd) :  1344
copy_superpoint_src_corr_points.shape :  (582, 3)
mask.shape :  (582,)
copy_superpoint_src_corr_points.shape :  (581, 3)
copy_superpoint_ref_corr_points.shape :  (581, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([581, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 581, 3])
batch_inlier_masks.shape :  torch.Size([1999, 581])
best_index :  1032
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (581, 3)
transformed_src_superpoints.shape :  torch.Size([581, 3])
residual.shape :  torch.Size([581])
batch_inlier_masks.shape :  torch.Size([581])
batch_outlier_masks.shape :  torch.Size([581])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([571])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02530556 -0.0068497   0.03489283]
 [ 0.02717641 -0.01164337  0.03459854]
 [ 0.02717641 -0.01164337  0.03459854]]
len(transformed_superpoints_pcd) :  1354
copy_superpoint_src_corr_points.shape :  (571, 3)
mask.shape :  (571,)
copy_superpoint_src_corr_points.shape :  (455, 3)
copy_superpoint_ref_corr_points.shape :  (455, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([455, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 455, 3])
batch_inlier_masks.shape :  torch.Size([1999, 455])
best_index :  695
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (455, 3)
transformed_src_superpoints.shape :  torch.Size([455, 3])
residual.shape :  torch.Size([455])
batch_inlier_masks.shape :  torch.Size([455])
batch_outlier_masks.shape :  torch.Size([455])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([447])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02359385 -0.02319962  0.02736471]
 [ 0.02359385 -0.02319962  0.02736471]
 [ 0.02359385 -0.02319962  0.02736471]]
len(transformed_superpoints_pcd) :  1362
copy_superpoint_src_corr_points.shape :  (447, 3)
mask.shape :  (447,)
copy_superpoint_src_corr_points.shape :  (370, 3)
copy_superpoint_ref_corr_points.shape :  (370, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([370, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 370, 3])
batch_inlier_masks.shape :  torch.Size([1999, 370])
best_index :  958
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (370, 3)
transformed_src_superpoints.shape :  torch.Size([370, 3])
residual.shape :  torch.Size([370])
batch_inlier_masks.shape :  torch.Size([370])
batch_outlier_masks.shape :  torch.Size([370])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([362])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.04011536 -0.08688207 -0.0058804 ]
 [ 0.03369371 -0.08146202 -0.01130034]
 [ 0.04011536 -0.08688207 -0.0058804 ]]
len(transformed_superpoints_pcd) :  1370
copy_superpoint_src_corr_points.shape :  (362, 3)
mask.shape :  (362,)
copy_superpoint_src_corr_points.shape :  (323, 3)
copy_superpoint_ref_corr_points.shape :  (323, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([323, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 323, 3])
batch_inlier_masks.shape :  torch.Size([1999, 323])
best_index :  1549
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (323, 3)
transformed_src_superpoints.shape :  torch.Size([323, 3])
residual.shape :  torch.Size([323])
batch_inlier_masks.shape :  torch.Size([323])
batch_outlier_masks.shape :  torch.Size([323])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([315])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02542198 -0.0182086  -0.00874843]
 [ 0.02508295 -0.03027851 -0.01505353]
 [ 0.02810848 -0.03398319 -0.01289883]]
len(transformed_superpoints_pcd) :  1378
copy_superpoint_src_corr_points.shape :  (315, 3)
mask.shape :  (315,)
copy_superpoint_src_corr_points.shape :  (303, 3)
copy_superpoint_ref_corr_points.shape :  (303, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([303, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 303, 3])
batch_inlier_masks.shape :  torch.Size([1999, 303])
best_index :  1082
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (303, 3)
transformed_src_superpoints.shape :  torch.Size([303, 3])
residual.shape :  torch.Size([303])
batch_inlier_masks.shape :  torch.Size([303])
batch_outlier_masks.shape :  torch.Size([303])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([296])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [ 0.02932169 -0.02357747 -0.00910118]
 [ 0.02814654 -0.03235682 -0.01309575]
 [ 0.02814654 -0.03235682 -0.01309575]]
len(transformed_superpoints_pcd) :  1385
copy_superpoint_src_corr_points.shape :  (296, 3)
mask.shape :  (296,)
copy_superpoint_src_corr_points.shape :  (280, 3)
copy_superpoint_ref_corr_points.shape :  (280, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([280, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 280, 3])
batch_inlier_masks.shape :  torch.Size([1999, 280])
best_index :  46
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (280, 3)
transformed_src_superpoints.shape :  torch.Size([280, 3])
residual.shape :  torch.Size([280])
batch_inlier_masks.shape :  torch.Size([280])
batch_outlier_masks.shape :  torch.Size([280])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([274])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00444876  0.08810143  0.00890136]
 [-0.00444876  0.08810143  0.00890136]
 [-0.00444876  0.08810143  0.00890136]]
len(transformed_superpoints_pcd) :  1391
copy_superpoint_src_corr_points.shape :  (274, 3)
mask.shape :  (274,)
copy_superpoint_src_corr_points.shape :  (229, 3)
copy_superpoint_ref_corr_points.shape :  (229, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([229, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 229, 3])
batch_inlier_masks.shape :  torch.Size([1999, 229])
best_index :  407
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (229, 3)
transformed_src_superpoints.shape :  torch.Size([229, 3])
residual.shape :  torch.Size([229])
batch_inlier_masks.shape :  torch.Size([229])
batch_outlier_masks.shape :  torch.Size([229])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([223])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00813012  0.0766767   0.00575703]
 [-0.00813012  0.0766767   0.00575703]
 [-0.02380547  0.07470883  0.00187605]]
len(transformed_superpoints_pcd) :  1397
copy_superpoint_src_corr_points.shape :  (223, 3)
mask.shape :  (223,)
copy_superpoint_src_corr_points.shape :  (172, 3)
copy_superpoint_ref_corr_points.shape :  (172, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([172, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 172, 3])
batch_inlier_masks.shape :  torch.Size([1999, 172])
best_index :  1199
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (172, 3)
transformed_src_superpoints.shape :  torch.Size([172, 3])
residual.shape :  torch.Size([172])
batch_inlier_masks.shape :  torch.Size([172])
batch_outlier_masks.shape :  torch.Size([172])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([166])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00845475  0.07806338  0.00597778]
 [-0.00845475  0.07806338  0.00597778]
 [-0.00845475  0.07806338  0.00597778]]
len(transformed_superpoints_pcd) :  1403
copy_superpoint_src_corr_points.shape :  (166, 3)
mask.shape :  (166,)
copy_superpoint_src_corr_points.shape :  (154, 3)
copy_superpoint_ref_corr_points.shape :  (154, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([154, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 154, 3])
batch_inlier_masks.shape :  torch.Size([1999, 154])
best_index :  1517
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (154, 3)
transformed_src_superpoints.shape :  torch.Size([154, 3])
residual.shape :  torch.Size([154])
batch_inlier_masks.shape :  torch.Size([154])
batch_outlier_masks.shape :  torch.Size([154])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([148])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.01471317  0.06145472 -0.00169412]
 [-0.01532635  0.06359185 -0.00664779]
 [-0.01471317  0.06145472 -0.00169412]
 ...
 [-0.00293612  0.058231   -0.00445658]
 [-0.00293612  0.058231   -0.00445658]
 [-0.00293612  0.058231   -0.00445658]]
len(transformed_superpoints_pcd) :  1409
copy_superpoint_src_corr_points.shape :  (148, 3)
mask.shape :  (148,)
copy_superpoint_src_corr_points.shape :  (93, 3)
copy_superpoint_ref_corr_points.shape :  (93, 3)
number of unique points in pcd :  508
number of rotations used :  42
transformed_superpoints_pcd.shape :  (1502, 3)
Line set updated
068
src_points :  [[-0.11873379  0.02066955  0.0081981 ]
 [-0.11725406  0.0284007   0.0056961 ]
 [-0.1165112   0.03401956  0.0018585 ]
 ...
 [-0.13518697  0.04342483 -0.03128485]
 [-0.04817243  0.12809841 -0.0682807 ]
 [-0.07177265  0.09240962 -0.07218105]]
ref_points :  [[-0.10160817 -0.01574565  0.08431453]
 [-0.09792544 -0.01017031  0.0834567 ]
 [-0.10185779 -0.01110617  0.08012378]
 ...
 [-0.05265435  0.02475315 -0.02351695]
 [-0.02476656  0.15557574 -0.02191376]
 [-0.03149861  0.15319283 -0.02138804]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([9461, 3])
lengths :  tensor([4712, 4749])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([6247, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([1967, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([972, 3])
ref_points_f.shape :  torch.Size([4712, 3])
src_points_c.shape :  torch.Size([995, 3])
src_points_f.shape :  torch.Size([4749, 3])
ref_node_masks.shape :  torch.Size([972])
ref_node_knn_indices.shape :  torch.Size([972, 5])
ref_node_knn_masks.shape :  torch.Size([972, 5])
src_node_masks.shape :  torch.Size([995])
src_node_knn_indices.shape :  torch.Size([995, 5])
src_node_knn_masks.shape :  torch.Size([995, 5])
ref_node_knn_points.shape :  torch.Size([972, 5, 3])
src_node_knn_points.shape :  torch.Size([995, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([1967, 512])
feats_f :  torch.Size([9461, 256])
k :  3
omegas.shape :  torch.Size([944784, 128, 1])
omegas.shape :  torch.Size([2834352, 128, 1])
070
src_points :  [[-0.09018452 -0.01783734  0.01054708]
 [-0.08821688 -0.01096874  0.00950905]
 [-0.08660178 -0.00538846  0.00771961]
 ...
 [-0.0474722   0.00993124 -0.00600572]
 [-0.03832395  0.09077891 -0.00708218]
 [-0.03248176  0.09329899 -0.04338172]]
ref_points :  [[-0.07263461 -0.02150334  0.04890938]
 [-0.05857892  0.06344242  0.00991493]
 [-0.0574179   0.06890942  0.00847932]
 ...
 [-0.02134655  0.11352614 -0.0157148 ]
 [-0.07275729  0.10059097 -0.01297086]
 [-0.03128767  0.05785546 -0.02311348]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([5081, 3])
lengths :  tensor([2531, 2550])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([3144, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([981, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([490, 3])
ref_points_f.shape :  torch.Size([2531, 3])
src_points_c.shape :  torch.Size([491, 3])
src_points_f.shape :  torch.Size([2550, 3])
ref_node_masks.shape :  torch.Size([490])
ref_node_knn_indices.shape :  torch.Size([490, 5])
ref_node_knn_masks.shape :  torch.Size([490, 5])
src_node_masks.shape :  torch.Size([491])
src_node_knn_indices.shape :  torch.Size([491, 5])
src_node_knn_masks.shape :  torch.Size([491, 5])
ref_node_knn_points.shape :  torch.Size([490, 5, 3])
src_node_knn_points.shape :  torch.Size([491, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([981, 512])
feats_f :  torch.Size([5081, 256])
k :  3
omegas.shape :  torch.Size([240100, 128, 1])
omegas.shape :  torch.Size([720300, 128, 1])
k :  3
omegas.shape :  torch.Size([241081, 128, 1])
omegas.shape :  torch.Size([723243, 128, 1])
ref_feats_c.shape :  torch.Size([1, 490, 256])
src_feats_c.shape :  torch.Size([1, 491, 256])
ref_feats_c_norm.shape :  torch.Size([490, 256])
src_feats_c_norm.shape :  torch.Size([491, 256])
ref_node_masks.shape :  torch.Size([490])
src_node_masks.shape :  torch.Size([491])
self.num_correspondences :  2000
matching_scores.numel() :  240590
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([19684])
ref_indices.shape :  torch.Size([19684])
src_indices.shape :  torch.Size([19684])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([1, 1, 2,  ..., 4, 4, 4], device='cuda:0')
src_indices :  tensor([0, 1, 0,  ..., 0, 2, 4], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([19684, 3])
global_src_corr_points.shape :  torch.Size([19684, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([2000, 4, 4])
src_corr_points.shape :  torch.Size([19684, 3])
ref_corr_points.shape :  torch.Size([1, 19684, 3])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 19684, 3])
batch_corr_residuals.shape :  torch.Size([2000, 19684])
batch_inlier_masks.shape :  torch.Size([2000, 19684])
best_index :  tensor(120, device='cuda:0')
len(batch_transforms) :  2000
estimated_transform :  [[ 0.8566796  -0.06646998  0.5115485  -0.00594382]
 [ 0.13059716  0.9873037  -0.09041929 -0.00191361]
 [-0.4990436   0.14426714  0.8544837  -0.00394254]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [1621 1230  332 ...   94  203  120]
superpoint_src_corr_points.shape :  (19684, 3)
superpoint_ref_corr_points.shape :  (19684, 3)
batch_inlier_masks.shape :  (2000, 19684)
batch_transforms.shape :  (2000, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([19684, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 19684, 3])
batch_inlier_masks.shape :  torch.Size([2000, 19684])
best_index :  650
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (19684, 3)
transformed_src_superpoints.shape :  torch.Size([19684, 3])
residual.shape :  torch.Size([19684])
batch_inlier_masks.shape :  torch.Size([19684])
batch_outlier_masks.shape :  torch.Size([19684])
indices_inliers.shape :  torch.Size([148])
indices_outliers.shape :  torch.Size([19536])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([148, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05465731 -0.03833538 -0.00377094]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.05465731 -0.03833538 -0.00377094]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05465731 -0.03833538 -0.00377094]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.0434381  -0.05274384 -0.01368502]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.04130926 -0.05703244 -0.01536836]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.03882699 -0.03770452 -0.01563087]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.04181276 -0.04773374 -0.01465112]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03882699 -0.03770452 -0.01563087]
 [ 0.04416862 -0.03387842 -0.01360344]
 [ 0.03907307 -0.03220528 -0.01571203]
 [ 0.0338189  -0.03966694 -0.0165412 ]
 [ 0.04449043 -0.03929791 -0.01340952]
 [ 0.03907307 -0.03220528 -0.01571203]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.03434903 -0.05730241 -0.01736834]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.04181276 -0.04773374 -0.01465112]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.05522436 -0.04702081 -0.00019384]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.05549556 -0.0596851  -0.00363233]
 [ 0.05549556 -0.0596851  -0.00363233]
 [ 0.05959391 -0.06607674  0.00638815]
 [ 0.05549556 -0.0596851  -0.00363233]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.04130926 -0.05703244 -0.01536836]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.0434381  -0.05274384 -0.01368502]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.04783209 -0.07020354 -0.01441665]
 [ 0.05207425 -0.07241663 -0.01228456]
 [ 0.04669856 -0.07735402 -0.01499675]
 [ 0.05207425 -0.07241663 -0.01228456]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.04181276 -0.04773374 -0.01465112]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.03434903 -0.05730241 -0.01736834]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.03434903 -0.05730241 -0.01736834]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.05232428 -0.03399785 -0.00807688]
 [ 0.0434381  -0.05274384 -0.01368502]
 [ 0.04768689 -0.10601677 -0.00455795]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.04367714  0.05135167  0.04776711]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.03997776  0.0450029   0.04804681]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.03997776  0.0450029   0.04804681]
 [ 0.04698422  0.05494554  0.0533832 ]
 [ 0.04838265  0.04518816  0.06201985]
 [ 0.04838265  0.04518816  0.06201985]
 [ 0.04784995  0.03962641  0.06645438]
 [ 0.07071461 -0.02159151  0.00116683]
 [ 0.07360439 -0.01702153  0.00135719]
 [ 0.07071461 -0.02159151  0.00116683]
 [ 0.07360439 -0.01702153  0.00135719]
 [ 0.06910865 -0.01472281 -0.00195478]
 [ 0.06910865 -0.01472281 -0.00195478]
 [ 0.08309745 -0.01831058  0.00829713]
 [ 0.07982164 -0.02321287  0.00841027]
 [ 0.08554951 -0.02172816  0.01188443]
 [ 0.08977878 -0.02116121  0.0155845 ]
 [ 0.04251401 -0.02733889 -0.01422725]
 [ 0.04217421 -0.08255577 -0.01490392]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.04217421 -0.08255577 -0.01490392]
 [ 0.08554951 -0.02172816  0.01188443]
 [ 0.09236868 -0.01411538  0.01596448]
 [ 0.08903924 -0.01406071  0.01216508]
 [ 0.08799651 -0.00488636  0.00959011]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.04800509  0.05024472  0.05769094]
 [ 0.04800509  0.05024472  0.05769094]
 [ 0.05282879 -0.02842232 -0.00872292]
 [ 0.05232428 -0.03399785 -0.00807688]
 [ 0.05727645 -0.03356415 -0.0032247 ]
 [ 0.05232428 -0.03399785 -0.00807688]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.04783209 -0.07020354 -0.01441665]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.04783209 -0.07020354 -0.01441665]
 [ 0.04217421 -0.08255577 -0.01490392]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.05522436 -0.04702081 -0.00019384]
 [ 0.05749775 -0.03912054  0.00096631]
 [ 0.05522436 -0.04702081 -0.00019384]
 [ 0.05749775 -0.03912054  0.00096631]
 [ 0.04784995  0.03962641  0.06645438]
 [ 0.05229509  0.04560298  0.06575869]
 [ 0.05733779  0.04818347  0.06668119]
 [ 0.04838265  0.04518816  0.06201985]
 [ 0.05209577  0.0508723   0.06135604]
 [ 0.04784995  0.03962641  0.06645438]
 [ 0.02201384 -0.04289596 -0.01490255]]
len(transformed_superpoints_pcd) :  148
copy_superpoint_src_corr_points.shape :  (19536, 3)
mask.shape :  (19536,)
copy_superpoint_src_corr_points.shape :  (16335, 3)
copy_superpoint_ref_corr_points.shape :  (16335, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([16335, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 16335, 3])
batch_inlier_masks.shape :  torch.Size([2000, 16335])
best_index :  784
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (16335, 3)
transformed_src_superpoints.shape :  torch.Size([16335, 3])
residual.shape :  torch.Size([16335])
batch_inlier_masks.shape :  torch.Size([16335])
batch_outlier_masks.shape :  torch.Size([16335])
indices_inliers.shape :  torch.Size([100])
indices_outliers.shape :  torch.Size([16235])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([100, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05465731 -0.03833538 -0.00377094]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.05465731 -0.03833538 -0.00377094]
 [ 0.04944555 -0.04174947 -0.00941597]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05465731 -0.03833538 -0.00377094]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.0434381  -0.05274384 -0.01368502]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.05140094 -0.05312768 -0.00689178]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.04130926 -0.05703244 -0.01536836]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.05198669 -0.06595992 -0.01034422]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.03882699 -0.03770452 -0.01563087]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.04181276 -0.04773374 -0.01465112]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03882699 -0.03770452 -0.01563087]
 [ 0.04416862 -0.03387842 -0.01360344]
 [ 0.03907307 -0.03220528 -0.01571203]
 [ 0.0338189  -0.03966694 -0.0165412 ]
 [ 0.04449043 -0.03929791 -0.01340952]
 [ 0.03907307 -0.03220528 -0.01571203]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.03434903 -0.05730241 -0.01736834]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.04181276 -0.04773374 -0.01465112]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.05522436 -0.04702081 -0.00019384]
 [ 0.05147161 -0.05967963 -0.00856904]
 [ 0.04589047 -0.06419243 -0.01429908]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.05549556 -0.0596851  -0.00363233]
 [ 0.05549556 -0.0596851  -0.00363233]
 [ 0.05959391 -0.06607674  0.00638815]
 [ 0.05549556 -0.0596851  -0.00363233]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.04130926 -0.05703244 -0.01536836]
 [ 0.04617432 -0.05737557 -0.01247963]
 [ 0.0434381  -0.05274384 -0.01368502]
 [ 0.04722773 -0.0500344  -0.01079549]
 [ 0.04783209 -0.07020354 -0.01441665]
 [ 0.05207425 -0.07241663 -0.01228456]
 [ 0.04669856 -0.07735402 -0.01499675]
 [ 0.05207425 -0.07241663 -0.01228456]
 [ 0.04561957 -0.04517685 -0.01207819]
 [ 0.03715713 -0.05086453 -0.01666175]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.04181276 -0.04773374 -0.01465112]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.03434903 -0.05730241 -0.01736834]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.03434903 -0.05730241 -0.01736834]
 [ 0.03390767 -0.0455147  -0.01707867]
 [ 0.05232428 -0.03399785 -0.00807688]
 [ 0.0434381  -0.05274384 -0.01368502]
 [ 0.04768689 -0.10601677 -0.00455795]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.05597842 -0.06588552 -0.00541953]
 [ 0.04367714  0.05135167  0.04776711]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.03997776  0.0450029   0.04804681]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.03997776  0.0450029   0.04804681]
 [ 0.04698422  0.05494554  0.0533832 ]
 [ 0.04838265  0.04518816  0.06201985]
 [ 0.04838265  0.04518816  0.06201985]
 [ 0.04784995  0.03962641  0.06645438]
 [ 0.07071461 -0.02159151  0.00116683]
 [ 0.07360439 -0.01702153  0.00135719]
 [ 0.07071461 -0.02159151  0.00116683]
 [ 0.07360439 -0.01702153  0.00135719]
 [ 0.06910865 -0.01472281 -0.00195478]
 [ 0.06910865 -0.01472281 -0.00195478]
 [ 0.08309745 -0.01831058  0.00829713]
 [ 0.07982164 -0.02321287  0.00841027]
 [ 0.08554951 -0.02172816  0.01188443]
 [ 0.08977878 -0.02116121  0.0155845 ]
 [ 0.04251401 -0.02733889 -0.01422725]
 [ 0.04217421 -0.08255577 -0.01490392]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.04217421 -0.08255577 -0.01490392]
 [ 0.08554951 -0.02172816  0.01188443]
 [ 0.09236868 -0.01411538  0.01596448]
 [ 0.08903924 -0.01406071  0.01216508]
 [ 0.08799651 -0.00488636  0.00959011]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.04446841  0.04596118  0.05595802]
 [ 0.04800509  0.05024472  0.05769094]
 [ 0.04800509  0.05024472  0.05769094]
 [ 0.05282879 -0.02842232 -0.00872292]
 [ 0.05232428 -0.03399785 -0.00807688]
 [ 0.05727645 -0.03356415 -0.0032247 ]
 [ 0.05232428 -0.03399785 -0.00807688]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.04783209 -0.07020354 -0.01441665]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.04783209 -0.07020354 -0.01441665]
 [ 0.04217421 -0.08255577 -0.01490392]
 [ 0.04310513 -0.07386414 -0.01607968]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.03195613 -0.0516036  -0.01750441]
 [ 0.05522436 -0.04702081 -0.00019384]
 [ 0.05749775 -0.03912054  0.00096631]
 [ 0.05522436 -0.04702081 -0.00019384]
 [ 0.05749775 -0.03912054  0.00096631]
 [ 0.04784995  0.03962641  0.06645438]
 [ 0.05229509  0.04560298  0.06575869]
 [ 0.05733779  0.04818347  0.06668119]
 [ 0.04838265  0.04518816  0.06201985]
 [ 0.05209577  0.0508723   0.06135604]
 [ 0.04784995  0.03962641  0.06645438]
 [ 0.02201384 -0.04289596 -0.01490255]
 [ 0.07051896  0.00779853 -0.01119547]
 [ 0.11024394 -0.00143985 -0.00293289]
 [ 0.11094539 -0.00275566  0.00205274]
 [ 0.11024394 -0.00143985 -0.00293289]
 [ 0.10930578  0.00236486  0.00079261]
 [ 0.10754149  0.00165681 -0.00697873]
 [ 0.10899423 -0.00636649 -0.01476579]
 [ 0.11145104 -0.00966767 -0.01060777]
 [ 0.11024394 -0.00143985 -0.00293289]
 [ 0.11094539 -0.00275566  0.00205274]
 [ 0.11024394 -0.00143985 -0.00293289]
 [ 0.10930578  0.00236486  0.00079261]
 [ 0.10754149  0.00165681 -0.00697873]
 [ 0.11166666 -0.00674525 -0.00166528]
 [ 0.11158449 -0.01213029  0.00146045]
 [ 0.11110111 -0.00784169  0.00515345]
 [ 0.11166666 -0.00674525 -0.00166528]
 [ 0.11166666 -0.00674525 -0.00166528]
 [ 0.11097629 -0.00539678 -0.00672345]
 [ 0.11166666 -0.00674525 -0.00166528]
 [ 0.11097629 -0.00539678 -0.00672345]
 [ 0.112221   -0.01098222 -0.00549247]
 [ 0.11166666 -0.00674525 -0.00166528]
 [ 0.11158449 -0.01213029  0.00146045]
 [ 0.11110111 -0.00784169  0.00515345]
 [ 0.11166666 -0.00674525 -0.00166528]
 [ 0.11097629 -0.00539678 -0.00672345]
 [ 0.112221   -0.01098222 -0.00549247]
 [ 0.112221   -0.01098222 -0.00549247]
 [ 0.11024394 -0.00143985 -0.00293289]
 [ 0.10754149  0.00165681 -0.00697873]
 [ 0.11275835 -0.01665404 -0.00293855]
 [ 0.11166666 -0.00674525 -0.00166528]
 [ 0.11097629 -0.00539678 -0.00672345]
 [ 0.112221   -0.01098222 -0.00549247]
 [ 0.10899423 -0.00636649 -0.01476579]
 [ 0.10847118 -0.00225594 -0.01084277]
 [ 0.1092415  -0.01074808 -0.01875217]
 [ 0.11145104 -0.00966767 -0.01060777]
 [ 0.10847118 -0.00225594 -0.01084277]
 [ 0.10899423 -0.00636649 -0.01476579]
 [ 0.11145104 -0.00966767 -0.01060777]
 [ 0.11145104 -0.00966767 -0.01060777]
 [ 0.11275835 -0.01665404 -0.00293855]
 [ 0.11275835 -0.01665404 -0.00293855]
 [ 0.11488518 -0.01996122 -0.01093385]
 [ 0.10650283  0.00534566 -0.00318631]
 [ 0.11158449 -0.01213029  0.00146045]
 [ 0.1149483  -0.02172052 -0.00561972]
 [ 0.11275835 -0.01665404 -0.00293855]
 [ 0.1149483  -0.02172052 -0.00561972]
 [ 0.11275835 -0.01665404 -0.00293855]
 [ 0.10497552  0.00231574 -0.01162006]
 [ 0.10378715  0.00601831 -0.00774512]
 [ 0.10497552  0.00231574 -0.01162006]
 [ 0.10378715  0.00601831 -0.00774512]
 [ 0.10650283  0.00534566 -0.00318631]
 [ 0.10497552  0.00231574 -0.01162006]
 [ 0.10378715  0.00601831 -0.00774512]
 [ 0.10650283  0.00534566 -0.00318631]
 [ 0.10497552  0.00231574 -0.01162006]
 [ 0.10378715  0.00601831 -0.00774512]
 [ 0.10497552  0.00231574 -0.01162006]
 [ 0.02796937 -0.01689329 -0.03144843]
 [ 0.08489545  0.0099312  -0.01893067]
 [ 0.10184521  0.00282028 -0.0163641 ]
 [ 0.09834864  0.00336015 -0.02107241]
 [ 0.1058936  -0.00161675 -0.01558591]
 [ 0.10184521  0.00282028 -0.0163641 ]
 [ 0.10183471 -0.00239664 -0.02205945]
 [ 0.10184521  0.00282028 -0.0163641 ]
 [ 0.09834864  0.00336015 -0.02107241]
 [ 0.06730837  0.00760552 -0.00571561]
 [ 0.07190932  0.01588451 -0.00288929]
 [ 0.06786691  0.01070745 -0.00182236]
 [ 0.07051896  0.00779853 -0.01119547]
 [ 0.07190932  0.01588451 -0.00288929]
 [ 0.06730837  0.00760552 -0.00571561]
 [ 0.07190932  0.01588451 -0.00288929]
 [ 0.07057209  0.01177514 -0.00650199]
 [ 0.06786691  0.01070745 -0.00182236]
 [ 0.07057209  0.01177514 -0.00650199]
 [ 0.110286    0.00115435  0.00561399]
 [ 0.10184521  0.00282028 -0.0163641 ]
 [ 0.1058936  -0.00161675 -0.01558591]
 [ 0.10184521  0.00282028 -0.0163641 ]
 [ 0.1058936  -0.00161675 -0.01558591]
 [ 0.10378715  0.00601831 -0.00774512]
 [ 0.10497552  0.00231574 -0.01162006]
 [ 0.10126137  0.01084331 -0.00465848]
 [ 0.10378715  0.00601831 -0.00774512]
 [ 0.10650283  0.00534566 -0.00318631]
 [ 0.10011499  0.00905507 -0.00928918]
 [ 0.10378715  0.00601831 -0.00774512]
 [ 0.10497552  0.00231574 -0.01162006]
 [ 0.03008162 -0.0274306  -0.03382456]
 [ 0.10650283  0.00534566 -0.00318631]
 [ 0.10126137  0.01084331 -0.00465848]
 [ 0.10126137  0.01084331 -0.00465848]
 [ 0.1045141   0.01025815 -0.0002322 ]]
len(transformed_superpoints_pcd) :  248
copy_superpoint_src_corr_points.shape :  (16235, 3)
mask.shape :  (16235,)
copy_superpoint_src_corr_points.shape :  (15034, 3)
copy_superpoint_ref_corr_points.shape :  (15034, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([15034, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 15034, 3])
batch_inlier_masks.shape :  torch.Size([2000, 15034])
best_index :  689
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (15034, 3)
transformed_src_superpoints.shape :  torch.Size([15034, 3])
residual.shape :  torch.Size([15034])
batch_inlier_masks.shape :  torch.Size([15034])
batch_outlier_masks.shape :  torch.Size([15034])
indices_inliers.shape :  torch.Size([97])
indices_outliers.shape :  torch.Size([14937])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([97, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.10617916 -0.01302686 -0.0206439 ]
 [ 0.10859702 -0.01602184 -0.01151111]
 [ 0.10536625 -0.01968962 -0.00990893]]
len(transformed_superpoints_pcd) :  345
copy_superpoint_src_corr_points.shape :  (14937, 3)
mask.shape :  (14937,)
copy_superpoint_src_corr_points.shape :  (13924, 3)
copy_superpoint_ref_corr_points.shape :  (13924, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13924, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 13924, 3])
batch_inlier_masks.shape :  torch.Size([2000, 13924])
best_index :  1164
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13924, 3)
transformed_src_superpoints.shape :  torch.Size([13924, 3])
residual.shape :  torch.Size([13924])
batch_inlier_masks.shape :  torch.Size([13924])
batch_outlier_masks.shape :  torch.Size([13924])
indices_inliers.shape :  torch.Size([94])
indices_outliers.shape :  torch.Size([13830])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([94, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.10281178 -0.01584342  0.00726217]
 [ 0.10094074 -0.02088082  0.00675028]
 [ 0.10669452 -0.01872238  0.00116815]]
len(transformed_superpoints_pcd) :  439
copy_superpoint_src_corr_points.shape :  (13830, 3)
mask.shape :  (13830,)
copy_superpoint_src_corr_points.shape :  (13039, 3)
copy_superpoint_ref_corr_points.shape :  (13039, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13039, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 13039, 3])
batch_inlier_masks.shape :  torch.Size([2000, 13039])
best_index :  845
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13039, 3)
transformed_src_superpoints.shape :  torch.Size([13039, 3])
residual.shape :  torch.Size([13039])
batch_inlier_masks.shape :  torch.Size([13039])
batch_outlier_masks.shape :  torch.Size([13039])
indices_inliers.shape :  torch.Size([86])
indices_outliers.shape :  torch.Size([12953])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([86, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.0142851  -0.04522412 -0.0290763 ]
 [ 0.00934751 -0.03427776 -0.02952886]
 [ 0.03325421 -0.05257808 -0.01716731]]
len(transformed_superpoints_pcd) :  525
copy_superpoint_src_corr_points.shape :  (12953, 3)
mask.shape :  (12953,)
copy_superpoint_src_corr_points.shape :  (11903, 3)
copy_superpoint_ref_corr_points.shape :  (11903, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([11903, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 11903, 3])
batch_inlier_masks.shape :  torch.Size([2000, 11903])
best_index :  581
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (11903, 3)
transformed_src_superpoints.shape :  torch.Size([11903, 3])
residual.shape :  torch.Size([11903])
batch_inlier_masks.shape :  torch.Size([11903])
batch_outlier_masks.shape :  torch.Size([11903])
indices_inliers.shape :  torch.Size([74])
indices_outliers.shape :  torch.Size([11829])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([74, 3])
transformed_superpoints_pcd :  [[ 5.2204542e-02 -4.6263799e-02 -5.1608793e-03]
 [ 5.2204542e-02 -4.6263799e-02 -5.1608793e-03]
 [ 4.6174318e-02 -5.7375573e-02 -1.2479629e-02]
 ...
 [-5.0405405e-02  9.6277967e-02  2.0361841e-03]
 [-4.5958705e-02  9.9417597e-02  6.0331076e-05]
 [-4.5958705e-02  9.9417597e-02  6.0331076e-05]]
len(transformed_superpoints_pcd) :  599
copy_superpoint_src_corr_points.shape :  (11829, 3)
mask.shape :  (11829,)
copy_superpoint_src_corr_points.shape :  (10965, 3)
copy_superpoint_ref_corr_points.shape :  (10965, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10965, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 10965, 3])
batch_inlier_masks.shape :  torch.Size([2000, 10965])
best_index :  68
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10965, 3)
transformed_src_superpoints.shape :  torch.Size([10965, 3])
residual.shape :  torch.Size([10965])
batch_inlier_masks.shape :  torch.Size([10965])
batch_outlier_masks.shape :  torch.Size([10965])
indices_inliers.shape :  torch.Size([66])
indices_outliers.shape :  torch.Size([10899])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([66, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.04229116  0.04579381  0.05632594]
 [ 0.04668895  0.01507311 -0.01487338]
 [ 0.04668895  0.01507311 -0.01487338]]
len(transformed_superpoints_pcd) :  665
copy_superpoint_src_corr_points.shape :  (10899, 3)
mask.shape :  (10899,)
copy_superpoint_src_corr_points.shape :  (9693, 3)
copy_superpoint_ref_corr_points.shape :  (9693, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9693, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 9693, 3])
batch_inlier_masks.shape :  torch.Size([2000, 9693])
best_index :  275
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9693, 3)
transformed_src_superpoints.shape :  torch.Size([9693, 3])
residual.shape :  torch.Size([9693])
batch_inlier_masks.shape :  torch.Size([9693])
batch_outlier_masks.shape :  torch.Size([9693])
indices_inliers.shape :  torch.Size([56])
indices_outliers.shape :  torch.Size([9637])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([56, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.08382741  0.08201233 -0.01134136]
 [-0.08382741  0.08201233 -0.01134136]
 [-0.06126139  0.07244211  0.00135595]]
len(transformed_superpoints_pcd) :  721
copy_superpoint_src_corr_points.shape :  (9637, 3)
mask.shape :  (9637,)
copy_superpoint_src_corr_points.shape :  (8751, 3)
copy_superpoint_ref_corr_points.shape :  (8751, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8751, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 8751, 3])
batch_inlier_masks.shape :  torch.Size([2000, 8751])
best_index :  194
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8751, 3)
transformed_src_superpoints.shape :  torch.Size([8751, 3])
residual.shape :  torch.Size([8751])
batch_inlier_masks.shape :  torch.Size([8751])
batch_outlier_masks.shape :  torch.Size([8751])
indices_inliers.shape :  torch.Size([55])
indices_outliers.shape :  torch.Size([8696])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([55, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03121034 -0.12534133 -0.01910815]
 [ 0.03452412 -0.04658122 -0.01958245]
 [ 0.03294213 -0.04381697 -0.0235594 ]]
len(transformed_superpoints_pcd) :  776
copy_superpoint_src_corr_points.shape :  (8696, 3)
mask.shape :  (8696,)
copy_superpoint_src_corr_points.shape :  (7844, 3)
copy_superpoint_ref_corr_points.shape :  (7844, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7844, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7844, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7844])
best_index :  551
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7844, 3)
transformed_src_superpoints.shape :  torch.Size([7844, 3])
residual.shape :  torch.Size([7844])
batch_inlier_masks.shape :  torch.Size([7844])
batch_outlier_masks.shape :  torch.Size([7844])
indices_inliers.shape :  torch.Size([55])
indices_outliers.shape :  torch.Size([7789])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([55, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.01997479 -0.12519816 -0.0092581 ]
 [ 0.02298727 -0.12358855 -0.01341387]
 [ 0.01829905 -0.12048838 -0.01740559]]
len(transformed_superpoints_pcd) :  831
copy_superpoint_src_corr_points.shape :  (7789, 3)
mask.shape :  (7789,)
copy_superpoint_src_corr_points.shape :  (7331, 3)
copy_superpoint_ref_corr_points.shape :  (7331, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7331, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7331, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7331])
best_index :  120
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7331, 3)
transformed_src_superpoints.shape :  torch.Size([7331, 3])
residual.shape :  torch.Size([7331])
batch_inlier_masks.shape :  torch.Size([7331])
batch_outlier_masks.shape :  torch.Size([7331])
indices_inliers.shape :  torch.Size([52])
indices_outliers.shape :  torch.Size([7279])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([52, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.08195399  0.00619928 -0.01178078]
 [ 0.08589569  0.00182304 -0.01243576]
 [ 0.03155637 -0.10923394 -0.01124828]]
len(transformed_superpoints_pcd) :  883
copy_superpoint_src_corr_points.shape :  (7279, 3)
mask.shape :  (7279,)
copy_superpoint_src_corr_points.shape :  (6341, 3)
copy_superpoint_ref_corr_points.shape :  (6341, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6341, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6341, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6341])
best_index :  935
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6341, 3)
transformed_src_superpoints.shape :  torch.Size([6341, 3])
residual.shape :  torch.Size([6341])
batch_inlier_masks.shape :  torch.Size([6341])
batch_outlier_masks.shape :  torch.Size([6341])
indices_inliers.shape :  torch.Size([43])
indices_outliers.shape :  torch.Size([6298])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([43, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.07942878 -0.02954938  0.00057788]
 [ 0.08108767 -0.02017416 -0.00139304]
 [ 0.08108767 -0.02017416 -0.00139304]]
len(transformed_superpoints_pcd) :  926
copy_superpoint_src_corr_points.shape :  (6298, 3)
mask.shape :  (6298,)
copy_superpoint_src_corr_points.shape :  (5411, 3)
copy_superpoint_ref_corr_points.shape :  (5411, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5411, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5411, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5411])
best_index :  1500
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5411, 3)
transformed_src_superpoints.shape :  torch.Size([5411, 3])
residual.shape :  torch.Size([5411])
batch_inlier_masks.shape :  torch.Size([5411])
batch_outlier_masks.shape :  torch.Size([5411])
indices_inliers.shape :  torch.Size([36])
indices_outliers.shape :  torch.Size([5375])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([36, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.0389194   0.02698922  0.00653552]
 [-0.04034996  0.02769836  0.01476844]
 [-0.04379715  0.02776535  0.00411226]]
len(transformed_superpoints_pcd) :  962
copy_superpoint_src_corr_points.shape :  (5375, 3)
mask.shape :  (5375,)
copy_superpoint_src_corr_points.shape :  (4854, 3)
copy_superpoint_ref_corr_points.shape :  (4854, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4854, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4854, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4854])
best_index :  1430
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4854, 3)
transformed_src_superpoints.shape :  torch.Size([4854, 3])
residual.shape :  torch.Size([4854])
batch_inlier_masks.shape :  torch.Size([4854])
batch_outlier_masks.shape :  torch.Size([4854])
indices_inliers.shape :  torch.Size([35])
indices_outliers.shape :  torch.Size([4819])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([35, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.10193684 -0.00240738  0.0118027 ]
 [ 0.0989766   0.00192503  0.01070103]
 [ 0.08443254 -0.01366664  0.00675737]]
len(transformed_superpoints_pcd) :  997
copy_superpoint_src_corr_points.shape :  (4819, 3)
mask.shape :  (4819,)
copy_superpoint_src_corr_points.shape :  (4211, 3)
copy_superpoint_ref_corr_points.shape :  (4211, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4211, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4211, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4211])
best_index :  890
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4211, 3)
transformed_src_superpoints.shape :  torch.Size([4211, 3])
residual.shape :  torch.Size([4211])
batch_inlier_masks.shape :  torch.Size([4211])
batch_outlier_masks.shape :  torch.Size([4211])
indices_inliers.shape :  torch.Size([34])
indices_outliers.shape :  torch.Size([4177])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([34, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.0543643   0.00086671 -0.00797959]
 [-0.05859377  0.00236165 -0.00336752]
 [-0.05859377  0.00236165 -0.00336752]]
len(transformed_superpoints_pcd) :  1031
copy_superpoint_src_corr_points.shape :  (4177, 3)
mask.shape :  (4177,)
copy_superpoint_src_corr_points.shape :  (3938, 3)
copy_superpoint_ref_corr_points.shape :  (3938, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3938, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3938, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3938])
best_index :  462
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3938, 3)
transformed_src_superpoints.shape :  torch.Size([3938, 3])
residual.shape :  torch.Size([3938])
batch_inlier_masks.shape :  torch.Size([3938])
batch_outlier_masks.shape :  torch.Size([3938])
indices_inliers.shape :  torch.Size([29])
indices_outliers.shape :  torch.Size([3909])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([29, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03432831  0.05895654  0.04780189]
 [ 0.02933951  0.05324368  0.05200914]
 [ 0.03510956  0.04928026  0.05271223]]
len(transformed_superpoints_pcd) :  1060
copy_superpoint_src_corr_points.shape :  (3909, 3)
mask.shape :  (3909,)
copy_superpoint_src_corr_points.shape :  (3674, 3)
copy_superpoint_ref_corr_points.shape :  (3674, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3674, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3674, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3674])
best_index :  781
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3674, 3)
transformed_src_superpoints.shape :  torch.Size([3674, 3])
residual.shape :  torch.Size([3674])
batch_inlier_masks.shape :  torch.Size([3674])
batch_outlier_masks.shape :  torch.Size([3674])
indices_inliers.shape :  torch.Size([29])
indices_outliers.shape :  torch.Size([3645])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([29, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.10088213 -0.02018681  0.00757085]
 [ 0.09919936 -0.01461927  0.00900211]
 [ 0.10414738 -0.01574652  0.00535429]]
len(transformed_superpoints_pcd) :  1089
copy_superpoint_src_corr_points.shape :  (3645, 3)
mask.shape :  (3645,)
copy_superpoint_src_corr_points.shape :  (3570, 3)
copy_superpoint_ref_corr_points.shape :  (3570, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3570, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3570, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3570])
best_index :  1987
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3570, 3)
transformed_src_superpoints.shape :  torch.Size([3570, 3])
residual.shape :  torch.Size([3570])
batch_inlier_masks.shape :  torch.Size([3570])
batch_outlier_masks.shape :  torch.Size([3570])
indices_inliers.shape :  torch.Size([29])
indices_outliers.shape :  torch.Size([3541])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([29, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.03746531  0.02178939  0.00897345]
 [-0.04190595  0.02211188  0.00354799]
 [-0.03836898  0.02373076 -0.00015306]]
len(transformed_superpoints_pcd) :  1118
copy_superpoint_src_corr_points.shape :  (3541, 3)
mask.shape :  (3541,)
copy_superpoint_src_corr_points.shape :  (3287, 3)
copy_superpoint_ref_corr_points.shape :  (3287, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3287, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3287, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3287])
best_index :  754
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3287, 3)
transformed_src_superpoints.shape :  torch.Size([3287, 3])
residual.shape :  torch.Size([3287])
batch_inlier_masks.shape :  torch.Size([3287])
batch_outlier_masks.shape :  torch.Size([3287])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([3259])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.06892389  0.09721859 -0.01539183]
 [-0.0750379   0.09947725 -0.01700003]
 [-0.07269794  0.10182796 -0.01233525]]
len(transformed_superpoints_pcd) :  1146
copy_superpoint_src_corr_points.shape :  (3259, 3)
mask.shape :  (3259,)
copy_superpoint_src_corr_points.shape :  (3073, 3)
copy_superpoint_ref_corr_points.shape :  (3073, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3073, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3073, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3073])
best_index :  263
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3073, 3)
transformed_src_superpoints.shape :  torch.Size([3073, 3])
residual.shape :  torch.Size([3073])
batch_inlier_masks.shape :  torch.Size([3073])
batch_outlier_masks.shape :  torch.Size([3073])
indices_inliers.shape :  torch.Size([27])
indices_outliers.shape :  torch.Size([3046])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([27, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03251397 -0.12027401 -0.01961947]
 [ 0.03221779 -0.12199183 -0.01358598]
 [ 0.0386739  -0.11944808 -0.01398923]]
len(transformed_superpoints_pcd) :  1173
copy_superpoint_src_corr_points.shape :  (3046, 3)
mask.shape :  (3046,)
copy_superpoint_src_corr_points.shape :  (3002, 3)
copy_superpoint_ref_corr_points.shape :  (3002, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3002, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3002, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3002])
best_index :  529
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3002, 3)
transformed_src_superpoints.shape :  torch.Size([3002, 3])
residual.shape :  torch.Size([3002])
batch_inlier_masks.shape :  torch.Size([3002])
batch_outlier_masks.shape :  torch.Size([3002])
indices_inliers.shape :  torch.Size([25])
indices_outliers.shape :  torch.Size([2977])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([25, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03965553 -0.047847   -0.01611297]
 [ 0.03965553 -0.047847   -0.01611297]
 [ 0.0348282  -0.04447857 -0.01866999]]
len(transformed_superpoints_pcd) :  1198
copy_superpoint_src_corr_points.shape :  (2977, 3)
mask.shape :  (2977,)
copy_superpoint_src_corr_points.shape :  (2904, 3)
copy_superpoint_ref_corr_points.shape :  (2904, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2904, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2904, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2904])
best_index :  886
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2904, 3)
transformed_src_superpoints.shape :  torch.Size([2904, 3])
residual.shape :  torch.Size([2904])
batch_inlier_masks.shape :  torch.Size([2904])
batch_outlier_masks.shape :  torch.Size([2904])
indices_inliers.shape :  torch.Size([25])
indices_outliers.shape :  torch.Size([2879])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([25, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.00065633 -0.04773585 -0.02050138]
 [-0.00019069 -0.04119164 -0.02555182]
 [-0.00466339 -0.04353175 -0.0233064 ]]
len(transformed_superpoints_pcd) :  1223
copy_superpoint_src_corr_points.shape :  (2879, 3)
mask.shape :  (2879,)
copy_superpoint_src_corr_points.shape :  (2729, 3)
copy_superpoint_ref_corr_points.shape :  (2729, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2729, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2729, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2729])
best_index :  568
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2729, 3)
transformed_src_superpoints.shape :  torch.Size([2729, 3])
residual.shape :  torch.Size([2729])
batch_inlier_masks.shape :  torch.Size([2729])
batch_outlier_masks.shape :  torch.Size([2729])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([2707])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.01636673 -0.0276091  -0.03704545]
 [ 0.02033364 -0.03047854 -0.03581585]
 [ 0.01636673 -0.0276091  -0.03704545]]
len(transformed_superpoints_pcd) :  1245
copy_superpoint_src_corr_points.shape :  (2707, 3)
mask.shape :  (2707,)
copy_superpoint_src_corr_points.shape :  (2558, 3)
copy_superpoint_ref_corr_points.shape :  (2558, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2558, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2558, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2558])
best_index :  1801
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2558, 3)
transformed_src_superpoints.shape :  torch.Size([2558, 3])
residual.shape :  torch.Size([2558])
batch_inlier_masks.shape :  torch.Size([2558])
batch_outlier_masks.shape :  torch.Size([2558])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([2536])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.07604045 -0.02915137 -0.00389489]
 [ 0.08063048 -0.02707234 -0.00357768]
 [ 0.03603251 -0.05409405 -0.01462158]]
len(transformed_superpoints_pcd) :  1267
copy_superpoint_src_corr_points.shape :  (2536, 3)
mask.shape :  (2536,)
copy_superpoint_src_corr_points.shape :  (2448, 3)
copy_superpoint_ref_corr_points.shape :  (2448, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2448, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2448, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2448])
best_index :  14
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2448, 3)
transformed_src_superpoints.shape :  torch.Size([2448, 3])
residual.shape :  torch.Size([2448])
batch_inlier_masks.shape :  torch.Size([2448])
batch_outlier_masks.shape :  torch.Size([2448])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2427])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.04235078  0.0231482   0.07127903]
 [ 0.03874205  0.02332593  0.07667382]
 [-0.02324839 -0.06256273 -0.02466584]]
len(transformed_superpoints_pcd) :  1288
copy_superpoint_src_corr_points.shape :  (2427, 3)
mask.shape :  (2427,)
copy_superpoint_src_corr_points.shape :  (2254, 3)
copy_superpoint_ref_corr_points.shape :  (2254, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2254, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2254, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2254])
best_index :  1454
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2254, 3)
transformed_src_superpoints.shape :  torch.Size([2254, 3])
residual.shape :  torch.Size([2254])
batch_inlier_masks.shape :  torch.Size([2254])
batch_outlier_masks.shape :  torch.Size([2254])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2233])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.04825259  0.09384509 -0.00227361]
 [-0.04860886  0.08771073  0.00025449]
 [-0.04976562  0.10051744 -0.00302873]]
len(transformed_superpoints_pcd) :  1309
copy_superpoint_src_corr_points.shape :  (2233, 3)
mask.shape :  (2233,)
copy_superpoint_src_corr_points.shape :  (2047, 3)
copy_superpoint_ref_corr_points.shape :  (2047, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2047, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2047, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2047])
best_index :  1924
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2047, 3)
transformed_src_superpoints.shape :  torch.Size([2047, 3])
residual.shape :  torch.Size([2047])
batch_inlier_masks.shape :  torch.Size([2047])
batch_outlier_masks.shape :  torch.Size([2047])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([2027])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.05886063 -0.06177761 -0.00029093]
 [ 0.05344367 -0.05675136 -0.00868705]
 [ 0.05161417 -0.05048408 -0.00861271]]
len(transformed_superpoints_pcd) :  1329
copy_superpoint_src_corr_points.shape :  (2027, 3)
mask.shape :  (2027,)
copy_superpoint_src_corr_points.shape :  (2002, 3)
copy_superpoint_ref_corr_points.shape :  (2002, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2002, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2002, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2002])
best_index :  485
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2002, 3)
transformed_src_superpoints.shape :  torch.Size([2002, 3])
residual.shape :  torch.Size([2002])
batch_inlier_masks.shape :  torch.Size([2002])
batch_outlier_masks.shape :  torch.Size([2002])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([1983])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.06743686  0.10019279 -0.00262973]
 [-0.07109094  0.09557518 -0.0020469 ]
 [-0.07334913  0.08839791 -0.00276013]]
len(transformed_superpoints_pcd) :  1348
copy_superpoint_src_corr_points.shape :  (1983, 3)
mask.shape :  (1983,)
copy_superpoint_src_corr_points.shape :  (1911, 3)
copy_superpoint_ref_corr_points.shape :  (1911, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1911, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1911, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1911])
best_index :  1328
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1911, 3)
transformed_src_superpoints.shape :  torch.Size([1911, 3])
residual.shape :  torch.Size([1911])
batch_inlier_masks.shape :  torch.Size([1911])
batch_outlier_masks.shape :  torch.Size([1911])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([1892])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.00011232  0.11119007 -0.02948341]
 [ 0.00651521  0.10977001 -0.02957654]
 [ 0.00380616  0.10844802 -0.03466906]]
len(transformed_superpoints_pcd) :  1367
copy_superpoint_src_corr_points.shape :  (1892, 3)
mask.shape :  (1892,)
copy_superpoint_src_corr_points.shape :  (1762, 3)
copy_superpoint_ref_corr_points.shape :  (1762, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1762, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1762, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1762])
best_index :  1844
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1762, 3)
transformed_src_superpoints.shape :  torch.Size([1762, 3])
residual.shape :  torch.Size([1762])
batch_inlier_masks.shape :  torch.Size([1762])
batch_outlier_masks.shape :  torch.Size([1762])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([1744])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.02926848 -0.04529889 -0.028145  ]
 [-0.03021098 -0.04958462 -0.02405901]
 [-0.02926848 -0.04529889 -0.028145  ]]
len(transformed_superpoints_pcd) :  1385
copy_superpoint_src_corr_points.shape :  (1744, 3)
mask.shape :  (1744,)
copy_superpoint_src_corr_points.shape :  (1617, 3)
copy_superpoint_ref_corr_points.shape :  (1617, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1617, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1617, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1617])
best_index :  1824
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1617, 3)
transformed_src_superpoints.shape :  torch.Size([1617, 3])
residual.shape :  torch.Size([1617])
batch_inlier_masks.shape :  torch.Size([1617])
batch_outlier_masks.shape :  torch.Size([1617])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1600])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.10520367 -0.01844805  0.00746121]
 [ 0.10364802 -0.01226196  0.00769443]
 [ 0.10192049 -0.0222131   0.00027746]]
len(transformed_superpoints_pcd) :  1402
copy_superpoint_src_corr_points.shape :  (1600, 3)
mask.shape :  (1600,)
copy_superpoint_src_corr_points.shape :  (1585, 3)
copy_superpoint_ref_corr_points.shape :  (1585, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1585, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1585, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1585])
best_index :  1004
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1585, 3)
transformed_src_superpoints.shape :  torch.Size([1585, 3])
residual.shape :  torch.Size([1585])
batch_inlier_masks.shape :  torch.Size([1585])
batch_outlier_masks.shape :  torch.Size([1585])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1569])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.02430574 -0.01941106 -0.04252477]
 [ 0.01459887 -0.01394754 -0.03996015]
 [ 0.01387798 -0.04568868  0.02220603]]
len(transformed_superpoints_pcd) :  1418
copy_superpoint_src_corr_points.shape :  (1569, 3)
mask.shape :  (1569,)
copy_superpoint_src_corr_points.shape :  (1523, 3)
copy_superpoint_ref_corr_points.shape :  (1523, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1523, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1523, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1523])
best_index :  1513
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1523, 3)
transformed_src_superpoints.shape :  torch.Size([1523, 3])
residual.shape :  torch.Size([1523])
batch_inlier_masks.shape :  torch.Size([1523])
batch_outlier_masks.shape :  torch.Size([1523])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1508])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.07402343 -0.01279766  0.00161396]
 [ 0.07662243 -0.02123995 -0.00578336]
 [ 0.07982861 -0.02458752 -0.00293834]]
len(transformed_superpoints_pcd) :  1433
copy_superpoint_src_corr_points.shape :  (1508, 3)
mask.shape :  (1508,)
copy_superpoint_src_corr_points.shape :  (1407, 3)
copy_superpoint_ref_corr_points.shape :  (1407, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1407, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1407, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1407])
best_index :  1980
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1407, 3)
transformed_src_superpoints.shape :  torch.Size([1407, 3])
residual.shape :  torch.Size([1407])
batch_inlier_masks.shape :  torch.Size([1407])
batch_outlier_masks.shape :  torch.Size([1407])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1392])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.0386874  -0.0433127  -0.01886318]
 [ 0.03805502 -0.03721467 -0.02399987]
 [ 0.04321609 -0.03670024 -0.02117074]]
len(transformed_superpoints_pcd) :  1448
copy_superpoint_src_corr_points.shape :  (1392, 3)
mask.shape :  (1392,)
copy_superpoint_src_corr_points.shape :  (1364, 3)
copy_superpoint_ref_corr_points.shape :  (1364, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1364, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1364, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1364])
best_index :  1265
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1364, 3)
transformed_src_superpoints.shape :  torch.Size([1364, 3])
residual.shape :  torch.Size([1364])
batch_inlier_masks.shape :  torch.Size([1364])
batch_outlier_masks.shape :  torch.Size([1364])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1350])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.00698928 -0.11103788  0.01499861]
 [-0.01191334 -0.11974741  0.01861751]
 [-0.01048767 -0.10807969  0.01286327]]
len(transformed_superpoints_pcd) :  1462
copy_superpoint_src_corr_points.shape :  (1350, 3)
mask.shape :  (1350,)
copy_superpoint_src_corr_points.shape :  (1273, 3)
copy_superpoint_ref_corr_points.shape :  (1273, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1273, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1273, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1273])
best_index :  1470
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1273, 3)
transformed_src_superpoints.shape :  torch.Size([1273, 3])
residual.shape :  torch.Size([1273])
batch_inlier_masks.shape :  torch.Size([1273])
batch_outlier_masks.shape :  torch.Size([1273])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1259])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.00843489  0.04003515  0.01602714]
 [-0.01690579  0.04052348  0.01120286]
 [ 0.00484913  0.1101352  -0.04122276]]
len(transformed_superpoints_pcd) :  1476
copy_superpoint_src_corr_points.shape :  (1259, 3)
mask.shape :  (1259,)
copy_superpoint_src_corr_points.shape :  (1045, 3)
copy_superpoint_ref_corr_points.shape :  (1045, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1045, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1045, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1045])
best_index :  1781
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1045, 3)
transformed_src_superpoints.shape :  torch.Size([1045, 3])
residual.shape :  torch.Size([1045])
batch_inlier_masks.shape :  torch.Size([1045])
batch_outlier_masks.shape :  torch.Size([1045])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1031])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.07291839  0.09271228 -0.00661929]
 [-0.0723424   0.08722407 -0.00478757]
 [-0.07104619  0.08708967  0.00134845]]
len(transformed_superpoints_pcd) :  1490
copy_superpoint_src_corr_points.shape :  (1031, 3)
mask.shape :  (1031,)
copy_superpoint_src_corr_points.shape :  (996, 3)
copy_superpoint_ref_corr_points.shape :  (996, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([996, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 996, 3])
batch_inlier_masks.shape :  torch.Size([2000, 996])
best_index :  853
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (996, 3)
transformed_src_superpoints.shape :  torch.Size([996, 3])
residual.shape :  torch.Size([996])
batch_inlier_masks.shape :  torch.Size([996])
batch_outlier_masks.shape :  torch.Size([996])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([983])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.04013141 -0.05132109 -0.01983318]
 [ 0.03505105 -0.05306157 -0.01729174]
 [ 0.04068108 -0.05580878 -0.01725113]]
len(transformed_superpoints_pcd) :  1503
copy_superpoint_src_corr_points.shape :  (983, 3)
mask.shape :  (983,)
copy_superpoint_src_corr_points.shape :  (978, 3)
copy_superpoint_ref_corr_points.shape :  (978, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([978, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 978, 3])
batch_inlier_masks.shape :  torch.Size([2000, 978])
best_index :  1149
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (978, 3)
transformed_src_superpoints.shape :  torch.Size([978, 3])
residual.shape :  torch.Size([978])
batch_inlier_masks.shape :  torch.Size([978])
batch_outlier_masks.shape :  torch.Size([978])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([965])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.1040232  -0.02454006 -0.00767135]
 [ 0.10650399 -0.02138172 -0.00323766]
 [ 0.10091572 -0.0273136  -0.00034558]]
len(transformed_superpoints_pcd) :  1516
copy_superpoint_src_corr_points.shape :  (965, 3)
mask.shape :  (965,)
copy_superpoint_src_corr_points.shape :  (965, 3)
copy_superpoint_ref_corr_points.shape :  (965, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([965, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 965, 3])
batch_inlier_masks.shape :  torch.Size([2000, 965])
best_index :  1462
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (965, 3)
transformed_src_superpoints.shape :  torch.Size([965, 3])
residual.shape :  torch.Size([965])
batch_inlier_masks.shape :  torch.Size([965])
batch_outlier_masks.shape :  torch.Size([965])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([952])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.0272908  -0.05815902 -0.02079722]
 [-0.02841521 -0.05229026 -0.02025731]
 [-0.0272908  -0.05815902 -0.02079722]]
len(transformed_superpoints_pcd) :  1529
copy_superpoint_src_corr_points.shape :  (952, 3)
mask.shape :  (952,)
copy_superpoint_src_corr_points.shape :  (893, 3)
copy_superpoint_ref_corr_points.shape :  (893, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([893, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 893, 3])
batch_inlier_masks.shape :  torch.Size([2000, 893])
best_index :  1635
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (893, 3)
transformed_src_superpoints.shape :  torch.Size([893, 3])
residual.shape :  torch.Size([893])
batch_inlier_masks.shape :  torch.Size([893])
batch_outlier_masks.shape :  torch.Size([893])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([880])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.09173538 -0.03305396 -0.01276552]
 [ 0.08463224 -0.02751632 -0.0090128 ]
 [ 0.08844688 -0.0309128  -0.00693998]]
len(transformed_superpoints_pcd) :  1542
copy_superpoint_src_corr_points.shape :  (880, 3)
mask.shape :  (880,)
copy_superpoint_src_corr_points.shape :  (848, 3)
copy_superpoint_ref_corr_points.shape :  (848, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([848, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 848, 3])
batch_inlier_masks.shape :  torch.Size([2000, 848])
best_index :  1867
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (848, 3)
transformed_src_superpoints.shape :  torch.Size([848, 3])
residual.shape :  torch.Size([848])
batch_inlier_masks.shape :  torch.Size([848])
batch_outlier_masks.shape :  torch.Size([848])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([835])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.02668469 -0.05690916 -0.01703097]
 [-0.02593053 -0.0528199  -0.02005837]
 [-0.02846816 -0.04860012 -0.0225991 ]]
len(transformed_superpoints_pcd) :  1555
copy_superpoint_src_corr_points.shape :  (835, 3)
mask.shape :  (835,)
copy_superpoint_src_corr_points.shape :  (791, 3)
copy_superpoint_ref_corr_points.shape :  (791, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([791, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 791, 3])
batch_inlier_masks.shape :  torch.Size([2000, 791])
best_index :  1732
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (791, 3)
transformed_src_superpoints.shape :  torch.Size([791, 3])
residual.shape :  torch.Size([791])
batch_inlier_masks.shape :  torch.Size([791])
batch_outlier_masks.shape :  torch.Size([791])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([779])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.00425002 -0.0019964   0.03453714]
 [-0.00425002 -0.0019964   0.03453714]
 [-0.00246699  0.0002296   0.03874528]]
len(transformed_superpoints_pcd) :  1567
copy_superpoint_src_corr_points.shape :  (779, 3)
mask.shape :  (779,)
copy_superpoint_src_corr_points.shape :  (772, 3)
copy_superpoint_ref_corr_points.shape :  (772, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([772, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 772, 3])
batch_inlier_masks.shape :  torch.Size([2000, 772])
best_index :  1995
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (772, 3)
transformed_src_superpoints.shape :  torch.Size([772, 3])
residual.shape :  torch.Size([772])
batch_inlier_masks.shape :  torch.Size([772])
batch_outlier_masks.shape :  torch.Size([772])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([760])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.05358322  0.01529185  0.0096963 ]
 [-0.05013564  0.01795006  0.00691033]
 [-0.04935299  0.01730423  0.00021539]]
len(transformed_superpoints_pcd) :  1579
copy_superpoint_src_corr_points.shape :  (760, 3)
mask.shape :  (760,)
copy_superpoint_src_corr_points.shape :  (759, 3)
copy_superpoint_ref_corr_points.shape :  (759, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([759, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 759, 3])
batch_inlier_masks.shape :  torch.Size([2000, 759])
best_index :  682
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (759, 3)
transformed_src_superpoints.shape :  torch.Size([759, 3])
residual.shape :  torch.Size([759])
batch_inlier_masks.shape :  torch.Size([759])
batch_outlier_masks.shape :  torch.Size([759])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([748])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.01700629 -0.06589626 -0.01524535]
 [-0.02017785 -0.06509575 -0.02064282]
 [-0.01700629 -0.06589626 -0.01524535]]
len(transformed_superpoints_pcd) :  1590
copy_superpoint_src_corr_points.shape :  (748, 3)
mask.shape :  (748,)
copy_superpoint_src_corr_points.shape :  (735, 3)
copy_superpoint_ref_corr_points.shape :  (735, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([735, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 735, 3])
batch_inlier_masks.shape :  torch.Size([2000, 735])
best_index :  1731
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (735, 3)
transformed_src_superpoints.shape :  torch.Size([735, 3])
residual.shape :  torch.Size([735])
batch_inlier_masks.shape :  torch.Size([735])
batch_outlier_masks.shape :  torch.Size([735])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([724])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.11158597 -0.01119386 -0.00355956]
 [ 0.11156663 -0.00858186 -0.00786507]
 [ 0.11158124 -0.00555776 -0.00212744]]
len(transformed_superpoints_pcd) :  1601
copy_superpoint_src_corr_points.shape :  (724, 3)
mask.shape :  (724,)
copy_superpoint_src_corr_points.shape :  (720, 3)
copy_superpoint_ref_corr_points.shape :  (720, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([720, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 720, 3])
batch_inlier_masks.shape :  torch.Size([2000, 720])
best_index :  1804
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (720, 3)
transformed_src_superpoints.shape :  torch.Size([720, 3])
residual.shape :  torch.Size([720])
batch_inlier_masks.shape :  torch.Size([720])
batch_outlier_masks.shape :  torch.Size([720])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([709])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.06674699  0.09130786 -0.00331408]
 [-0.07068636  0.08747464 -0.00258673]
 [-0.06674699  0.09130786 -0.00331408]]
len(transformed_superpoints_pcd) :  1612
copy_superpoint_src_corr_points.shape :  (709, 3)
mask.shape :  (709,)
copy_superpoint_src_corr_points.shape :  (708, 3)
copy_superpoint_ref_corr_points.shape :  (708, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([708, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 708, 3])
batch_inlier_masks.shape :  torch.Size([2000, 708])
best_index :  949
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (708, 3)
transformed_src_superpoints.shape :  torch.Size([708, 3])
residual.shape :  torch.Size([708])
batch_inlier_masks.shape :  torch.Size([708])
batch_outlier_masks.shape :  torch.Size([708])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([698])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.07026927  0.09131166 -0.00544906]
 [-0.06623849  0.08925312 -0.00050364]
 [ 0.03196341  0.05772567  0.05813993]]
len(transformed_superpoints_pcd) :  1622
copy_superpoint_src_corr_points.shape :  (698, 3)
mask.shape :  (698,)
copy_superpoint_src_corr_points.shape :  (630, 3)
copy_superpoint_ref_corr_points.shape :  (630, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([630, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 630, 3])
batch_inlier_masks.shape :  torch.Size([2000, 630])
best_index :  1024
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (630, 3)
transformed_src_superpoints.shape :  torch.Size([630, 3])
residual.shape :  torch.Size([630])
batch_inlier_masks.shape :  torch.Size([630])
batch_outlier_masks.shape :  torch.Size([630])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([620])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.00670077  0.11658826 -0.0229137 ]
 [-0.01081571  0.11657508 -0.02912712]
 [-0.00253465  0.11437457 -0.02527081]]
len(transformed_superpoints_pcd) :  1632
copy_superpoint_src_corr_points.shape :  (620, 3)
mask.shape :  (620,)
copy_superpoint_src_corr_points.shape :  (618, 3)
copy_superpoint_ref_corr_points.shape :  (618, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([618, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 618, 3])
batch_inlier_masks.shape :  torch.Size([2000, 618])
best_index :  1873
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (618, 3)
transformed_src_superpoints.shape :  torch.Size([618, 3])
residual.shape :  torch.Size([618])
batch_inlier_masks.shape :  torch.Size([618])
batch_outlier_masks.shape :  torch.Size([618])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([608])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03878352  0.02209853  0.07283413]
 [ 0.03603032  0.02949756  0.06960572]
 [ 0.03265144  0.02320956  0.06808975]]
len(transformed_superpoints_pcd) :  1642
copy_superpoint_src_corr_points.shape :  (608, 3)
mask.shape :  (608,)
copy_superpoint_src_corr_points.shape :  (607, 3)
copy_superpoint_ref_corr_points.shape :  (607, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([607, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 607, 3])
batch_inlier_masks.shape :  torch.Size([2000, 607])
best_index :  351
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (607, 3)
transformed_src_superpoints.shape :  torch.Size([607, 3])
residual.shape :  torch.Size([607])
batch_inlier_masks.shape :  torch.Size([607])
batch_outlier_masks.shape :  torch.Size([607])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([598])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.02751674 -0.05742765 -0.01725164]
 [-0.02751674 -0.05742765 -0.01725164]
 [-0.03206892 -0.05529391 -0.01810095]]
len(transformed_superpoints_pcd) :  1651
copy_superpoint_src_corr_points.shape :  (598, 3)
mask.shape :  (598,)
copy_superpoint_src_corr_points.shape :  (554, 3)
copy_superpoint_ref_corr_points.shape :  (554, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([554, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 554, 3])
batch_inlier_masks.shape :  torch.Size([2000, 554])
best_index :  948
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (554, 3)
transformed_src_superpoints.shape :  torch.Size([554, 3])
residual.shape :  torch.Size([554])
batch_inlier_masks.shape :  torch.Size([554])
batch_outlier_masks.shape :  torch.Size([554])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([545])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.06958643  0.09010658 -0.00824539]
 [-0.07134396  0.09281678 -0.00161085]
 [-0.07063736  0.08533837 -0.00275726]]
len(transformed_superpoints_pcd) :  1660
copy_superpoint_src_corr_points.shape :  (545, 3)
mask.shape :  (545,)
copy_superpoint_src_corr_points.shape :  (545, 3)
copy_superpoint_ref_corr_points.shape :  (545, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([545, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 545, 3])
batch_inlier_masks.shape :  torch.Size([2000, 545])
best_index :  1072
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (545, 3)
transformed_src_superpoints.shape :  torch.Size([545, 3])
residual.shape :  torch.Size([545])
batch_inlier_masks.shape :  torch.Size([545])
batch_outlier_masks.shape :  torch.Size([545])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([536])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03532526 -0.04309297 -0.01140345]
 [ 0.03699023 -0.04622976 -0.01726773]
 [ 0.03515573 -0.0519814  -0.0228225 ]]
len(transformed_superpoints_pcd) :  1669
copy_superpoint_src_corr_points.shape :  (536, 3)
mask.shape :  (536,)
copy_superpoint_src_corr_points.shape :  (534, 3)
copy_superpoint_ref_corr_points.shape :  (534, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([534, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 534, 3])
batch_inlier_masks.shape :  torch.Size([2000, 534])
best_index :  1221
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (534, 3)
transformed_src_superpoints.shape :  torch.Size([534, 3])
residual.shape :  torch.Size([534])
batch_inlier_masks.shape :  torch.Size([534])
batch_outlier_masks.shape :  torch.Size([534])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([525])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.014985   -0.12294427  0.03607992]
 [-0.01850033 -0.12059953  0.03966062]
 [-0.01378049 -0.12182047  0.03115096]]
len(transformed_superpoints_pcd) :  1678
copy_superpoint_src_corr_points.shape :  (525, 3)
mask.shape :  (525,)
copy_superpoint_src_corr_points.shape :  (523, 3)
copy_superpoint_ref_corr_points.shape :  (523, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([523, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 523, 3])
batch_inlier_masks.shape :  torch.Size([2000, 523])
best_index :  1250
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (523, 3)
transformed_src_superpoints.shape :  torch.Size([523, 3])
residual.shape :  torch.Size([523])
batch_inlier_masks.shape :  torch.Size([523])
batch_outlier_masks.shape :  torch.Size([523])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([514])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.05230826  0.04202254  0.05696194]
 [ 0.05594789  0.03424216  0.05728889]
 [ 0.04807221  0.040776    0.05376816]]
len(transformed_superpoints_pcd) :  1687
copy_superpoint_src_corr_points.shape :  (514, 3)
mask.shape :  (514,)
copy_superpoint_src_corr_points.shape :  (459, 3)
copy_superpoint_ref_corr_points.shape :  (459, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([459, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 459, 3])
batch_inlier_masks.shape :  torch.Size([2000, 459])
best_index :  1563
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (459, 3)
transformed_src_superpoints.shape :  torch.Size([459, 3])
residual.shape :  torch.Size([459])
batch_inlier_masks.shape :  torch.Size([459])
batch_outlier_masks.shape :  torch.Size([459])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([450])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03734808 -0.05241919 -0.01895319]
 [ 0.0333757  -0.04902539 -0.02091935]
 [ 0.04297585 -0.05438085 -0.01389348]]
len(transformed_superpoints_pcd) :  1696
copy_superpoint_src_corr_points.shape :  (450, 3)
mask.shape :  (450,)
copy_superpoint_src_corr_points.shape :  (442, 3)
copy_superpoint_ref_corr_points.shape :  (442, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([442, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 442, 3])
batch_inlier_masks.shape :  torch.Size([2000, 442])
best_index :  1728
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (442, 3)
transformed_src_superpoints.shape :  torch.Size([442, 3])
residual.shape :  torch.Size([442])
batch_inlier_masks.shape :  torch.Size([442])
batch_outlier_masks.shape :  torch.Size([442])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([433])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.05514883  0.09186967 -0.02424641]
 [-0.06071492  0.08945385 -0.0252382 ]
 [-0.05639665  0.08799367 -0.02028731]]
len(transformed_superpoints_pcd) :  1705
copy_superpoint_src_corr_points.shape :  (433, 3)
mask.shape :  (433,)
copy_superpoint_src_corr_points.shape :  (431, 3)
copy_superpoint_ref_corr_points.shape :  (431, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([431, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 431, 3])
batch_inlier_masks.shape :  torch.Size([2000, 431])
best_index :  1379
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (431, 3)
transformed_src_superpoints.shape :  torch.Size([431, 3])
residual.shape :  torch.Size([431])
batch_inlier_masks.shape :  torch.Size([431])
batch_outlier_masks.shape :  torch.Size([431])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([423])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.07473645  0.08230802 -0.00358202]
 [-0.06766374  0.09216888 -0.0099447 ]
 [-0.07556247  0.09268229 -0.00304455]]
len(transformed_superpoints_pcd) :  1713
copy_superpoint_src_corr_points.shape :  (423, 3)
mask.shape :  (423,)
copy_superpoint_src_corr_points.shape :  (422, 3)
copy_superpoint_ref_corr_points.shape :  (422, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([422, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 422, 3])
batch_inlier_masks.shape :  torch.Size([2000, 422])
best_index :  1789
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (422, 3)
transformed_src_superpoints.shape :  torch.Size([422, 3])
residual.shape :  torch.Size([422])
batch_inlier_masks.shape :  torch.Size([422])
batch_outlier_masks.shape :  torch.Size([422])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([414])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.11144764 -0.00588598 -0.00707058]
 [ 0.11167119 -0.00730062 -0.0022743 ]
 [ 0.1116289  -0.01355058 -0.00184146]]
len(transformed_superpoints_pcd) :  1721
copy_superpoint_src_corr_points.shape :  (414, 3)
mask.shape :  (414,)
copy_superpoint_src_corr_points.shape :  (413, 3)
copy_superpoint_ref_corr_points.shape :  (413, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([413, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 413, 3])
batch_inlier_masks.shape :  torch.Size([2000, 413])
best_index :  1916
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (413, 3)
transformed_src_superpoints.shape :  torch.Size([413, 3])
residual.shape :  torch.Size([413])
batch_inlier_masks.shape :  torch.Size([413])
batch_outlier_masks.shape :  torch.Size([413])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([405])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.00397216  0.11376733 -0.02809084]
 [-0.00920864  0.11470941 -0.02830046]
 [-0.00397216  0.11376733 -0.02809084]]
len(transformed_superpoints_pcd) :  1729
copy_superpoint_src_corr_points.shape :  (405, 3)
mask.shape :  (405,)
copy_superpoint_src_corr_points.shape :  (404, 3)
copy_superpoint_ref_corr_points.shape :  (404, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([404, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 404, 3])
batch_inlier_masks.shape :  torch.Size([2000, 404])
best_index :  112
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (404, 3)
transformed_src_superpoints.shape :  torch.Size([404, 3])
residual.shape :  torch.Size([404])
batch_inlier_masks.shape :  torch.Size([404])
batch_outlier_masks.shape :  torch.Size([404])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([397])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.04756212 -0.04140891  0.00607202]
 [-0.04756212 -0.04140891  0.00607202]
 [-0.04756212 -0.04140891  0.00607202]]
len(transformed_superpoints_pcd) :  1736
copy_superpoint_src_corr_points.shape :  (397, 3)
mask.shape :  (397,)
copy_superpoint_src_corr_points.shape :  (297, 3)
copy_superpoint_ref_corr_points.shape :  (297, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([297, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 297, 3])
batch_inlier_masks.shape :  torch.Size([2000, 297])
best_index :  396
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (297, 3)
transformed_src_superpoints.shape :  torch.Size([297, 3])
residual.shape :  torch.Size([297])
batch_inlier_masks.shape :  torch.Size([297])
batch_outlier_masks.shape :  torch.Size([297])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([291])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.03280257  0.03975638  0.06429891]
 [ 0.03280257  0.03975638  0.06429891]
 [ 0.03280257  0.03975638  0.06429891]]
len(transformed_superpoints_pcd) :  1742
copy_superpoint_src_corr_points.shape :  (291, 3)
mask.shape :  (291,)
copy_superpoint_src_corr_points.shape :  (269, 3)
copy_superpoint_ref_corr_points.shape :  (269, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([269, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 269, 3])
batch_inlier_masks.shape :  torch.Size([2000, 269])
best_index :  593
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (269, 3)
transformed_src_superpoints.shape :  torch.Size([269, 3])
residual.shape :  torch.Size([269])
batch_inlier_masks.shape :  torch.Size([269])
batch_outlier_masks.shape :  torch.Size([269])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([263])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.11106508 -0.01393903 -0.00067899]
 [ 0.11106508 -0.01393903 -0.00067899]
 [ 0.11106508 -0.01393903 -0.00067899]]
len(transformed_superpoints_pcd) :  1748
copy_superpoint_src_corr_points.shape :  (263, 3)
mask.shape :  (263,)
copy_superpoint_src_corr_points.shape :  (262, 3)
copy_superpoint_ref_corr_points.shape :  (262, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([262, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 262, 3])
batch_inlier_masks.shape :  torch.Size([2000, 262])
best_index :  1031
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (262, 3)
transformed_src_superpoints.shape :  torch.Size([262, 3])
residual.shape :  torch.Size([262])
batch_inlier_masks.shape :  torch.Size([262])
batch_outlier_masks.shape :  torch.Size([262])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([256])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 5.2204542e-02 -4.6263799e-02 -5.1608793e-03]
 [ 5.2204542e-02 -4.6263799e-02 -5.1608793e-03]
 [ 4.6174318e-02 -5.7375573e-02 -1.2479629e-02]
 ...
 [ 8.3106406e-02 -1.7105455e-02  6.9187637e-03]
 [ 8.9965798e-02 -2.0762717e-02  9.2638247e-03]
 [ 8.5676804e-02 -2.7206434e-02 -1.1570752e-05]]
len(transformed_superpoints_pcd) :  1754
copy_superpoint_src_corr_points.shape :  (256, 3)
mask.shape :  (256,)
copy_superpoint_src_corr_points.shape :  (251, 3)
copy_superpoint_ref_corr_points.shape :  (251, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([251, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 251, 3])
batch_inlier_masks.shape :  torch.Size([2000, 251])
best_index :  1252
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (251, 3)
transformed_src_superpoints.shape :  torch.Size([251, 3])
residual.shape :  torch.Size([251])
batch_inlier_masks.shape :  torch.Size([251])
batch_outlier_masks.shape :  torch.Size([251])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([245])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 5.2204542e-02 -4.6263799e-02 -5.1608793e-03]
 [ 5.2204542e-02 -4.6263799e-02 -5.1608793e-03]
 [ 4.6174318e-02 -5.7375573e-02 -1.2479629e-02]
 ...
 [-5.1421903e-02  1.7698854e-05 -1.0685600e-02]
 [-6.0963899e-02  6.8324134e-03 -1.1786148e-03]
 [-5.1421903e-02  1.7698854e-05 -1.0685600e-02]]
len(transformed_superpoints_pcd) :  1760
copy_superpoint_src_corr_points.shape :  (245, 3)
mask.shape :  (245,)
copy_superpoint_src_corr_points.shape :  (211, 3)
copy_superpoint_ref_corr_points.shape :  (211, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([211, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 211, 3])
batch_inlier_masks.shape :  torch.Size([2000, 211])
best_index :  654
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (211, 3)
transformed_src_superpoints.shape :  torch.Size([211, 3])
residual.shape :  torch.Size([211])
batch_inlier_masks.shape :  torch.Size([211])
batch_outlier_masks.shape :  torch.Size([211])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([206])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [-0.06176706 -0.05263873  0.0377504 ]
 [-0.07414311 -0.04664703  0.04331864]
 [-0.06176706 -0.05263873  0.0377504 ]]
len(transformed_superpoints_pcd) :  1765
copy_superpoint_src_corr_points.shape :  (206, 3)
mask.shape :  (206,)
copy_superpoint_src_corr_points.shape :  (177, 3)
copy_superpoint_ref_corr_points.shape :  (177, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([177, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 177, 3])
batch_inlier_masks.shape :  torch.Size([2000, 177])
best_index :  343
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (177, 3)
transformed_src_superpoints.shape :  torch.Size([177, 3])
residual.shape :  torch.Size([177])
batch_inlier_masks.shape :  torch.Size([177])
batch_outlier_masks.shape :  torch.Size([177])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([173])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.01472859 -0.12309676 -0.00499294]
 [ 0.01472859 -0.12309676 -0.00499294]
 [ 0.01472859 -0.12309676 -0.00499294]]
len(transformed_superpoints_pcd) :  1769
copy_superpoint_src_corr_points.shape :  (173, 3)
mask.shape :  (173,)
copy_superpoint_src_corr_points.shape :  (160, 3)
copy_superpoint_ref_corr_points.shape :  (160, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([160, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 160, 3])
batch_inlier_masks.shape :  torch.Size([2000, 160])
best_index :  708
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (160, 3)
transformed_src_superpoints.shape :  torch.Size([160, 3])
residual.shape :  torch.Size([160])
batch_inlier_masks.shape :  torch.Size([160])
batch_outlier_masks.shape :  torch.Size([160])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([156])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.01301376 -0.03443139 -0.04021561]
 [ 0.08309668 -0.00793717 -0.02496695]
 [ 0.08309668 -0.00793717 -0.02496695]]
len(transformed_superpoints_pcd) :  1773
copy_superpoint_src_corr_points.shape :  (156, 3)
mask.shape :  (156,)
copy_superpoint_src_corr_points.shape :  (110, 3)
copy_superpoint_ref_corr_points.shape :  (110, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([110, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 110, 3])
batch_inlier_masks.shape :  torch.Size([2000, 110])
best_index :  1125
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (110, 3)
transformed_src_superpoints.shape :  torch.Size([110, 3])
residual.shape :  torch.Size([110])
batch_inlier_masks.shape :  torch.Size([110])
batch_outlier_masks.shape :  torch.Size([110])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([106])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.08816441 -0.03120881 -0.01385126]
 [ 0.08749622 -0.03206822 -0.00669766]
 [ 0.08816441 -0.03120881 -0.01385126]]
len(transformed_superpoints_pcd) :  1777
copy_superpoint_src_corr_points.shape :  (106, 3)
mask.shape :  (106,)
copy_superpoint_src_corr_points.shape :  (102, 3)
copy_superpoint_ref_corr_points.shape :  (102, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([102, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 102, 3])
batch_inlier_masks.shape :  torch.Size([2000, 102])
best_index :  1195
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (102, 3)
transformed_src_superpoints.shape :  torch.Size([102, 3])
residual.shape :  torch.Size([102])
batch_inlier_masks.shape :  torch.Size([102])
batch_outlier_masks.shape :  torch.Size([102])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([98])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.05220454 -0.0462638  -0.00516088]
 [ 0.05220454 -0.0462638  -0.00516088]
 [ 0.04617432 -0.05737557 -0.01247963]
 ...
 [ 0.01044978 -0.02587332 -0.04048439]
 [ 0.01044978 -0.02587332 -0.04048439]
 [ 0.01044978 -0.02587332 -0.04048439]]
len(transformed_superpoints_pcd) :  1781
copy_superpoint_src_corr_points.shape :  (98, 3)
mask.shape :  (98,)
copy_superpoint_src_corr_points.shape :  (98, 3)
copy_superpoint_ref_corr_points.shape :  (98, 3)
number of unique points in pcd :  729
number of rotations used :  70
transformed_superpoints_pcd.shape :  (1879, 3)
Line set updated
082
src_points :  [[-0.1300882   0.02467502 -0.01094195]
 [-0.12762992  0.0327431  -0.01201444]
 [-0.12724413  0.03721709 -0.01423139]
 ...
 [-0.00838114  0.1682121  -0.07902831]
 [-0.01586198  0.16550881 -0.07714843]
 [-0.02148508  0.16297145 -0.07582803]]
ref_points :  [[-0.10832125  0.00227571  0.05642994]
 [-0.10612176  0.0108118   0.0542661 ]
 [-0.10470351  0.0177229   0.05149782]
 ...
 [-0.04950933  0.17379364 -0.03260092]
 [-0.04396255  0.17802987 -0.04412273]
 [-0.04250211  0.17824008 -0.05107219]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([9950, 3])
lengths :  tensor([4896, 5054])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([6717, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([2112, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([1045, 3])
ref_points_f.shape :  torch.Size([4896, 3])
src_points_c.shape :  torch.Size([1067, 3])
src_points_f.shape :  torch.Size([5054, 3])
ref_node_masks.shape :  torch.Size([1045])
ref_node_knn_indices.shape :  torch.Size([1045, 5])
ref_node_knn_masks.shape :  torch.Size([1045, 5])
src_node_masks.shape :  torch.Size([1067])
src_node_knn_indices.shape :  torch.Size([1067, 5])
src_node_knn_masks.shape :  torch.Size([1067, 5])
ref_node_knn_points.shape :  torch.Size([1045, 5, 3])
src_node_knn_points.shape :  torch.Size([1067, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([2112, 512])
feats_f :  torch.Size([9950, 256])
k :  3
omegas.shape :  torch.Size([1092025, 128, 1])
omegas.shape :  torch.Size([3276075, 128, 1])
094
src_points :  [[-0.07436185  0.02524504  0.04119252]
 [-0.07373216  0.026556    0.03636954]
 [-0.07291794  0.02770571  0.03061258]
 ...
 [-0.0317802   0.0175235   0.01633774]
 [-0.04300954  0.0147028   0.04309741]
 [-0.03994118  0.01948907  0.06899039]]
ref_points :  [[-0.08202786  0.01995728 -0.01090144]
 [-0.08228672  0.019114   -0.00529749]
 [-0.08238837  0.01869785  0.00025844]
 ...
 [-0.08641842  0.02564511  0.0144211 ]
 [-0.07843734  0.02495068  0.01563376]
 [-0.04396457  0.02154023  0.01226196]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([3446, 3])
lengths :  tensor([1675, 1771])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([2124, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([651, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([323, 3])
ref_points_f.shape :  torch.Size([1675, 3])
src_points_c.shape :  torch.Size([328, 3])
src_points_f.shape :  torch.Size([1771, 3])
ref_node_masks.shape :  torch.Size([323])
ref_node_knn_indices.shape :  torch.Size([323, 5])
ref_node_knn_masks.shape :  torch.Size([323, 5])
src_node_masks.shape :  torch.Size([328])
src_node_knn_indices.shape :  torch.Size([328, 5])
src_node_knn_masks.shape :  torch.Size([328, 5])
ref_node_knn_points.shape :  torch.Size([323, 5, 3])
src_node_knn_points.shape :  torch.Size([328, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([651, 512])
feats_f :  torch.Size([3446, 256])
k :  3
omegas.shape :  torch.Size([104329, 128, 1])
omegas.shape :  torch.Size([312987, 128, 1])
k :  3
omegas.shape :  torch.Size([107584, 128, 1])
omegas.shape :  torch.Size([322752, 128, 1])
ref_feats_c.shape :  torch.Size([1, 323, 256])
src_feats_c.shape :  torch.Size([1, 328, 256])
ref_feats_c_norm.shape :  torch.Size([323, 256])
src_feats_c_norm.shape :  torch.Size([328, 256])
ref_node_masks.shape :  torch.Size([323])
src_node_masks.shape :  torch.Size([328])
self.num_correspondences :  2000
matching_scores.numel() :  105944
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([17861])
ref_indices.shape :  torch.Size([17861])
src_indices.shape :  torch.Size([17861])
batch_indices :  tensor([   0,    1,    2,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 3, 4, 4], device='cuda:0')
src_indices :  tensor([0, 0, 0,  ..., 4, 2, 4], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([17861, 3])
global_src_corr_points.shape :  torch.Size([17861, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([2000, 4, 4])
src_corr_points.shape :  torch.Size([17861, 3])
ref_corr_points.shape :  torch.Size([1, 17861, 3])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 17861, 3])
batch_corr_residuals.shape :  torch.Size([2000, 17861])
batch_inlier_masks.shape :  torch.Size([2000, 17861])
best_index :  tensor(470, device='cuda:0')
len(batch_transforms) :  2000
estimated_transform :  [[ 9.8543930e-01  1.3870844e-01 -9.8332003e-02 -1.9655004e-04]
 [-1.3779518e-01  9.9033064e-01  1.6052064e-02 -1.0566824e-02]
 [ 9.9607714e-02 -2.2687465e-03  9.9502432e-01  3.9872974e-03]
 [ 0.0000000e+00  0.0000000e+00  0.0000000e+00  1.0000000e+00]]
sorted_indices :  [1651  193  752 ...  741  425  470]
superpoint_src_corr_points.shape :  (17861, 3)
superpoint_ref_corr_points.shape :  (17861, 3)
batch_inlier_masks.shape :  (2000, 17861)
batch_transforms.shape :  (2000, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([17861, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 17861, 3])
batch_inlier_masks.shape :  torch.Size([2000, 17861])
best_index :  18
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (17861, 3)
transformed_src_superpoints.shape :  torch.Size([17861, 3])
residual.shape :  torch.Size([17861])
batch_inlier_masks.shape :  torch.Size([17861])
batch_outlier_masks.shape :  torch.Size([17861])
indices_inliers.shape :  torch.Size([276])
indices_outliers.shape :  torch.Size([17585])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([276, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.00730117 -0.02114011  0.07908215]
 [-0.01026187 -0.01619247  0.08179987]
 [-0.01337216 -0.02094161  0.08001066]
 [-0.00489231 -0.01487958  0.08198509]
 [-0.00230223 -0.02083665  0.07979325]
 [-0.00730117 -0.02114011  0.07908215]
 [-0.01026187 -0.01619247  0.08179987]
 [-0.00489231 -0.01487958  0.08198509]
 [-0.01337216 -0.02094161  0.08001066]
 [-0.01026187 -0.01619247  0.08179987]
 [-0.01337216 -0.02094161  0.08001066]
 [-0.01825491 -0.0199282   0.08043523]
 [-0.01825491 -0.0199282   0.08043523]
 [-0.01065146 -0.0250452   0.07708944]
 [-0.00058288 -0.0278975   0.07563214]
 [-0.00614064 -0.02695829  0.07534861]
 [-0.00058288 -0.0278975   0.07563214]
 [-0.01065146 -0.0250452   0.07708944]
 [-0.01590084 -0.02510342  0.07678381]
 [-0.01809417 -0.00479198  0.08527122]
 [-0.01222551 -0.01022682  0.08364961]
 [-0.01809417 -0.00479198  0.08527122]
 [-0.01809417 -0.00479198  0.08527122]
 [-0.00191188  0.02151902 -0.03881826]
 [-0.00191188  0.02151902 -0.03881826]
 [ 0.00281314  0.02502783 -0.03292515]
 [-0.00191188  0.02151902 -0.03881826]
 [-0.01380294  0.01831209 -0.04258525]
 [-0.0073921   0.01738438 -0.04373115]
 [-0.01380294  0.01831209 -0.04258525]
 [-0.0073921   0.01738438 -0.04373115]
 [-0.01386453  0.0183447  -0.04855964]
 [-0.0274062  -0.00043398  0.08111101]
 [-0.02224997 -0.00161722  0.08379251]
 [-0.02526849 -0.00583773  0.08317249]
 [-0.0274062  -0.00043398  0.08111101]
 [-0.02224997 -0.00161722  0.08379251]
 [-0.02526849 -0.00583773  0.08317249]
 [-0.02323894  0.00439994  0.08140299]
 [-0.02323894  0.00439994  0.08140299]
 [-0.01291869  0.02511591 -0.03280431]
 [-0.00825097  0.02664732 -0.03173704]
 [-0.00320487  0.02590814 -0.03228452]
 [-0.0158     -0.02910492  0.07243946]
 [-0.01135765 -0.03120718  0.07107946]
 [-0.01135765 -0.03120718  0.07107946]
 [-0.0164316  -0.03192377  0.06810647]
 [-0.0158     -0.02910492  0.07243946]
 [-0.01818872  0.02193347 -0.03574308]
 [-0.01818872  0.02193347 -0.03574308]
 [-0.02991867 -0.00722159  0.08030748]
 [-0.0274062  -0.00043398  0.08111101]
 [-0.02526849 -0.00583773  0.08317249]
 [-0.00772964  0.01617189 -0.04945609]
 [-0.01061831  0.02063839 -0.05164418]
 [-0.00165975  0.01681235 -0.04581102]
 [-0.01797929  0.00891163  0.0814587 ]
 [-0.01026187 -0.01619247  0.08179987]
 [-0.00489231 -0.01487958  0.08198509]
 [-0.01026187 -0.01619247  0.08179987]
 [-0.03228023 -0.01406914  0.07537213]
 [-0.02962593 -0.01930121  0.07395772]
 [-0.02564349 -0.02389336  0.07259224]
 [-0.02962593 -0.01930121  0.07395772]
 [-0.03228023 -0.01406914  0.07537213]
 [ 0.01657127  0.01609782  0.04812631]
 [ 0.01657127  0.01609782  0.04812631]
 [-0.01291869  0.02511591 -0.03280431]
 [-0.01090728  0.02814949 -0.02674188]
 [-0.01090728  0.02814949 -0.02674188]
 [-0.00447174  0.02965247 -0.02756498]
 [-0.00825097  0.02664732 -0.03173704]
 [-0.00447174  0.02965247 -0.02756498]
 [-0.00825097  0.02664732 -0.03173704]
 [-0.01090728  0.02814949 -0.02674188]
 [-0.02405633 -0.01915555  0.07875946]
 [-0.02405633 -0.01915555  0.07875946]
 [-0.02830753 -0.01500883  0.07861355]
 [-0.01825491 -0.0199282   0.08043523]
 [-0.02405633 -0.01915555  0.07875946]
 [-0.01825491 -0.0199282   0.08043523]
 [-0.02158797 -0.01507465  0.08258991]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.02158797 -0.01507465  0.08258991]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.00723241  0.00220129  0.08400352]
 [-0.00788392 -0.00374955  0.0838191 ]
 [-0.01273909  0.00080843  0.08366656]
 [-0.01273909  0.00080843  0.08366656]
 [-0.01337216 -0.02094161  0.08001066]
 [-0.01337216 -0.02094161  0.08001066]
 [-0.00614064 -0.02695829  0.07534861]
 [-0.01065146 -0.0250452   0.07708944]
 [-0.01590084 -0.02510342  0.07678381]
 [-0.00614064 -0.02695829  0.07534861]
 [-0.00058288 -0.0278975   0.07563214]
 [-0.00614064 -0.02695829  0.07534861]
 [-0.01065146 -0.0250452   0.07708944]
 [-0.01590084 -0.02510342  0.07678381]
 [-0.01590084 -0.02510342  0.07678381]
 [-0.01818872  0.02193347 -0.03574308]
 [-0.020612    0.02172112 -0.03053622]
 [-0.01818872  0.02193347 -0.03574308]
 [-0.00757738  0.03062213 -0.01966532]
 [-0.01376255  0.02793548 -0.01631522]
 [-0.00757738  0.03062213 -0.01966532]
 [-0.01318388  0.0274556  -0.02232222]
 [-0.01318388  0.0274556  -0.02232222]
 [-0.01318388  0.0274556  -0.02232222]
 [-0.0158     -0.02910492  0.07243946]
 [-0.02200255 -0.02868038  0.06912737]
 [-0.0158     -0.02910492  0.07243946]
 [-0.0164316  -0.03192377  0.06810647]
 [-0.0158     -0.02910492  0.07243946]
 [-0.01135765 -0.03120718  0.07107946]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 [-0.01222551 -0.01022682  0.08364961]
 [-0.01729107 -0.01045377  0.08457962]
 [-0.01809417 -0.00479198  0.08527122]
 [-0.01729107 -0.01045377  0.08457962]
 [-0.01809417 -0.00479198  0.08527122]
 [-0.02158797 -0.01507465  0.08258991]
 [ 0.03429557  0.01439608 -0.11176304]
 [-0.01026187 -0.01619247  0.08179987]
 [-0.01337216 -0.02094161  0.08001066]
 [-0.01061831  0.02063839 -0.05164418]
 [-0.01061831  0.02063839 -0.05164418]
 [ 0.01810996  0.00932098  0.03992451]
 [ 0.01738262  0.01136224  0.03510817]
 [ 0.01810996  0.00932098  0.03992451]
 [ 0.01738262  0.01136224  0.03510817]
 [-0.02158279  0.01253384  0.07888042]
 [-0.02647144  0.01407569  0.07597902]
 [ 0.01657127  0.01609782  0.04812631]
 [ 0.01761375  0.00675231  0.08792025]
 [-0.02564349 -0.02389336  0.07259224]
 [-0.02962593 -0.01930121  0.07395772]
 [-0.02564349 -0.02389336  0.07259224]
 [-0.02156435  0.02146626 -0.02047288]
 [-0.01798815  0.02391944 -0.02297228]
 [-0.01575691  0.02495661 -0.02754462]
 [-0.01575691  0.02495661 -0.02754462]
 [-0.01798815  0.02391944 -0.02297228]
 [-0.02291962  0.02004761 -0.02575929]
 [-0.01575691  0.02495661 -0.02754462]
 [-0.00646342  0.02843166 -0.05808773]
 [-0.00927096  0.02534955 -0.05510414]
 [-0.01380294  0.01831209 -0.04258525]
 [-0.0073921   0.01738438 -0.04373115]
 [ 0.03429557  0.01439608 -0.11176304]
 [-0.02405633 -0.01915555  0.07875946]
 [-0.01825491 -0.0199282   0.08043523]
 [-0.02405633 -0.01915555  0.07875946]
 [-0.01825491 -0.0199282   0.08043523]
 [-0.02405633 -0.01915555  0.07875946]
 [-0.01825491 -0.0199282   0.08043523]
 [-0.01590084 -0.02510342  0.07678381]
 [-0.01065146 -0.0250452   0.07708944]
 [-0.01590084 -0.02510342  0.07678381]
 [-0.01590084 -0.02510342  0.07678381]
 [-0.01520027 -0.01528216  0.08286663]
 [ 0.01699771  0.01437645  0.04133853]
 [ 0.01657127  0.01609782  0.04812631]
 [ 0.01699771  0.01437645  0.04133853]
 [ 0.01657127  0.01609782  0.04812631]
 [ 0.01699771  0.01437645  0.04133853]
 [ 0.01832157  0.00903197  0.04618425]
 [-0.01182994  0.01792065  0.08987059]
 [-0.01227432  0.01890803  0.09794866]
 [-0.0064589   0.0140101   0.0914768 ]
 [-0.01182994  0.01792065  0.08987059]
 [ 0.01441225  0.00085303  0.10756429]
 [ 0.01931442  0.00014706  0.10610218]
 [ 0.01735081  0.00479141  0.10525688]
 [-0.00296331  0.01738789 -0.05330145]
 [-0.01061831  0.02063839 -0.05164418]
 [-0.00165975  0.01681235 -0.04581102]
 [-0.01061831  0.02063839 -0.05164418]
 [-0.00165975  0.01681235 -0.04581102]
 [-0.00772964  0.01617189 -0.04945609]
 [-0.00296331  0.01738789 -0.05330145]
 [-0.01061831  0.02063839 -0.05164418]
 [-0.00772964  0.01617189 -0.04945609]
 [-0.00296331  0.01738789 -0.05330145]
 [ 0.02327127 -0.00780407 -0.12318457]
 [ 0.02327127 -0.00780407 -0.12318457]
 [-0.00228785  0.00397849  0.08783845]
 [-0.00171464 -0.00106132  0.08733699]
 [-0.00171464 -0.00106132  0.08733699]
 [-0.01337216 -0.02094161  0.08001066]
 [-0.01044817  0.0150475   0.08600791]
 [-0.01242113  0.01110456  0.0828165 ]
 [-0.01044817  0.0150475   0.08600791]
 [-0.01242113  0.01110456  0.0828165 ]
 [-0.01797929  0.00891163  0.0814587 ]
 [-0.01490621  0.01828756  0.08250745]
 [-0.01687817  0.01395669  0.08082629]
 [-0.01044817  0.0150475   0.08600791]
 [ 0.02694625  0.01028615 -0.02738666]
 [ 0.02630028  0.00709139 -0.03170333]
 [-0.01418274  0.01419108 -0.07039478]
 [-0.01368519  0.01896307 -0.07257892]
 [-0.00999331  0.01414383 -0.07354234]
 [-0.00999331  0.01414383 -0.07354234]
 [-0.00603496  0.01080756 -0.07375837]
 [-0.01418274  0.01419108 -0.07039478]
 [ 0.00679867  0.02991384 -0.02289015]
 [ 0.00213923  0.0294419  -0.0270693 ]
 [ 0.00679867  0.02991384 -0.02289015]
 [ 0.0046456   0.03046151 -0.01800161]
 [ 0.00213923  0.0294419  -0.0270693 ]
 [-0.0015249   0.03159181 -0.02225045]
 [-0.0015249   0.03159181 -0.02225045]
 [ 0.03084395  0.00228938 -0.11599425]
 [ 0.02972929 -0.00249313 -0.11295473]
 [ 0.01193812 -0.0011717   0.07339467]
 [-0.00325711  0.02465659 -0.05614123]
 [-0.00325711  0.02465659 -0.05614123]
 [ 0.00025884  0.02060599 -0.0562771 ]
 [ 0.01267681 -0.00059392  0.0806149 ]
 [ 0.01765443  0.00096615  0.08726468]
 [ 0.03691246  0.01525956 -0.10444583]
 [ 0.03691246  0.01525956 -0.10444583]
 [ 0.03280762  0.01994657 -0.1040381 ]
 [ 0.03691246  0.01525956 -0.10444583]
 [ 0.00877952  0.01270784  0.06998254]
 [ 0.00777082  0.01106875  0.07514431]
 [ 0.00465174  0.0200401   0.07882182]
 [ 0.00592255  0.01921862  0.06908411]
 [ 0.00613503  0.01568649  0.07645215]
 [ 0.00592255  0.01921862  0.06908411]
 [ 0.00613503  0.01568649  0.07645215]
 [ 0.00465174  0.0200401   0.07882182]
 [ 0.01331244 -0.00982104  0.07493322]
 [ 0.01320873 -0.00642794  0.07940531]
 [-0.01550703  0.00802984 -0.06612059]
 [-0.01017153  0.00323203 -0.06658196]
 [ 0.03084395  0.00228938 -0.11599425]
 [ 0.03084395  0.00228938 -0.11599425]
 [ 0.02972929 -0.00249313 -0.11295473]
 [ 0.03581732  0.00982503 -0.1101004 ]
 [ 0.03280762  0.01994657 -0.1040381 ]
 [-0.02085092 -0.00280687 -0.00660647]
 [-0.03204192  0.00046381  0.07758858]
 [ 0.03417441  0.01536935 -0.09491757]
 [ 0.03417441  0.01536935 -0.09491757]
 [-0.00320487  0.02590814 -0.03228452]
 [-0.00825097  0.02664732 -0.03173704]
 [-0.01090728  0.02814949 -0.02674188]
 [-0.00447174  0.02965247 -0.02756498]
 [-0.01090728  0.02814949 -0.02674188]
 [-0.00447174  0.02965247 -0.02756498]
 [-0.03092288  0.00582191  0.07683915]
 [-0.03457397  0.00835901  0.07309637]
 [-0.03043135  0.01105021  0.07518264]
 [-0.03092288  0.00582191  0.07683915]
 [-0.03204192  0.00046381  0.07758858]
 [-0.03043135  0.01105021  0.07518264]
 [ 0.02142787 -0.01218161 -0.11089227]
 [ 0.02385375 -0.00864191 -0.10756703]
 [ 0.02385375 -0.00864191 -0.10756703]
 [ 0.02142026 -0.00908255 -0.1021684 ]
 [ 0.02385375 -0.00864191 -0.10756703]
 [ 0.02142026 -0.00908255 -0.1021684 ]
 [ 0.01734551 -0.00980841  0.08356074]
 [ 0.01579097 -0.01754808  0.07320718]
 [ 0.00916123  0.01987565  0.06457187]
 [ 0.00744274  0.02413431  0.06244375]
 [ 0.00438087  0.0238648   0.06678944]
 [-0.00146712  0.03093911 -0.01550495]
 [-0.00757738  0.03062213 -0.01966532]]
len(transformed_superpoints_pcd) :  276
copy_superpoint_src_corr_points.shape :  (17585, 3)
mask.shape :  (17585,)
copy_superpoint_src_corr_points.shape :  (12833, 3)
copy_superpoint_ref_corr_points.shape :  (12833, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12833, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 12833, 3])
batch_inlier_masks.shape :  torch.Size([2000, 12833])
best_index :  741
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12833, 3)
transformed_src_superpoints.shape :  torch.Size([12833, 3])
residual.shape :  torch.Size([12833])
batch_inlier_masks.shape :  torch.Size([12833])
batch_outlier_masks.shape :  torch.Size([12833])
indices_inliers.shape :  torch.Size([194])
indices_outliers.shape :  torch.Size([12639])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([194, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00148101 -0.01790867 -0.02705717]
 [-0.00709031 -0.01480437 -0.02116488]
 [-0.00148101 -0.01790867 -0.02705717]]
len(transformed_superpoints_pcd) :  470
copy_superpoint_src_corr_points.shape :  (12639, 3)
mask.shape :  (12639,)
copy_superpoint_src_corr_points.shape :  (9798, 3)
copy_superpoint_ref_corr_points.shape :  (9798, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9798, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 9798, 3])
batch_inlier_masks.shape :  torch.Size([2000, 9798])
best_index :  1750
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9798, 3)
transformed_src_superpoints.shape :  torch.Size([9798, 3])
residual.shape :  torch.Size([9798])
batch_inlier_masks.shape :  torch.Size([9798])
batch_outlier_masks.shape :  torch.Size([9798])
indices_inliers.shape :  torch.Size([108])
indices_outliers.shape :  torch.Size([9690])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([108, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.0017329  -0.01985892  0.0709552 ]
 [ 0.02949232 -0.00088169 -0.11105574]
 [ 0.0326125   0.00206278 -0.10818172]]
len(transformed_superpoints_pcd) :  578
copy_superpoint_src_corr_points.shape :  (9690, 3)
mask.shape :  (9690,)
copy_superpoint_src_corr_points.shape :  (8933, 3)
copy_superpoint_ref_corr_points.shape :  (8933, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8933, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 8933, 3])
batch_inlier_masks.shape :  torch.Size([2000, 8933])
best_index :  988
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8933, 3)
transformed_src_superpoints.shape :  torch.Size([8933, 3])
residual.shape :  torch.Size([8933])
batch_inlier_masks.shape :  torch.Size([8933])
batch_outlier_masks.shape :  torch.Size([8933])
indices_inliers.shape :  torch.Size([107])
indices_outliers.shape :  torch.Size([8826])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([107, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.02658857  0.00672767 -0.08872121]
 [ 0.03610925  0.0153015  -0.08756382]
 [ 0.02658857  0.00672767 -0.08872121]]
len(transformed_superpoints_pcd) :  685
copy_superpoint_src_corr_points.shape :  (8826, 3)
mask.shape :  (8826,)
copy_superpoint_src_corr_points.shape :  (7626, 3)
copy_superpoint_ref_corr_points.shape :  (7626, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7626, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7626, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7626])
best_index :  773
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7626, 3)
transformed_src_superpoints.shape :  torch.Size([7626, 3])
residual.shape :  torch.Size([7626])
batch_inlier_masks.shape :  torch.Size([7626])
batch_outlier_masks.shape :  torch.Size([7626])
indices_inliers.shape :  torch.Size([85])
indices_outliers.shape :  torch.Size([7541])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([85, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.03374005 -0.03758775 -0.10024366]
 [-0.03045286 -0.03829535 -0.10495283]
 [-0.03374005 -0.03758775 -0.10024366]]
len(transformed_superpoints_pcd) :  770
copy_superpoint_src_corr_points.shape :  (7541, 3)
mask.shape :  (7541,)
copy_superpoint_src_corr_points.shape :  (6943, 3)
copy_superpoint_ref_corr_points.shape :  (6943, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6943, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6943, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6943])
best_index :  454
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6943, 3)
transformed_src_superpoints.shape :  torch.Size([6943, 3])
residual.shape :  torch.Size([6943])
batch_inlier_masks.shape :  torch.Size([6943])
batch_outlier_masks.shape :  torch.Size([6943])
indices_inliers.shape :  torch.Size([81])
indices_outliers.shape :  torch.Size([6862])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([81, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.07198897 -0.04739968  0.04384444]
 [ 0.07450122 -0.04571475  0.05001616]
 [ 0.07639423 -0.0494777   0.04016208]]
len(transformed_superpoints_pcd) :  851
copy_superpoint_src_corr_points.shape :  (6862, 3)
mask.shape :  (6862,)
copy_superpoint_src_corr_points.shape :  (6281, 3)
copy_superpoint_ref_corr_points.shape :  (6281, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6281, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6281, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6281])
best_index :  770
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6281, 3)
transformed_src_superpoints.shape :  torch.Size([6281, 3])
residual.shape :  torch.Size([6281])
batch_inlier_masks.shape :  torch.Size([6281])
batch_outlier_masks.shape :  torch.Size([6281])
indices_inliers.shape :  torch.Size([65])
indices_outliers.shape :  torch.Size([6216])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([65, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.03115907 -0.0267132   0.07330532]
 [-0.02473965 -0.02589181  0.07223865]
 [-0.02663682 -0.02055345  0.07632209]]
len(transformed_superpoints_pcd) :  916
copy_superpoint_src_corr_points.shape :  (6216, 3)
mask.shape :  (6216,)
copy_superpoint_src_corr_points.shape :  (5604, 3)
copy_superpoint_ref_corr_points.shape :  (5604, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5604, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5604, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5604])
best_index :  1571
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5604, 3)
transformed_src_superpoints.shape :  torch.Size([5604, 3])
residual.shape :  torch.Size([5604])
batch_inlier_masks.shape :  torch.Size([5604])
batch_outlier_masks.shape :  torch.Size([5604])
indices_inliers.shape :  torch.Size([63])
indices_outliers.shape :  torch.Size([5541])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([63, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.04713726 -0.00877695  0.06789521]
 [-0.0095025  -0.03731779  0.03562612]
 [-0.0095025  -0.03731779  0.03562612]]
len(transformed_superpoints_pcd) :  979
copy_superpoint_src_corr_points.shape :  (5541, 3)
mask.shape :  (5541,)
copy_superpoint_src_corr_points.shape :  (4822, 3)
copy_superpoint_ref_corr_points.shape :  (4822, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4822, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4822, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4822])
best_index :  1290
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4822, 3)
transformed_src_superpoints.shape :  torch.Size([4822, 3])
residual.shape :  torch.Size([4822])
batch_inlier_masks.shape :  torch.Size([4822])
batch_outlier_masks.shape :  torch.Size([4822])
indices_inliers.shape :  torch.Size([60])
indices_outliers.shape :  torch.Size([4762])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([60, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.00952037 -0.00990872  0.08036792]
 [ 0.00952037 -0.00990872  0.08036792]
 [ 0.00952037 -0.00990872  0.08036792]]
len(transformed_superpoints_pcd) :  1039
copy_superpoint_src_corr_points.shape :  (4762, 3)
mask.shape :  (4762,)
copy_superpoint_src_corr_points.shape :  (3984, 3)
copy_superpoint_ref_corr_points.shape :  (3984, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3984, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3984, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3984])
best_index :  1613
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3984, 3)
transformed_src_superpoints.shape :  torch.Size([3984, 3])
residual.shape :  torch.Size([3984])
batch_inlier_masks.shape :  torch.Size([3984])
batch_outlier_masks.shape :  torch.Size([3984])
indices_inliers.shape :  torch.Size([54])
indices_outliers.shape :  torch.Size([3930])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([54, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.0074694   0.02812001 -0.03186445]
 [-0.0074694   0.02812001 -0.03186445]
 [-0.03795343 -0.00146807  0.07883202]]
len(transformed_superpoints_pcd) :  1093
copy_superpoint_src_corr_points.shape :  (3930, 3)
mask.shape :  (3930,)
copy_superpoint_src_corr_points.shape :  (3523, 3)
copy_superpoint_ref_corr_points.shape :  (3523, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3523, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3523, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3523])
best_index :  922
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3523, 3)
transformed_src_superpoints.shape :  torch.Size([3523, 3])
residual.shape :  torch.Size([3523])
batch_inlier_masks.shape :  torch.Size([3523])
batch_outlier_masks.shape :  torch.Size([3523])
indices_inliers.shape :  torch.Size([37])
indices_outliers.shape :  torch.Size([3486])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([37, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.0095327  -0.00661528  0.08702353]
 [-0.01298794 -0.01471918  0.0846189 ]
 [-0.01298794 -0.01471918  0.0846189 ]]
len(transformed_superpoints_pcd) :  1130
copy_superpoint_src_corr_points.shape :  (3486, 3)
mask.shape :  (3486,)
copy_superpoint_src_corr_points.shape :  (3238, 3)
copy_superpoint_ref_corr_points.shape :  (3238, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3238, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3238, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3238])
best_index :  387
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3238, 3)
transformed_src_superpoints.shape :  torch.Size([3238, 3])
residual.shape :  torch.Size([3238])
batch_inlier_masks.shape :  torch.Size([3238])
batch_outlier_masks.shape :  torch.Size([3238])
indices_inliers.shape :  torch.Size([33])
indices_outliers.shape :  torch.Size([3205])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([33, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00971045  0.0257575  -0.0313344 ]
 [-0.00864158  0.02819456 -0.03576574]
 [-0.00971045  0.0257575  -0.0313344 ]]
len(transformed_superpoints_pcd) :  1163
copy_superpoint_src_corr_points.shape :  (3205, 3)
mask.shape :  (3205,)
copy_superpoint_src_corr_points.shape :  (2965, 3)
copy_superpoint_ref_corr_points.shape :  (2965, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2965, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2965, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2965])
best_index :  1463
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2965, 3)
transformed_src_superpoints.shape :  torch.Size([2965, 3])
residual.shape :  torch.Size([2965])
batch_inlier_masks.shape :  torch.Size([2965])
batch_outlier_masks.shape :  torch.Size([2965])
indices_inliers.shape :  torch.Size([30])
indices_outliers.shape :  torch.Size([2935])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([30, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.03838683 -0.00018068 -0.11387422]
 [ 0.03838683 -0.00018068 -0.11387422]
 [ 0.02329226  0.00316639 -0.09767538]]
len(transformed_superpoints_pcd) :  1193
copy_superpoint_src_corr_points.shape :  (2935, 3)
mask.shape :  (2935,)
copy_superpoint_src_corr_points.shape :  (2780, 3)
copy_superpoint_ref_corr_points.shape :  (2780, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2780, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2780, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2780])
best_index :  604
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2780, 3)
transformed_src_superpoints.shape :  torch.Size([2780, 3])
residual.shape :  torch.Size([2780])
batch_inlier_masks.shape :  torch.Size([2780])
batch_outlier_masks.shape :  torch.Size([2780])
indices_inliers.shape :  torch.Size([29])
indices_outliers.shape :  torch.Size([2751])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([29, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.01702584 -0.01696902  0.08099681]
 [-0.01087203 -0.01787325  0.07940689]
 [-0.01702584 -0.01696902  0.08099681]]
len(transformed_superpoints_pcd) :  1222
copy_superpoint_src_corr_points.shape :  (2751, 3)
mask.shape :  (2751,)
copy_superpoint_src_corr_points.shape :  (2468, 3)
copy_superpoint_ref_corr_points.shape :  (2468, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2468, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2468, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2468])
best_index :  840
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2468, 3)
transformed_src_superpoints.shape :  torch.Size([2468, 3])
residual.shape :  torch.Size([2468])
batch_inlier_masks.shape :  torch.Size([2468])
batch_outlier_masks.shape :  torch.Size([2468])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([2440])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.01274149 -0.01538266  0.085116  ]
 [ 0.00732635 -0.02386838  0.07437925]
 [ 0.01274149 -0.01538266  0.085116  ]]
len(transformed_superpoints_pcd) :  1250
copy_superpoint_src_corr_points.shape :  (2440, 3)
mask.shape :  (2440,)
copy_superpoint_src_corr_points.shape :  (2294, 3)
copy_superpoint_ref_corr_points.shape :  (2294, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2294, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2294, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2294])
best_index :  479
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2294, 3)
transformed_src_superpoints.shape :  torch.Size([2294, 3])
residual.shape :  torch.Size([2294])
batch_inlier_masks.shape :  torch.Size([2294])
batch_outlier_masks.shape :  torch.Size([2294])
indices_inliers.shape :  torch.Size([23])
indices_outliers.shape :  torch.Size([2271])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([23, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.02310711  0.01655866 -0.04626568]
 [-0.00133172 -0.00657773 -0.00703655]
 [ 0.01039803 -0.02229591 -0.012636  ]]
len(transformed_superpoints_pcd) :  1273
copy_superpoint_src_corr_points.shape :  (2271, 3)
mask.shape :  (2271,)
copy_superpoint_src_corr_points.shape :  (2185, 3)
copy_superpoint_ref_corr_points.shape :  (2185, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2185, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2185, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2185])
best_index :  1852
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2185, 3)
transformed_src_superpoints.shape :  torch.Size([2185, 3])
residual.shape :  torch.Size([2185])
batch_inlier_masks.shape :  torch.Size([2185])
batch_outlier_masks.shape :  torch.Size([2185])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([2163])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.01271613  0.01133703 -0.06044603]
 [ 0.01271613  0.01133703 -0.06044603]
 [ 0.01271613  0.01133703 -0.06044603]]
len(transformed_superpoints_pcd) :  1295
copy_superpoint_src_corr_points.shape :  (2163, 3)
mask.shape :  (2163,)
copy_superpoint_src_corr_points.shape :  (2025, 3)
copy_superpoint_ref_corr_points.shape :  (2025, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2025, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2025, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2025])
best_index :  746
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2025, 3)
transformed_src_superpoints.shape :  torch.Size([2025, 3])
residual.shape :  torch.Size([2025])
batch_inlier_masks.shape :  torch.Size([2025])
batch_outlier_masks.shape :  torch.Size([2025])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2004])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.0070298   0.01823623 -0.04184841]
 [-0.00667327  0.01340805 -0.04534428]
 [ 0.04863644  0.01055213 -0.1089615 ]]
len(transformed_superpoints_pcd) :  1316
copy_superpoint_src_corr_points.shape :  (2004, 3)
mask.shape :  (2004,)
copy_superpoint_src_corr_points.shape :  (1969, 3)
copy_superpoint_ref_corr_points.shape :  (1969, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1969, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1969, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1969])
best_index :  1037
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1969, 3)
transformed_src_superpoints.shape :  torch.Size([1969, 3])
residual.shape :  torch.Size([1969])
batch_inlier_masks.shape :  torch.Size([1969])
batch_outlier_masks.shape :  torch.Size([1969])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([1948])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.01187475 -0.00933534 -0.06307784]
 [-0.01405761 -0.0138538  -0.06455878]
 [-0.02747924 -0.00889854  0.08255085]]
len(transformed_superpoints_pcd) :  1337
copy_superpoint_src_corr_points.shape :  (1948, 3)
mask.shape :  (1948,)
copy_superpoint_src_corr_points.shape :  (1854, 3)
copy_superpoint_ref_corr_points.shape :  (1854, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1854, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1854, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1854])
best_index :  1190
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1854, 3)
transformed_src_superpoints.shape :  torch.Size([1854, 3])
residual.shape :  torch.Size([1854])
batch_inlier_masks.shape :  torch.Size([1854])
batch_outlier_masks.shape :  torch.Size([1854])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([1833])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.02046484 -0.0110655   0.082148  ]
 [-0.02046484 -0.0110655   0.082148  ]
 [-0.02146464 -0.00622261  0.07342625]]
len(transformed_superpoints_pcd) :  1358
copy_superpoint_src_corr_points.shape :  (1833, 3)
mask.shape :  (1833,)
copy_superpoint_src_corr_points.shape :  (1743, 3)
copy_superpoint_ref_corr_points.shape :  (1743, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1743, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1743, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1743])
best_index :  1388
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1743, 3)
transformed_src_superpoints.shape :  torch.Size([1743, 3])
residual.shape :  torch.Size([1743])
batch_inlier_masks.shape :  torch.Size([1743])
batch_outlier_masks.shape :  torch.Size([1743])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([1722])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.05213057 -0.04106173  0.03040844]
 [ 0.05968291 -0.04596999  0.02448671]
 [ 0.07785782 -0.03834562  0.03605742]]
len(transformed_superpoints_pcd) :  1379
copy_superpoint_src_corr_points.shape :  (1722, 3)
mask.shape :  (1722,)
copy_superpoint_src_corr_points.shape :  (1626, 3)
copy_superpoint_ref_corr_points.shape :  (1626, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1626, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1626, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1626])
best_index :  227
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1626, 3)
transformed_src_superpoints.shape :  torch.Size([1626, 3])
residual.shape :  torch.Size([1626])
batch_inlier_masks.shape :  torch.Size([1626])
batch_outlier_masks.shape :  torch.Size([1626])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([1606])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00071641 -0.0094556   0.07637806]
 [-0.0031387  -0.00487138  0.07895715]
 [ 0.0012598  -0.00280632  0.07682671]]
len(transformed_superpoints_pcd) :  1399
copy_superpoint_src_corr_points.shape :  (1606, 3)
mask.shape :  (1606,)
copy_superpoint_src_corr_points.shape :  (1514, 3)
copy_superpoint_ref_corr_points.shape :  (1514, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1514, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1514, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1514])
best_index :  339
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1514, 3)
transformed_src_superpoints.shape :  torch.Size([1514, 3])
residual.shape :  torch.Size([1514])
batch_inlier_masks.shape :  torch.Size([1514])
batch_outlier_masks.shape :  torch.Size([1514])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([1496])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.02184086 -0.01896334  0.07556599]
 [-0.02138216 -0.01676326  0.08035058]
 [-0.02138216 -0.01676326  0.08035058]]
len(transformed_superpoints_pcd) :  1417
copy_superpoint_src_corr_points.shape :  (1496, 3)
mask.shape :  (1496,)
copy_superpoint_src_corr_points.shape :  (1430, 3)
copy_superpoint_ref_corr_points.shape :  (1430, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1430, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1430, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1430])
best_index :  1582
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1430, 3)
transformed_src_superpoints.shape :  torch.Size([1430, 3])
residual.shape :  torch.Size([1430])
batch_inlier_masks.shape :  torch.Size([1430])
batch_outlier_masks.shape :  torch.Size([1430])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([1412])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.02548624 -0.00332142  0.07735301]
 [-0.01743563 -0.02538678  0.07702731]
 [-0.01743563 -0.02538678  0.07702731]]
len(transformed_superpoints_pcd) :  1435
copy_superpoint_src_corr_points.shape :  (1412, 3)
mask.shape :  (1412,)
copy_superpoint_src_corr_points.shape :  (1381, 3)
copy_superpoint_ref_corr_points.shape :  (1381, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1381, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1381, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1381])
best_index :  1770
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1381, 3)
transformed_src_superpoints.shape :  torch.Size([1381, 3])
residual.shape :  torch.Size([1381])
batch_inlier_masks.shape :  torch.Size([1381])
batch_outlier_masks.shape :  torch.Size([1381])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([1363])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.03065073 -0.03749963 -0.1037595 ]
 [-0.0258171  -0.03490424 -0.10651577]
 [-0.01904406 -0.03238102 -0.10214148]]
len(transformed_superpoints_pcd) :  1453
copy_superpoint_src_corr_points.shape :  (1363, 3)
mask.shape :  (1363,)
copy_superpoint_src_corr_points.shape :  (1332, 3)
copy_superpoint_ref_corr_points.shape :  (1332, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1332, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1332, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1332])
best_index :  411
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1332, 3)
transformed_src_superpoints.shape :  torch.Size([1332, 3])
residual.shape :  torch.Size([1332])
batch_inlier_masks.shape :  torch.Size([1332])
batch_outlier_masks.shape :  torch.Size([1332])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1315])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.01325913  0.0195114  -0.04690081]
 [-0.00903975  0.01657866 -0.05355788]
 [-0.00903975  0.01657866 -0.05355788]]
len(transformed_superpoints_pcd) :  1470
copy_superpoint_src_corr_points.shape :  (1315, 3)
mask.shape :  (1315,)
copy_superpoint_src_corr_points.shape :  (1239, 3)
copy_superpoint_ref_corr_points.shape :  (1239, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1239, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1239, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1239])
best_index :  672
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1239, 3)
transformed_src_superpoints.shape :  torch.Size([1239, 3])
residual.shape :  torch.Size([1239])
batch_inlier_masks.shape :  torch.Size([1239])
batch_outlier_masks.shape :  torch.Size([1239])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1223])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.01881556 -0.02255853  0.07669333]
 [-0.01881556 -0.02255853  0.07669333]
 [-0.01736621 -0.02243388  0.06132406]]
len(transformed_superpoints_pcd) :  1486
copy_superpoint_src_corr_points.shape :  (1223, 3)
mask.shape :  (1223,)
copy_superpoint_src_corr_points.shape :  (1180, 3)
copy_superpoint_ref_corr_points.shape :  (1180, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1180, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1180, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1180])
best_index :  566
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1180, 3)
transformed_src_superpoints.shape :  torch.Size([1180, 3])
residual.shape :  torch.Size([1180])
batch_inlier_masks.shape :  torch.Size([1180])
batch_outlier_masks.shape :  torch.Size([1180])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1165])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.01067565 -0.01253451 -0.08190919]
 [-0.01490659 -0.00400312 -0.07658982]
 [-0.01409475 -0.00998144 -0.07704274]]
len(transformed_superpoints_pcd) :  1501
copy_superpoint_src_corr_points.shape :  (1165, 3)
mask.shape :  (1165,)
copy_superpoint_src_corr_points.shape :  (1052, 3)
copy_superpoint_ref_corr_points.shape :  (1052, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1052, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1052, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1052])
best_index :  26
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1052, 3)
transformed_src_superpoints.shape :  torch.Size([1052, 3])
residual.shape :  torch.Size([1052])
batch_inlier_masks.shape :  torch.Size([1052])
batch_outlier_masks.shape :  torch.Size([1052])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1039])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.01248035 -0.01676148  0.08168124]
 [ 0.01106692 -0.00495537  0.07908763]
 [ 0.01106692 -0.00495537  0.07908763]]
len(transformed_superpoints_pcd) :  1514
copy_superpoint_src_corr_points.shape :  (1039, 3)
mask.shape :  (1039,)
copy_superpoint_src_corr_points.shape :  (917, 3)
copy_superpoint_ref_corr_points.shape :  (917, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([917, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 917, 3])
batch_inlier_masks.shape :  torch.Size([2000, 917])
best_index :  1176
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (917, 3)
transformed_src_superpoints.shape :  torch.Size([917, 3])
residual.shape :  torch.Size([917])
batch_inlier_masks.shape :  torch.Size([917])
batch_outlier_masks.shape :  torch.Size([917])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([905])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00522366 -0.02704531  0.05766928]
 [-0.0106307  -0.02765489  0.05995423]
 [-0.00522366 -0.02704531  0.05766928]]
len(transformed_superpoints_pcd) :  1526
copy_superpoint_src_corr_points.shape :  (905, 3)
mask.shape :  (905,)
copy_superpoint_src_corr_points.shape :  (841, 3)
copy_superpoint_ref_corr_points.shape :  (841, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([841, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 841, 3])
batch_inlier_masks.shape :  torch.Size([2000, 841])
best_index :  1953
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (841, 3)
transformed_src_superpoints.shape :  torch.Size([841, 3])
residual.shape :  torch.Size([841])
batch_inlier_masks.shape :  torch.Size([841])
batch_outlier_masks.shape :  torch.Size([841])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([829])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.02762929  0.02383918  0.10306479]
 [ 0.02284187  0.02770457  0.09987459]
 [ 0.02744359  0.01837496  0.10588388]]
len(transformed_superpoints_pcd) :  1538
copy_superpoint_src_corr_points.shape :  (829, 3)
mask.shape :  (829,)
copy_superpoint_src_corr_points.shape :  (829, 3)
copy_superpoint_ref_corr_points.shape :  (829, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([829, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 829, 3])
batch_inlier_masks.shape :  torch.Size([2000, 829])
best_index :  499
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (829, 3)
transformed_src_superpoints.shape :  torch.Size([829, 3])
residual.shape :  torch.Size([829])
batch_inlier_masks.shape :  torch.Size([829])
batch_outlier_masks.shape :  torch.Size([829])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([818])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.01872197 -0.02203159  0.07721545]
 [-0.01872197 -0.02203159  0.07721545]
 [-0.01872197 -0.02203159  0.07721545]]
len(transformed_superpoints_pcd) :  1549
copy_superpoint_src_corr_points.shape :  (818, 3)
mask.shape :  (818,)
copy_superpoint_src_corr_points.shape :  (705, 3)
copy_superpoint_ref_corr_points.shape :  (705, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([705, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 705, 3])
batch_inlier_masks.shape :  torch.Size([2000, 705])
best_index :  1685
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (705, 3)
transformed_src_superpoints.shape :  torch.Size([705, 3])
residual.shape :  torch.Size([705])
batch_inlier_masks.shape :  torch.Size([705])
batch_outlier_masks.shape :  torch.Size([705])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([694])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.01542721 -0.01036681  0.07643057]
 [ 0.01275924 -0.00759627  0.08027885]
 [ 0.01031689 -0.01611106  0.0770935 ]]
len(transformed_superpoints_pcd) :  1560
copy_superpoint_src_corr_points.shape :  (694, 3)
mask.shape :  (694,)
copy_superpoint_src_corr_points.shape :  (694, 3)
copy_superpoint_ref_corr_points.shape :  (694, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([694, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 694, 3])
batch_inlier_masks.shape :  torch.Size([2000, 694])
best_index :  1993
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (694, 3)
transformed_src_superpoints.shape :  torch.Size([694, 3])
residual.shape :  torch.Size([694])
batch_inlier_masks.shape :  torch.Size([694])
batch_outlier_masks.shape :  torch.Size([694])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([683])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.06233941 -0.05179737  0.03301534]
 [ 0.0610944  -0.04766002  0.03806805]
 [ 0.06192851 -0.05040306  0.04326478]]
len(transformed_superpoints_pcd) :  1571
copy_superpoint_src_corr_points.shape :  (683, 3)
mask.shape :  (683,)
copy_superpoint_src_corr_points.shape :  (682, 3)
copy_superpoint_ref_corr_points.shape :  (682, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([682, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 682, 3])
batch_inlier_masks.shape :  torch.Size([2000, 682])
best_index :  1997
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (682, 3)
transformed_src_superpoints.shape :  torch.Size([682, 3])
residual.shape :  torch.Size([682])
batch_inlier_masks.shape :  torch.Size([682])
batch_outlier_masks.shape :  torch.Size([682])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([671])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00581631  0.02521764 -0.0425478 ]
 [-0.00397737  0.02300726 -0.04677247]
 [-0.00994179  0.02301705 -0.03984863]]
len(transformed_superpoints_pcd) :  1582
copy_superpoint_src_corr_points.shape :  (671, 3)
mask.shape :  (671,)
copy_superpoint_src_corr_points.shape :  (671, 3)
copy_superpoint_ref_corr_points.shape :  (671, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([671, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 671, 3])
batch_inlier_masks.shape :  torch.Size([2000, 671])
best_index :  335
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (671, 3)
transformed_src_superpoints.shape :  torch.Size([671, 3])
residual.shape :  torch.Size([671])
batch_inlier_masks.shape :  torch.Size([671])
batch_outlier_masks.shape :  torch.Size([671])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([662])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.03007696 -0.00537882 -0.08475715]
 [-0.03007696 -0.00537882 -0.08475715]
 [-0.03007696 -0.00537882 -0.08475715]]
len(transformed_superpoints_pcd) :  1591
copy_superpoint_src_corr_points.shape :  (662, 3)
mask.shape :  (662,)
copy_superpoint_src_corr_points.shape :  (615, 3)
copy_superpoint_ref_corr_points.shape :  (615, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([615, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 615, 3])
batch_inlier_masks.shape :  torch.Size([2000, 615])
best_index :  1204
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (615, 3)
transformed_src_superpoints.shape :  torch.Size([615, 3])
residual.shape :  torch.Size([615])
batch_inlier_masks.shape :  torch.Size([615])
batch_outlier_masks.shape :  torch.Size([615])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([606])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.03964411 -0.00047441 -0.10464626]
 [-0.03160109 -0.0010114  -0.10679897]
 [-0.03964411 -0.00047441 -0.10464626]]
len(transformed_superpoints_pcd) :  1600
copy_superpoint_src_corr_points.shape :  (606, 3)
mask.shape :  (606,)
copy_superpoint_src_corr_points.shape :  (606, 3)
copy_superpoint_ref_corr_points.shape :  (606, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([606, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 606, 3])
batch_inlier_masks.shape :  torch.Size([2000, 606])
best_index :  1458
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (606, 3)
transformed_src_superpoints.shape :  torch.Size([606, 3])
residual.shape :  torch.Size([606])
batch_inlier_masks.shape :  torch.Size([606])
batch_outlier_masks.shape :  torch.Size([606])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([597])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00716341 -0.02859605  0.06649309]
 [-0.00716341 -0.02859605  0.06649309]
 [-0.00668098 -0.03057374  0.06169404]]
len(transformed_superpoints_pcd) :  1609
copy_superpoint_src_corr_points.shape :  (597, 3)
mask.shape :  (597,)
copy_superpoint_src_corr_points.shape :  (576, 3)
copy_superpoint_ref_corr_points.shape :  (576, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([576, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 576, 3])
batch_inlier_masks.shape :  torch.Size([2000, 576])
best_index :  1979
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (576, 3)
transformed_src_superpoints.shape :  torch.Size([576, 3])
residual.shape :  torch.Size([576])
batch_inlier_masks.shape :  torch.Size([576])
batch_outlier_masks.shape :  torch.Size([576])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([567])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00195653 -0.03108782  0.05677147]
 [-0.00243866 -0.02867749  0.06366887]
 [-0.00694295 -0.02953715  0.06593958]]
len(transformed_superpoints_pcd) :  1618
copy_superpoint_src_corr_points.shape :  (567, 3)
mask.shape :  (567,)
copy_superpoint_src_corr_points.shape :  (565, 3)
copy_superpoint_ref_corr_points.shape :  (565, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([565, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 565, 3])
batch_inlier_masks.shape :  torch.Size([2000, 565])
best_index :  1081
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (565, 3)
transformed_src_superpoints.shape :  torch.Size([565, 3])
residual.shape :  torch.Size([565])
batch_inlier_masks.shape :  torch.Size([565])
batch_outlier_masks.shape :  torch.Size([565])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([558])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.02602232  0.0279412   0.00028235]
 [ 0.01598649 -0.00865289  0.07728353]
 [-0.00703936 -0.00291621 -0.0633443 ]]
len(transformed_superpoints_pcd) :  1625
copy_superpoint_src_corr_points.shape :  (558, 3)
mask.shape :  (558,)
copy_superpoint_src_corr_points.shape :  (530, 3)
copy_superpoint_ref_corr_points.shape :  (530, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([530, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 530, 3])
batch_inlier_masks.shape :  torch.Size([2000, 530])
best_index :  1147
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (530, 3)
transformed_src_superpoints.shape :  torch.Size([530, 3])
residual.shape :  torch.Size([530])
batch_inlier_masks.shape :  torch.Size([530])
batch_outlier_masks.shape :  torch.Size([530])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([523])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.0327391  -0.00272563 -0.10940726]
 [-0.0327391  -0.00272563 -0.10940726]
 [-0.04386048 -0.00109951 -0.10457165]]
len(transformed_superpoints_pcd) :  1632
copy_superpoint_src_corr_points.shape :  (523, 3)
mask.shape :  (523,)
copy_superpoint_src_corr_points.shape :  (523, 3)
copy_superpoint_ref_corr_points.shape :  (523, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([523, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 523, 3])
batch_inlier_masks.shape :  torch.Size([2000, 523])
best_index :  1249
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (523, 3)
transformed_src_superpoints.shape :  torch.Size([523, 3])
residual.shape :  torch.Size([523])
batch_inlier_masks.shape :  torch.Size([523])
batch_outlier_masks.shape :  torch.Size([523])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([516])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.02803652 -0.01520311 -0.11692281]
 [ 0.0315667  -0.00529066 -0.10387725]
 [ 0.0315667  -0.00529066 -0.10387725]]
len(transformed_superpoints_pcd) :  1639
copy_superpoint_src_corr_points.shape :  (516, 3)
mask.shape :  (516,)
copy_superpoint_src_corr_points.shape :  (492, 3)
copy_superpoint_ref_corr_points.shape :  (492, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([492, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 492, 3])
batch_inlier_masks.shape :  torch.Size([2000, 492])
best_index :  1495
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (492, 3)
transformed_src_superpoints.shape :  torch.Size([492, 3])
residual.shape :  torch.Size([492])
batch_inlier_masks.shape :  torch.Size([492])
batch_outlier_masks.shape :  torch.Size([492])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([485])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.05720746 -0.04780323  0.03319084]
 [ 0.05720746 -0.04780323  0.03319084]
 [ 0.05720746 -0.04780323  0.03319084]]
len(transformed_superpoints_pcd) :  1646
copy_superpoint_src_corr_points.shape :  (485, 3)
mask.shape :  (485,)
copy_superpoint_src_corr_points.shape :  (464, 3)
copy_superpoint_ref_corr_points.shape :  (464, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([464, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 464, 3])
batch_inlier_masks.shape :  torch.Size([2000, 464])
best_index :  59
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (464, 3)
transformed_src_superpoints.shape :  torch.Size([464, 3])
residual.shape :  torch.Size([464])
batch_inlier_masks.shape :  torch.Size([464])
batch_outlier_masks.shape :  torch.Size([464])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([458])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.03798756  0.01421394 -0.00498516]
 [-0.03798756  0.01421394 -0.00498516]
 [-0.03798756  0.01421394 -0.00498516]]
len(transformed_superpoints_pcd) :  1652
copy_superpoint_src_corr_points.shape :  (458, 3)
mask.shape :  (458,)
copy_superpoint_src_corr_points.shape :  (367, 3)
copy_superpoint_ref_corr_points.shape :  (367, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([367, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 367, 3])
batch_inlier_masks.shape :  torch.Size([2000, 367])
best_index :  1313
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (367, 3)
transformed_src_superpoints.shape :  torch.Size([367, 3])
residual.shape :  torch.Size([367])
batch_inlier_masks.shape :  torch.Size([367])
batch_outlier_masks.shape :  torch.Size([367])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([361])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.03530774 -0.00558759 -0.11426282]
 [-0.03760086 -0.00101942 -0.10589264]
 [-0.03760086 -0.00101942 -0.10589264]]
len(transformed_superpoints_pcd) :  1658
copy_superpoint_src_corr_points.shape :  (361, 3)
mask.shape :  (361,)
copy_superpoint_src_corr_points.shape :  (360, 3)
copy_superpoint_ref_corr_points.shape :  (360, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([360, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 360, 3])
batch_inlier_masks.shape :  torch.Size([2000, 360])
best_index :  587
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (360, 3)
transformed_src_superpoints.shape :  torch.Size([360, 3])
residual.shape :  torch.Size([360])
batch_inlier_masks.shape :  torch.Size([360])
batch_outlier_masks.shape :  torch.Size([360])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([355])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00428434  0.01141605 -0.07282126]
 [-0.00140605  0.01395056 -0.06660743]
 [-0.00140605  0.01395056 -0.06660743]]
len(transformed_superpoints_pcd) :  1663
copy_superpoint_src_corr_points.shape :  (355, 3)
mask.shape :  (355,)
copy_superpoint_src_corr_points.shape :  (337, 3)
copy_superpoint_ref_corr_points.shape :  (337, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([337, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 337, 3])
batch_inlier_masks.shape :  torch.Size([2000, 337])
best_index :  647
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (337, 3)
transformed_src_superpoints.shape :  torch.Size([337, 3])
residual.shape :  torch.Size([337])
batch_inlier_masks.shape :  torch.Size([337])
batch_outlier_masks.shape :  torch.Size([337])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([332])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-1.5200270e-02 -1.5282163e-02  8.2866631e-02]
 [-1.5200270e-02 -1.5282163e-02  8.2866631e-02]
 [-1.2225507e-02 -1.0226815e-02  8.3649613e-02]
 ...
 [-4.3016858e-05  3.1146055e-02 -4.3354861e-02]
 [-4.3016858e-05  3.1146055e-02 -4.3354861e-02]
 [-3.5283854e-03  2.5237087e-02 -4.0981814e-02]]
len(transformed_superpoints_pcd) :  1668
copy_superpoint_src_corr_points.shape :  (332, 3)
mask.shape :  (332,)
copy_superpoint_src_corr_points.shape :  (329, 3)
copy_superpoint_ref_corr_points.shape :  (329, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([329, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 329, 3])
batch_inlier_masks.shape :  torch.Size([2000, 329])
best_index :  688
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (329, 3)
transformed_src_superpoints.shape :  torch.Size([329, 3])
residual.shape :  torch.Size([329])
batch_inlier_masks.shape :  torch.Size([329])
batch_outlier_masks.shape :  torch.Size([329])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([324])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.00059884  0.02232593 -0.0447101 ]
 [ 0.00059884  0.02232593 -0.0447101 ]
 [ 0.00059884  0.02232593 -0.0447101 ]]
len(transformed_superpoints_pcd) :  1673
copy_superpoint_src_corr_points.shape :  (324, 3)
mask.shape :  (324,)
copy_superpoint_src_corr_points.shape :  (321, 3)
copy_superpoint_ref_corr_points.shape :  (321, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([321, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 321, 3])
batch_inlier_masks.shape :  torch.Size([2000, 321])
best_index :  1752
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (321, 3)
transformed_src_superpoints.shape :  torch.Size([321, 3])
residual.shape :  torch.Size([321])
batch_inlier_masks.shape :  torch.Size([321])
batch_outlier_masks.shape :  torch.Size([321])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([316])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.00898213 -0.0160225  -0.03825314]
 [ 0.00898213 -0.0160225  -0.03825314]
 [ 0.00898213 -0.0160225  -0.03825314]]
len(transformed_superpoints_pcd) :  1678
copy_superpoint_src_corr_points.shape :  (316, 3)
mask.shape :  (316,)
copy_superpoint_src_corr_points.shape :  (279, 3)
copy_superpoint_ref_corr_points.shape :  (279, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([279, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 279, 3])
batch_inlier_masks.shape :  torch.Size([2000, 279])
best_index :  133
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (279, 3)
transformed_src_superpoints.shape :  torch.Size([279, 3])
residual.shape :  torch.Size([279])
batch_inlier_masks.shape :  torch.Size([279])
batch_outlier_masks.shape :  torch.Size([279])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([275])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.02981523  0.01571657 -0.03793807]
 [ 0.02981523  0.01571657 -0.03793807]
 [-0.03238248 -0.01937144  0.06636856]]
len(transformed_superpoints_pcd) :  1682
copy_superpoint_src_corr_points.shape :  (275, 3)
mask.shape :  (275,)
copy_superpoint_src_corr_points.shape :  (232, 3)
copy_superpoint_ref_corr_points.shape :  (232, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([232, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 232, 3])
batch_inlier_masks.shape :  torch.Size([2000, 232])
best_index :  694
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (232, 3)
transformed_src_superpoints.shape :  torch.Size([232, 3])
residual.shape :  torch.Size([232])
batch_inlier_masks.shape :  torch.Size([232])
batch_outlier_masks.shape :  torch.Size([232])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([228])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00696755 -0.01020235 -0.00615154]
 [-0.00696755 -0.01020235 -0.00615154]
 [-0.00696755 -0.01020235 -0.00615154]]
len(transformed_superpoints_pcd) :  1686
copy_superpoint_src_corr_points.shape :  (228, 3)
mask.shape :  (228,)
copy_superpoint_src_corr_points.shape :  (215, 3)
copy_superpoint_ref_corr_points.shape :  (215, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([215, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 215, 3])
batch_inlier_masks.shape :  torch.Size([2000, 215])
best_index :  1653
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (215, 3)
transformed_src_superpoints.shape :  torch.Size([215, 3])
residual.shape :  torch.Size([215])
batch_inlier_masks.shape :  torch.Size([215])
batch_outlier_masks.shape :  torch.Size([215])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([211])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [-0.00526975  0.01481915 -0.07134152]
 [-0.00526975  0.01481915 -0.07134152]
 [ 0.00113502  0.01972982 -0.06628291]]
len(transformed_superpoints_pcd) :  1690
copy_superpoint_src_corr_points.shape :  (211, 3)
mask.shape :  (211,)
copy_superpoint_src_corr_points.shape :  (202, 3)
copy_superpoint_ref_corr_points.shape :  (202, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([202, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 202, 3])
batch_inlier_masks.shape :  torch.Size([2000, 202])
best_index :  11
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (202, 3)
transformed_src_superpoints.shape :  torch.Size([202, 3])
residual.shape :  torch.Size([202])
batch_inlier_masks.shape :  torch.Size([202])
batch_outlier_masks.shape :  torch.Size([202])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([199])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.12849349 -0.027944   -0.06260732]
 [-0.00622111  0.00902081 -0.05252815]
 [-0.00622111  0.00902081 -0.05252815]]
len(transformed_superpoints_pcd) :  1693
copy_superpoint_src_corr_points.shape :  (199, 3)
mask.shape :  (199,)
copy_superpoint_src_corr_points.shape :  (147, 3)
copy_superpoint_ref_corr_points.shape :  (147, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([147, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 147, 3])
batch_inlier_masks.shape :  torch.Size([2000, 147])
best_index :  38
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (147, 3)
transformed_src_superpoints.shape :  torch.Size([147, 3])
residual.shape :  torch.Size([147])
batch_inlier_masks.shape :  torch.Size([147])
batch_outlier_masks.shape :  torch.Size([147])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([144])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.01010873  0.00728343 -0.07554349]
 [ 0.01010873  0.00728343 -0.07554349]
 [ 0.01010873  0.00728343 -0.07554349]]
len(transformed_superpoints_pcd) :  1696
copy_superpoint_src_corr_points.shape :  (144, 3)
mask.shape :  (144,)
copy_superpoint_src_corr_points.shape :  (105, 3)
copy_superpoint_ref_corr_points.shape :  (105, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([105, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 105, 3])
batch_inlier_masks.shape :  torch.Size([2000, 105])
best_index :  51
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (105, 3)
transformed_src_superpoints.shape :  torch.Size([105, 3])
residual.shape :  torch.Size([105])
batch_inlier_masks.shape :  torch.Size([105])
batch_outlier_masks.shape :  torch.Size([105])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([102])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[-0.01520027 -0.01528216  0.08286663]
 [-0.01520027 -0.01528216  0.08286663]
 [-0.01222551 -0.01022682  0.08364961]
 ...
 [ 0.02107575  0.03165346 -0.02504747]
 [ 0.02107575  0.03165346 -0.02504747]
 [ 0.02107575  0.03165346 -0.02504747]]
len(transformed_superpoints_pcd) :  1699
copy_superpoint_src_corr_points.shape :  (102, 3)
mask.shape :  (102,)
copy_superpoint_src_corr_points.shape :  (61, 3)
copy_superpoint_ref_corr_points.shape :  (61, 3)
number of unique points in pcd :  688
number of rotations used :  55
transformed_superpoints_pcd.shape :  (1760, 3)
Line set updated
100
src_points :  [[-0.07423215  0.00614111 -0.01107964]
 [-0.05332529  0.03907285  0.02419371]
 [-0.0508292   0.04502644  0.02643515]
 ...
 [-0.04491115  0.01599825 -0.02825209]
 [-0.05107782  0.01837878 -0.02646702]
 [-0.06582337  0.02244079 -0.0224214 ]]
ref_points :  [[-0.06722299 -0.00113073  0.02226378]
 [-0.06758776  0.00285855  0.01707591]
 [-0.06648453  0.05457951 -0.03108914]
 ...
 [-0.02964622  0.03650341  0.01817239]
 [-0.00041078  0.09477007 -0.0053878 ]
 [-0.03699995  0.02181324 -0.012888  ]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([4466, 3])
lengths :  tensor([2174, 2292])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([2734, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([829, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([408, 3])
ref_points_f.shape :  torch.Size([2174, 3])
src_points_c.shape :  torch.Size([421, 3])
src_points_f.shape :  torch.Size([2292, 3])
ref_node_masks.shape :  torch.Size([408])
ref_node_knn_indices.shape :  torch.Size([408, 5])
ref_node_knn_masks.shape :  torch.Size([408, 5])
src_node_masks.shape :  torch.Size([421])
src_node_knn_indices.shape :  torch.Size([421, 5])
src_node_knn_masks.shape :  torch.Size([421, 5])
ref_node_knn_points.shape :  torch.Size([408, 5, 3])
src_node_knn_points.shape :  torch.Size([421, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([829, 512])
feats_f :  torch.Size([4466, 256])
k :  3
omegas.shape :  torch.Size([166464, 128, 1])
omegas.shape :  torch.Size([499392, 128, 1])
k :  3
omegas.shape :  torch.Size([177241, 128, 1])
omegas.shape :  torch.Size([531723, 128, 1])
ref_feats_c.shape :  torch.Size([1, 408, 256])
src_feats_c.shape :  torch.Size([1, 421, 256])
ref_feats_c_norm.shape :  torch.Size([408, 256])
src_feats_c_norm.shape :  torch.Size([421, 256])
ref_node_masks.shape :  torch.Size([408])
src_node_masks.shape :  torch.Size([421])
self.num_correspondences :  2000
matching_scores.numel() :  171768
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([19586])
ref_indices.shape :  torch.Size([19586])
src_indices.shape :  torch.Size([19586])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 1,  ..., 3, 3, 3], device='cuda:0')
src_indices :  tensor([1, 3, 0,  ..., 1, 2, 4], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([19586, 3])
global_src_corr_points.shape :  torch.Size([19586, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([1997, 4, 4])
src_corr_points.shape :  torch.Size([19586, 3])
ref_corr_points.shape :  torch.Size([1, 19586, 3])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 19586, 3])
batch_corr_residuals.shape :  torch.Size([1997, 19586])
batch_inlier_masks.shape :  torch.Size([1997, 19586])
best_index :  tensor(1070, device='cuda:0')
len(batch_transforms) :  1997
estimated_transform :  [[ 0.23237786 -0.87326765 -0.42825755  0.00244187]
 [-0.5098108  -0.48433793  0.71099234 -0.00878216]
 [-0.8283077   0.05311167 -0.5577505  -0.01424905]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [ 987  802 1933 ...  308 1518 1070]
superpoint_src_corr_points.shape :  (19586, 3)
superpoint_ref_corr_points.shape :  (19586, 3)
batch_inlier_masks.shape :  (1997, 19586)
batch_transforms.shape :  (1997, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([19586, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 19586, 3])
batch_inlier_masks.shape :  torch.Size([1997, 19586])
best_index :  1269
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (19586, 3)
transformed_src_superpoints.shape :  torch.Size([19586, 3])
residual.shape :  torch.Size([19586])
batch_inlier_masks.shape :  torch.Size([19586])
batch_outlier_masks.shape :  torch.Size([19586])
indices_inliers.shape :  torch.Size([119])
indices_outliers.shape :  torch.Size([19467])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([119, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 [ 0.01377045  0.08142965 -0.03738849]
 [ 0.01573092  0.07750176 -0.03469539]
 [ 0.01185654  0.08626024 -0.03834992]
 [ 0.01185654  0.08626024 -0.03834992]
 [ 0.01377045  0.08142965 -0.03738849]
 [ 0.01862209  0.08023928 -0.04171522]
 [ 0.0128957  -0.07514447  0.00543094]
 [ 0.00809886 -0.07305823  0.00801251]
 [ 0.0128957  -0.07514447  0.00543094]
 [ 0.01420154 -0.07789694 -0.00122395]
 [-0.05381775 -0.06113258  0.03779063]
 [-0.05381775 -0.06113258  0.03779063]
 [-0.04707365 -0.0619297   0.03951417]
 [-0.05381775 -0.06113258  0.03779063]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.09788024  0.04054681 -0.02224843]
 [ 0.09402332  0.03991824 -0.01824505]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.0111376   0.09074228 -0.0361584 ]
 [ 0.0111376   0.09074228 -0.0361584 ]
 [-0.05381775 -0.06113258  0.03779063]
 [ 0.09452643  0.03328124 -0.0204299 ]
 [ 0.09452643  0.03328124 -0.0204299 ]
 [ 0.09416181  0.02876922 -0.02528704]
 [ 0.09283076  0.02795697 -0.01892933]
 [-0.03386708 -0.06418157  0.00644949]
 [-0.03386708 -0.06418157  0.00644949]
 [-0.03054387 -0.06674071  0.01137079]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.09914034  0.03672158 -0.02951542]
 [ 0.09540544  0.03218026 -0.0292215 ]
 [ 0.09914034  0.03672158 -0.02951542]
 [ 0.08423296  0.05225517 -0.03077472]
 [ 0.09283076  0.02795697 -0.01892933]
 [ 0.09299284  0.02361247 -0.0241366 ]
 [ 0.09452643  0.03328124 -0.0204299 ]
 [ 0.09416181  0.02876922 -0.02528704]
 [ 0.09416181  0.02876922 -0.02528704]
 [ 0.09283076  0.02795697 -0.01892933]
 [ 0.09299284  0.02361247 -0.0241366 ]
 [ 0.09452643  0.03328124 -0.0204299 ]
 [ 0.09416181  0.02876922 -0.02528704]
 [ 0.09283076  0.02795697 -0.01892933]
 [ 0.0923567   0.01827044 -0.02457057]
 [ 0.09132491  0.01474974 -0.02832388]
 [ 0.08985808  0.00956174 -0.02683316]
 [ 0.09133393  0.01314858 -0.02336166]
 [ 0.09165765  0.01595837 -0.01907676]
 [ 0.08985808  0.00956174 -0.02683316]
 [ 0.05740356  0.06768385 -0.02733574]
 [ 0.0560212   0.07623155 -0.0278921 ]
 [ 0.05740356  0.06768385 -0.02733574]
 [ 0.09401159  0.03912391 -0.0401533 ]
 [ 0.09251674  0.03071784 -0.03308507]
 [ 0.09401159  0.03912391 -0.0401533 ]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.09914034  0.03672158 -0.02951542]
 [ 0.09540544  0.03218026 -0.0292215 ]
 [ 0.09452643  0.03328124 -0.0204299 ]
 [ 0.09416181  0.02876922 -0.02528704]
 [-0.05183198 -0.00052985  0.0235568 ]
 [-0.05209299  0.00052149  0.02870269]
 [-0.05183198 -0.00052985  0.0235568 ]
 [-0.05183198 -0.00052985  0.0235568 ]
 [-0.05209299  0.00052149  0.02870269]
 [-0.05331039 -0.06357437  0.03217334]
 [-0.05331039 -0.06357437  0.03217334]
 [ 0.01862209  0.08023928 -0.04171522]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.0930426   0.04952526 -0.02450093]
 [ 0.09208054  0.05303933 -0.0304045 ]
 [ 0.08650218  0.04919884 -0.02334118]
 [ 0.0930426   0.04952526 -0.02450093]
 [ 0.08650218  0.04919884 -0.02334118]
 [ 0.0930426   0.04952526 -0.02450093]
 [ 0.09148232  0.04630927 -0.02082715]
 [ 0.09208054  0.05303933 -0.0304045 ]
 [-0.05331039 -0.06357437  0.03217334]
 [-0.04863069 -0.06507961  0.03542415]
 [-0.05331039 -0.06357437  0.03217334]
 [ 0.02318242  0.08203119 -0.04532363]
 [ 0.02094827  0.08624624 -0.04728112]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.09914034  0.03672158 -0.02951542]
 [ 0.09540544  0.03218026 -0.0292215 ]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.09914034  0.03672158 -0.02951542]
 [ 0.09540544  0.03218026 -0.0292215 ]
 [ 0.0923567   0.01827044 -0.02457057]
 [ 0.09402332  0.03991824 -0.01824505]
 [ 0.01497158  0.08492666 -0.04230133]
 [ 0.09152344  0.03255021 -0.01574153]
 [ 0.09747018  0.03528673 -0.02465426]
 [ 0.09283076  0.02795697 -0.01892933]
 [ 0.09299284  0.02361247 -0.0241366 ]
 [ 0.09299284  0.02361247 -0.0241366 ]
 [ 0.09283076  0.02795697 -0.01892933]
 [-0.00267053 -0.09220494  0.03126371]
 [ 0.09283076  0.02795697 -0.01892933]
 [ 0.09152344  0.03255021 -0.01574153]
 [ 0.09283076  0.02795697 -0.01892933]
 [ 0.09152344  0.03255021 -0.01574153]
 [ 0.09452643  0.03328124 -0.0204299 ]
 [ 0.09416181  0.02876922 -0.02528704]
 [ 0.09283076  0.02795697 -0.01892933]
 [ 0.09237155  0.02174386 -0.01846212]
 [ 0.03131454  0.06515601 -0.04125586]
 [-0.01341365 -0.08275658  0.0087003 ]
 [-0.02049304 -0.08141996  0.01417916]
 [-0.0171541  -0.07870802  0.01125534]
 [-0.01820736 -0.08726582  0.01485225]
 [-0.01344065 -0.08817461  0.01005119]
 [-0.01341365 -0.08275658  0.0087003 ]
 [-0.01344065 -0.08817461  0.01005119]
 [-0.01341365 -0.08275658  0.0087003 ]]
len(transformed_superpoints_pcd) :  119
copy_superpoint_src_corr_points.shape :  (19467, 3)
mask.shape :  (19467,)
copy_superpoint_src_corr_points.shape :  (17643, 3)
copy_superpoint_ref_corr_points.shape :  (17643, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([17643, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 17643, 3])
batch_inlier_masks.shape :  torch.Size([1997, 17643])
best_index :  1048
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (17643, 3)
transformed_src_superpoints.shape :  torch.Size([17643, 3])
residual.shape :  torch.Size([17643])
batch_inlier_masks.shape :  torch.Size([17643])
batch_outlier_masks.shape :  torch.Size([17643])
indices_inliers.shape :  torch.Size([101])
indices_outliers.shape :  torch.Size([17542])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([101, 3])
transformed_superpoints_pcd :  [[ 1.37704462e-02  8.14296454e-02 -3.73884887e-02]
 [ 1.96474921e-02  7.60604888e-02 -3.88496891e-02]
 [ 1.18565392e-02  8.62602443e-02 -3.83499190e-02]
 [ 1.37704462e-02  8.14296454e-02 -3.73884887e-02]
 [ 1.57309249e-02  7.75017589e-02 -3.46953869e-02]
 [ 1.18565392e-02  8.62602443e-02 -3.83499190e-02]
 [ 1.18565392e-02  8.62602443e-02 -3.83499190e-02]
 [ 1.37704462e-02  8.14296454e-02 -3.73884887e-02]
 [ 1.86220910e-02  8.02392811e-02 -4.17152196e-02]
 [ 1.28957015e-02 -7.51444697e-02  5.43093681e-03]
 [ 8.09885934e-03 -7.30582327e-02  8.01250897e-03]
 [ 1.28957015e-02 -7.51444697e-02  5.43093681e-03]
 [ 1.42015386e-02 -7.78969377e-02 -1.22394599e-03]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [-4.70736511e-02 -6.19296990e-02  3.95141691e-02]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.78802368e-02  4.05468121e-02 -2.22484265e-02]
 [ 9.40233171e-02  3.99182364e-02 -1.82450507e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 1.11375954e-02  9.07422751e-02 -3.61583978e-02]
 [ 1.11375954e-02  9.07422751e-02 -3.61583978e-02]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [-3.38670760e-02 -6.41815662e-02  6.44949358e-03]
 [-3.38670760e-02 -6.41815662e-02  6.44949358e-03]
 [-3.05438712e-02 -6.67407066e-02  1.13707883e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 8.42329562e-02  5.22551723e-02 -3.07747219e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.23566967e-02  1.82704404e-02 -2.45705750e-02]
 [ 9.13249105e-02  1.47497430e-02 -2.83238757e-02]
 [ 8.98580849e-02  9.56174172e-03 -2.68331598e-02]
 [ 9.13339332e-02  1.31485816e-02 -2.33616624e-02]
 [ 9.16576460e-02  1.59583725e-02 -1.90767553e-02]
 [ 8.98580849e-02  9.56174172e-03 -2.68331598e-02]
 [ 5.74035645e-02  6.76838458e-02 -2.73357425e-02]
 [ 5.60211986e-02  7.62315542e-02 -2.78920960e-02]
 [ 5.74035645e-02  6.76838458e-02 -2.73357425e-02]
 [ 9.40115899e-02  3.91239114e-02 -4.01533023e-02]
 [ 9.25167426e-02  3.07178386e-02 -3.30850706e-02]
 [ 9.40115899e-02  3.91239114e-02 -4.01533023e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [-5.18319793e-02 -5.29848039e-04  2.35567968e-02]
 [-5.20929880e-02  5.21490350e-04  2.87026912e-02]
 [-5.18319793e-02 -5.29848039e-04  2.35567968e-02]
 [-5.18319793e-02 -5.29848039e-04  2.35567968e-02]
 [-5.20929880e-02  5.21490350e-04  2.87026912e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [ 1.86220910e-02  8.02392811e-02 -4.17152196e-02]
 [ 1.96474921e-02  7.60604888e-02 -3.88496891e-02]
 [ 9.30425972e-02  4.95252647e-02 -2.45009307e-02]
 [ 9.20805410e-02  5.30393347e-02 -3.04044951e-02]
 [ 8.65021795e-02  4.91988398e-02 -2.33411752e-02]
 [ 9.30425972e-02  4.95252647e-02 -2.45009307e-02]
 [ 8.65021795e-02  4.91988398e-02 -2.33411752e-02]
 [ 9.30425972e-02  4.95252647e-02 -2.45009307e-02]
 [ 9.14823189e-02  4.63092737e-02 -2.08271500e-02]
 [ 9.20805410e-02  5.30393347e-02 -3.04044951e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [-4.86306921e-02 -6.50796145e-02  3.54241543e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [ 2.31824201e-02  8.20311904e-02 -4.53236252e-02]
 [ 2.09482703e-02  8.62462372e-02 -4.72811237e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.23566967e-02  1.82704404e-02 -2.45705750e-02]
 [ 9.40233171e-02  3.99182364e-02 -1.82450507e-02]
 [ 1.49715785e-02  8.49266648e-02 -4.23013344e-02]
 [ 9.15234387e-02  3.25502083e-02 -1.57415252e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [-2.67053209e-03 -9.22049433e-02  3.12637091e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.15234387e-02  3.25502083e-02 -1.57415252e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.15234387e-02  3.25502083e-02 -1.57415252e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.23715532e-02  2.17438638e-02 -1.84621178e-02]
 [ 3.13145369e-02  6.51560128e-02 -4.12558615e-02]
 [-1.34136472e-02 -8.27565789e-02  8.70029628e-03]
 [-2.04930380e-02 -8.14199597e-02  1.41791571e-02]
 [-1.71541013e-02 -7.87080228e-02  1.12553407e-02]
 [-1.82073638e-02 -8.72658193e-02  1.48522519e-02]
 [-1.34406481e-02 -8.81746113e-02  1.00511927e-02]
 [-1.34136472e-02 -8.27565789e-02  8.70029628e-03]
 [-1.34406481e-02 -8.81746113e-02  1.00511927e-02]
 [-1.34136472e-02 -8.27565789e-02  8.70029628e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 6.81739300e-03  2.10958943e-02 -4.26619425e-02]
 [ 6.81739300e-03  2.10958943e-02 -4.26619425e-02]
 [ 4.20692563e-03 -2.58126371e-02 -4.40799482e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [-5.29944301e-02  6.60235435e-02 -4.52288426e-02]
 [ 4.20692563e-03 -2.58126371e-02 -4.40799482e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 1.22501925e-02  5.27697802e-03 -4.47863378e-02]
 [ 6.94310665e-03  6.42042607e-04 -5.13528548e-02]
 [ 1.22501925e-02  5.27697802e-03 -4.47863378e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.78074157e-02  3.93443219e-02 -6.35119975e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.78074157e-02  3.93443219e-02 -6.35119975e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-5.78074157e-02  3.93443219e-02 -6.35119975e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 3.89133543e-02  2.88153626e-02 -5.76437637e-03]
 [ 3.89133543e-02  2.88153626e-02 -5.76437637e-03]
 [ 3.89133543e-02  2.88153626e-02 -5.76437637e-03]
 [ 3.56826633e-02  3.18306871e-02 -2.99413223e-03]
 [-4.15466316e-02  5.71337827e-02 -4.59657758e-02]
 [-3.91035043e-02  5.85015491e-02 -4.11634259e-02]
 [-4.19914871e-02  5.19761592e-02 -4.79882136e-02]
 [-4.15466316e-02  5.71337827e-02 -4.59657758e-02]
 [-4.19914871e-02  5.19761592e-02 -4.79882136e-02]
 [-3.89779992e-02  4.99348007e-02 -4.44649979e-02]
 [-4.15466316e-02  5.71337827e-02 -4.59657758e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [ 1.18928440e-02  1.73814595e-04 -4.66693230e-02]
 [ 1.51097849e-02 -3.13782319e-03 -4.46461961e-02]
 [ 1.18928440e-02  1.73814595e-04 -4.66693230e-02]
 [ 1.18928440e-02  1.73814595e-04 -4.66693230e-02]
 [ 1.98089704e-02 -5.98292798e-03 -4.04831916e-02]
 [ 1.87113583e-02  2.20909715e-05 -4.12914492e-02]
 [ 1.55611038e-02 -9.14848223e-03 -4.38393727e-02]
 [ 1.98089704e-02 -5.98292798e-03 -4.04831916e-02]
 [ 1.98089704e-02 -5.98292798e-03 -4.04831916e-02]
 [-5.22207171e-02  3.99314426e-02 -2.35911980e-02]
 [-5.22207171e-02  3.99314426e-02 -2.35911980e-02]
 [-5.74193336e-02  4.05187048e-02 -2.82424688e-02]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 6.00136817e-03 -2.08014473e-02 -4.53923494e-02]
 [ 1.22501925e-02  5.27697802e-03 -4.47863378e-02]
 [ 6.94310665e-03  6.42042607e-04 -5.13528548e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 4.33425754e-02  1.25558265e-02 -6.46934658e-03]
 [ 3.84939983e-02  1.48880258e-02  3.03686038e-03]
 [ 4.24117669e-02  1.72471870e-02 -1.47595303e-03]
 [ 3.60969156e-02  1.11123137e-02 -2.27332953e-03]
 [ 4.24117669e-02  1.72471870e-02 -1.47595303e-03]
 [ 3.84939983e-02  1.48880258e-02  3.03686038e-03]
 [ 3.60969156e-02  1.11123137e-02 -2.27332953e-03]
 [ 4.24117669e-02  1.72471870e-02 -1.47595303e-03]
 [ 3.84939983e-02  1.48880258e-02  3.03686038e-03]
 [ 6.94310665e-03  6.42042607e-04 -5.13528548e-02]
 [ 3.71124595e-03 -1.81156248e-02 -4.97595333e-02]
 [-2.96874456e-02 -3.02649476e-02  2.94584166e-02]
 [-3.56099084e-02 -3.34152319e-02  2.62842886e-02]
 [-3.50341536e-02 -3.59608121e-02  2.18280572e-02]
 [-3.56099084e-02 -3.34152319e-02  2.62842886e-02]
 [-3.91035043e-02  5.85015491e-02 -4.11634259e-02]
 [-4.43066433e-02  6.19971454e-02 -4.35494855e-02]
 [-2.57223845e-04 -2.09494345e-02 -5.37801869e-02]
 [-1.82804465e-03 -2.58444659e-02 -5.22156879e-02]
 [-1.82804465e-03 -2.58444659e-02 -5.22156879e-02]
 [-2.57223845e-04 -2.09494345e-02 -5.37801869e-02]
 [ 1.86469406e-03 -2.28171311e-02 -4.90485094e-02]
 [-1.82804465e-03 -2.58444659e-02 -5.22156879e-02]]
len(transformed_superpoints_pcd) :  220
copy_superpoint_src_corr_points.shape :  (17542, 3)
mask.shape :  (17542,)
copy_superpoint_src_corr_points.shape :  (15533, 3)
copy_superpoint_ref_corr_points.shape :  (15533, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([15533, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 15533, 3])
batch_inlier_masks.shape :  torch.Size([1997, 15533])
best_index :  1677
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (15533, 3)
transformed_src_superpoints.shape :  torch.Size([15533, 3])
residual.shape :  torch.Size([15533])
batch_inlier_masks.shape :  torch.Size([15533])
batch_outlier_masks.shape :  torch.Size([15533])
indices_inliers.shape :  torch.Size([99])
indices_outliers.shape :  torch.Size([15434])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([99, 3])
transformed_superpoints_pcd :  [[ 1.37704462e-02  8.14296454e-02 -3.73884887e-02]
 [ 1.96474921e-02  7.60604888e-02 -3.88496891e-02]
 [ 1.18565392e-02  8.62602443e-02 -3.83499190e-02]
 [ 1.37704462e-02  8.14296454e-02 -3.73884887e-02]
 [ 1.57309249e-02  7.75017589e-02 -3.46953869e-02]
 [ 1.18565392e-02  8.62602443e-02 -3.83499190e-02]
 [ 1.18565392e-02  8.62602443e-02 -3.83499190e-02]
 [ 1.37704462e-02  8.14296454e-02 -3.73884887e-02]
 [ 1.86220910e-02  8.02392811e-02 -4.17152196e-02]
 [ 1.28957015e-02 -7.51444697e-02  5.43093681e-03]
 [ 8.09885934e-03 -7.30582327e-02  8.01250897e-03]
 [ 1.28957015e-02 -7.51444697e-02  5.43093681e-03]
 [ 1.42015386e-02 -7.78969377e-02 -1.22394599e-03]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [-4.70736511e-02 -6.19296990e-02  3.95141691e-02]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.78802368e-02  4.05468121e-02 -2.22484265e-02]
 [ 9.40233171e-02  3.99182364e-02 -1.82450507e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 1.11375954e-02  9.07422751e-02 -3.61583978e-02]
 [ 1.11375954e-02  9.07422751e-02 -3.61583978e-02]
 [-5.38177527e-02 -6.11325763e-02  3.77906263e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [-3.38670760e-02 -6.41815662e-02  6.44949358e-03]
 [-3.38670760e-02 -6.41815662e-02  6.44949358e-03]
 [-3.05438712e-02 -6.67407066e-02  1.13707883e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 8.42329562e-02  5.22551723e-02 -3.07747219e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.23566967e-02  1.82704404e-02 -2.45705750e-02]
 [ 9.13249105e-02  1.47497430e-02 -2.83238757e-02]
 [ 8.98580849e-02  9.56174172e-03 -2.68331598e-02]
 [ 9.13339332e-02  1.31485816e-02 -2.33616624e-02]
 [ 9.16576460e-02  1.59583725e-02 -1.90767553e-02]
 [ 8.98580849e-02  9.56174172e-03 -2.68331598e-02]
 [ 5.74035645e-02  6.76838458e-02 -2.73357425e-02]
 [ 5.60211986e-02  7.62315542e-02 -2.78920960e-02]
 [ 5.74035645e-02  6.76838458e-02 -2.73357425e-02]
 [ 9.40115899e-02  3.91239114e-02 -4.01533023e-02]
 [ 9.25167426e-02  3.07178386e-02 -3.30850706e-02]
 [ 9.40115899e-02  3.91239114e-02 -4.01533023e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [-5.18319793e-02 -5.29848039e-04  2.35567968e-02]
 [-5.20929880e-02  5.21490350e-04  2.87026912e-02]
 [-5.18319793e-02 -5.29848039e-04  2.35567968e-02]
 [-5.18319793e-02 -5.29848039e-04  2.35567968e-02]
 [-5.20929880e-02  5.21490350e-04  2.87026912e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [ 1.86220910e-02  8.02392811e-02 -4.17152196e-02]
 [ 1.96474921e-02  7.60604888e-02 -3.88496891e-02]
 [ 9.30425972e-02  4.95252647e-02 -2.45009307e-02]
 [ 9.20805410e-02  5.30393347e-02 -3.04044951e-02]
 [ 8.65021795e-02  4.91988398e-02 -2.33411752e-02]
 [ 9.30425972e-02  4.95252647e-02 -2.45009307e-02]
 [ 8.65021795e-02  4.91988398e-02 -2.33411752e-02]
 [ 9.30425972e-02  4.95252647e-02 -2.45009307e-02]
 [ 9.14823189e-02  4.63092737e-02 -2.08271500e-02]
 [ 9.20805410e-02  5.30393347e-02 -3.04044951e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [-4.86306921e-02 -6.50796145e-02  3.54241543e-02]
 [-5.33103868e-02 -6.35743737e-02  3.21733356e-02]
 [ 2.31824201e-02  8.20311904e-02 -4.53236252e-02]
 [ 2.09482703e-02  8.62462372e-02 -4.72811237e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.91403386e-02  3.67215835e-02 -2.95154173e-02]
 [ 9.54054445e-02  3.21802646e-02 -2.92214956e-02]
 [ 9.23566967e-02  1.82704404e-02 -2.45705750e-02]
 [ 9.40233171e-02  3.99182364e-02 -1.82450507e-02]
 [ 1.49715785e-02  8.49266648e-02 -4.23013344e-02]
 [ 9.15234387e-02  3.25502083e-02 -1.57415252e-02]
 [ 9.74701792e-02  3.52867320e-02 -2.46542636e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.29928422e-02  2.36124694e-02 -2.41365992e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [-2.67053209e-03 -9.22049433e-02  3.12637091e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.15234387e-02  3.25502083e-02 -1.57415252e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.15234387e-02  3.25502083e-02 -1.57415252e-02]
 [ 9.45264325e-02  3.32812369e-02 -2.04298981e-02]
 [ 9.41618085e-02  2.87692249e-02 -2.52870396e-02]
 [ 9.28307623e-02  2.79569738e-02 -1.89293269e-02]
 [ 9.23715532e-02  2.17438638e-02 -1.84621178e-02]
 [ 3.13145369e-02  6.51560128e-02 -4.12558615e-02]
 [-1.34136472e-02 -8.27565789e-02  8.70029628e-03]
 [-2.04930380e-02 -8.14199597e-02  1.41791571e-02]
 [-1.71541013e-02 -7.87080228e-02  1.12553407e-02]
 [-1.82073638e-02 -8.72658193e-02  1.48522519e-02]
 [-1.34406481e-02 -8.81746113e-02  1.00511927e-02]
 [-1.34136472e-02 -8.27565789e-02  8.70029628e-03]
 [-1.34406481e-02 -8.81746113e-02  1.00511927e-02]
 [-1.34136472e-02 -8.27565789e-02  8.70029628e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 6.81739300e-03  2.10958943e-02 -4.26619425e-02]
 [ 6.81739300e-03  2.10958943e-02 -4.26619425e-02]
 [ 4.20692563e-03 -2.58126371e-02 -4.40799482e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [-5.29944301e-02  6.60235435e-02 -4.52288426e-02]
 [ 4.20692563e-03 -2.58126371e-02 -4.40799482e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 1.22501925e-02  5.27697802e-03 -4.47863378e-02]
 [ 6.94310665e-03  6.42042607e-04 -5.13528548e-02]
 [ 1.22501925e-02  5.27697802e-03 -4.47863378e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.78074157e-02  3.93443219e-02 -6.35119975e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.78074157e-02  3.93443219e-02 -6.35119975e-02]
 [-5.45964837e-02  3.56406495e-02 -5.84380664e-02]
 [-5.78074157e-02  3.93443219e-02 -6.35119975e-02]
 [-4.95763682e-02  3.50154936e-02 -5.55067733e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 7.38215074e-03  9.51550901e-03 -4.79545072e-02]
 [ 3.89133543e-02  2.88153626e-02 -5.76437637e-03]
 [ 3.89133543e-02  2.88153626e-02 -5.76437637e-03]
 [ 3.89133543e-02  2.88153626e-02 -5.76437637e-03]
 [ 3.56826633e-02  3.18306871e-02 -2.99413223e-03]
 [-4.15466316e-02  5.71337827e-02 -4.59657758e-02]
 [-3.91035043e-02  5.85015491e-02 -4.11634259e-02]
 [-4.19914871e-02  5.19761592e-02 -4.79882136e-02]
 [-4.15466316e-02  5.71337827e-02 -4.59657758e-02]
 [-4.19914871e-02  5.19761592e-02 -4.79882136e-02]
 [-3.89779992e-02  4.99348007e-02 -4.44649979e-02]
 [-4.15466316e-02  5.71337827e-02 -4.59657758e-02]
 [-5.62007204e-02  3.21006477e-02 -5.29891849e-02]
 [ 1.18928440e-02  1.73814595e-04 -4.66693230e-02]
 [ 1.51097849e-02 -3.13782319e-03 -4.46461961e-02]
 [ 1.18928440e-02  1.73814595e-04 -4.66693230e-02]
 [ 1.18928440e-02  1.73814595e-04 -4.66693230e-02]
 [ 1.98089704e-02 -5.98292798e-03 -4.04831916e-02]
 [ 1.87113583e-02  2.20909715e-05 -4.12914492e-02]
 [ 1.55611038e-02 -9.14848223e-03 -4.38393727e-02]
 [ 1.98089704e-02 -5.98292798e-03 -4.04831916e-02]
 [ 1.98089704e-02 -5.98292798e-03 -4.04831916e-02]
 [-5.22207171e-02  3.99314426e-02 -2.35911980e-02]
 [-5.22207171e-02  3.99314426e-02 -2.35911980e-02]
 [-5.74193336e-02  4.05187048e-02 -2.82424688e-02]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.26419622e-02  1.91094466e-02 -5.66123612e-03]
 [ 3.87215912e-02  1.62010398e-02 -9.96837951e-03]
 [ 3.76471132e-02  2.10461430e-02 -7.69747514e-03]
 [ 6.00136817e-03 -2.08014473e-02 -4.53923494e-02]
 [ 1.22501925e-02  5.27697802e-03 -4.47863378e-02]
 [ 6.94310665e-03  6.42042607e-04 -5.13528548e-02]
 [ 8.72850791e-03  4.64617088e-03 -4.84462716e-02]
 [ 5.30993566e-03  6.42217696e-03 -5.18841371e-02]
 [ 4.33425754e-02  1.25558265e-02 -6.46934658e-03]
 [ 3.84939983e-02  1.48880258e-02  3.03686038e-03]
 [ 4.24117669e-02  1.72471870e-02 -1.47595303e-03]
 [ 3.60969156e-02  1.11123137e-02 -2.27332953e-03]
 [ 4.24117669e-02  1.72471870e-02 -1.47595303e-03]
 [ 3.84939983e-02  1.48880258e-02  3.03686038e-03]
 [ 3.60969156e-02  1.11123137e-02 -2.27332953e-03]
 [ 4.24117669e-02  1.72471870e-02 -1.47595303e-03]
 [ 3.84939983e-02  1.48880258e-02  3.03686038e-03]
 [ 6.94310665e-03  6.42042607e-04 -5.13528548e-02]
 [ 3.71124595e-03 -1.81156248e-02 -4.97595333e-02]
 [-2.96874456e-02 -3.02649476e-02  2.94584166e-02]
 [-3.56099084e-02 -3.34152319e-02  2.62842886e-02]
 [-3.50341536e-02 -3.59608121e-02  2.18280572e-02]
 [-3.56099084e-02 -3.34152319e-02  2.62842886e-02]
 [-3.91035043e-02  5.85015491e-02 -4.11634259e-02]
 [-4.43066433e-02  6.19971454e-02 -4.35494855e-02]
 [-2.57223845e-04 -2.09494345e-02 -5.37801869e-02]
 [-1.82804465e-03 -2.58444659e-02 -5.22156879e-02]
 [-1.82804465e-03 -2.58444659e-02 -5.22156879e-02]
 [-2.57223845e-04 -2.09494345e-02 -5.37801869e-02]
 [ 1.86469406e-03 -2.28171311e-02 -4.90485094e-02]
 [-1.82804465e-03 -2.58444659e-02 -5.22156879e-02]
 [-5.39978519e-02 -3.26293111e-02  2.66227871e-05]
 [-4.90969270e-02 -3.01370323e-02  1.93525665e-03]
 [ 2.97314487e-02  4.06731255e-02 -2.68300921e-02]
 [ 3.18972394e-02  4.50781696e-02 -2.93470994e-02]
 [ 2.97314487e-02  4.06731255e-02 -2.68300921e-02]
 [ 2.97314487e-02  4.06731255e-02 -2.68300921e-02]
 [ 2.43279226e-02  3.76657769e-02 -2.57655866e-02]
 [ 2.16202773e-02  4.15252671e-02 -2.95197405e-02]
 [ 2.43279226e-02  3.76657769e-02 -2.57655866e-02]
 [ 2.43279226e-02  3.76657769e-02 -2.57655866e-02]
 [ 2.16202773e-02  4.15252671e-02 -2.95197405e-02]
 [ 2.97314487e-02  4.06731255e-02 -2.68300921e-02]
 [-4.67395447e-02 -3.26496139e-02  9.45062377e-03]
 [ 2.97314487e-02  4.06731255e-02 -2.68300921e-02]
 [ 2.61384174e-02  8.37959200e-02 -3.99474017e-02]
 [ 3.18905711e-02  8.34008604e-02 -3.70659344e-02]
 [ 3.64519358e-02  7.97038525e-02 -3.43231000e-02]
 [ 2.61384174e-02  8.37959200e-02 -3.99474017e-02]
 [ 2.98462119e-02  7.24217817e-02 -4.04012240e-02]
 [ 2.98462119e-02  7.24217817e-02 -4.04012240e-02]
 [ 2.84943953e-02  7.81757683e-02 -4.05588485e-02]
 [ 3.28905061e-02  7.63984099e-02 -3.83790918e-02]
 [ 2.84943953e-02  7.81757683e-02 -4.05588485e-02]
 [ 3.64838690e-02  7.31147453e-02 -3.57218422e-02]
 [ 2.98462119e-02  7.24217817e-02 -4.04012240e-02]
 [ 2.84943953e-02  7.81757683e-02 -4.05588485e-02]
 [-4.63764444e-02 -3.78379226e-02  3.84443477e-02]
 [-4.98688221e-02 -3.85633036e-02  2.01866869e-02]
 [-4.98688221e-02 -3.85633036e-02  2.01866869e-02]
 [-4.57843021e-02 -3.48918885e-02  1.56123526e-02]
 [-5.01640812e-02 -3.68510857e-02  1.20895877e-02]
 [-5.01640812e-02 -3.68510857e-02  1.20895877e-02]
 [-4.94549274e-02 -3.72615829e-02  3.15256119e-02]
 [-4.94549274e-02 -3.72615829e-02  3.15256119e-02]
 [-4.67395447e-02 -3.26496139e-02  9.45062377e-03]
 [-4.67395447e-02 -3.26496139e-02  9.45062377e-03]
 [-5.40021583e-02 -7.76493549e-03  3.00451256e-02]
 [-5.40021583e-02 -7.76493549e-03  3.00451256e-02]
 [-5.40021583e-02 -7.76493549e-03  3.00451256e-02]
 [-4.94549274e-02 -3.72615829e-02  3.15256119e-02]
 [ 1.48211010e-02  8.20075572e-02 -4.11238335e-02]
 [ 1.04475804e-02  7.80056715e-02 -4.09728549e-02]
 [ 9.05707292e-03  8.37134421e-02 -4.04243581e-02]
 [ 1.48211010e-02  8.20075572e-02 -4.11238335e-02]
 [ 1.04475804e-02  7.80056715e-02 -4.09728549e-02]
 [ 1.91269238e-02  8.50164145e-02 -4.07078676e-02]
 [ 3.68274972e-02  8.52063000e-02 -3.18459086e-02]
 [ 3.68274972e-02  8.52063000e-02 -3.18459086e-02]
 [ 3.68274972e-02  8.52063000e-02 -3.18459086e-02]
 [ 1.48211010e-02  8.20075572e-02 -4.11238335e-02]
 [ 3.64838690e-02  7.31147453e-02 -3.57218422e-02]
 [ 3.38672809e-02  6.83200061e-02 -3.82322557e-02]
 [ 3.28905061e-02  7.63984099e-02 -3.83790918e-02]
 [ 3.64838690e-02  7.31147453e-02 -3.57218422e-02]
 [ 2.84943953e-02  7.81757683e-02 -4.05588485e-02]
 [ 3.28905061e-02  7.63984099e-02 -3.83790918e-02]
 [ 3.64838690e-02  7.31147453e-02 -3.57218422e-02]
 [ 2.98462119e-02  7.24217817e-02 -4.04012240e-02]
 [-5.01640812e-02 -3.68510857e-02  1.20895877e-02]
 [-4.57843021e-02 -3.48918885e-02  1.56123526e-02]
 [-5.01640812e-02 -3.68510857e-02  1.20895877e-02]
 [-4.57843021e-02 -3.48918885e-02  1.56123526e-02]
 [ 3.64519358e-02  7.97038525e-02 -3.43231000e-02]
 [ 2.61384174e-02  8.37959200e-02 -3.99474017e-02]
 [ 3.18905711e-02  8.34008604e-02 -3.70659344e-02]
 [ 3.68274972e-02  8.52063000e-02 -3.18459086e-02]
 [ 3.18905711e-02  8.34008604e-02 -3.70659344e-02]
 [ 3.68274972e-02  8.52063000e-02 -3.18459086e-02]
 [ 3.18905711e-02  8.34008604e-02 -3.70659344e-02]
 [ 3.64519358e-02  7.97038525e-02 -3.43231000e-02]
 [ 9.05707292e-03  8.37134421e-02 -4.04243581e-02]
 [ 1.04475804e-02  7.80056715e-02 -4.09728549e-02]
 [ 1.48211010e-02  8.20075572e-02 -4.11238335e-02]
 [ 1.04475804e-02  7.80056715e-02 -4.09728549e-02]
 [ 1.71733890e-02  7.71569461e-02 -4.18365262e-02]
 [ 1.04475804e-02  7.80056715e-02 -4.09728549e-02]
 [-4.27520946e-02 -3.62417847e-02  2.93796211e-02]
 [-4.64256890e-02 -3.74116600e-02  2.48104017e-02]
 [-4.27520946e-02 -3.62417847e-02  2.93796211e-02]
 [-4.32846695e-02 -3.45920026e-02  2.13699657e-02]
 [-4.64256890e-02 -3.74116600e-02  2.48104017e-02]
 [-3.88644114e-02 -3.20283324e-02  2.52356883e-02]
 [-4.32846695e-02 -3.45920026e-02  2.13699657e-02]
 [-4.27520946e-02 -3.62417847e-02  2.93796211e-02]
 [-4.64256890e-02 -3.74116600e-02  2.48104017e-02]
 [-3.88644114e-02 -3.20283324e-02  2.52356883e-02]
 [-4.32846695e-02 -3.45920026e-02  2.13699657e-02]
 [-4.27520946e-02 -3.62417847e-02  2.93796211e-02]
 [-4.64256890e-02 -3.74116600e-02  2.48104017e-02]
 [ 3.28905061e-02  7.63984099e-02 -3.83790918e-02]
 [ 3.64838690e-02  7.31147453e-02 -3.57218422e-02]
 [ 3.28905061e-02  7.63984099e-02 -3.83790918e-02]
 [ 3.64838690e-02  7.31147453e-02 -3.57218422e-02]
 [ 3.32133137e-02  8.88912976e-02 -3.38624977e-02]
 [ 3.32133137e-02  8.88912976e-02 -3.38624977e-02]
 [ 2.83578709e-02  8.78354609e-02 -3.77227403e-02]
 [ 3.61979790e-02  9.08800438e-02 -3.02385464e-02]
 [ 1.71733890e-02  7.71569461e-02 -4.18365262e-02]
 [ 3.32133137e-02  8.88912976e-02 -3.38624977e-02]]
len(transformed_superpoints_pcd) :  319
copy_superpoint_src_corr_points.shape :  (15434, 3)
mask.shape :  (15434,)
copy_superpoint_src_corr_points.shape :  (13864, 3)
copy_superpoint_ref_corr_points.shape :  (13864, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13864, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 13864, 3])
batch_inlier_masks.shape :  torch.Size([1997, 13864])
best_index :  422
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13864, 3)
transformed_src_superpoints.shape :  torch.Size([13864, 3])
residual.shape :  torch.Size([13864])
batch_inlier_masks.shape :  torch.Size([13864])
batch_outlier_masks.shape :  torch.Size([13864])
indices_inliers.shape :  torch.Size([91])
indices_outliers.shape :  torch.Size([13773])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([91, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00153333  0.0863349  -0.03129809]
 [-0.00342065  0.08454169 -0.03277722]
 [ 0.00153333  0.0863349  -0.03129809]]
len(transformed_superpoints_pcd) :  410
copy_superpoint_src_corr_points.shape :  (13773, 3)
mask.shape :  (13773,)
copy_superpoint_src_corr_points.shape :  (12801, 3)
copy_superpoint_ref_corr_points.shape :  (12801, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12801, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 12801, 3])
batch_inlier_masks.shape :  torch.Size([1997, 12801])
best_index :  1256
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12801, 3)
transformed_src_superpoints.shape :  torch.Size([12801, 3])
residual.shape :  torch.Size([12801])
batch_inlier_masks.shape :  torch.Size([12801])
batch_outlier_masks.shape :  torch.Size([12801])
indices_inliers.shape :  torch.Size([89])
indices_outliers.shape :  torch.Size([12712])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([89, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.04532367 -0.03245152  0.00240923]
 [-0.04273606 -0.03006996  0.00672936]
 [ 0.01021554 -0.0800635   0.00456669]]
len(transformed_superpoints_pcd) :  499
copy_superpoint_src_corr_points.shape :  (12712, 3)
mask.shape :  (12712,)
copy_superpoint_src_corr_points.shape :  (10896, 3)
copy_superpoint_ref_corr_points.shape :  (10896, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10896, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 10896, 3])
batch_inlier_masks.shape :  torch.Size([1997, 10896])
best_index :  1319
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10896, 3)
transformed_src_superpoints.shape :  torch.Size([10896, 3])
residual.shape :  torch.Size([10896])
batch_inlier_masks.shape :  torch.Size([10896])
batch_outlier_masks.shape :  torch.Size([10896])
indices_inliers.shape :  torch.Size([74])
indices_outliers.shape :  torch.Size([10822])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([74, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00959415  0.07137245 -0.05292816]
 [ 0.03808867  0.04127666 -0.03137964]
 [ 0.04832122  0.04841826 -0.03976791]]
len(transformed_superpoints_pcd) :  573
copy_superpoint_src_corr_points.shape :  (10822, 3)
mask.shape :  (10822,)
copy_superpoint_src_corr_points.shape :  (9482, 3)
copy_superpoint_ref_corr_points.shape :  (9482, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9482, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 9482, 3])
batch_inlier_masks.shape :  torch.Size([1997, 9482])
best_index :  1774
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9482, 3)
transformed_src_superpoints.shape :  torch.Size([9482, 3])
residual.shape :  torch.Size([9482])
batch_inlier_masks.shape :  torch.Size([9482])
batch_outlier_masks.shape :  torch.Size([9482])
indices_inliers.shape :  torch.Size([67])
indices_outliers.shape :  torch.Size([9415])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([67, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.02453919  0.0031755  -0.03964713]
 [ 0.02453919  0.0031755  -0.03964713]
 [ 0.02453919  0.0031755  -0.03964713]]
len(transformed_superpoints_pcd) :  640
copy_superpoint_src_corr_points.shape :  (9415, 3)
mask.shape :  (9415,)
copy_superpoint_src_corr_points.shape :  (8107, 3)
copy_superpoint_ref_corr_points.shape :  (8107, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8107, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 8107, 3])
batch_inlier_masks.shape :  torch.Size([1997, 8107])
best_index :  1112
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8107, 3)
transformed_src_superpoints.shape :  torch.Size([8107, 3])
residual.shape :  torch.Size([8107])
batch_inlier_masks.shape :  torch.Size([8107])
batch_outlier_masks.shape :  torch.Size([8107])
indices_inliers.shape :  torch.Size([66])
indices_outliers.shape :  torch.Size([8041])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([66, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00153999 -0.02516269 -0.04957917]
 [ 0.00362644  0.07367106 -0.04731375]
 [-0.00113698  0.07293302 -0.04916098]]
len(transformed_superpoints_pcd) :  706
copy_superpoint_src_corr_points.shape :  (8041, 3)
mask.shape :  (8041,)
copy_superpoint_src_corr_points.shape :  (7010, 3)
copy_superpoint_ref_corr_points.shape :  (7010, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7010, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 7010, 3])
batch_inlier_masks.shape :  torch.Size([1997, 7010])
best_index :  1020
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7010, 3)
transformed_src_superpoints.shape :  torch.Size([7010, 3])
residual.shape :  torch.Size([7010])
batch_inlier_masks.shape :  torch.Size([7010])
batch_outlier_masks.shape :  torch.Size([7010])
indices_inliers.shape :  torch.Size([55])
indices_outliers.shape :  torch.Size([6955])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([55, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.01067414  0.08201702 -0.03129789]
 [ 0.01067414  0.08201702 -0.03129789]
 [ 0.0074891   0.08293296 -0.02698699]]
len(transformed_superpoints_pcd) :  761
copy_superpoint_src_corr_points.shape :  (6955, 3)
mask.shape :  (6955,)
copy_superpoint_src_corr_points.shape :  (6606, 3)
copy_superpoint_ref_corr_points.shape :  (6606, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6606, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 6606, 3])
batch_inlier_masks.shape :  torch.Size([1997, 6606])
best_index :  495
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6606, 3)
transformed_src_superpoints.shape :  torch.Size([6606, 3])
residual.shape :  torch.Size([6606])
batch_inlier_masks.shape :  torch.Size([6606])
batch_outlier_masks.shape :  torch.Size([6606])
indices_inliers.shape :  torch.Size([54])
indices_outliers.shape :  torch.Size([6552])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([54, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.04840244 -0.08383518  0.0357166 ]
 [-0.04719799 -0.08789128  0.03956292]
 [-0.04206392 -0.07808261  0.03284238]]
len(transformed_superpoints_pcd) :  815
copy_superpoint_src_corr_points.shape :  (6552, 3)
mask.shape :  (6552,)
copy_superpoint_src_corr_points.shape :  (6095, 3)
copy_superpoint_ref_corr_points.shape :  (6095, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6095, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 6095, 3])
batch_inlier_masks.shape :  torch.Size([1997, 6095])
best_index :  1630
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6095, 3)
transformed_src_superpoints.shape :  torch.Size([6095, 3])
residual.shape :  torch.Size([6095])
batch_inlier_masks.shape :  torch.Size([6095])
batch_outlier_masks.shape :  torch.Size([6095])
indices_inliers.shape :  torch.Size([52])
indices_outliers.shape :  torch.Size([6043])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([52, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.03038907 -0.09149122  0.04965632]
 [-0.03391571 -0.09256114  0.05384081]
 [-0.0340098  -0.09230867  0.04501114]]
len(transformed_superpoints_pcd) :  867
copy_superpoint_src_corr_points.shape :  (6043, 3)
mask.shape :  (6043,)
copy_superpoint_src_corr_points.shape :  (4850, 3)
copy_superpoint_ref_corr_points.shape :  (4850, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4850, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 4850, 3])
batch_inlier_masks.shape :  torch.Size([1997, 4850])
best_index :  11
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4850, 3)
transformed_src_superpoints.shape :  torch.Size([4850, 3])
residual.shape :  torch.Size([4850])
batch_inlier_masks.shape :  torch.Size([4850])
batch_outlier_masks.shape :  torch.Size([4850])
indices_inliers.shape :  torch.Size([42])
indices_outliers.shape :  torch.Size([4808])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([42, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.02764777  0.06608986 -0.05060247]
 [ 0.01922212  0.06478002 -0.04931777]
 [ 0.02322193  0.06674802 -0.04600304]]
len(transformed_superpoints_pcd) :  909
copy_superpoint_src_corr_points.shape :  (4808, 3)
mask.shape :  (4808,)
copy_superpoint_src_corr_points.shape :  (4174, 3)
copy_superpoint_ref_corr_points.shape :  (4174, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4174, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 4174, 3])
batch_inlier_masks.shape :  torch.Size([1997, 4174])
best_index :  1481
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4174, 3)
transformed_src_superpoints.shape :  torch.Size([4174, 3])
residual.shape :  torch.Size([4174])
batch_inlier_masks.shape :  torch.Size([4174])
batch_outlier_masks.shape :  torch.Size([4174])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([4136])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.04212094  0.07460813 -0.03393836]
 [ 0.04026517  0.07473324 -0.03958989]
 [ 0.04212094  0.07460813 -0.03393836]]
len(transformed_superpoints_pcd) :  947
copy_superpoint_src_corr_points.shape :  (4136, 3)
mask.shape :  (4136,)
copy_superpoint_src_corr_points.shape :  (3448, 3)
copy_superpoint_ref_corr_points.shape :  (3448, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3448, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 3448, 3])
batch_inlier_masks.shape :  torch.Size([1997, 3448])
best_index :  1314
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3448, 3)
transformed_src_superpoints.shape :  torch.Size([3448, 3])
residual.shape :  torch.Size([3448])
batch_inlier_masks.shape :  torch.Size([3448])
batch_outlier_masks.shape :  torch.Size([3448])
indices_inliers.shape :  torch.Size([37])
indices_outliers.shape :  torch.Size([3411])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([37, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.05962076 -0.05282915  0.02847116]
 [-0.05508104 -0.04666597  0.03077401]
 [-0.05508104 -0.04666597  0.03077401]]
len(transformed_superpoints_pcd) :  984
copy_superpoint_src_corr_points.shape :  (3411, 3)
mask.shape :  (3411,)
copy_superpoint_src_corr_points.shape :  (3338, 3)
copy_superpoint_ref_corr_points.shape :  (3338, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3338, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 3338, 3])
batch_inlier_masks.shape :  torch.Size([1997, 3338])
best_index :  743
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3338, 3)
transformed_src_superpoints.shape :  torch.Size([3338, 3])
residual.shape :  torch.Size([3338])
batch_inlier_masks.shape :  torch.Size([3338])
batch_outlier_masks.shape :  torch.Size([3338])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([3310])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.02270884 -0.10284326  0.04063561]
 [ 0.02707646 -0.10225309  0.03773765]
 [ 0.02504784 -0.09781288  0.0332609 ]]
len(transformed_superpoints_pcd) :  1012
copy_superpoint_src_corr_points.shape :  (3310, 3)
mask.shape :  (3310,)
copy_superpoint_src_corr_points.shape :  (2902, 3)
copy_superpoint_ref_corr_points.shape :  (2902, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2902, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2902, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2902])
best_index :  1614
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2902, 3)
transformed_src_superpoints.shape :  torch.Size([2902, 3])
residual.shape :  torch.Size([2902])
batch_inlier_masks.shape :  torch.Size([2902])
batch_outlier_masks.shape :  torch.Size([2902])
indices_inliers.shape :  torch.Size([25])
indices_outliers.shape :  torch.Size([2877])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([25, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00136583 -0.09493034  0.0111379 ]
 [ 0.0038495  -0.09157117  0.0073523 ]
 [ 0.00136583 -0.09493034  0.0111379 ]]
len(transformed_superpoints_pcd) :  1037
copy_superpoint_src_corr_points.shape :  (2877, 3)
mask.shape :  (2877,)
copy_superpoint_src_corr_points.shape :  (2721, 3)
copy_superpoint_ref_corr_points.shape :  (2721, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2721, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2721, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2721])
best_index :  1494
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2721, 3)
transformed_src_superpoints.shape :  torch.Size([2721, 3])
residual.shape :  torch.Size([2721])
batch_inlier_masks.shape :  torch.Size([2721])
batch_outlier_masks.shape :  torch.Size([2721])
indices_inliers.shape :  torch.Size([23])
indices_outliers.shape :  torch.Size([2698])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([23, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.0097471  -0.00555569 -0.04669411]
 [ 0.00318009 -0.00241216 -0.04670632]
 [ 0.00318009 -0.00241216 -0.04670632]]
len(transformed_superpoints_pcd) :  1060
copy_superpoint_src_corr_points.shape :  (2698, 3)
mask.shape :  (2698,)
copy_superpoint_src_corr_points.shape :  (2633, 3)
copy_superpoint_ref_corr_points.shape :  (2633, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2633, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2633, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2633])
best_index :  1707
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2633, 3)
transformed_src_superpoints.shape :  torch.Size([2633, 3])
residual.shape :  torch.Size([2633])
batch_inlier_masks.shape :  torch.Size([2633])
batch_outlier_masks.shape :  torch.Size([2633])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([2611])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.09111704  0.03610328 -0.01387842]
 [ 0.09530105  0.03368138 -0.02968383]
 [ 0.09891027  0.03396898 -0.02513363]]
len(transformed_superpoints_pcd) :  1082
copy_superpoint_src_corr_points.shape :  (2611, 3)
mask.shape :  (2611,)
copy_superpoint_src_corr_points.shape :  (2530, 3)
copy_superpoint_ref_corr_points.shape :  (2530, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2530, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2530, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2530])
best_index :  941
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2530, 3)
transformed_src_superpoints.shape :  torch.Size([2530, 3])
residual.shape :  torch.Size([2530])
batch_inlier_masks.shape :  torch.Size([2530])
batch_outlier_masks.shape :  torch.Size([2530])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2509])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.04324483  0.08689034 -0.02250631]
 [ 0.04324483  0.08689034 -0.02250631]
 [ 0.04324483  0.08689034 -0.02250631]]
len(transformed_superpoints_pcd) :  1103
copy_superpoint_src_corr_points.shape :  (2509, 3)
mask.shape :  (2509,)
copy_superpoint_src_corr_points.shape :  (2383, 3)
copy_superpoint_ref_corr_points.shape :  (2383, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2383, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2383, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2383])
best_index :  1136
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2383, 3)
transformed_src_superpoints.shape :  torch.Size([2383, 3])
residual.shape :  torch.Size([2383])
batch_inlier_masks.shape :  torch.Size([2383])
batch_outlier_masks.shape :  torch.Size([2383])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([2364])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00971952  0.00268813 -0.04140287]
 [ 0.01074839  0.0059702  -0.04886003]
 [ 0.00971952  0.00268813 -0.04140287]]
len(transformed_superpoints_pcd) :  1122
copy_superpoint_src_corr_points.shape :  (2364, 3)
mask.shape :  (2364,)
copy_superpoint_src_corr_points.shape :  (2261, 3)
copy_superpoint_ref_corr_points.shape :  (2261, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2261, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2261, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2261])
best_index :  1464
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2261, 3)
transformed_src_superpoints.shape :  torch.Size([2261, 3])
residual.shape :  torch.Size([2261])
batch_inlier_masks.shape :  torch.Size([2261])
batch_outlier_masks.shape :  torch.Size([2261])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([2242])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.03919289 -0.03550185  0.03055067]
 [-0.04651574 -0.03748581  0.02680283]
 [-0.03919289 -0.03550185  0.03055067]]
len(transformed_superpoints_pcd) :  1141
copy_superpoint_src_corr_points.shape :  (2242, 3)
mask.shape :  (2242,)
copy_superpoint_src_corr_points.shape :  (2176, 3)
copy_superpoint_ref_corr_points.shape :  (2176, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2176, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2176, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2176])
best_index :  212
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2176, 3)
transformed_src_superpoints.shape :  torch.Size([2176, 3])
residual.shape :  torch.Size([2176])
batch_inlier_masks.shape :  torch.Size([2176])
batch_outlier_masks.shape :  torch.Size([2176])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([2158])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.03686277 -0.10022935  0.0535545 ]
 [ 0.03310689 -0.09981034  0.05700479]
 [ 0.0349327  -0.09634514  0.06017281]]
len(transformed_superpoints_pcd) :  1159
copy_superpoint_src_corr_points.shape :  (2158, 3)
mask.shape :  (2158,)
copy_superpoint_src_corr_points.shape :  (2117, 3)
copy_superpoint_ref_corr_points.shape :  (2117, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2117, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 2117, 3])
batch_inlier_masks.shape :  torch.Size([1997, 2117])
best_index :  401
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2117, 3)
transformed_src_superpoints.shape :  torch.Size([2117, 3])
residual.shape :  torch.Size([2117])
batch_inlier_masks.shape :  torch.Size([2117])
batch_outlier_masks.shape :  torch.Size([2117])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([2100])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.0275225   0.09016939 -0.02232733]
 [ 0.03214582  0.08884936 -0.02676495]
 [ 0.03214582  0.08884936 -0.02676495]]
len(transformed_superpoints_pcd) :  1176
copy_superpoint_src_corr_points.shape :  (2100, 3)
mask.shape :  (2100,)
copy_superpoint_src_corr_points.shape :  (1840, 3)
copy_superpoint_ref_corr_points.shape :  (1840, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1840, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1840, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1840])
best_index :  1279
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1840, 3)
transformed_src_superpoints.shape :  torch.Size([1840, 3])
residual.shape :  torch.Size([1840])
batch_inlier_masks.shape :  torch.Size([1840])
batch_outlier_masks.shape :  torch.Size([1840])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1824])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.03390564  0.06752136 -0.05018066]
 [ 0.02517197  0.06818621 -0.047986  ]
 [ 0.01427795  0.06846338 -0.05043492]]
len(transformed_superpoints_pcd) :  1192
copy_superpoint_src_corr_points.shape :  (1824, 3)
mask.shape :  (1824,)
copy_superpoint_src_corr_points.shape :  (1743, 3)
copy_superpoint_ref_corr_points.shape :  (1743, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1743, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1743, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1743])
best_index :  1331
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1743, 3)
transformed_src_superpoints.shape :  torch.Size([1743, 3])
residual.shape :  torch.Size([1743])
batch_inlier_masks.shape :  torch.Size([1743])
batch_outlier_masks.shape :  torch.Size([1743])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1727])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00361894 -0.00664927 -0.04876715]
 [ 0.00361894 -0.00664927 -0.04876715]
 [ 0.00677723 -0.01114888 -0.04814526]]
len(transformed_superpoints_pcd) :  1208
copy_superpoint_src_corr_points.shape :  (1727, 3)
mask.shape :  (1727,)
copy_superpoint_src_corr_points.shape :  (1698, 3)
copy_superpoint_ref_corr_points.shape :  (1698, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1698, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1698, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1698])
best_index :  657
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1698, 3)
transformed_src_superpoints.shape :  torch.Size([1698, 3])
residual.shape :  torch.Size([1698])
batch_inlier_masks.shape :  torch.Size([1698])
batch_outlier_masks.shape :  torch.Size([1698])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1683])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.04331651 -0.0648478   0.0119526 ]
 [-0.04078571 -0.0692032   0.01354643]
 [-0.04078571 -0.0692032   0.01354643]]
len(transformed_superpoints_pcd) :  1223
copy_superpoint_src_corr_points.shape :  (1683, 3)
mask.shape :  (1683,)
copy_superpoint_src_corr_points.shape :  (1582, 3)
copy_superpoint_ref_corr_points.shape :  (1582, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1582, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1582, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1582])
best_index :  1483
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1582, 3)
transformed_src_superpoints.shape :  torch.Size([1582, 3])
residual.shape :  torch.Size([1582])
batch_inlier_masks.shape :  torch.Size([1582])
batch_outlier_masks.shape :  torch.Size([1582])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1567])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.04656969 -0.04474844  0.04115627]
 [-0.04957442 -0.04308596  0.03519111]
 [-0.04957442 -0.04308596  0.03519111]]
len(transformed_superpoints_pcd) :  1238
copy_superpoint_src_corr_points.shape :  (1567, 3)
mask.shape :  (1567,)
copy_superpoint_src_corr_points.shape :  (1404, 3)
copy_superpoint_ref_corr_points.shape :  (1404, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1404, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1404, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1404])
best_index :  905
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1404, 3)
transformed_src_superpoints.shape :  torch.Size([1404, 3])
residual.shape :  torch.Size([1404])
batch_inlier_masks.shape :  torch.Size([1404])
batch_outlier_masks.shape :  torch.Size([1404])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1390])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.01574442  0.08544755 -0.02955859]
 [ 0.01467521  0.08060417 -0.0305851 ]
 [ 0.02074858  0.09175146 -0.02966478]]
len(transformed_superpoints_pcd) :  1252
copy_superpoint_src_corr_points.shape :  (1390, 3)
mask.shape :  (1390,)
copy_superpoint_src_corr_points.shape :  (1302, 3)
copy_superpoint_ref_corr_points.shape :  (1302, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1302, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1302, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1302])
best_index :  379
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1302, 3)
transformed_src_superpoints.shape :  torch.Size([1302, 3])
residual.shape :  torch.Size([1302])
batch_inlier_masks.shape :  torch.Size([1302])
batch_outlier_masks.shape :  torch.Size([1302])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1289])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.09809652  0.05014091 -0.02068681]
 [ 0.00138709 -0.02328289 -0.0480446 ]
 [ 0.00138709 -0.02328289 -0.0480446 ]]
len(transformed_superpoints_pcd) :  1265
copy_superpoint_src_corr_points.shape :  (1289, 3)
mask.shape :  (1289,)
copy_superpoint_src_corr_points.shape :  (1175, 3)
copy_superpoint_ref_corr_points.shape :  (1175, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1175, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1175, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1175])
best_index :  870
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1175, 3)
transformed_src_superpoints.shape :  torch.Size([1175, 3])
residual.shape :  torch.Size([1175])
batch_inlier_masks.shape :  torch.Size([1175])
batch_outlier_masks.shape :  torch.Size([1175])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([1162])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.03749513 -0.09951156  0.04142165]
 [ 0.03768511 -0.09489889  0.03857108]
 [ 0.030786   -0.08054043  0.06023388]]
len(transformed_superpoints_pcd) :  1278
copy_superpoint_src_corr_points.shape :  (1162, 3)
mask.shape :  (1162,)
copy_superpoint_src_corr_points.shape :  (1108, 3)
copy_superpoint_ref_corr_points.shape :  (1108, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1108, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 1108, 3])
batch_inlier_masks.shape :  torch.Size([1997, 1108])
best_index :  1697
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1108, 3)
transformed_src_superpoints.shape :  torch.Size([1108, 3])
residual.shape :  torch.Size([1108])
batch_inlier_masks.shape :  torch.Size([1108])
batch_outlier_masks.shape :  torch.Size([1108])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1096])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.0388841   0.04435443 -0.03446205]
 [ 0.0388841   0.04435443 -0.03446205]
 [ 0.05038651  0.03750842 -0.02939289]]
len(transformed_superpoints_pcd) :  1290
copy_superpoint_src_corr_points.shape :  (1096, 3)
mask.shape :  (1096,)
copy_superpoint_src_corr_points.shape :  (995, 3)
copy_superpoint_ref_corr_points.shape :  (995, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([995, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 995, 3])
batch_inlier_masks.shape :  torch.Size([1997, 995])
best_index :  1747
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (995, 3)
transformed_src_superpoints.shape :  torch.Size([995, 3])
residual.shape :  torch.Size([995])
batch_inlier_masks.shape :  torch.Size([995])
batch_outlier_masks.shape :  torch.Size([995])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([983])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.0389639  -0.07110314  0.02548544]
 [-0.0451075  -0.0719932   0.02204302]
 [-0.04225629 -0.06984932  0.01755351]]
len(transformed_superpoints_pcd) :  1302
copy_superpoint_src_corr_points.shape :  (983, 3)
mask.shape :  (983,)
copy_superpoint_src_corr_points.shape :  (963, 3)
copy_superpoint_ref_corr_points.shape :  (963, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([963, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 963, 3])
batch_inlier_masks.shape :  torch.Size([1997, 963])
best_index :  1711
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (963, 3)
transformed_src_superpoints.shape :  torch.Size([963, 3])
residual.shape :  torch.Size([963])
batch_inlier_masks.shape :  torch.Size([963])
batch_outlier_masks.shape :  torch.Size([963])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([952])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.08664697  0.05337264 -0.0246702 ]
 [ 0.08532281  0.0554253  -0.02910819]
 [ 0.08808994  0.05118062 -0.0190156 ]]
len(transformed_superpoints_pcd) :  1313
copy_superpoint_src_corr_points.shape :  (952, 3)
mask.shape :  (952,)
copy_superpoint_src_corr_points.shape :  (952, 3)
copy_superpoint_ref_corr_points.shape :  (952, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([952, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 952, 3])
batch_inlier_masks.shape :  torch.Size([1997, 952])
best_index :  1977
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (952, 3)
transformed_src_superpoints.shape :  torch.Size([952, 3])
residual.shape :  torch.Size([952])
batch_inlier_masks.shape :  torch.Size([952])
batch_outlier_masks.shape :  torch.Size([952])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([941])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00717037  0.01842538 -0.04988357]
 [ 0.01115869  0.01271684 -0.04742795]
 [-0.00051916  0.01340129 -0.04879828]]
len(transformed_superpoints_pcd) :  1324
copy_superpoint_src_corr_points.shape :  (941, 3)
mask.shape :  (941,)
copy_superpoint_src_corr_points.shape :  (925, 3)
copy_superpoint_ref_corr_points.shape :  (925, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([925, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 925, 3])
batch_inlier_masks.shape :  torch.Size([1997, 925])
best_index :  1979
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (925, 3)
transformed_src_superpoints.shape :  torch.Size([925, 3])
residual.shape :  torch.Size([925])
batch_inlier_masks.shape :  torch.Size([925])
batch_outlier_masks.shape :  torch.Size([925])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([914])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.03377035 -0.08275419  0.03748569]
 [-0.03927572 -0.08197111  0.03864529]
 [-0.03816109 -0.08400176  0.04370259]]
len(transformed_superpoints_pcd) :  1335
copy_superpoint_src_corr_points.shape :  (914, 3)
mask.shape :  (914,)
copy_superpoint_src_corr_points.shape :  (887, 3)
copy_superpoint_ref_corr_points.shape :  (887, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([887, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 887, 3])
batch_inlier_masks.shape :  torch.Size([1997, 887])
best_index :  1419
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (887, 3)
transformed_src_superpoints.shape :  torch.Size([887, 3])
residual.shape :  torch.Size([887])
batch_inlier_masks.shape :  torch.Size([887])
batch_outlier_masks.shape :  torch.Size([887])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([877])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.03816142 -0.07485384 -0.00843867]
 [-0.03942902 -0.07064815 -0.01384474]
 [-0.03440669 -0.07836808 -0.00787977]]
len(transformed_superpoints_pcd) :  1345
copy_superpoint_src_corr_points.shape :  (877, 3)
mask.shape :  (877,)
copy_superpoint_src_corr_points.shape :  (867, 3)
copy_superpoint_ref_corr_points.shape :  (867, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([867, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 867, 3])
batch_inlier_masks.shape :  torch.Size([1997, 867])
best_index :  1592
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (867, 3)
transformed_src_superpoints.shape :  torch.Size([867, 3])
residual.shape :  torch.Size([867])
batch_inlier_masks.shape :  torch.Size([867])
batch_outlier_masks.shape :  torch.Size([867])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([857])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.04947262 -0.04574408  0.02172691]
 [-0.05306663 -0.038236    0.02087299]
 [-0.05487974 -0.04484593  0.02529851]]
len(transformed_superpoints_pcd) :  1355
copy_superpoint_src_corr_points.shape :  (857, 3)
mask.shape :  (857,)
copy_superpoint_src_corr_points.shape :  (857, 3)
copy_superpoint_ref_corr_points.shape :  (857, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([857, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 857, 3])
batch_inlier_masks.shape :  torch.Size([1997, 857])
best_index :  1647
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (857, 3)
transformed_src_superpoints.shape :  torch.Size([857, 3])
residual.shape :  torch.Size([857])
batch_inlier_masks.shape :  torch.Size([857])
batch_outlier_masks.shape :  torch.Size([857])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([847])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.08288523  0.05867462 -0.01777984]
 [ 0.08689976  0.05344202 -0.02435184]
 [ 0.08595604  0.05068657 -0.0290534 ]]
len(transformed_superpoints_pcd) :  1365
copy_superpoint_src_corr_points.shape :  (847, 3)
mask.shape :  (847,)
copy_superpoint_src_corr_points.shape :  (821, 3)
copy_superpoint_ref_corr_points.shape :  (821, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([821, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 821, 3])
batch_inlier_masks.shape :  torch.Size([1997, 821])
best_index :  1967
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (821, 3)
transformed_src_superpoints.shape :  torch.Size([821, 3])
residual.shape :  torch.Size([821])
batch_inlier_masks.shape :  torch.Size([821])
batch_outlier_masks.shape :  torch.Size([821])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([811])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.05207957 -0.04769151  0.01822109]
 [-0.05358019 -0.04462075  0.02370776]
 [-0.05154636 -0.03868072  0.0239787 ]]
len(transformed_superpoints_pcd) :  1375
copy_superpoint_src_corr_points.shape :  (811, 3)
mask.shape :  (811,)
copy_superpoint_src_corr_points.shape :  (811, 3)
copy_superpoint_ref_corr_points.shape :  (811, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([811, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 811, 3])
batch_inlier_masks.shape :  torch.Size([1997, 811])
best_index :  84
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (811, 3)
transformed_src_superpoints.shape :  torch.Size([811, 3])
residual.shape :  torch.Size([811])
batch_inlier_masks.shape :  torch.Size([811])
batch_outlier_masks.shape :  torch.Size([811])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([802])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.04683802  0.03738521 -0.03450412]
 [-0.0302231  -0.07768559  0.01957081]
 [ 0.0018095   0.02329096  0.04331097]]
len(transformed_superpoints_pcd) :  1384
copy_superpoint_src_corr_points.shape :  (802, 3)
mask.shape :  (802,)
copy_superpoint_src_corr_points.shape :  (625, 3)
copy_superpoint_ref_corr_points.shape :  (625, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([625, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 625, 3])
batch_inlier_masks.shape :  torch.Size([1997, 625])
best_index :  1185
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (625, 3)
transformed_src_superpoints.shape :  torch.Size([625, 3])
residual.shape :  torch.Size([625])
batch_inlier_masks.shape :  torch.Size([625])
batch_outlier_masks.shape :  torch.Size([625])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([616])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.01829119 -0.02908869  0.03551551]
 [ 0.01982712 -0.02486593  0.0331276 ]
 [ 0.02376667 -0.02847559  0.03182898]]
len(transformed_superpoints_pcd) :  1393
copy_superpoint_src_corr_points.shape :  (616, 3)
mask.shape :  (616,)
copy_superpoint_src_corr_points.shape :  (616, 3)
copy_superpoint_ref_corr_points.shape :  (616, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([616, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 616, 3])
batch_inlier_masks.shape :  torch.Size([1997, 616])
best_index :  1348
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (616, 3)
transformed_src_superpoints.shape :  torch.Size([616, 3])
residual.shape :  torch.Size([616])
batch_inlier_masks.shape :  torch.Size([616])
batch_outlier_masks.shape :  torch.Size([616])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([607])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.0567514   0.04017445 -0.03406298]
 [-0.06057901  0.04004242 -0.03041869]
 [-0.0567514   0.04017445 -0.03406298]]
len(transformed_superpoints_pcd) :  1402
copy_superpoint_src_corr_points.shape :  (607, 3)
mask.shape :  (607,)
copy_superpoint_src_corr_points.shape :  (598, 3)
copy_superpoint_ref_corr_points.shape :  (598, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([598, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 598, 3])
batch_inlier_masks.shape :  torch.Size([1997, 598])
best_index :  1698
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (598, 3)
transformed_src_superpoints.shape :  torch.Size([598, 3])
residual.shape :  torch.Size([598])
batch_inlier_masks.shape :  torch.Size([598])
batch_outlier_masks.shape :  torch.Size([598])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([589])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.03645618 -0.09986956  0.03621155]
 [ 0.0395954  -0.09972694  0.04068373]
 [ 0.03440232 -0.09945958  0.04144645]]
len(transformed_superpoints_pcd) :  1411
copy_superpoint_src_corr_points.shape :  (589, 3)
mask.shape :  (589,)
copy_superpoint_src_corr_points.shape :  (587, 3)
copy_superpoint_ref_corr_points.shape :  (587, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([587, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 587, 3])
batch_inlier_masks.shape :  torch.Size([1997, 587])
best_index :  1902
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (587, 3)
transformed_src_superpoints.shape :  torch.Size([587, 3])
residual.shape :  torch.Size([587])
batch_inlier_masks.shape :  torch.Size([587])
batch_outlier_masks.shape :  torch.Size([587])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([578])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.04988559 -0.04541212  0.01197439]
 [-0.04804122 -0.0419375   0.00771527]
 [-0.04963817 -0.04943493  0.0089352 ]]
len(transformed_superpoints_pcd) :  1420
copy_superpoint_src_corr_points.shape :  (578, 3)
mask.shape :  (578,)
copy_superpoint_src_corr_points.shape :  (569, 3)
copy_superpoint_ref_corr_points.shape :  (569, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([569, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 569, 3])
batch_inlier_masks.shape :  torch.Size([1997, 569])
best_index :  1499
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (569, 3)
transformed_src_superpoints.shape :  torch.Size([569, 3])
residual.shape :  torch.Size([569])
batch_inlier_masks.shape :  torch.Size([569])
batch_outlier_masks.shape :  torch.Size([569])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([561])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.0066675   0.00514486 -0.04706965]
 [ 0.0066675   0.00514486 -0.04706965]
 [ 0.0066675   0.00514486 -0.04706965]]
len(transformed_superpoints_pcd) :  1428
copy_superpoint_src_corr_points.shape :  (561, 3)
mask.shape :  (561,)
copy_superpoint_src_corr_points.shape :  (502, 3)
copy_superpoint_ref_corr_points.shape :  (502, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([502, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 502, 3])
batch_inlier_masks.shape :  torch.Size([1997, 502])
best_index :  652
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (502, 3)
transformed_src_superpoints.shape :  torch.Size([502, 3])
residual.shape :  torch.Size([502])
batch_inlier_masks.shape :  torch.Size([502])
batch_outlier_masks.shape :  torch.Size([502])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([495])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.00615426 -0.03722479 -0.0486578 ]
 [-0.00615426 -0.03722479 -0.0486578 ]
 [-0.00615426 -0.03722479 -0.0486578 ]]
len(transformed_superpoints_pcd) :  1435
copy_superpoint_src_corr_points.shape :  (495, 3)
mask.shape :  (495,)
copy_superpoint_src_corr_points.shape :  (485, 3)
copy_superpoint_ref_corr_points.shape :  (485, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([485, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 485, 3])
batch_inlier_masks.shape :  torch.Size([1997, 485])
best_index :  1117
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (485, 3)
transformed_src_superpoints.shape :  torch.Size([485, 3])
residual.shape :  torch.Size([485])
batch_inlier_masks.shape :  torch.Size([485])
batch_outlier_masks.shape :  torch.Size([485])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([478])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.04771736 -0.03841743  0.01481632]
 [-0.04771736 -0.03841743  0.01481632]
 [-0.04771736 -0.03841743  0.01481632]]
len(transformed_superpoints_pcd) :  1442
copy_superpoint_src_corr_points.shape :  (478, 3)
mask.shape :  (478,)
copy_superpoint_src_corr_points.shape :  (469, 3)
copy_superpoint_ref_corr_points.shape :  (469, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([469, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 469, 3])
batch_inlier_masks.shape :  torch.Size([1997, 469])
best_index :  1688
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (469, 3)
transformed_src_superpoints.shape :  torch.Size([469, 3])
residual.shape :  torch.Size([469])
batch_inlier_masks.shape :  torch.Size([469])
batch_outlier_masks.shape :  torch.Size([469])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([462])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.00775238  0.07941133 -0.03079537]
 [-0.0452227   0.04915062 -0.02008301]
 [-0.0452227   0.04915062 -0.02008301]]
len(transformed_superpoints_pcd) :  1449
copy_superpoint_src_corr_points.shape :  (462, 3)
mask.shape :  (462,)
copy_superpoint_src_corr_points.shape :  (347, 3)
copy_superpoint_ref_corr_points.shape :  (347, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([347, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 347, 3])
batch_inlier_masks.shape :  torch.Size([1997, 347])
best_index :  1475
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (347, 3)
transformed_src_superpoints.shape :  torch.Size([347, 3])
residual.shape :  torch.Size([347])
batch_inlier_masks.shape :  torch.Size([347])
batch_outlier_masks.shape :  torch.Size([347])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([341])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.01155718 -0.02063492 -0.04274632]
 [ 0.01320339 -0.01462194 -0.04124067]
 [ 0.02416272  0.0675046  -0.04449353]]
len(transformed_superpoints_pcd) :  1455
copy_superpoint_src_corr_points.shape :  (341, 3)
mask.shape :  (341,)
copy_superpoint_src_corr_points.shape :  (326, 3)
copy_superpoint_ref_corr_points.shape :  (326, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([326, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 326, 3])
batch_inlier_masks.shape :  torch.Size([1997, 326])
best_index :  1482
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (326, 3)
transformed_src_superpoints.shape :  torch.Size([326, 3])
residual.shape :  torch.Size([326])
batch_inlier_masks.shape :  torch.Size([326])
batch_outlier_masks.shape :  torch.Size([326])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([320])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.092798    0.03942235 -0.01786637]
 [ 0.09466335  0.03816749 -0.0223509 ]
 [ 0.092798    0.03942235 -0.01786637]]
len(transformed_superpoints_pcd) :  1461
copy_superpoint_src_corr_points.shape :  (320, 3)
mask.shape :  (320,)
copy_superpoint_src_corr_points.shape :  (312, 3)
copy_superpoint_ref_corr_points.shape :  (312, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([312, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 312, 3])
batch_inlier_masks.shape :  torch.Size([1997, 312])
best_index :  1800
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (312, 3)
transformed_src_superpoints.shape :  torch.Size([312, 3])
residual.shape :  torch.Size([312])
batch_inlier_masks.shape :  torch.Size([312])
batch_outlier_masks.shape :  torch.Size([312])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([306])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [-0.05706899  0.03982995 -0.03419874]
 [-0.05256323  0.03996458 -0.03088931]
 [-0.05706899  0.03982995 -0.03419874]]
len(transformed_superpoints_pcd) :  1467
copy_superpoint_src_corr_points.shape :  (306, 3)
mask.shape :  (306,)
copy_superpoint_src_corr_points.shape :  (297, 3)
copy_superpoint_ref_corr_points.shape :  (297, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([297, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 297, 3])
batch_inlier_masks.shape :  torch.Size([1997, 297])
best_index :  248
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (297, 3)
transformed_src_superpoints.shape :  torch.Size([297, 3])
residual.shape :  torch.Size([297])
batch_inlier_masks.shape :  torch.Size([297])
batch_outlier_masks.shape :  torch.Size([297])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([292])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00965615  0.00212894 -0.0500058 ]
 [ 0.00965615  0.00212894 -0.0500058 ]
 [ 0.00965615  0.00212894 -0.0500058 ]]
len(transformed_superpoints_pcd) :  1472
copy_superpoint_src_corr_points.shape :  (292, 3)
mask.shape :  (292,)
copy_superpoint_src_corr_points.shape :  (240, 3)
copy_superpoint_ref_corr_points.shape :  (240, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([240, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 240, 3])
batch_inlier_masks.shape :  torch.Size([1997, 240])
best_index :  475
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (240, 3)
transformed_src_superpoints.shape :  torch.Size([240, 3])
residual.shape :  torch.Size([240])
batch_inlier_masks.shape :  torch.Size([240])
batch_outlier_masks.shape :  torch.Size([240])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([235])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.00732938 -0.01431546  0.03313011]
 [-0.03891489 -0.06776294  0.01746592]
 [-0.03891489 -0.06776294  0.01746592]]
len(transformed_superpoints_pcd) :  1477
copy_superpoint_src_corr_points.shape :  (235, 3)
mask.shape :  (235,)
copy_superpoint_src_corr_points.shape :  (134, 3)
copy_superpoint_ref_corr_points.shape :  (134, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([134, 3])
batch_transforms.shape :  torch.Size([1997, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1997, 134, 3])
batch_inlier_masks.shape :  torch.Size([1997, 134])
best_index :  700
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (134, 3)
transformed_src_superpoints.shape :  torch.Size([134, 3])
residual.shape :  torch.Size([134])
batch_inlier_masks.shape :  torch.Size([134])
batch_outlier_masks.shape :  torch.Size([134])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([129])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.01377045  0.08142965 -0.03738849]
 [ 0.01964749  0.07606049 -0.03884969]
 [ 0.01185654  0.08626024 -0.03834992]
 ...
 [ 0.02914947  0.03626383 -0.02350767]
 [-0.0326045  -0.06476928 -0.01824389]
 [ 0.02914947  0.03626383 -0.02350767]]
len(transformed_superpoints_pcd) :  1482
copy_superpoint_src_corr_points.shape :  (129, 3)
mask.shape :  (129,)
copy_superpoint_src_corr_points.shape :  (94, 3)
copy_superpoint_ref_corr_points.shape :  (94, 3)
number of unique points in pcd :  568
number of rotations used :  54
transformed_superpoints_pcd.shape :  (1576, 3)
Line set updated
101
src_points :  [[-0.06078721  0.01203374  0.00560631]
 [-0.05945548  0.01725497  0.00581695]
 [-0.05801029  0.02336633  0.00443192]
 ...
 [-0.01520868  0.09860527 -0.0231151 ]
 [-0.01959388  0.09696081 -0.02497291]
 [-0.03303383  0.09144338 -0.03539792]]
ref_points :  [[-0.05968004 -0.04557859  0.06209375]
 [-0.05975939 -0.0417841   0.05804032]
 [-0.0612934  -0.041524    0.05277384]
 ...
 [-0.04740175  0.09180488 -0.00583601]
 [-0.0317386   0.09482536 -0.01556156]
 [-0.02351403  0.09600922 -0.02392419]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([3776, 3])
lengths :  tensor([1860, 1916])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([2237, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([712, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([351, 3])
ref_points_f.shape :  torch.Size([1860, 3])
src_points_c.shape :  torch.Size([361, 3])
src_points_f.shape :  torch.Size([1916, 3])
ref_node_masks.shape :  torch.Size([351])
ref_node_knn_indices.shape :  torch.Size([351, 5])
ref_node_knn_masks.shape :  torch.Size([351, 5])
src_node_masks.shape :  torch.Size([361])
src_node_knn_indices.shape :  torch.Size([361, 5])
src_node_knn_masks.shape :  torch.Size([361, 5])
ref_node_knn_points.shape :  torch.Size([351, 5, 3])
src_node_knn_points.shape :  torch.Size([361, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([712, 512])
feats_f :  torch.Size([3776, 256])
k :  3
omegas.shape :  torch.Size([123201, 128, 1])
omegas.shape :  torch.Size([369603, 128, 1])
k :  3
omegas.shape :  torch.Size([130321, 128, 1])
omegas.shape :  torch.Size([390963, 128, 1])
ref_feats_c.shape :  torch.Size([1, 351, 256])
src_feats_c.shape :  torch.Size([1, 361, 256])
ref_feats_c_norm.shape :  torch.Size([351, 256])
src_feats_c_norm.shape :  torch.Size([361, 256])
ref_node_masks.shape :  torch.Size([351])
src_node_masks.shape :  torch.Size([361])
self.num_correspondences :  2000
matching_scores.numel() :  126711
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([19054])
ref_indices.shape :  torch.Size([19054])
src_indices.shape :  torch.Size([19054])
batch_indices :  tensor([   0,    1,    1,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 3, 4, 4], device='cuda:0')
src_indices :  tensor([0, 0, 1,  ..., 4, 0, 4], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([19054, 3])
global_src_corr_points.shape :  torch.Size([19054, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([1971, 4, 4])
src_corr_points.shape :  torch.Size([19054, 3])
ref_corr_points.shape :  torch.Size([1, 19054, 3])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 19054, 3])
batch_corr_residuals.shape :  torch.Size([1971, 19054])
batch_inlier_masks.shape :  torch.Size([1971, 19054])
best_index :  tensor(1631, device='cuda:0')
len(batch_transforms) :  1971
estimated_transform :  [[ 0.93762475  0.18510173  0.2942737   0.00290927]
 [-0.2111935   0.97564864  0.05921733 -0.00909269]
 [-0.27614656 -0.11767229  0.9538847   0.00146648]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [1467  788  697 ...  239 1041 1631]
superpoint_src_corr_points.shape :  (19054, 3)
superpoint_ref_corr_points.shape :  (19054, 3)
batch_inlier_masks.shape :  (1971, 19054)
batch_transforms.shape :  (1971, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([19054, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 19054, 3])
batch_inlier_masks.shape :  torch.Size([1971, 19054])
best_index :  91
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (19054, 3)
transformed_src_superpoints.shape :  torch.Size([19054, 3])
residual.shape :  torch.Size([19054])
batch_inlier_masks.shape :  torch.Size([19054])
batch_outlier_masks.shape :  torch.Size([19054])
indices_inliers.shape :  torch.Size([139])
indices_outliers.shape :  torch.Size([18915])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([139, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02118111  0.05344458  0.00338795]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02164273  0.05871164  0.00441741]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02118111  0.05344458  0.00338795]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02164273  0.05871164  0.00441741]
 [-0.02075488  0.04826311  0.00252808]
 [-0.0241144  -0.0591938  -0.01126053]
 [ 0.00104713  0.09500691 -0.05501365]
 [ 0.00208552  0.09823341 -0.04920686]
 [ 0.00104713  0.09500691 -0.05501365]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.0103752   0.06061195 -0.06145169]
 [ 0.01271205  0.05657827 -0.0569411 ]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.00488113  0.05488501 -0.06490178]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.00488113  0.05488501 -0.06490178]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [-0.00365955  0.09591094 -0.05709494]
 [ 0.00384647  0.05016723 -0.06261297]
 [ 0.00075505  0.05299406 -0.06726608]
 [-0.00087277  0.04830473 -0.06530355]
 [ 0.00384647  0.05016723 -0.06261297]
 [-0.00038265  0.04445805 -0.06141501]
 [-0.00087277  0.04830473 -0.06530355]
 [ 0.00384647  0.05016723 -0.06261297]
 [ 0.00075505  0.05299406 -0.06726608]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.01940491  0.00143579 -0.0391867 ]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.00629734  0.06045748 -0.06500449]
 [ 0.00153734  0.05821346 -0.06784492]
 [ 0.00629734  0.06045748 -0.06500449]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.03273746  0.0139505  -0.03879944]
 [ 0.03120059  0.01871122 -0.04118236]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.00582197  0.08661695 -0.05945742]
 [ 0.00582197  0.08661695 -0.05945742]
 [-0.00100068  0.08886397 -0.06307264]
 [ 0.00582197  0.08661695 -0.05945742]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.02107224  0.00950472 -0.04552228]
 [ 0.0215381   0.01424737 -0.04714119]
 [ 0.02643992  0.01611159 -0.04472995]
 [ 0.0215381   0.01424737 -0.04714119]
 [ 0.02643992  0.01611159 -0.04472995]
 [-0.00656609  0.01353616 -0.05292293]
 [ 0.00090189  0.01496852 -0.05158692]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02075488  0.04826311  0.00252808]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00724829  0.09625187 -0.04858881]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00569311  0.09332651 -0.05314263]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00569311  0.09332651 -0.05314263]
 [ 0.00724829  0.09625187 -0.04858881]
 [-0.00724745 -0.01509107  0.01426208]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00297704 -0.01251328  0.01184075]
 [-0.00724745 -0.01509107  0.01426208]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00297704 -0.01251328  0.01184075]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00458222 -0.00313223  0.01273431]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00458222 -0.00313223  0.01273431]
 [-0.00643779  0.00291049  0.01439599]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00627206  0.02634659 -0.05370296]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.01285358  0.01590647 -0.05465037]
 [-0.00627206  0.02634659 -0.05370296]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.01443586  0.02232697 -0.05538305]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.00384647  0.05016723 -0.06261297]
 [-0.00038265  0.04445805 -0.06141501]
 [-0.0011869   0.0199783  -0.05215612]
 [-0.00027919  0.02517047 -0.05201101]
 [-0.0011869   0.0199783  -0.05215612]
 [-0.00027919  0.02517047 -0.05201101]
 [ 0.00326348 -0.03899555 -0.03846969]
 [ 0.00837459  0.01861656 -0.05048032]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.00756418  0.00884602 -0.04882757]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.00756418  0.00884602 -0.04882757]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.01676538  0.05865975 -0.05225749]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.01542621  0.06960917 -0.05660537]
 [ 0.01221298  0.06529275 -0.06029828]
 [ 0.01760985  0.06374268 -0.05330715]
 [ 0.02747405  0.02129678 -0.04384003]
 [ 0.00137575  0.00857135 -0.05030322]
 [ 0.00137575  0.00857135 -0.05030322]
 [-0.01251962  0.00064883  0.01724824]]
len(transformed_superpoints_pcd) :  139
copy_superpoint_src_corr_points.shape :  (18915, 3)
mask.shape :  (18915,)
copy_superpoint_src_corr_points.shape :  (13160, 3)
copy_superpoint_ref_corr_points.shape :  (13160, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13160, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 13160, 3])
batch_inlier_masks.shape :  torch.Size([1971, 13160])
best_index :  942
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13160, 3)
transformed_src_superpoints.shape :  torch.Size([13160, 3])
residual.shape :  torch.Size([13160])
batch_inlier_masks.shape :  torch.Size([13160])
batch_outlier_masks.shape :  torch.Size([13160])
indices_inliers.shape :  torch.Size([82])
indices_outliers.shape :  torch.Size([13078])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([82, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02118111  0.05344458  0.00338795]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02164273  0.05871164  0.00441741]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02118111  0.05344458  0.00338795]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02164273  0.05871164  0.00441741]
 [-0.02075488  0.04826311  0.00252808]
 [-0.0241144  -0.0591938  -0.01126053]
 [ 0.00104713  0.09500691 -0.05501365]
 [ 0.00208552  0.09823341 -0.04920686]
 [ 0.00104713  0.09500691 -0.05501365]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.0103752   0.06061195 -0.06145169]
 [ 0.01271205  0.05657827 -0.0569411 ]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.00488113  0.05488501 -0.06490178]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.00488113  0.05488501 -0.06490178]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [-0.00365955  0.09591094 -0.05709494]
 [ 0.00384647  0.05016723 -0.06261297]
 [ 0.00075505  0.05299406 -0.06726608]
 [-0.00087277  0.04830473 -0.06530355]
 [ 0.00384647  0.05016723 -0.06261297]
 [-0.00038265  0.04445805 -0.06141501]
 [-0.00087277  0.04830473 -0.06530355]
 [ 0.00384647  0.05016723 -0.06261297]
 [ 0.00075505  0.05299406 -0.06726608]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.01940491  0.00143579 -0.0391867 ]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.00629734  0.06045748 -0.06500449]
 [ 0.00153734  0.05821346 -0.06784492]
 [ 0.00629734  0.06045748 -0.06500449]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.03273746  0.0139505  -0.03879944]
 [ 0.03120059  0.01871122 -0.04118236]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.00582197  0.08661695 -0.05945742]
 [ 0.00582197  0.08661695 -0.05945742]
 [-0.00100068  0.08886397 -0.06307264]
 [ 0.00582197  0.08661695 -0.05945742]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.02107224  0.00950472 -0.04552228]
 [ 0.0215381   0.01424737 -0.04714119]
 [ 0.02643992  0.01611159 -0.04472995]
 [ 0.0215381   0.01424737 -0.04714119]
 [ 0.02643992  0.01611159 -0.04472995]
 [-0.00656609  0.01353616 -0.05292293]
 [ 0.00090189  0.01496852 -0.05158692]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02075488  0.04826311  0.00252808]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00724829  0.09625187 -0.04858881]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00569311  0.09332651 -0.05314263]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00569311  0.09332651 -0.05314263]
 [ 0.00724829  0.09625187 -0.04858881]
 [-0.00724745 -0.01509107  0.01426208]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00297704 -0.01251328  0.01184075]
 [-0.00724745 -0.01509107  0.01426208]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00297704 -0.01251328  0.01184075]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00458222 -0.00313223  0.01273431]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00458222 -0.00313223  0.01273431]
 [-0.00643779  0.00291049  0.01439599]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00627206  0.02634659 -0.05370296]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.01285358  0.01590647 -0.05465037]
 [-0.00627206  0.02634659 -0.05370296]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.01443586  0.02232697 -0.05538305]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.00384647  0.05016723 -0.06261297]
 [-0.00038265  0.04445805 -0.06141501]
 [-0.0011869   0.0199783  -0.05215612]
 [-0.00027919  0.02517047 -0.05201101]
 [-0.0011869   0.0199783  -0.05215612]
 [-0.00027919  0.02517047 -0.05201101]
 [ 0.00326348 -0.03899555 -0.03846969]
 [ 0.00837459  0.01861656 -0.05048032]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.00756418  0.00884602 -0.04882757]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.00756418  0.00884602 -0.04882757]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.01676538  0.05865975 -0.05225749]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.01542621  0.06960917 -0.05660537]
 [ 0.01221298  0.06529275 -0.06029828]
 [ 0.01760985  0.06374268 -0.05330715]
 [ 0.02747405  0.02129678 -0.04384003]
 [ 0.00137575  0.00857135 -0.05030322]
 [ 0.00137575  0.00857135 -0.05030322]
 [-0.01251962  0.00064883  0.01724824]
 [-0.01563559  0.04404626  0.00252146]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.05084842  0.01123711 -0.04212637]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.04432616  0.01520785 -0.03640274]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.05084842  0.01123711 -0.04212637]
 [ 0.04432616  0.01520785 -0.03640274]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.0519364   0.04056665 -0.0284216 ]
 [ 0.04814171  0.03521444 -0.02755988]
 [ 0.04701157  0.04023051 -0.02621281]
 [ 0.05316569  0.03560106 -0.02977896]
 [ 0.0519364   0.04056665 -0.0284216 ]
 [ 0.04814171  0.03521444 -0.02755988]
 [ 0.04814171  0.03521444 -0.02755988]
 [ 0.05316569  0.03560106 -0.02977896]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.00853247  0.04766963  0.00781777]
 [-0.00735312  0.04211767  0.00281576]
 [-0.00735312  0.04211767  0.00281576]
 [-0.00853247  0.04766963  0.00781777]
 [-0.01498769  0.05049304  0.00813048]
 [ 0.0211675   0.00770589 -0.04091717]
 [ 0.02288659  0.00462969 -0.04591701]
 [ 0.0211675   0.00770589 -0.04091717]
 [ 0.02288659  0.00462969 -0.04591701]
 [ 0.0211675   0.00770589 -0.04091717]
 [-0.01498769  0.05049304  0.00813048]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.03068976  0.08999321 -0.03051713]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.03595722  0.08789626 -0.02484857]
 [-0.03157017  0.09141228 -0.02479384]
 [-0.03068976  0.08999321 -0.03051713]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.03595722  0.08789626 -0.02484857]
 [-0.00329069  0.05515599  0.01161802]
 [ 0.00179695  0.05623065  0.0118435 ]
 [-0.00231115  0.06069858  0.01341077]
 [ 0.00179695  0.05623065  0.0118435 ]
 [-0.00329069  0.05515599  0.01161802]
 [ 0.01313674  0.04949955  0.0068637 ]
 [ 0.01612689  0.05409914  0.00773015]
 [ 0.02054731  0.05287856  0.00477844]
 [ 0.02054731  0.05287856  0.00477844]
 [ 0.01612689  0.05409914  0.00773015]
 [ 0.01313674  0.04949955  0.0068637 ]
 [ 0.02054731  0.05287856  0.00477844]
 [ 0.01313674  0.04949955  0.0068637 ]
 [ 0.01612689  0.05409914  0.00773015]
 [-0.03179629  0.09233041 -0.01960499]
 [-0.03608702  0.08906835 -0.01974677]
 [-0.03390667  0.09102967 -0.01443489]
 [-0.03179629  0.09233041 -0.01960499]
 [-0.03608702  0.08906835 -0.01974677]
 [ 0.02694549  0.00996207 -0.03836883]
 [ 0.02694549  0.00996207 -0.03836883]
 [-0.00971096  0.05218379  0.00984623]
 [-0.00324801  0.04669677  0.00764688]
 [-0.01498769  0.05049304  0.00813048]
 [-0.00853247  0.04766963  0.00781777]
 [-0.00971096  0.05218379  0.00984623]
 [-0.01563559  0.04404626  0.00252146]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02094907  0.04448053 -0.00034796]
 [ 0.05535565  0.02570044 -0.03508348]
 [-0.01498769  0.05049304  0.00813048]]
len(transformed_superpoints_pcd) :  221
copy_superpoint_src_corr_points.shape :  (13078, 3)
mask.shape :  (13078,)
copy_superpoint_src_corr_points.shape :  (10607, 3)
copy_superpoint_ref_corr_points.shape :  (10607, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10607, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 10607, 3])
batch_inlier_masks.shape :  torch.Size([1971, 10607])
best_index :  413
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10607, 3)
transformed_src_superpoints.shape :  torch.Size([10607, 3])
residual.shape :  torch.Size([10607])
batch_inlier_masks.shape :  torch.Size([10607])
batch_outlier_masks.shape :  torch.Size([10607])
indices_inliers.shape :  torch.Size([74])
indices_outliers.shape :  torch.Size([10533])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([74, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02118111  0.05344458  0.00338795]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02164273  0.05871164  0.00441741]
 [-0.02755321  0.05841246  0.00161026]
 [-0.02118111  0.05344458  0.00338795]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02164273  0.05871164  0.00441741]
 [-0.02075488  0.04826311  0.00252808]
 [-0.0241144  -0.0591938  -0.01126053]
 [ 0.00104713  0.09500691 -0.05501365]
 [ 0.00208552  0.09823341 -0.04920686]
 [ 0.00104713  0.09500691 -0.05501365]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.0103752   0.06061195 -0.06145169]
 [ 0.01271205  0.05657827 -0.0569411 ]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.00488113  0.05488501 -0.06490178]
 [ 0.00917489  0.05566858 -0.06068173]
 [ 0.00488113  0.05488501 -0.06490178]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [-0.00365955  0.09591094 -0.05709494]
 [ 0.00384647  0.05016723 -0.06261297]
 [ 0.00075505  0.05299406 -0.06726608]
 [-0.00087277  0.04830473 -0.06530355]
 [ 0.00384647  0.05016723 -0.06261297]
 [-0.00038265  0.04445805 -0.06141501]
 [-0.00087277  0.04830473 -0.06530355]
 [ 0.00384647  0.05016723 -0.06261297]
 [ 0.00075505  0.05299406 -0.06726608]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.02022762  0.00524528 -0.04260011]
 [ 0.01940491  0.00143579 -0.0391867 ]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.02503767  0.00755202 -0.04126105]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.00629734  0.06045748 -0.06500449]
 [ 0.00153734  0.05821346 -0.06784492]
 [ 0.00629734  0.06045748 -0.06500449]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.02874862  0.01118898 -0.04121666]
 [ 0.03273746  0.0139505  -0.03879944]
 [ 0.03120059  0.01871122 -0.04118236]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.00582197  0.08661695 -0.05945742]
 [ 0.00582197  0.08661695 -0.05945742]
 [-0.00100068  0.08886397 -0.06307264]
 [ 0.00582197  0.08661695 -0.05945742]
 [ 0.00218225  0.09119604 -0.0583398 ]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.02107224  0.00950472 -0.04552228]
 [ 0.0215381   0.01424737 -0.04714119]
 [ 0.02643992  0.01611159 -0.04472995]
 [ 0.0215381   0.01424737 -0.04714119]
 [ 0.02643992  0.01611159 -0.04472995]
 [-0.00656609  0.01353616 -0.05292293]
 [ 0.00090189  0.01496852 -0.05158692]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02757731  0.05224333  0.00076239]
 [-0.02075488  0.04826311  0.00252808]
 [-0.02075488  0.04826311  0.00252808]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00724829  0.09625187 -0.04858881]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00569311  0.09332651 -0.05314263]
 [ 0.0117625   0.09262826 -0.04986021]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00920751  0.08882143 -0.05460665]
 [ 0.00569311  0.09332651 -0.05314263]
 [ 0.00724829  0.09625187 -0.04858881]
 [-0.00724745 -0.01509107  0.01426208]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00297704 -0.01251328  0.01184075]
 [-0.00724745 -0.01509107  0.01426208]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00297704 -0.01251328  0.01184075]
 [-0.01258839 -0.01318611  0.01695344]
 [-0.00458222 -0.00313223  0.01273431]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00458222 -0.00313223  0.01273431]
 [-0.00643779  0.00291049  0.01439599]
 [-0.00998036 -0.0039835   0.01622658]
 [-0.00627206  0.02634659 -0.05370296]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.01285358  0.01590647 -0.05465037]
 [-0.00627206  0.02634659 -0.05370296]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.00830417  0.01976811 -0.0536583 ]
 [-0.01443586  0.02232697 -0.05538305]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.00752207  0.05000188 -0.0586625 ]
 [ 0.00955045  0.0476025  -0.05441775]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.0045772   0.04470347 -0.05734624]
 [ 0.00384647  0.05016723 -0.06261297]
 [-0.00038265  0.04445805 -0.06141501]
 [-0.0011869   0.0199783  -0.05215612]
 [-0.00027919  0.02517047 -0.05201101]
 [-0.0011869   0.0199783  -0.05215612]
 [-0.00027919  0.02517047 -0.05201101]
 [ 0.00326348 -0.03899555 -0.03846969]
 [ 0.00837459  0.01861656 -0.05048032]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.00756418  0.00884602 -0.04882757]
 [ 0.01294597  0.00893829 -0.04736051]
 [ 0.00756418  0.00884602 -0.04882757]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.01676538  0.05865975 -0.05225749]
 [ 0.01447453  0.06155955 -0.05695773]
 [ 0.01542621  0.06960917 -0.05660537]
 [ 0.01221298  0.06529275 -0.06029828]
 [ 0.01760985  0.06374268 -0.05330715]
 [ 0.02747405  0.02129678 -0.04384003]
 [ 0.00137575  0.00857135 -0.05030322]
 [ 0.00137575  0.00857135 -0.05030322]
 [-0.01251962  0.00064883  0.01724824]
 [-0.01563559  0.04404626  0.00252146]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.05084842  0.01123711 -0.04212637]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.04432616  0.01520785 -0.03640274]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.05084842  0.01123711 -0.04212637]
 [ 0.04432616  0.01520785 -0.03640274]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.04980648  0.01579371 -0.03821769]
 [ 0.0519364   0.04056665 -0.0284216 ]
 [ 0.04814171  0.03521444 -0.02755988]
 [ 0.04701157  0.04023051 -0.02621281]
 [ 0.05316569  0.03560106 -0.02977896]
 [ 0.0519364   0.04056665 -0.0284216 ]
 [ 0.04814171  0.03521444 -0.02755988]
 [ 0.04814171  0.03521444 -0.02755988]
 [ 0.05316569  0.03560106 -0.02977896]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.00853247  0.04766963  0.00781777]
 [-0.00735312  0.04211767  0.00281576]
 [-0.00735312  0.04211767  0.00281576]
 [-0.00853247  0.04766963  0.00781777]
 [-0.01498769  0.05049304  0.00813048]
 [ 0.0211675   0.00770589 -0.04091717]
 [ 0.02288659  0.00462969 -0.04591701]
 [ 0.0211675   0.00770589 -0.04091717]
 [ 0.02288659  0.00462969 -0.04591701]
 [ 0.0211675   0.00770589 -0.04091717]
 [-0.01498769  0.05049304  0.00813048]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.03068976  0.08999321 -0.03051713]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.03595722  0.08789626 -0.02484857]
 [-0.03157017  0.09141228 -0.02479384]
 [-0.03068976  0.08999321 -0.03051713]
 [-0.02759548  0.09440961 -0.02797399]
 [-0.02770279  0.0956272  -0.02129455]
 [-0.03595722  0.08789626 -0.02484857]
 [-0.00329069  0.05515599  0.01161802]
 [ 0.00179695  0.05623065  0.0118435 ]
 [-0.00231115  0.06069858  0.01341077]
 [ 0.00179695  0.05623065  0.0118435 ]
 [-0.00329069  0.05515599  0.01161802]
 [ 0.01313674  0.04949955  0.0068637 ]
 [ 0.01612689  0.05409914  0.00773015]
 [ 0.02054731  0.05287856  0.00477844]
 [ 0.02054731  0.05287856  0.00477844]
 [ 0.01612689  0.05409914  0.00773015]
 [ 0.01313674  0.04949955  0.0068637 ]
 [ 0.02054731  0.05287856  0.00477844]
 [ 0.01313674  0.04949955  0.0068637 ]
 [ 0.01612689  0.05409914  0.00773015]
 [-0.03179629  0.09233041 -0.01960499]
 [-0.03608702  0.08906835 -0.01974677]
 [-0.03390667  0.09102967 -0.01443489]
 [-0.03179629  0.09233041 -0.01960499]
 [-0.03608702  0.08906835 -0.01974677]
 [ 0.02694549  0.00996207 -0.03836883]
 [ 0.02694549  0.00996207 -0.03836883]
 [-0.00971096  0.05218379  0.00984623]
 [-0.00324801  0.04669677  0.00764688]
 [-0.01498769  0.05049304  0.00813048]
 [-0.00853247  0.04766963  0.00781777]
 [-0.00971096  0.05218379  0.00984623]
 [-0.01563559  0.04404626  0.00252146]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02094907  0.04448053 -0.00034796]
 [-0.01976379  0.04808153  0.00402597]
 [-0.02094907  0.04448053 -0.00034796]
 [ 0.05535565  0.02570044 -0.03508348]
 [-0.01498769  0.05049304  0.00813048]
 [ 0.02531193  0.00943614 -0.04033932]
 [ 0.02531193  0.00943614 -0.04033932]
 [ 0.02531193  0.00943614 -0.04033932]
 [ 0.0653663   0.03150702 -0.02366912]
 [ 0.05937566  0.02670773 -0.03076354]
 [ 0.05536204  0.02504553 -0.03493958]
 [ 0.0577029   0.0210818  -0.03254825]
 [ 0.0577029   0.0210818  -0.03254825]
 [ 0.05536204  0.02504553 -0.03493958]
 [ 0.05133414  0.02830059 -0.0375234 ]
 [ 0.0577029   0.0210818  -0.03254825]
 [ 0.05536204  0.02504553 -0.03493958]
 [ 0.05133414  0.02830059 -0.0375234 ]
 [ 0.0577029   0.0210818  -0.03254825]
 [ 0.05155835  0.0229552  -0.03767372]
 [ 0.05133414  0.02830059 -0.0375234 ]
 [ 0.05937566  0.02670773 -0.03076354]
 [ 0.05155835  0.0229552  -0.03767372]
 [ 0.05937566  0.02670773 -0.03076354]
 [ 0.04957354  0.04018756 -0.03501947]
 [ 0.04957354  0.04018756 -0.03501947]
 [ 0.05536204  0.02504553 -0.03493958]
 [ 0.05536204  0.02504553 -0.03493958]
 [ 0.05133414  0.02830059 -0.0375234 ]
 [ 0.05536204  0.02504553 -0.03493958]
 [ 0.05937566  0.02670773 -0.03076354]
 [ 0.0614929   0.03715412 -0.02605505]
 [ 0.06805353  0.03407198 -0.01881033]
 [ 0.07220006  0.03135131 -0.01620109]
 [ 0.05625697  0.03747462 -0.03087126]
 [ 0.05328916  0.04250719 -0.03115667]
 [ 0.05625697  0.03747462 -0.03087126]
 [ 0.05328916  0.04250719 -0.03115667]
 [ 0.0614929   0.03715412 -0.02605505]
 [-0.02951169  0.06607357  0.00362058]
 [-0.01751561  0.05691329 -0.0025501 ]
 [-0.01751561  0.05691329 -0.0025501 ]
 [-0.01407729  0.05241774 -0.00181097]
 [ 0.05355937  0.01780058 -0.03555676]
 [-0.01385459  0.04106805  0.01527265]
 [-0.00990842  0.03840294  0.0103927 ]
 [-0.01399144  0.04177978  0.00958406]
 [-0.00990842  0.03840294  0.0103927 ]
 [-0.01399144  0.04177978  0.00958406]
 [-0.00932965  0.03858992  0.01602189]
 [-0.00932965  0.03858992  0.01602189]
 [-0.01385459  0.04106805  0.01527265]
 [-0.00990842  0.03840294  0.0103927 ]
 [-0.01399144  0.04177978  0.00958406]
 [ 0.05355937  0.01780058 -0.03555676]
 [ 0.04931619  0.01842591 -0.03853019]
 [ 0.05355937  0.01780058 -0.03555676]
 [ 0.04931619  0.01842591 -0.03853019]
 [ 0.0537774   0.01291604 -0.0339743 ]
 [ 0.05355937  0.01780058 -0.03555676]
 [ 0.04931619  0.01842591 -0.03853019]
 [ 0.0537774   0.01291604 -0.0339743 ]
 [ 0.05355937  0.01780058 -0.03555676]
 [ 0.0537774   0.01291604 -0.0339743 ]
 [ 0.05355937  0.01780058 -0.03555676]
 [ 0.04931619  0.01842591 -0.03853019]
 [ 0.0537774   0.01291604 -0.0339743 ]
 [ 0.04931619  0.01842591 -0.03853019]
 [ 0.06805353  0.03407198 -0.01881033]
 [ 0.06987745  0.02739635 -0.02087249]
 [ 0.07220006  0.03135131 -0.01620109]
 [ 0.0653663   0.03150702 -0.02366912]
 [ 0.06805353  0.03407198 -0.01881033]
 [ 0.06987745  0.02739635 -0.02087249]
 [ 0.07220006  0.03135131 -0.01620109]
 [-0.02330238  0.05733559 -0.0002595 ]
 [-0.01993645  0.06338665 -0.00247238]
 [-0.02511092  0.06373135 -0.00017754]
 [-0.02330238  0.05733559 -0.0002595 ]]
len(transformed_superpoints_pcd) :  295
copy_superpoint_src_corr_points.shape :  (10533, 3)
mask.shape :  (10533,)
copy_superpoint_src_corr_points.shape :  (8918, 3)
copy_superpoint_ref_corr_points.shape :  (8918, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8918, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 8918, 3])
batch_inlier_masks.shape :  torch.Size([1971, 8918])
best_index :  1862
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8918, 3)
transformed_src_superpoints.shape :  torch.Size([8918, 3])
residual.shape :  torch.Size([8918])
batch_inlier_masks.shape :  torch.Size([8918])
batch_outlier_masks.shape :  torch.Size([8918])
indices_inliers.shape :  torch.Size([66])
indices_outliers.shape :  torch.Size([8852])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([66, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.06446146  0.00575722 -0.01137794]
 [ 0.05993696  0.00313982 -0.01283838]
 [ 0.06791644  0.01231806 -0.00264085]]
len(transformed_superpoints_pcd) :  361
copy_superpoint_src_corr_points.shape :  (8852, 3)
mask.shape :  (8852,)
copy_superpoint_src_corr_points.shape :  (7838, 3)
copy_superpoint_ref_corr_points.shape :  (7838, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7838, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 7838, 3])
batch_inlier_masks.shape :  torch.Size([1971, 7838])
best_index :  1772
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7838, 3)
transformed_src_superpoints.shape :  torch.Size([7838, 3])
residual.shape :  torch.Size([7838])
batch_inlier_masks.shape :  torch.Size([7838])
batch_outlier_masks.shape :  torch.Size([7838])
indices_inliers.shape :  torch.Size([51])
indices_outliers.shape :  torch.Size([7787])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([51, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04469639  0.0730857  -0.02476223]
 [-0.0436324   0.07711115 -0.0276345 ]
 [-0.05174583  0.07439154 -0.02640654]]
len(transformed_superpoints_pcd) :  412
copy_superpoint_src_corr_points.shape :  (7787, 3)
mask.shape :  (7787,)
copy_superpoint_src_corr_points.shape :  (6891, 3)
copy_superpoint_ref_corr_points.shape :  (6891, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6891, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 6891, 3])
batch_inlier_masks.shape :  torch.Size([1971, 6891])
best_index :  845
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6891, 3)
transformed_src_superpoints.shape :  torch.Size([6891, 3])
residual.shape :  torch.Size([6891])
batch_inlier_masks.shape :  torch.Size([6891])
batch_outlier_masks.shape :  torch.Size([6891])
indices_inliers.shape :  torch.Size([48])
indices_outliers.shape :  torch.Size([6843])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([48, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.05140618  0.03176563 -0.03491566]
 [ 0.04416569  0.03105537 -0.04244011]
 [ 0.05140618  0.03176563 -0.03491566]]
len(transformed_superpoints_pcd) :  460
copy_superpoint_src_corr_points.shape :  (6843, 3)
mask.shape :  (6843,)
copy_superpoint_src_corr_points.shape :  (6007, 3)
copy_superpoint_ref_corr_points.shape :  (6007, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6007, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 6007, 3])
batch_inlier_masks.shape :  torch.Size([1971, 6007])
best_index :  1797
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6007, 3)
transformed_src_superpoints.shape :  torch.Size([6007, 3])
residual.shape :  torch.Size([6007])
batch_inlier_masks.shape :  torch.Size([6007])
batch_outlier_masks.shape :  torch.Size([6007])
indices_inliers.shape :  torch.Size([48])
indices_outliers.shape :  torch.Size([5959])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([48, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.05807554  0.02572556 -0.03109976]
 [ 0.05508358  0.02129949 -0.0360648 ]
 [ 0.06074759  0.02642854 -0.02593059]]
len(transformed_superpoints_pcd) :  508
copy_superpoint_src_corr_points.shape :  (5959, 3)
mask.shape :  (5959,)
copy_superpoint_src_corr_points.shape :  (5483, 3)
copy_superpoint_ref_corr_points.shape :  (5483, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5483, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 5483, 3])
batch_inlier_masks.shape :  torch.Size([1971, 5483])
best_index :  1865
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5483, 3)
transformed_src_superpoints.shape :  torch.Size([5483, 3])
residual.shape :  torch.Size([5483])
batch_inlier_masks.shape :  torch.Size([5483])
batch_outlier_masks.shape :  torch.Size([5483])
indices_inliers.shape :  torch.Size([44])
indices_outliers.shape :  torch.Size([5439])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([44, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.03068149  0.07181406 -0.04886059]
 [-0.02704237  0.07534812 -0.04858187]
 [-0.03068149  0.07181406 -0.04886059]]
len(transformed_superpoints_pcd) :  552
copy_superpoint_src_corr_points.shape :  (5439, 3)
mask.shape :  (5439,)
copy_superpoint_src_corr_points.shape :  (4979, 3)
copy_superpoint_ref_corr_points.shape :  (4979, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4979, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 4979, 3])
batch_inlier_masks.shape :  torch.Size([1971, 4979])
best_index :  928
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4979, 3)
transformed_src_superpoints.shape :  torch.Size([4979, 3])
residual.shape :  torch.Size([4979])
batch_inlier_masks.shape :  torch.Size([4979])
batch_outlier_masks.shape :  torch.Size([4979])
indices_inliers.shape :  torch.Size([41])
indices_outliers.shape :  torch.Size([4938])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([41, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.06837736  0.02322173 -0.01857852]
 [ 0.06586864  0.02085161 -0.02460878]
 [ 0.06597388  0.01554698 -0.02445152]]
len(transformed_superpoints_pcd) :  593
copy_superpoint_src_corr_points.shape :  (4938, 3)
mask.shape :  (4938,)
copy_superpoint_src_corr_points.shape :  (4537, 3)
copy_superpoint_ref_corr_points.shape :  (4537, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4537, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 4537, 3])
batch_inlier_masks.shape :  torch.Size([1971, 4537])
best_index :  1476
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4537, 3)
transformed_src_superpoints.shape :  torch.Size([4537, 3])
residual.shape :  torch.Size([4537])
batch_inlier_masks.shape :  torch.Size([4537])
batch_outlier_masks.shape :  torch.Size([4537])
indices_inliers.shape :  torch.Size([39])
indices_outliers.shape :  torch.Size([4498])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([39, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04979782 -0.04436001  0.01241475]
 [ 0.06744549  0.00693935  0.00218451]
 [ 0.06423891  0.00406948  0.00597833]]
len(transformed_superpoints_pcd) :  632
copy_superpoint_src_corr_points.shape :  (4498, 3)
mask.shape :  (4498,)
copy_superpoint_src_corr_points.shape :  (4104, 3)
copy_superpoint_ref_corr_points.shape :  (4104, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4104, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 4104, 3])
batch_inlier_masks.shape :  torch.Size([1971, 4104])
best_index :  1822
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4104, 3)
transformed_src_superpoints.shape :  torch.Size([4104, 3])
residual.shape :  torch.Size([4104])
batch_inlier_masks.shape :  torch.Size([4104])
batch_outlier_masks.shape :  torch.Size([4104])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([4066])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.05358656  0.01581006 -0.04074703]
 [ 0.05219349  0.0165981  -0.03392372]
 [ 0.05358656  0.01581006 -0.04074703]]
len(transformed_superpoints_pcd) :  670
copy_superpoint_src_corr_points.shape :  (4066, 3)
mask.shape :  (4066,)
copy_superpoint_src_corr_points.shape :  (3789, 3)
copy_superpoint_ref_corr_points.shape :  (3789, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3789, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 3789, 3])
batch_inlier_masks.shape :  torch.Size([1971, 3789])
best_index :  804
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3789, 3)
transformed_src_superpoints.shape :  torch.Size([3789, 3])
residual.shape :  torch.Size([3789])
batch_inlier_masks.shape :  torch.Size([3789])
batch_outlier_masks.shape :  torch.Size([3789])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([3758])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04347178 -0.08589258  0.02827044]
 [-0.04155518 -0.0792203   0.027713  ]
 [-0.00244382 -0.0069415   0.01328869]]
len(transformed_superpoints_pcd) :  701
copy_superpoint_src_corr_points.shape :  (3758, 3)
mask.shape :  (3758,)
copy_superpoint_src_corr_points.shape :  (3158, 3)
copy_superpoint_ref_corr_points.shape :  (3158, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3158, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 3158, 3])
batch_inlier_masks.shape :  torch.Size([1971, 3158])
best_index :  1647
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3158, 3)
transformed_src_superpoints.shape :  torch.Size([3158, 3])
residual.shape :  torch.Size([3158])
batch_inlier_masks.shape :  torch.Size([3158])
batch_outlier_masks.shape :  torch.Size([3158])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([3127])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.05199162  0.0332339  -0.03020559]
 [ 0.05029565  0.03154034 -0.03543153]
 [ 0.05695018  0.02987786 -0.02997781]]
len(transformed_superpoints_pcd) :  732
copy_superpoint_src_corr_points.shape :  (3127, 3)
mask.shape :  (3127,)
copy_superpoint_src_corr_points.shape :  (2645, 3)
copy_superpoint_ref_corr_points.shape :  (2645, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2645, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 2645, 3])
batch_inlier_masks.shape :  torch.Size([1971, 2645])
best_index :  1760
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2645, 3)
transformed_src_superpoints.shape :  torch.Size([2645, 3])
residual.shape :  torch.Size([2645])
batch_inlier_masks.shape :  torch.Size([2645])
batch_outlier_masks.shape :  torch.Size([2645])
indices_inliers.shape :  torch.Size([29])
indices_outliers.shape :  torch.Size([2616])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([29, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.00712422  0.01215994 -0.05683067]
 [ 0.01065864  0.01319828 -0.05239093]
 [ 0.00712422  0.01215994 -0.05683067]]
len(transformed_superpoints_pcd) :  761
copy_superpoint_src_corr_points.shape :  (2616, 3)
mask.shape :  (2616,)
copy_superpoint_src_corr_points.shape :  (2212, 3)
copy_superpoint_ref_corr_points.shape :  (2212, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2212, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 2212, 3])
batch_inlier_masks.shape :  torch.Size([1971, 2212])
best_index :  1963
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2212, 3)
transformed_src_superpoints.shape :  torch.Size([2212, 3])
residual.shape :  torch.Size([2212])
batch_inlier_masks.shape :  torch.Size([2212])
batch_outlier_masks.shape :  torch.Size([2212])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([2184])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04428261 -0.08005966  0.02478515]
 [-0.04399741 -0.08327202  0.03063853]
 [-0.03865076 -0.08461772  0.0308884 ]]
len(transformed_superpoints_pcd) :  789
copy_superpoint_src_corr_points.shape :  (2184, 3)
mask.shape :  (2184,)
copy_superpoint_src_corr_points.shape :  (2141, 3)
copy_superpoint_ref_corr_points.shape :  (2141, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2141, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 2141, 3])
batch_inlier_masks.shape :  torch.Size([1971, 2141])
best_index :  1204
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2141, 3)
transformed_src_superpoints.shape :  torch.Size([2141, 3])
residual.shape :  torch.Size([2141])
batch_inlier_masks.shape :  torch.Size([2141])
batch_outlier_masks.shape :  torch.Size([2141])
indices_inliers.shape :  torch.Size([26])
indices_outliers.shape :  torch.Size([2115])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([26, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.06265619  0.01929712 -0.03221548]
 [ 0.06429277  0.01529036 -0.02914826]
 [ 0.06265619  0.01929712 -0.03221548]]
len(transformed_superpoints_pcd) :  815
copy_superpoint_src_corr_points.shape :  (2115, 3)
mask.shape :  (2115,)
copy_superpoint_src_corr_points.shape :  (1882, 3)
copy_superpoint_ref_corr_points.shape :  (1882, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1882, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 1882, 3])
batch_inlier_masks.shape :  torch.Size([1971, 1882])
best_index :  1277
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1882, 3)
transformed_src_superpoints.shape :  torch.Size([1882, 3])
residual.shape :  torch.Size([1882])
batch_inlier_masks.shape :  torch.Size([1882])
batch_outlier_masks.shape :  torch.Size([1882])
indices_inliers.shape :  torch.Size([26])
indices_outliers.shape :  torch.Size([1856])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([26, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04487738 -0.04864534  0.01280864]
 [-0.04487738 -0.04864534  0.01280864]
 [-0.05364892 -0.04871999  0.00448218]]
len(transformed_superpoints_pcd) :  841
copy_superpoint_src_corr_points.shape :  (1856, 3)
mask.shape :  (1856,)
copy_superpoint_src_corr_points.shape :  (1637, 3)
copy_superpoint_ref_corr_points.shape :  (1637, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1637, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 1637, 3])
batch_inlier_masks.shape :  torch.Size([1971, 1637])
best_index :  829
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1637, 3)
transformed_src_superpoints.shape :  torch.Size([1637, 3])
residual.shape :  torch.Size([1637])
batch_inlier_masks.shape :  torch.Size([1637])
batch_outlier_masks.shape :  torch.Size([1637])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([1613])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.055804    0.02476897 -0.03368782]
 [ 0.055804    0.02476897 -0.03368782]
 [ 0.01902763 -0.01431487  0.02061222]]
len(transformed_superpoints_pcd) :  865
copy_superpoint_src_corr_points.shape :  (1613, 3)
mask.shape :  (1613,)
copy_superpoint_src_corr_points.shape :  (1426, 3)
copy_superpoint_ref_corr_points.shape :  (1426, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1426, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 1426, 3])
batch_inlier_masks.shape :  torch.Size([1971, 1426])
best_index :  1330
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1426, 3)
transformed_src_superpoints.shape :  torch.Size([1426, 3])
residual.shape :  torch.Size([1426])
batch_inlier_masks.shape :  torch.Size([1426])
batch_outlier_masks.shape :  torch.Size([1426])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([1405])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04740041 -0.08262311  0.03088076]
 [-0.03836303 -0.08257392  0.02729589]
 [-0.04373245 -0.08092114  0.02581552]]
len(transformed_superpoints_pcd) :  886
copy_superpoint_src_corr_points.shape :  (1405, 3)
mask.shape :  (1405,)
copy_superpoint_src_corr_points.shape :  (1351, 3)
copy_superpoint_ref_corr_points.shape :  (1351, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1351, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 1351, 3])
batch_inlier_masks.shape :  torch.Size([1971, 1351])
best_index :  995
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1351, 3)
transformed_src_superpoints.shape :  torch.Size([1351, 3])
residual.shape :  torch.Size([1351])
batch_inlier_masks.shape :  torch.Size([1351])
batch_outlier_masks.shape :  torch.Size([1351])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1334])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.03182919  0.04713978 -0.00032581]
 [-0.00343566  0.03992634  0.01065001]
 [-0.00343566  0.03992634  0.01065001]]
len(transformed_superpoints_pcd) :  903
copy_superpoint_src_corr_points.shape :  (1334, 3)
mask.shape :  (1334,)
copy_superpoint_src_corr_points.shape :  (1034, 3)
copy_superpoint_ref_corr_points.shape :  (1034, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1034, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 1034, 3])
batch_inlier_masks.shape :  torch.Size([1971, 1034])
best_index :  1729
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1034, 3)
transformed_src_superpoints.shape :  torch.Size([1034, 3])
residual.shape :  torch.Size([1034])
batch_inlier_masks.shape :  torch.Size([1034])
batch_outlier_masks.shape :  torch.Size([1034])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1018])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04689627 -0.0429918   0.00306604]
 [-0.04687358 -0.0432116   0.00834024]
 [-0.04687358 -0.0432116   0.00834024]]
len(transformed_superpoints_pcd) :  919
copy_superpoint_src_corr_points.shape :  (1018, 3)
mask.shape :  (1018,)
copy_superpoint_src_corr_points.shape :  (984, 3)
copy_superpoint_ref_corr_points.shape :  (984, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([984, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 984, 3])
batch_inlier_masks.shape :  torch.Size([1971, 984])
best_index :  1831
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (984, 3)
transformed_src_superpoints.shape :  torch.Size([984, 3])
residual.shape :  torch.Size([984])
batch_inlier_masks.shape :  torch.Size([984])
batch_outlier_masks.shape :  torch.Size([984])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([968])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04410629 -0.08483212  0.03640059]
 [-0.0387551  -0.08283088  0.03427818]
 [-0.03063658 -0.0902061   0.03703072]]
len(transformed_superpoints_pcd) :  935
copy_superpoint_src_corr_points.shape :  (968, 3)
mask.shape :  (968,)
copy_superpoint_src_corr_points.shape :  (931, 3)
copy_superpoint_ref_corr_points.shape :  (931, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([931, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 931, 3])
batch_inlier_masks.shape :  torch.Size([1971, 931])
best_index :  1580
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (931, 3)
transformed_src_superpoints.shape :  torch.Size([931, 3])
residual.shape :  torch.Size([931])
batch_inlier_masks.shape :  torch.Size([931])
batch_outlier_masks.shape :  torch.Size([931])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([917])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04582433  0.06164056 -0.01913032]
 [-0.0494652   0.06560092 -0.02242337]
 [-0.0494652   0.06560092 -0.02242337]]
len(transformed_superpoints_pcd) :  949
copy_superpoint_src_corr_points.shape :  (917, 3)
mask.shape :  (917,)
copy_superpoint_src_corr_points.shape :  (881, 3)
copy_superpoint_ref_corr_points.shape :  (881, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([881, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 881, 3])
batch_inlier_masks.shape :  torch.Size([1971, 881])
best_index :  1725
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (881, 3)
transformed_src_superpoints.shape :  torch.Size([881, 3])
residual.shape :  torch.Size([881])
batch_inlier_masks.shape :  torch.Size([881])
batch_outlier_masks.shape :  torch.Size([881])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([868])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.05286949  0.07494549 -0.01688517]
 [-0.03998327  0.07131774 -0.03647001]
 [-0.03998327  0.07131774 -0.03647001]]
len(transformed_superpoints_pcd) :  962
copy_superpoint_src_corr_points.shape :  (868, 3)
mask.shape :  (868,)
copy_superpoint_src_corr_points.shape :  (824, 3)
copy_superpoint_ref_corr_points.shape :  (824, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([824, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 824, 3])
batch_inlier_masks.shape :  torch.Size([1971, 824])
best_index :  1876
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (824, 3)
transformed_src_superpoints.shape :  torch.Size([824, 3])
residual.shape :  torch.Size([824])
batch_inlier_masks.shape :  torch.Size([824])
batch_outlier_masks.shape :  torch.Size([824])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([811])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.02410157  0.01095307 -0.05045138]
 [ 0.02336939  0.00722145 -0.04646438]
 [ 0.02410157  0.01095307 -0.05045138]]
len(transformed_superpoints_pcd) :  975
copy_superpoint_src_corr_points.shape :  (811, 3)
mask.shape :  (811,)
copy_superpoint_src_corr_points.shape :  (811, 3)
copy_superpoint_ref_corr_points.shape :  (811, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([811, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 811, 3])
batch_inlier_masks.shape :  torch.Size([1971, 811])
best_index :  158
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (811, 3)
transformed_src_superpoints.shape :  torch.Size([811, 3])
residual.shape :  torch.Size([811])
batch_inlier_masks.shape :  torch.Size([811])
batch_outlier_masks.shape :  torch.Size([811])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([799])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.02857198  0.00268043 -0.04730055]
 [ 0.02293248  0.00413922 -0.04648782]
 [ 0.02857198  0.00268043 -0.04730055]]
len(transformed_superpoints_pcd) :  987
copy_superpoint_src_corr_points.shape :  (799, 3)
mask.shape :  (799,)
copy_superpoint_src_corr_points.shape :  (628, 3)
copy_superpoint_ref_corr_points.shape :  (628, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([628, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 628, 3])
batch_inlier_masks.shape :  torch.Size([1971, 628])
best_index :  1352
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (628, 3)
transformed_src_superpoints.shape :  torch.Size([628, 3])
residual.shape :  torch.Size([628])
batch_inlier_masks.shape :  torch.Size([628])
batch_outlier_masks.shape :  torch.Size([628])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([616])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.07869346  0.02270645  0.00954612]
 [ 0.07562088  0.01818732  0.0091442 ]
 [ 0.0766668   0.02624391  0.01347922]]
len(transformed_superpoints_pcd) :  999
copy_superpoint_src_corr_points.shape :  (616, 3)
mask.shape :  (616,)
copy_superpoint_src_corr_points.shape :  (615, 3)
copy_superpoint_ref_corr_points.shape :  (615, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([615, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 615, 3])
batch_inlier_masks.shape :  torch.Size([1971, 615])
best_index :  1947
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (615, 3)
transformed_src_superpoints.shape :  torch.Size([615, 3])
residual.shape :  torch.Size([615])
batch_inlier_masks.shape :  torch.Size([615])
batch_outlier_masks.shape :  torch.Size([615])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([603])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.02487617  0.00653769 -0.0497656 ]
 [ 0.02418998  0.01157854 -0.04904189]
 [ 0.02737934  0.01247842 -0.04385765]]
len(transformed_superpoints_pcd) :  1011
copy_superpoint_src_corr_points.shape :  (603, 3)
mask.shape :  (603,)
copy_superpoint_src_corr_points.shape :  (564, 3)
copy_superpoint_ref_corr_points.shape :  (564, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([564, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 564, 3])
batch_inlier_masks.shape :  torch.Size([1971, 564])
best_index :  683
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (564, 3)
transformed_src_superpoints.shape :  torch.Size([564, 3])
residual.shape :  torch.Size([564])
batch_inlier_masks.shape :  torch.Size([564])
batch_outlier_masks.shape :  torch.Size([564])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([553])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04246563 -0.08439888  0.0320049 ]
 [-0.04246563 -0.08439888  0.0320049 ]
 [-0.04630625 -0.08185613  0.02905805]]
len(transformed_superpoints_pcd) :  1022
copy_superpoint_src_corr_points.shape :  (553, 3)
mask.shape :  (553,)
copy_superpoint_src_corr_points.shape :  (488, 3)
copy_superpoint_ref_corr_points.shape :  (488, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([488, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 488, 3])
batch_inlier_masks.shape :  torch.Size([1971, 488])
best_index :  1522
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (488, 3)
transformed_src_superpoints.shape :  torch.Size([488, 3])
residual.shape :  torch.Size([488])
batch_inlier_masks.shape :  torch.Size([488])
batch_outlier_masks.shape :  torch.Size([488])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([478])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.04099997 -0.06550366 -0.00684639]
 [ 0.03856551 -0.06992773 -0.00630544]
 [ 0.03343952 -0.06930734 -0.00820372]]
len(transformed_superpoints_pcd) :  1032
copy_superpoint_src_corr_points.shape :  (478, 3)
mask.shape :  (478,)
copy_superpoint_src_corr_points.shape :  (444, 3)
copy_superpoint_ref_corr_points.shape :  (444, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([444, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 444, 3])
batch_inlier_masks.shape :  torch.Size([1971, 444])
best_index :  312
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (444, 3)
transformed_src_superpoints.shape :  torch.Size([444, 3])
residual.shape :  torch.Size([444])
batch_inlier_masks.shape :  torch.Size([444])
batch_outlier_masks.shape :  torch.Size([444])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([435])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.02684763 -0.09465967  0.03393237]
 [ 0.02640538 -0.09743635  0.02931176]
 [ 0.02281737 -0.09325     0.03014033]]
len(transformed_superpoints_pcd) :  1041
copy_superpoint_src_corr_points.shape :  (435, 3)
mask.shape :  (435,)
copy_superpoint_src_corr_points.shape :  (352, 3)
copy_superpoint_ref_corr_points.shape :  (352, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([352, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 352, 3])
batch_inlier_masks.shape :  torch.Size([1971, 352])
best_index :  733
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (352, 3)
transformed_src_superpoints.shape :  torch.Size([352, 3])
residual.shape :  torch.Size([352])
batch_inlier_masks.shape :  torch.Size([352])
batch_outlier_masks.shape :  torch.Size([352])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([343])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.05668746  0.02675439 -0.03269235]
 [ 0.05668746  0.02675439 -0.03269235]
 [ 0.05668746  0.02675439 -0.03269235]]
len(transformed_superpoints_pcd) :  1050
copy_superpoint_src_corr_points.shape :  (343, 3)
mask.shape :  (343,)
copy_superpoint_src_corr_points.shape :  (246, 3)
copy_superpoint_ref_corr_points.shape :  (246, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([246, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 246, 3])
batch_inlier_masks.shape :  torch.Size([1971, 246])
best_index :  1693
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (246, 3)
transformed_src_superpoints.shape :  torch.Size([246, 3])
residual.shape :  torch.Size([246])
batch_inlier_masks.shape :  torch.Size([246])
batch_outlier_masks.shape :  torch.Size([246])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([238])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.02675372  0.07729115 -0.0470155 ]
 [-0.03139867  0.07339292 -0.0463744 ]
 [-0.03139867  0.07339292 -0.0463744 ]]
len(transformed_superpoints_pcd) :  1058
copy_superpoint_src_corr_points.shape :  (238, 3)
mask.shape :  (238,)
copy_superpoint_src_corr_points.shape :  (234, 3)
copy_superpoint_ref_corr_points.shape :  (234, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([234, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 234, 3])
batch_inlier_masks.shape :  torch.Size([1971, 234])
best_index :  602
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (234, 3)
transformed_src_superpoints.shape :  torch.Size([234, 3])
residual.shape :  torch.Size([234])
batch_inlier_masks.shape :  torch.Size([234])
batch_outlier_masks.shape :  torch.Size([234])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([228])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.03185575  0.0481169   0.00068285]
 [-0.03185575  0.0481169   0.00068285]
 [-0.03185575  0.0481169   0.00068285]]
len(transformed_superpoints_pcd) :  1064
copy_superpoint_src_corr_points.shape :  (228, 3)
mask.shape :  (228,)
copy_superpoint_src_corr_points.shape :  (165, 3)
copy_superpoint_ref_corr_points.shape :  (165, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([165, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 165, 3])
batch_inlier_masks.shape :  torch.Size([1971, 165])
best_index :  1564
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (165, 3)
transformed_src_superpoints.shape :  torch.Size([165, 3])
residual.shape :  torch.Size([165])
batch_inlier_masks.shape :  torch.Size([165])
batch_outlier_masks.shape :  torch.Size([165])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([159])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-5.8211144e-02 -7.8246526e-02  3.4066096e-02]
 [-5.4122567e-02 -8.1937864e-02  3.7424713e-02]
 [-5.4122567e-02 -8.1937864e-02  3.7424713e-02]
 ...
 [-2.3481790e-02 -7.1975708e-02  7.5938180e-05]
 [-2.3481790e-02 -7.1975708e-02  7.5938180e-05]
 [-2.3481790e-02 -7.1975708e-02  7.5938180e-05]]
len(transformed_superpoints_pcd) :  1070
copy_superpoint_src_corr_points.shape :  (159, 3)
mask.shape :  (159,)
copy_superpoint_src_corr_points.shape :  (148, 3)
copy_superpoint_ref_corr_points.shape :  (148, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([148, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 148, 3])
batch_inlier_masks.shape :  torch.Size([1971, 148])
best_index :  1642
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (148, 3)
transformed_src_superpoints.shape :  torch.Size([148, 3])
residual.shape :  torch.Size([148])
batch_inlier_masks.shape :  torch.Size([148])
batch_outlier_masks.shape :  torch.Size([148])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([142])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.03183648  0.06917554 -0.04628596]
 [-0.03183648  0.06917554 -0.04628596]
 [-0.03183648  0.06917554 -0.04628596]]
len(transformed_superpoints_pcd) :  1076
copy_superpoint_src_corr_points.shape :  (142, 3)
mask.shape :  (142,)
copy_superpoint_src_corr_points.shape :  (119, 3)
copy_superpoint_ref_corr_points.shape :  (119, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([119, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 119, 3])
batch_inlier_masks.shape :  torch.Size([1971, 119])
best_index :  1749
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (119, 3)
transformed_src_superpoints.shape :  torch.Size([119, 3])
residual.shape :  torch.Size([119])
batch_inlier_masks.shape :  torch.Size([119])
batch_outlier_masks.shape :  torch.Size([119])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([113])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [ 0.03020539  0.0105328  -0.04413302]
 [ 0.02454934  0.00327168 -0.04642081]
 [ 0.03020539  0.0105328  -0.04413302]]
len(transformed_superpoints_pcd) :  1082
copy_superpoint_src_corr_points.shape :  (113, 3)
mask.shape :  (113,)
copy_superpoint_src_corr_points.shape :  (106, 3)
copy_superpoint_ref_corr_points.shape :  (106, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([106, 3])
batch_transforms.shape :  torch.Size([1971, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1971, 106, 3])
batch_inlier_masks.shape :  torch.Size([1971, 106])
best_index :  1624
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (106, 3)
transformed_src_superpoints.shape :  torch.Size([106, 3])
residual.shape :  torch.Size([106])
batch_inlier_masks.shape :  torch.Size([106])
batch_outlier_masks.shape :  torch.Size([106])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([101])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.05821114 -0.07824653  0.0340661 ]
 [-0.05412257 -0.08193786  0.03742471]
 [-0.05412257 -0.08193786  0.03742471]
 ...
 [-0.04347977 -0.01203354 -0.03073775]
 [-0.04347977 -0.01203354 -0.03073775]
 [-0.04429758 -0.00536336 -0.03089826]]
len(transformed_superpoints_pcd) :  1087
copy_superpoint_src_corr_points.shape :  (101, 3)
mask.shape :  (101,)
copy_superpoint_src_corr_points.shape :  (96, 3)
copy_superpoint_ref_corr_points.shape :  (96, 3)
number of unique points in pcd :  390
number of rotations used :  38
transformed_superpoints_pcd.shape :  (1183, 3)
Line set updated
113
src_points :  [[-0.0790557   0.00106235  0.04141935]
 [-0.07806131  0.00202999  0.03639042]
 [-0.07412383  0.00395602  0.03906889]
 ...
 [-0.04748396 -0.02626457  0.01467652]
 [-0.0367763   0.01302596  0.0862826 ]
 [-0.08097411 -0.00608224  0.04977458]]
ref_points :  [[-0.07207307 -0.02149156  0.0384459 ]
 [-0.07104911 -0.02012665  0.04415699]
 [-0.07034845 -0.01784495  0.0488799 ]
 ...
 [-0.04249537 -0.00633282  0.04850005]
 [-0.04408585 -0.00473453  0.05675923]
 [-0.03718751  0.02482232  0.08484223]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([5534, 3])
lengths :  tensor([2701, 2833])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([3421, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([1040, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([523, 3])
ref_points_f.shape :  torch.Size([2701, 3])
src_points_c.shape :  torch.Size([517, 3])
src_points_f.shape :  torch.Size([2833, 3])
ref_node_masks.shape :  torch.Size([523])
ref_node_knn_indices.shape :  torch.Size([523, 5])
ref_node_knn_masks.shape :  torch.Size([523, 5])
src_node_masks.shape :  torch.Size([517])
src_node_knn_indices.shape :  torch.Size([517, 5])
src_node_knn_masks.shape :  torch.Size([517, 5])
ref_node_knn_points.shape :  torch.Size([523, 5, 3])
src_node_knn_points.shape :  torch.Size([517, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([1040, 512])
feats_f :  torch.Size([5534, 256])
k :  3
omegas.shape :  torch.Size([273529, 128, 1])
omegas.shape :  torch.Size([820587, 128, 1])
k :  3
omegas.shape :  torch.Size([267289, 128, 1])
omegas.shape :  torch.Size([801867, 128, 1])
ref_feats_c.shape :  torch.Size([1, 523, 256])
src_feats_c.shape :  torch.Size([1, 517, 256])
ref_feats_c_norm.shape :  torch.Size([523, 256])
src_feats_c_norm.shape :  torch.Size([517, 256])
ref_node_masks.shape :  torch.Size([523])
src_node_masks.shape :  torch.Size([517])
self.num_correspondences :  2000
matching_scores.numel() :  270391
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([20272])
ref_indices.shape :  torch.Size([20272])
src_indices.shape :  torch.Size([20272])
batch_indices :  tensor([   0,    1,    2,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 3, 4, 4], device='cuda:0')
src_indices :  tensor([0, 0, 0,  ..., 3, 0, 1], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([20272, 3])
global_src_corr_points.shape :  torch.Size([20272, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([2000, 4, 4])
src_corr_points.shape :  torch.Size([20272, 3])
ref_corr_points.shape :  torch.Size([1, 20272, 3])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 20272, 3])
batch_corr_residuals.shape :  torch.Size([2000, 20272])
batch_inlier_masks.shape :  torch.Size([2000, 20272])
best_index :  tensor(1986, device='cuda:0')
len(batch_transforms) :  2000
estimated_transform :  [[-0.7671887   0.63174605  0.1109899  -0.00300574]
 [ 0.5800017   0.6093714   0.5406146   0.00976197]
 [ 0.2738969   0.4791276  -0.8339168   0.01466872]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [ 673  755 1134 ...  488  641 1986]
superpoint_src_corr_points.shape :  (20272, 3)
superpoint_ref_corr_points.shape :  (20272, 3)
batch_inlier_masks.shape :  (2000, 20272)
batch_transforms.shape :  (2000, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([20272, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 20272, 3])
batch_inlier_masks.shape :  torch.Size([2000, 20272])
best_index :  641
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (20272, 3)
transformed_src_superpoints.shape :  torch.Size([20272, 3])
residual.shape :  torch.Size([20272])
batch_inlier_masks.shape :  torch.Size([20272])
batch_outlier_masks.shape :  torch.Size([20272])
indices_inliers.shape :  torch.Size([142])
indices_outliers.shape :  torch.Size([20130])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([142, 3])
transformed_superpoints_pcd :  [[ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-4.35487460e-03 -4.14419770e-02  3.01158167e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 3.13226134e-03 -2.77765468e-02  9.98787209e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.74775012e-02 -2.84366310e-02  9.86715555e-02]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 2.07130797e-03 -2.42803693e-02  1.04096912e-01]
 [ 8.25982541e-03 -2.27292627e-02  1.06671035e-01]
 [ 2.07130797e-03 -2.42803693e-02  1.04096912e-01]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 8.25982541e-03 -2.27292627e-02  1.06671035e-01]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [-4.35487460e-03 -4.14419770e-02  3.01158167e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-7.35371653e-03 -4.43919301e-02  2.53937654e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.75977349e-02 -5.37185818e-02  9.05550644e-03]
 [-1.59058645e-02 -5.33993915e-02  4.13522124e-03]
 [-1.59063265e-02 -5.27286530e-02 -1.90990046e-03]
 [-1.59058645e-02 -5.33993915e-02  4.13522124e-03]
 [-1.59063265e-02 -5.27286530e-02 -1.90990046e-03]
 [-8.49390589e-03 -5.07534295e-02  2.56131589e-03]
 [-2.33575460e-02 -5.31596914e-02  7.47485459e-03]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [ 2.24739499e-03 -3.88677567e-02  8.13730210e-02]
 [ 1.85263902e-03 -3.63623798e-02  8.57429281e-02]
 [ 5.60325757e-03 -4.18822840e-02  7.80599564e-02]
 [ 5.60325757e-03 -4.18822840e-02  7.80599564e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 2.50125043e-02  5.19124791e-02  6.43848553e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 2.05580778e-02  5.58343828e-02  6.27533048e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-2.96176784e-02 -4.88720536e-02 -1.24316663e-03]
 [-2.00393535e-02 -5.19710556e-02 -4.68520820e-03]
 [-2.80440263e-02 -4.76582050e-02 -6.80954009e-03]
 [-2.00393535e-02 -5.19710556e-02 -4.68520820e-03]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-7.35371653e-03 -4.43919301e-02  2.53937654e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.55813172e-02 -3.72100174e-02  8.90296400e-02]
 [ 1.79298632e-02 -3.39285582e-02  9.25081223e-02]
 [ 1.85263902e-03 -3.63623798e-02  8.57429281e-02]
 [ 1.61420628e-02  3.83694991e-02  1.05085701e-01]
 [ 1.61420628e-02  3.83694991e-02  1.05085701e-01]
 [ 1.31005049e-02  3.51039320e-02  1.08153135e-01]
 [ 1.60333365e-02  4.27008271e-02  1.00721784e-01]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [ 2.50752531e-02 -3.18485349e-02  9.32594389e-02]
 [ 2.82216743e-02 -2.74429247e-02  9.66450498e-02]
 [ 2.50752531e-02 -3.18485349e-02  9.32594389e-02]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 1.79298632e-02 -3.39285582e-02  9.25081223e-02]
 [ 1.55813172e-02 -3.72100174e-02  8.90296400e-02]
 [ 8.68170895e-03  9.61028039e-03  1.18355565e-01]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 8.68170895e-03  9.61028039e-03  1.18355565e-01]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 2.92740762e-03  1.25681944e-02  1.17364608e-01]
 [-2.66019143e-02 -4.85642105e-02  2.02325881e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [-2.21490897e-02 -5.11855632e-02  1.84147991e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [ 2.87083276e-02 -2.38090754e-02  1.00130998e-01]
 [ 3.30027156e-02 -2.10393257e-02  1.00861095e-01]
 [ 2.56818645e-02 -1.89624056e-02  1.05807506e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.75977349e-02 -5.37185818e-02  9.05550644e-03]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [ 2.37384997e-03 -4.39063758e-02  5.72112873e-02]
 [-2.52987072e-03 -4.09299582e-02  6.97957203e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [ 8.78231227e-03 -4.00319546e-02  8.28630030e-02]
 [ 1.37784816e-02 -4.07262221e-02  8.40120837e-02]
 [ 1.37784816e-02 -4.07262221e-02  8.40120837e-02]
 [ 8.78231227e-03 -4.00319546e-02  8.28630030e-02]
 [-6.01296127e-03 -3.90690789e-02  6.33718744e-02]
 [-1.63546950e-03 -4.21346277e-02  6.27444461e-02]
 [ 1.47378407e-02  4.61791120e-02  9.59231630e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.74905472e-02 -4.90254313e-02  2.15759240e-02]
 [-2.21490897e-02 -5.11855632e-02  1.84147991e-02]
 [-1.74905472e-02 -4.90254313e-02  2.15759240e-02]
 [-7.65551720e-03 -1.86446980e-02  1.05329588e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-7.65551720e-03 -1.86446980e-02  1.05329588e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-5.46551961e-03  5.94206154e-04  1.18118353e-01]]
len(transformed_superpoints_pcd) :  142
copy_superpoint_src_corr_points.shape :  (20130, 3)
mask.shape :  (20130,)
copy_superpoint_src_corr_points.shape :  (15554, 3)
copy_superpoint_ref_corr_points.shape :  (15554, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([15554, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 15554, 3])
batch_inlier_masks.shape :  torch.Size([2000, 15554])
best_index :  252
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (15554, 3)
transformed_src_superpoints.shape :  torch.Size([15554, 3])
residual.shape :  torch.Size([15554])
batch_inlier_masks.shape :  torch.Size([15554])
batch_outlier_masks.shape :  torch.Size([15554])
indices_inliers.shape :  torch.Size([101])
indices_outliers.shape :  torch.Size([15453])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([101, 3])
transformed_superpoints_pcd :  [[ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-4.35487460e-03 -4.14419770e-02  3.01158167e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 3.13226134e-03 -2.77765468e-02  9.98787209e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.74775012e-02 -2.84366310e-02  9.86715555e-02]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 2.07130797e-03 -2.42803693e-02  1.04096912e-01]
 [ 8.25982541e-03 -2.27292627e-02  1.06671035e-01]
 [ 2.07130797e-03 -2.42803693e-02  1.04096912e-01]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 8.25982541e-03 -2.27292627e-02  1.06671035e-01]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [-4.35487460e-03 -4.14419770e-02  3.01158167e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-7.35371653e-03 -4.43919301e-02  2.53937654e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.75977349e-02 -5.37185818e-02  9.05550644e-03]
 [-1.59058645e-02 -5.33993915e-02  4.13522124e-03]
 [-1.59063265e-02 -5.27286530e-02 -1.90990046e-03]
 [-1.59058645e-02 -5.33993915e-02  4.13522124e-03]
 [-1.59063265e-02 -5.27286530e-02 -1.90990046e-03]
 [-8.49390589e-03 -5.07534295e-02  2.56131589e-03]
 [-2.33575460e-02 -5.31596914e-02  7.47485459e-03]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [ 2.24739499e-03 -3.88677567e-02  8.13730210e-02]
 [ 1.85263902e-03 -3.63623798e-02  8.57429281e-02]
 [ 5.60325757e-03 -4.18822840e-02  7.80599564e-02]
 [ 5.60325757e-03 -4.18822840e-02  7.80599564e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 2.50125043e-02  5.19124791e-02  6.43848553e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 2.05580778e-02  5.58343828e-02  6.27533048e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-2.96176784e-02 -4.88720536e-02 -1.24316663e-03]
 [-2.00393535e-02 -5.19710556e-02 -4.68520820e-03]
 [-2.80440263e-02 -4.76582050e-02 -6.80954009e-03]
 [-2.00393535e-02 -5.19710556e-02 -4.68520820e-03]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-7.35371653e-03 -4.43919301e-02  2.53937654e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.55813172e-02 -3.72100174e-02  8.90296400e-02]
 [ 1.79298632e-02 -3.39285582e-02  9.25081223e-02]
 [ 1.85263902e-03 -3.63623798e-02  8.57429281e-02]
 [ 1.61420628e-02  3.83694991e-02  1.05085701e-01]
 [ 1.61420628e-02  3.83694991e-02  1.05085701e-01]
 [ 1.31005049e-02  3.51039320e-02  1.08153135e-01]
 [ 1.60333365e-02  4.27008271e-02  1.00721784e-01]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [ 2.50752531e-02 -3.18485349e-02  9.32594389e-02]
 [ 2.82216743e-02 -2.74429247e-02  9.66450498e-02]
 [ 2.50752531e-02 -3.18485349e-02  9.32594389e-02]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 1.79298632e-02 -3.39285582e-02  9.25081223e-02]
 [ 1.55813172e-02 -3.72100174e-02  8.90296400e-02]
 [ 8.68170895e-03  9.61028039e-03  1.18355565e-01]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 8.68170895e-03  9.61028039e-03  1.18355565e-01]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 2.92740762e-03  1.25681944e-02  1.17364608e-01]
 [-2.66019143e-02 -4.85642105e-02  2.02325881e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [-2.21490897e-02 -5.11855632e-02  1.84147991e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [ 2.87083276e-02 -2.38090754e-02  1.00130998e-01]
 [ 3.30027156e-02 -2.10393257e-02  1.00861095e-01]
 [ 2.56818645e-02 -1.89624056e-02  1.05807506e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.75977349e-02 -5.37185818e-02  9.05550644e-03]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [ 2.37384997e-03 -4.39063758e-02  5.72112873e-02]
 [-2.52987072e-03 -4.09299582e-02  6.97957203e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [ 8.78231227e-03 -4.00319546e-02  8.28630030e-02]
 [ 1.37784816e-02 -4.07262221e-02  8.40120837e-02]
 [ 1.37784816e-02 -4.07262221e-02  8.40120837e-02]
 [ 8.78231227e-03 -4.00319546e-02  8.28630030e-02]
 [-6.01296127e-03 -3.90690789e-02  6.33718744e-02]
 [-1.63546950e-03 -4.21346277e-02  6.27444461e-02]
 [ 1.47378407e-02  4.61791120e-02  9.59231630e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.74905472e-02 -4.90254313e-02  2.15759240e-02]
 [-2.21490897e-02 -5.11855632e-02  1.84147991e-02]
 [-1.74905472e-02 -4.90254313e-02  2.15759240e-02]
 [-7.65551720e-03 -1.86446980e-02  1.05329588e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-7.65551720e-03 -1.86446980e-02  1.05329588e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-5.46551961e-03  5.94206154e-04  1.18118353e-01]
 [-3.06713432e-02 -3.09297144e-02  5.70819154e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.06713432e-02 -3.09297144e-02  5.70819154e-02]
 [-3.55737209e-02 -2.54787598e-02  6.37350008e-02]
 [-3.42351124e-02 -2.70052105e-02  5.90964891e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.67858857e-02 -2.30121966e-02  5.72215095e-02]
 [-3.42351124e-02 -2.70052105e-02  5.90964891e-02]
 [-3.06713432e-02 -3.09297144e-02  5.70819154e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-2.88648531e-02 -3.20549347e-02  6.79166317e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.42351124e-02 -2.70052105e-02  5.90964891e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 1.12722311e-02 -4.11243066e-02  6.01998605e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 1.12722311e-02 -4.11243066e-02  6.01998605e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 2.47911196e-02 -4.00467962e-02  5.40887453e-02]
 [ 2.14174371e-02 -4.15954217e-02  5.95821142e-02]
 [-2.88648531e-02 -3.20549347e-02  6.79166317e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [ 4.01659980e-02  2.27269791e-02  8.01203996e-02]
 [ 4.32333499e-02  1.81825161e-02  8.14623907e-02]
 [ 4.01659980e-02  2.27269791e-02  8.01203996e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.07095277e-02 -3.70465703e-02  6.25890344e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-2.88648531e-02 -3.20549347e-02  6.79166317e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [ 3.72291356e-02  2.71016173e-02  7.65202194e-02]
 [ 1.42413173e-02 -4.36206646e-02  6.41553998e-02]
 [-2.68219635e-02 -2.61995848e-02  8.55903774e-02]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-2.54163072e-02 -3.48412953e-02  4.53991294e-02]
 [-2.17359662e-02 -3.68931741e-02  5.05130887e-02]
 [-2.54163072e-02 -3.48412953e-02  4.53991294e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-1.25708273e-02 -4.17058393e-02  4.09326963e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [-2.17359662e-02 -3.68931741e-02  5.05130887e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [ 4.50923815e-02  1.36298649e-02  8.31997097e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [-1.58723071e-02 -3.91112790e-02  5.98192886e-02]
 [-1.58723071e-02 -3.91112790e-02  5.98192886e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [ 2.76593473e-02  3.21804732e-02  6.96916580e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [ 9.86319035e-04 -4.40011248e-02  3.96868959e-02]
 [-1.07241888e-02 -3.96455638e-02  6.29544407e-02]
 [-9.54324752e-03 -3.98200378e-02  6.85225427e-02]
 [-3.96135263e-03 -4.01667878e-02  6.72530532e-02]
 [-1.07241888e-02 -3.96455638e-02  6.29544407e-02]
 [ 3.82195041e-02  2.96509899e-02  6.48807734e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [ 1.22737270e-02 -2.29442678e-02  1.05300620e-01]
 [ 1.22737270e-02 -2.29442678e-02  1.05300620e-01]
 [ 1.57055426e-02 -2.71233544e-02  1.05636880e-01]
 [ 1.22737270e-02 -2.29442678e-02  1.05300620e-01]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]
 [-2.42495965e-02 -4.38664332e-02  3.37581709e-02]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]]
len(transformed_superpoints_pcd) :  243
copy_superpoint_src_corr_points.shape :  (15453, 3)
mask.shape :  (15453,)
copy_superpoint_src_corr_points.shape :  (12310, 3)
copy_superpoint_ref_corr_points.shape :  (12310, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12310, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 12310, 3])
batch_inlier_masks.shape :  torch.Size([2000, 12310])
best_index :  61
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12310, 3)
transformed_src_superpoints.shape :  torch.Size([12310, 3])
residual.shape :  torch.Size([12310])
batch_inlier_masks.shape :  torch.Size([12310])
batch_outlier_masks.shape :  torch.Size([12310])
indices_inliers.shape :  torch.Size([67])
indices_outliers.shape :  torch.Size([12243])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([67, 3])
transformed_superpoints_pcd :  [[ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-4.35487460e-03 -4.14419770e-02  3.01158167e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 3.13226134e-03 -2.77765468e-02  9.98787209e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.74775012e-02 -2.84366310e-02  9.86715555e-02]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 2.07130797e-03 -2.42803693e-02  1.04096912e-01]
 [ 8.25982541e-03 -2.27292627e-02  1.06671035e-01]
 [ 2.07130797e-03 -2.42803693e-02  1.04096912e-01]
 [ 7.67123327e-03 -2.96301991e-02  9.79325250e-02]
 [ 8.25982541e-03 -2.27292627e-02  1.06671035e-01]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.25695057e-02 -2.86572278e-02  9.96882170e-02]
 [ 1.28576271e-02 -2.54975557e-02  1.03602968e-01]
 [ 1.45446174e-02 -3.13905999e-02  9.55720842e-02]
 [-4.35487460e-03 -4.14419770e-02  3.01158167e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-7.35371653e-03 -4.43919301e-02  2.53937654e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.75977349e-02 -5.37185818e-02  9.05550644e-03]
 [-1.59058645e-02 -5.33993915e-02  4.13522124e-03]
 [-1.59063265e-02 -5.27286530e-02 -1.90990046e-03]
 [-1.59058645e-02 -5.33993915e-02  4.13522124e-03]
 [-1.59063265e-02 -5.27286530e-02 -1.90990046e-03]
 [-8.49390589e-03 -5.07534295e-02  2.56131589e-03]
 [-2.33575460e-02 -5.31596914e-02  7.47485459e-03]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [ 2.24739499e-03 -3.88677567e-02  8.13730210e-02]
 [ 1.85263902e-03 -3.63623798e-02  8.57429281e-02]
 [ 5.60325757e-03 -4.18822840e-02  7.80599564e-02]
 [ 5.60325757e-03 -4.18822840e-02  7.80599564e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 2.50125043e-02  5.19124791e-02  6.43848553e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 2.05580778e-02  5.58343828e-02  6.27533048e-02]
 [ 2.13497505e-02  5.33041246e-02  6.76844046e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 1.71560571e-02  5.59758209e-02  6.70897812e-02]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-2.96176784e-02 -4.88720536e-02 -1.24316663e-03]
 [-2.00393535e-02 -5.19710556e-02 -4.68520820e-03]
 [-2.80440263e-02 -4.76582050e-02 -6.80954009e-03]
 [-2.00393535e-02 -5.19710556e-02 -4.68520820e-03]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-2.18642149e-02 -5.29076681e-02  1.17965043e-04]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-7.35371653e-03 -4.43919301e-02  2.53937654e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.44520439e-02 -6.58057630e-04  1.18135609e-01]
 [ 1.60012580e-02  6.46195933e-03  1.18732356e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.74693987e-02 -4.85431030e-03  1.16625898e-01]
 [ 1.55813172e-02 -3.72100174e-02  8.90296400e-02]
 [ 1.79298632e-02 -3.39285582e-02  9.25081223e-02]
 [ 1.85263902e-03 -3.63623798e-02  8.57429281e-02]
 [ 1.61420628e-02  3.83694991e-02  1.05085701e-01]
 [ 1.61420628e-02  3.83694991e-02  1.05085701e-01]
 [ 1.31005049e-02  3.51039320e-02  1.08153135e-01]
 [ 1.60333365e-02  4.27008271e-02  1.00721784e-01]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [ 2.50752531e-02 -3.18485349e-02  9.32594389e-02]
 [ 2.82216743e-02 -2.74429247e-02  9.66450498e-02]
 [ 2.50752531e-02 -3.18485349e-02  9.32594389e-02]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 1.79298632e-02 -3.39285582e-02  9.25081223e-02]
 [ 1.55813172e-02 -3.72100174e-02  8.90296400e-02]
 [ 8.68170895e-03  9.61028039e-03  1.18355565e-01]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 8.68170895e-03  9.61028039e-03  1.18355565e-01]
 [ 1.05686188e-02  4.11093980e-03  1.18880354e-01]
 [ 2.92740762e-03  1.25681944e-02  1.17364608e-01]
 [-2.66019143e-02 -4.85642105e-02  2.02325881e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [-2.21490897e-02 -5.11855632e-02  1.84147991e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [ 2.87083276e-02 -2.38090754e-02  1.00130998e-01]
 [ 3.30027156e-02 -2.10393257e-02  1.00861095e-01]
 [ 2.56818645e-02 -1.89624056e-02  1.05807506e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [ 2.24388428e-02 -2.28675231e-02  1.03486247e-01]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.53228622e-02 -5.25060147e-02  1.45386755e-02]
 [-1.75977349e-02 -5.37185818e-02  9.05550644e-03]
 [-1.27878124e-02 -5.00345975e-02  1.85762793e-02]
 [ 2.37384997e-03 -4.39063758e-02  5.72112873e-02]
 [-2.52987072e-03 -4.09299582e-02  6.97957203e-02]
 [-2.11080853e-02 -4.61861789e-02  2.44826972e-02]
 [ 8.78231227e-03 -4.00319546e-02  8.28630030e-02]
 [ 1.37784816e-02 -4.07262221e-02  8.40120837e-02]
 [ 1.37784816e-02 -4.07262221e-02  8.40120837e-02]
 [ 8.78231227e-03 -4.00319546e-02  8.28630030e-02]
 [-6.01296127e-03 -3.90690789e-02  6.33718744e-02]
 [-1.63546950e-03 -4.21346277e-02  6.27444461e-02]
 [ 1.47378407e-02  4.61791120e-02  9.59231630e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.32087590e-02 -4.69806269e-02  2.34704018e-02]
 [-1.56299993e-02 -4.34667319e-02  2.69106254e-02]
 [-1.05526717e-02 -4.07879800e-02  2.86816508e-02]
 [-1.74905472e-02 -4.90254313e-02  2.15759240e-02]
 [-2.21490897e-02 -5.11855632e-02  1.84147991e-02]
 [-1.74905472e-02 -4.90254313e-02  2.15759240e-02]
 [-7.65551720e-03 -1.86446980e-02  1.05329588e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-7.65551720e-03 -1.86446980e-02  1.05329588e-01]
 [-1.24632185e-02 -1.70567781e-02  1.04086719e-01]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-2.98225991e-02 -2.75795609e-02  7.27197602e-02]
 [-5.46551961e-03  5.94206154e-04  1.18118353e-01]
 [-3.06713432e-02 -3.09297144e-02  5.70819154e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.06713432e-02 -3.09297144e-02  5.70819154e-02]
 [-3.55737209e-02 -2.54787598e-02  6.37350008e-02]
 [-3.42351124e-02 -2.70052105e-02  5.90964891e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.67858857e-02 -2.30121966e-02  5.72215095e-02]
 [-3.42351124e-02 -2.70052105e-02  5.90964891e-02]
 [-3.06713432e-02 -3.09297144e-02  5.70819154e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-2.88648531e-02 -3.20549347e-02  6.79166317e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [-3.42351124e-02 -2.70052105e-02  5.90964891e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 1.12722311e-02 -4.11243066e-02  6.01998605e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 1.12722311e-02 -4.11243066e-02  6.01998605e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 1.64253768e-02 -4.07725759e-02  5.75139150e-02]
 [ 2.47911196e-02 -4.00467962e-02  5.40887453e-02]
 [ 2.14174371e-02 -4.15954217e-02  5.95821142e-02]
 [-2.88648531e-02 -3.20549347e-02  6.79166317e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-3.01172771e-02 -3.11829261e-02  6.31029904e-02]
 [ 4.01659980e-02  2.27269791e-02  8.01203996e-02]
 [ 4.32333499e-02  1.81825161e-02  8.14623907e-02]
 [ 4.01659980e-02  2.27269791e-02  8.01203996e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.07095277e-02 -3.70465703e-02  6.25890344e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-2.88648531e-02 -3.20549347e-02  6.79166317e-02]
 [-3.24501693e-02 -2.81793829e-02  6.90185428e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [ 3.72291356e-02  2.71016173e-02  7.65202194e-02]
 [ 1.42413173e-02 -4.36206646e-02  6.41553998e-02]
 [-2.68219635e-02 -2.61995848e-02  8.55903774e-02]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-2.54163072e-02 -3.48412953e-02  4.53991294e-02]
 [-2.17359662e-02 -3.68931741e-02  5.05130887e-02]
 [-2.54163072e-02 -3.48412953e-02  4.53991294e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-1.25708273e-02 -4.17058393e-02  4.09326963e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [-2.17359662e-02 -3.68931741e-02  5.05130887e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-2.97002979e-02 -2.97216736e-02  7.51965418e-02]
 [ 4.50923815e-02  1.36298649e-02  8.31997097e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-1.62183568e-02 -3.84706222e-02  6.80237114e-02]
 [-1.65489204e-02 -3.91525626e-02  5.16701378e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [-1.58723071e-02 -3.91112790e-02  5.98192886e-02]
 [-1.58723071e-02 -3.91112790e-02  5.98192886e-02]
 [-2.58356929e-02 -3.34564149e-02  7.36206025e-02]
 [ 2.76593473e-02  3.21804732e-02  6.96916580e-02]
 [-2.20506005e-02 -3.63122970e-02  6.77836016e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [-2.58454308e-02 -3.44469324e-02  6.27513453e-02]
 [-2.09678859e-02 -3.62935439e-02  7.34219775e-02]
 [ 9.86319035e-04 -4.40011248e-02  3.96868959e-02]
 [-1.07241888e-02 -3.96455638e-02  6.29544407e-02]
 [-9.54324752e-03 -3.98200378e-02  6.85225427e-02]
 [-3.96135263e-03 -4.01667878e-02  6.72530532e-02]
 [-1.07241888e-02 -3.96455638e-02  6.29544407e-02]
 [ 3.82195041e-02  2.96509899e-02  6.48807734e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [-1.37918219e-02 -4.07447889e-02  4.77298945e-02]
 [ 1.22737270e-02 -2.29442678e-02  1.05300620e-01]
 [ 1.22737270e-02 -2.29442678e-02  1.05300620e-01]
 [ 1.57055426e-02 -2.71233544e-02  1.05636880e-01]
 [ 1.22737270e-02 -2.29442678e-02  1.05300620e-01]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]
 [-2.42495965e-02 -4.38664332e-02  3.37581709e-02]
 [-2.02169884e-02 -4.07439023e-02  3.83641124e-02]
 [ 8.33488256e-02  1.37762055e-02  2.68370137e-02]
 [ 7.81580806e-02  8.54288787e-03  2.55293176e-02]
 [ 8.24565142e-02  1.14791542e-02  2.19934508e-02]
 [ 8.33488256e-02  1.37762055e-02  2.68370137e-02]
 [ 7.81580806e-02  8.54288787e-03  2.55293176e-02]
 [ 8.24565142e-02  1.14791542e-02  2.19934508e-02]
 [ 8.24565142e-02  1.14791542e-02  2.19934508e-02]
 [ 7.65368491e-02  2.81865150e-03  2.58632228e-02]
 [ 8.33488256e-02  1.37762055e-02  2.68370137e-02]
 [ 7.81580806e-02  8.54288787e-03  2.55293176e-02]
 [ 7.67734721e-02  3.99857014e-03  3.08172926e-02]
 [ 8.22773799e-02  1.26206800e-02  3.30070108e-02]
 [ 7.85391480e-02  8.68135691e-03  3.11266221e-02]
 [ 7.67734721e-02  3.99857014e-03  3.08172926e-02]
 [ 7.83674717e-02  5.51008433e-03  3.53405923e-02]
 [ 7.67734721e-02  3.99857014e-03  3.08172926e-02]
 [ 8.22773799e-02  1.26206800e-02  3.30070108e-02]
 [ 8.33488256e-02  1.37762055e-02  2.68370137e-02]
 [ 8.33488256e-02  1.37762055e-02  2.68370137e-02]
 [ 8.33488256e-02  1.37762055e-02  2.68370137e-02]
 [ 8.24565142e-02  1.14791542e-02  2.19934508e-02]
 [ 8.33488256e-02  1.37762055e-02  2.68370137e-02]
 [ 8.45755637e-03 -2.50155441e-02  8.71476308e-02]
 [ 1.30502358e-02 -3.16935703e-02  8.92100334e-02]
 [ 8.22773799e-02  1.26206800e-02  3.30070108e-02]
 [ 7.71669000e-02  1.32417753e-02  3.41965184e-02]
 [ 8.22773799e-02  1.26206800e-02  3.30070108e-02]
 [ 7.71669000e-02  1.32417753e-02  3.41965184e-02]
 [ 1.18080433e-02 -2.50965208e-02  9.86066461e-02]
 [ 7.68475328e-03 -2.20845342e-02  9.79112163e-02]
 [ 1.18080433e-02 -2.50965208e-02  9.86066461e-02]
 [ 7.68475328e-03 -2.20845342e-02  9.79112163e-02]
 [ 1.18080433e-02 -2.50965208e-02  9.86066461e-02]
 [ 8.45755637e-03 -2.50155441e-02  8.71476308e-02]
 [ 1.07848197e-02 -2.44920552e-02  9.23317671e-02]
 [ 5.82886860e-03 -2.21245773e-02  9.06825736e-02]
 [ 8.45755637e-03 -2.50155441e-02  8.71476308e-02]
 [ 1.07848197e-02 -2.44920552e-02  9.23317671e-02]
 [ 5.82886860e-03 -2.21245773e-02  9.06825736e-02]
 [ 1.07848197e-02 -2.44920552e-02  9.23317671e-02]
 [ 5.82886860e-03 -2.21245773e-02  9.06825736e-02]
 [ 1.30502358e-02 -3.16935703e-02  8.92100334e-02]
 [ 8.33402798e-02  9.75749642e-03  3.91885340e-02]
 [ 8.33402798e-02  9.75749642e-03  3.91885340e-02]
 [ 1.07848197e-02 -2.44920552e-02  9.23317671e-02]
 [ 5.82886860e-03 -2.21245773e-02  9.06825736e-02]
 [ 1.07848197e-02 -2.44920552e-02  9.23317671e-02]
 [ 7.68475328e-03 -2.20845342e-02  9.79112163e-02]
 [ 1.18080433e-02 -2.50965208e-02  9.86066461e-02]
 [ 7.68475328e-03 -2.20845342e-02  9.79112163e-02]
 [ 1.18080433e-02 -2.50965208e-02  9.86066461e-02]
 [ 7.68475328e-03 -2.20845342e-02  9.79112163e-02]
 [ 1.18080433e-02 -2.50965208e-02  9.86066461e-02]
 [ 4.39121667e-03 -3.50119397e-02  8.11325014e-02]
 [-1.41258864e-03 -3.11326981e-02  7.91433752e-02]
 [ 4.39121667e-03 -3.50119397e-02  8.11325014e-02]
 [ 8.22773799e-02  1.26206800e-02  3.30070108e-02]
 [-1.18846092e-02 -3.96582708e-02  1.91045180e-02]
 [-1.02673024e-02 -4.44294512e-02  1.71829760e-02]
 [-1.18846092e-02 -3.96582708e-02  1.91045180e-02]
 [-1.02673024e-02 -4.44294512e-02  1.71829760e-02]
 [ 4.39121667e-03 -3.50119397e-02  8.11325014e-02]
 [-1.41258864e-03 -3.11326981e-02  7.91433752e-02]
 [ 4.39121667e-03 -3.50119397e-02  8.11325014e-02]
 [-1.41258864e-03 -3.11326981e-02  7.91433752e-02]
 [ 4.39121667e-03 -3.50119397e-02  8.11325014e-02]
 [ 5.78999054e-04 -2.49561742e-02  8.39643180e-02]]
len(transformed_superpoints_pcd) :  310
copy_superpoint_src_corr_points.shape :  (12243, 3)
mask.shape :  (12243,)
copy_superpoint_src_corr_points.shape :  (11590, 3)
copy_superpoint_ref_corr_points.shape :  (11590, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([11590, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 11590, 3])
batch_inlier_masks.shape :  torch.Size([2000, 11590])
best_index :  1009
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (11590, 3)
transformed_src_superpoints.shape :  torch.Size([11590, 3])
residual.shape :  torch.Size([11590])
batch_inlier_masks.shape :  torch.Size([11590])
batch_outlier_masks.shape :  torch.Size([11590])
indices_inliers.shape :  torch.Size([65])
indices_outliers.shape :  torch.Size([11525])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([65, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01516309 -0.02901914  0.05949586]
 [ 0.02003121 -0.02958276  0.05430369]
 [ 0.01516309 -0.02901914  0.05949586]]
len(transformed_superpoints_pcd) :  375
copy_superpoint_src_corr_points.shape :  (11525, 3)
mask.shape :  (11525,)
copy_superpoint_src_corr_points.shape :  (10368, 3)
copy_superpoint_ref_corr_points.shape :  (10368, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10368, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 10368, 3])
batch_inlier_masks.shape :  torch.Size([2000, 10368])
best_index :  239
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10368, 3)
transformed_src_superpoints.shape :  torch.Size([10368, 3])
residual.shape :  torch.Size([10368])
batch_inlier_masks.shape :  torch.Size([10368])
batch_outlier_masks.shape :  torch.Size([10368])
indices_inliers.shape :  torch.Size([64])
indices_outliers.shape :  torch.Size([10304])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([64, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.02537129 -0.03541593  0.08732101]
 [ 0.01939366 -0.03504747  0.08721666]
 [ 0.02537129 -0.03541593  0.08732101]]
len(transformed_superpoints_pcd) :  439
copy_superpoint_src_corr_points.shape :  (10304, 3)
mask.shape :  (10304,)
copy_superpoint_src_corr_points.shape :  (9439, 3)
copy_superpoint_ref_corr_points.shape :  (9439, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9439, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 9439, 3])
batch_inlier_masks.shape :  torch.Size([2000, 9439])
best_index :  1757
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9439, 3)
transformed_src_superpoints.shape :  torch.Size([9439, 3])
residual.shape :  torch.Size([9439])
batch_inlier_masks.shape :  torch.Size([9439])
batch_outlier_masks.shape :  torch.Size([9439])
indices_inliers.shape :  torch.Size([58])
indices_outliers.shape :  torch.Size([9381])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([58, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01775558 -0.02605192  0.10625097]
 [ 0.01416067 -0.03454079  0.08395678]
 [ 0.01416067 -0.03454079  0.08395678]]
len(transformed_superpoints_pcd) :  497
copy_superpoint_src_corr_points.shape :  (9381, 3)
mask.shape :  (9381,)
copy_superpoint_src_corr_points.shape :  (8365, 3)
copy_superpoint_ref_corr_points.shape :  (8365, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8365, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 8365, 3])
batch_inlier_masks.shape :  torch.Size([2000, 8365])
best_index :  500
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8365, 3)
transformed_src_superpoints.shape :  torch.Size([8365, 3])
residual.shape :  torch.Size([8365])
batch_inlier_masks.shape :  torch.Size([8365])
batch_outlier_masks.shape :  torch.Size([8365])
indices_inliers.shape :  torch.Size([41])
indices_outliers.shape :  torch.Size([8324])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([41, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01989387 -0.02929621  0.04803919]
 [ 0.02477975 -0.02971594  0.05029811]
 [ 0.01507476 -0.03162156  0.04859547]]
len(transformed_superpoints_pcd) :  538
copy_superpoint_src_corr_points.shape :  (8324, 3)
mask.shape :  (8324,)
copy_superpoint_src_corr_points.shape :  (7923, 3)
copy_superpoint_ref_corr_points.shape :  (7923, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7923, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7923, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7923])
best_index :  530
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7923, 3)
transformed_src_superpoints.shape :  torch.Size([7923, 3])
residual.shape :  torch.Size([7923])
batch_inlier_masks.shape :  torch.Size([7923])
batch_outlier_masks.shape :  torch.Size([7923])
indices_inliers.shape :  torch.Size([40])
indices_outliers.shape :  torch.Size([7883])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([40, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01658952  0.00901854 -0.0985519 ]
 [-0.0188129   0.01614761 -0.10193024]
 [-0.02149114  0.01020342 -0.09743914]]
len(transformed_superpoints_pcd) :  578
copy_superpoint_src_corr_points.shape :  (7883, 3)
mask.shape :  (7883,)
copy_superpoint_src_corr_points.shape :  (7195, 3)
copy_superpoint_ref_corr_points.shape :  (7195, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7195, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7195, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7195])
best_index :  1381
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7195, 3)
transformed_src_superpoints.shape :  torch.Size([7195, 3])
residual.shape :  torch.Size([7195])
batch_inlier_masks.shape :  torch.Size([7195])
batch_outlier_masks.shape :  torch.Size([7195])
indices_inliers.shape :  torch.Size([40])
indices_outliers.shape :  torch.Size([7155])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([40, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.0247349  -0.03262491  0.05455994]
 [-0.01417523 -0.03550296  0.05685126]
 [-0.0242901  -0.03424747  0.05930466]]
len(transformed_superpoints_pcd) :  618
copy_superpoint_src_corr_points.shape :  (7155, 3)
mask.shape :  (7155,)
copy_superpoint_src_corr_points.shape :  (6919, 3)
copy_superpoint_ref_corr_points.shape :  (6919, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6919, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6919, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6919])
best_index :  405
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6919, 3)
transformed_src_superpoints.shape :  torch.Size([6919, 3])
residual.shape :  torch.Size([6919])
batch_inlier_masks.shape :  torch.Size([6919])
batch_outlier_masks.shape :  torch.Size([6919])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([6881])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.00287118 -0.03435365  0.07181126]
 [ 0.00729578 -0.0355761   0.06627861]
 [ 0.00287118 -0.03435365  0.07181126]]
len(transformed_superpoints_pcd) :  656
copy_superpoint_src_corr_points.shape :  (6881, 3)
mask.shape :  (6881,)
copy_superpoint_src_corr_points.shape :  (5982, 3)
copy_superpoint_ref_corr_points.shape :  (5982, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5982, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5982, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5982])
best_index :  510
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5982, 3)
transformed_src_superpoints.shape :  torch.Size([5982, 3])
residual.shape :  torch.Size([5982])
batch_inlier_masks.shape :  torch.Size([5982])
batch_outlier_masks.shape :  torch.Size([5982])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([5944])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01786508  0.01689311  0.14890333]
 [-0.02263424  0.01971423  0.14908524]
 [-0.02263424  0.01971423  0.14908524]]
len(transformed_superpoints_pcd) :  694
copy_superpoint_src_corr_points.shape :  (5944, 3)
mask.shape :  (5944,)
copy_superpoint_src_corr_points.shape :  (5745, 3)
copy_superpoint_ref_corr_points.shape :  (5745, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5745, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5745, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5745])
best_index :  248
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5745, 3)
transformed_src_superpoints.shape :  torch.Size([5745, 3])
residual.shape :  torch.Size([5745])
batch_inlier_masks.shape :  torch.Size([5745])
batch_outlier_masks.shape :  torch.Size([5745])
indices_inliers.shape :  torch.Size([37])
indices_outliers.shape :  torch.Size([5708])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([37, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01419433 -0.03912812  0.03882212]
 [-0.01958536 -0.0418459   0.03555238]
 [-0.01476339 -0.03416042  0.04272026]]
len(transformed_superpoints_pcd) :  731
copy_superpoint_src_corr_points.shape :  (5708, 3)
mask.shape :  (5708,)
copy_superpoint_src_corr_points.shape :  (5440, 3)
copy_superpoint_ref_corr_points.shape :  (5440, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5440, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5440, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5440])
best_index :  366
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5440, 3)
transformed_src_superpoints.shape :  torch.Size([5440, 3])
residual.shape :  torch.Size([5440])
batch_inlier_masks.shape :  torch.Size([5440])
batch_outlier_masks.shape :  torch.Size([5440])
indices_inliers.shape :  torch.Size([37])
indices_outliers.shape :  torch.Size([5403])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([37, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.03114392 -0.03055149  0.0627218 ]
 [-0.03055613 -0.02985694  0.05753432]
 [-0.03324825 -0.03248869  0.06798016]]
len(transformed_superpoints_pcd) :  768
copy_superpoint_src_corr_points.shape :  (5403, 3)
mask.shape :  (5403,)
copy_superpoint_src_corr_points.shape :  (5237, 3)
copy_superpoint_ref_corr_points.shape :  (5237, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5237, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5237, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5237])
best_index :  77
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5237, 3)
transformed_src_superpoints.shape :  torch.Size([5237, 3])
residual.shape :  torch.Size([5237])
batch_inlier_masks.shape :  torch.Size([5237])
batch_outlier_masks.shape :  torch.Size([5237])
indices_inliers.shape :  torch.Size([36])
indices_outliers.shape :  torch.Size([5201])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([36, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01043437 -0.06554775 -0.11452119]
 [ 0.01558984 -0.06617584 -0.11009239]
 [-0.02271992 -0.04300332  0.02470988]]
len(transformed_superpoints_pcd) :  804
copy_superpoint_src_corr_points.shape :  (5201, 3)
mask.shape :  (5201,)
copy_superpoint_src_corr_points.shape :  (4836, 3)
copy_superpoint_ref_corr_points.shape :  (4836, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4836, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4836, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4836])
best_index :  1348
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4836, 3)
transformed_src_superpoints.shape :  torch.Size([4836, 3])
residual.shape :  torch.Size([4836])
batch_inlier_masks.shape :  torch.Size([4836])
batch_outlier_masks.shape :  torch.Size([4836])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([4805])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03253187  0.0276408   0.06682976]
 [ 0.03111207  0.02748788  0.07325129]
 [ 0.03111207  0.02748788  0.07325129]]
len(transformed_superpoints_pcd) :  835
copy_superpoint_src_corr_points.shape :  (4805, 3)
mask.shape :  (4805,)
copy_superpoint_src_corr_points.shape :  (4492, 3)
copy_superpoint_ref_corr_points.shape :  (4492, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4492, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4492, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4492])
best_index :  1874
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4492, 3)
transformed_src_superpoints.shape :  torch.Size([4492, 3])
residual.shape :  torch.Size([4492])
batch_inlier_masks.shape :  torch.Size([4492])
batch_outlier_masks.shape :  torch.Size([4492])
indices_inliers.shape :  torch.Size([27])
indices_outliers.shape :  torch.Size([4465])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([27, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.02391524 -0.03371543  0.07064465]
 [-0.01805443 -0.03451359  0.06796567]
 [-0.02271407 -0.0341654   0.06547309]]
len(transformed_superpoints_pcd) :  862
copy_superpoint_src_corr_points.shape :  (4465, 3)
mask.shape :  (4465,)
copy_superpoint_src_corr_points.shape :  (4246, 3)
copy_superpoint_ref_corr_points.shape :  (4246, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4246, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4246, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4246])
best_index :  1602
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4246, 3)
transformed_src_superpoints.shape :  torch.Size([4246, 3])
residual.shape :  torch.Size([4246])
batch_inlier_masks.shape :  torch.Size([4246])
batch_outlier_masks.shape :  torch.Size([4246])
indices_inliers.shape :  torch.Size([25])
indices_outliers.shape :  torch.Size([4221])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([25, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01210869 -0.03798979  0.08859704]
 [ 0.00729983 -0.03893723  0.0855696 ]
 [ 0.00729983 -0.03893723  0.0855696 ]]
len(transformed_superpoints_pcd) :  887
copy_superpoint_src_corr_points.shape :  (4221, 3)
mask.shape :  (4221,)
copy_superpoint_src_corr_points.shape :  (4154, 3)
copy_superpoint_ref_corr_points.shape :  (4154, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4154, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4154, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4154])
best_index :  134
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4154, 3)
transformed_src_superpoints.shape :  torch.Size([4154, 3])
residual.shape :  torch.Size([4154])
batch_inlier_masks.shape :  torch.Size([4154])
batch_outlier_masks.shape :  torch.Size([4154])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([4130])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.03204506 -0.02804242  0.07847805]
 [ 0.00447877 -0.0262703   0.08901495]
 [ 0.00447877 -0.0262703   0.08901495]]
len(transformed_superpoints_pcd) :  911
copy_superpoint_src_corr_points.shape :  (4130, 3)
mask.shape :  (4130,)
copy_superpoint_src_corr_points.shape :  (3495, 3)
copy_superpoint_ref_corr_points.shape :  (3495, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3495, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3495, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3495])
best_index :  712
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3495, 3)
transformed_src_superpoints.shape :  torch.Size([3495, 3])
residual.shape :  torch.Size([3495])
batch_inlier_masks.shape :  torch.Size([3495])
batch_outlier_masks.shape :  torch.Size([3495])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([3471])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.03086927 -0.03118028  0.06559978]
 [-0.02840544 -0.0307498   0.06124315]
 [-0.0229424  -0.02993823  0.06009542]]
len(transformed_superpoints_pcd) :  935
copy_superpoint_src_corr_points.shape :  (3471, 3)
mask.shape :  (3471,)
copy_superpoint_src_corr_points.shape :  (3259, 3)
copy_superpoint_ref_corr_points.shape :  (3259, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3259, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3259, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3259])
best_index :  1299
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3259, 3)
transformed_src_superpoints.shape :  torch.Size([3259, 3])
residual.shape :  torch.Size([3259])
batch_inlier_masks.shape :  torch.Size([3259])
batch_outlier_masks.shape :  torch.Size([3259])
indices_inliers.shape :  torch.Size([24])
indices_outliers.shape :  torch.Size([3235])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([24, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.02131837 -0.03434645  0.06522769]
 [-0.01781469 -0.03316933  0.07110853]
 [-0.01781469 -0.03316933  0.07110853]]
len(transformed_superpoints_pcd) :  959
copy_superpoint_src_corr_points.shape :  (3235, 3)
mask.shape :  (3235,)
copy_superpoint_src_corr_points.shape :  (3164, 3)
copy_superpoint_ref_corr_points.shape :  (3164, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3164, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3164, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3164])
best_index :  262
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3164, 3)
transformed_src_superpoints.shape :  torch.Size([3164, 3])
residual.shape :  torch.Size([3164])
batch_inlier_masks.shape :  torch.Size([3164])
batch_outlier_masks.shape :  torch.Size([3164])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([3142])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.0368584   0.01956447  0.0699012 ]
 [ 0.0356781   0.01569335  0.07312725]
 [ 0.03322441  0.02017101  0.07361837]]
len(transformed_superpoints_pcd) :  981
copy_superpoint_src_corr_points.shape :  (3142, 3)
mask.shape :  (3142,)
copy_superpoint_src_corr_points.shape :  (2966, 3)
copy_superpoint_ref_corr_points.shape :  (2966, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2966, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2966, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2966])
best_index :  1059
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2966, 3)
transformed_src_superpoints.shape :  torch.Size([2966, 3])
residual.shape :  torch.Size([2966])
batch_inlier_masks.shape :  torch.Size([2966])
batch_outlier_masks.shape :  torch.Size([2966])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2945])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.00919549 -0.06826109 -0.10819721]
 [ 0.00688576 -0.07412526 -0.10396986]
 [ 0.00511752 -0.06938984 -0.10496809]]
len(transformed_superpoints_pcd) :  1002
copy_superpoint_src_corr_points.shape :  (2945, 3)
mask.shape :  (2945,)
copy_superpoint_src_corr_points.shape :  (2854, 3)
copy_superpoint_ref_corr_points.shape :  (2854, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2854, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2854, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2854])
best_index :  1791
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2854, 3)
transformed_src_superpoints.shape :  torch.Size([2854, 3])
residual.shape :  torch.Size([2854])
batch_inlier_masks.shape :  torch.Size([2854])
batch_outlier_masks.shape :  torch.Size([2854])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([2833])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.00789381 -0.02503893  0.0974554 ]
 [ 0.00789381 -0.02503893  0.0974554 ]
 [ 0.00781711 -0.02156404  0.1010873 ]]
len(transformed_superpoints_pcd) :  1023
copy_superpoint_src_corr_points.shape :  (2833, 3)
mask.shape :  (2833,)
copy_superpoint_src_corr_points.shape :  (2638, 3)
copy_superpoint_ref_corr_points.shape :  (2638, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2638, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2638, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2638])
best_index :  1215
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2638, 3)
transformed_src_superpoints.shape :  torch.Size([2638, 3])
residual.shape :  torch.Size([2638])
batch_inlier_masks.shape :  torch.Size([2638])
batch_outlier_masks.shape :  torch.Size([2638])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([2618])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01709873  0.01707016  0.15146369]
 [-0.01709873  0.01707016  0.15146369]
 [-0.01800833  0.0121418   0.14736883]]
len(transformed_superpoints_pcd) :  1043
copy_superpoint_src_corr_points.shape :  (2618, 3)
mask.shape :  (2618,)
copy_superpoint_src_corr_points.shape :  (2504, 3)
copy_superpoint_ref_corr_points.shape :  (2504, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2504, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2504, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2504])
best_index :  1453
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2504, 3)
transformed_src_superpoints.shape :  torch.Size([2504, 3])
residual.shape :  torch.Size([2504])
batch_inlier_masks.shape :  torch.Size([2504])
batch_outlier_masks.shape :  torch.Size([2504])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([2484])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.02399073 -0.03164468  0.0592974 ]
 [ 0.02115827 -0.03461112  0.06261791]
 [ 0.02850061 -0.03285458  0.06361842]]
len(transformed_superpoints_pcd) :  1063
copy_superpoint_src_corr_points.shape :  (2484, 3)
mask.shape :  (2484,)
copy_superpoint_src_corr_points.shape :  (2292, 3)
copy_superpoint_ref_corr_points.shape :  (2292, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2292, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2292, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2292])
best_index :  1220
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2292, 3)
transformed_src_superpoints.shape :  torch.Size([2292, 3])
residual.shape :  torch.Size([2292])
batch_inlier_masks.shape :  torch.Size([2292])
batch_outlier_masks.shape :  torch.Size([2292])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([2273])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.03531863 -0.07386355 -0.02687179]
 [-0.03571456 -0.06890645 -0.02418825]
 [-0.043537   -0.067183   -0.02579649]]
len(transformed_superpoints_pcd) :  1082
copy_superpoint_src_corr_points.shape :  (2273, 3)
mask.shape :  (2273,)
copy_superpoint_src_corr_points.shape :  (2096, 3)
copy_superpoint_ref_corr_points.shape :  (2096, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2096, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2096, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2096])
best_index :  115
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2096, 3)
transformed_src_superpoints.shape :  torch.Size([2096, 3])
residual.shape :  torch.Size([2096])
batch_inlier_masks.shape :  torch.Size([2096])
batch_outlier_masks.shape :  torch.Size([2096])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([2078])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03843703  0.03168699  0.06785906]
 [ 0.03884493  0.03314692  0.05826367]
 [ 0.03843703  0.03168699  0.06785906]]
len(transformed_superpoints_pcd) :  1100
copy_superpoint_src_corr_points.shape :  (2078, 3)
mask.shape :  (2078,)
copy_superpoint_src_corr_points.shape :  (2045, 3)
copy_superpoint_ref_corr_points.shape :  (2045, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2045, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2045, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2045])
best_index :  854
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2045, 3)
transformed_src_superpoints.shape :  torch.Size([2045, 3])
residual.shape :  torch.Size([2045])
batch_inlier_masks.shape :  torch.Size([2045])
batch_outlier_masks.shape :  torch.Size([2045])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([2028])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.02243922  0.01879235  0.15298423]
 [-0.01978109  0.01537365  0.14783105]
 [-0.02533434  0.01596106  0.14891401]]
len(transformed_superpoints_pcd) :  1117
copy_superpoint_src_corr_points.shape :  (2028, 3)
mask.shape :  (2028,)
copy_superpoint_src_corr_points.shape :  (2017, 3)
copy_superpoint_ref_corr_points.shape :  (2017, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2017, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2017, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2017])
best_index :  1995
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2017, 3)
transformed_src_superpoints.shape :  torch.Size([2017, 3])
residual.shape :  torch.Size([2017])
batch_inlier_masks.shape :  torch.Size([2017])
batch_outlier_masks.shape :  torch.Size([2017])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([2000])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01080535 -0.06786265 -0.10921233]
 [ 0.00970254 -0.07788481 -0.10423727]
 [ 0.00525181 -0.0741436  -0.10302834]]
len(transformed_superpoints_pcd) :  1134
copy_superpoint_src_corr_points.shape :  (2000, 3)
mask.shape :  (2000,)
copy_superpoint_src_corr_points.shape :  (1886, 3)
copy_superpoint_ref_corr_points.shape :  (1886, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1886, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1886, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1886])
best_index :  1323
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1886, 3)
transformed_src_superpoints.shape :  torch.Size([1886, 3])
residual.shape :  torch.Size([1886])
batch_inlier_masks.shape :  torch.Size([1886])
batch_outlier_masks.shape :  torch.Size([1886])
indices_inliers.shape :  torch.Size([16])
indices_outliers.shape :  torch.Size([1870])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([16, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.02506256 -0.03348172  0.05691707]
 [-0.0249662  -0.03403672  0.06281664]
 [-0.02506256 -0.03348172  0.05691707]]
len(transformed_superpoints_pcd) :  1150
copy_superpoint_src_corr_points.shape :  (1870, 3)
mask.shape :  (1870,)
copy_superpoint_src_corr_points.shape :  (1781, 3)
copy_superpoint_ref_corr_points.shape :  (1781, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1781, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1781, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1781])
best_index :  457
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1781, 3)
transformed_src_superpoints.shape :  torch.Size([1781, 3])
residual.shape :  torch.Size([1781])
batch_inlier_masks.shape :  torch.Size([1781])
batch_outlier_masks.shape :  torch.Size([1781])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1766])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.02291509 -0.03684839  0.02875074]
 [-0.02788026 -0.03663282  0.02962587]
 [-0.01982287 -0.03687847  0.03277704]]
len(transformed_superpoints_pcd) :  1165
copy_superpoint_src_corr_points.shape :  (1766, 3)
mask.shape :  (1766,)
copy_superpoint_src_corr_points.shape :  (1692, 3)
copy_superpoint_ref_corr_points.shape :  (1692, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1692, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1692, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1692])
best_index :  610
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1692, 3)
transformed_src_superpoints.shape :  torch.Size([1692, 3])
residual.shape :  torch.Size([1692])
batch_inlier_masks.shape :  torch.Size([1692])
batch_outlier_masks.shape :  torch.Size([1692])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1677])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.03305762  0.00758535 -0.04089365]
 [-0.0230489   0.0053806  -0.0357158 ]
 [-0.02623693  0.00205512 -0.03798846]]
len(transformed_superpoints_pcd) :  1180
copy_superpoint_src_corr_points.shape :  (1677, 3)
mask.shape :  (1677,)
copy_superpoint_src_corr_points.shape :  (1550, 3)
copy_superpoint_ref_corr_points.shape :  (1550, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1550, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1550, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1550])
best_index :  1199
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1550, 3)
transformed_src_superpoints.shape :  torch.Size([1550, 3])
residual.shape :  torch.Size([1550])
batch_inlier_masks.shape :  torch.Size([1550])
batch_outlier_masks.shape :  torch.Size([1550])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1535])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01713337  0.01406706  0.14698106]
 [-0.02203473  0.01059991  0.144466  ]
 [-0.02126486  0.01647884  0.15076207]]
len(transformed_superpoints_pcd) :  1195
copy_superpoint_src_corr_points.shape :  (1535, 3)
mask.shape :  (1535,)
copy_superpoint_src_corr_points.shape :  (1529, 3)
copy_superpoint_ref_corr_points.shape :  (1529, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1529, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1529, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1529])
best_index :  1516
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1529, 3)
transformed_src_superpoints.shape :  torch.Size([1529, 3])
residual.shape :  torch.Size([1529])
batch_inlier_masks.shape :  torch.Size([1529])
batch_outlier_masks.shape :  torch.Size([1529])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1514])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.02147905  0.06116588 -0.07539864]
 [ 0.02914853  0.05530596 -0.07169924]
 [ 0.02852302  0.05278219 -0.07634315]]
len(transformed_superpoints_pcd) :  1210
copy_superpoint_src_corr_points.shape :  (1514, 3)
mask.shape :  (1514,)
copy_superpoint_src_corr_points.shape :  (1477, 3)
copy_superpoint_ref_corr_points.shape :  (1477, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1477, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1477, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1477])
best_index :  525
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1477, 3)
transformed_src_superpoints.shape :  torch.Size([1477, 3])
residual.shape :  torch.Size([1477])
batch_inlier_masks.shape :  torch.Size([1477])
batch_outlier_masks.shape :  torch.Size([1477])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1463])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03734494  0.02608766  0.07432479]
 [ 0.03622662  0.03040045  0.06962913]
 [ 0.03550295  0.03680745  0.05110926]]
len(transformed_superpoints_pcd) :  1224
copy_superpoint_src_corr_points.shape :  (1463, 3)
mask.shape :  (1463,)
copy_superpoint_src_corr_points.shape :  (1399, 3)
copy_superpoint_ref_corr_points.shape :  (1399, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1399, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1399, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1399])
best_index :  549
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1399, 3)
transformed_src_superpoints.shape :  torch.Size([1399, 3])
residual.shape :  torch.Size([1399])
batch_inlier_masks.shape :  torch.Size([1399])
batch_outlier_masks.shape :  torch.Size([1399])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1385])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.00423033 -0.02947321  0.08587822]
 [ 0.02707948  0.05196056  0.07315417]
 [ 0.00460555 -0.03718863  0.04062065]]
len(transformed_superpoints_pcd) :  1238
copy_superpoint_src_corr_points.shape :  (1385, 3)
mask.shape :  (1385,)
copy_superpoint_src_corr_points.shape :  (1256, 3)
copy_superpoint_ref_corr_points.shape :  (1256, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1256, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1256, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1256])
best_index :  1964
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1256, 3)
transformed_src_superpoints.shape :  torch.Size([1256, 3])
residual.shape :  torch.Size([1256])
batch_inlier_masks.shape :  torch.Size([1256])
batch_outlier_masks.shape :  torch.Size([1256])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1242])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01873215  0.01063507  0.14113906]
 [-0.02598633  0.01218215  0.14814894]
 [-0.02037071  0.01304675  0.14573857]]
len(transformed_superpoints_pcd) :  1252
copy_superpoint_src_corr_points.shape :  (1242, 3)
mask.shape :  (1242,)
copy_superpoint_src_corr_points.shape :  (1240, 3)
copy_superpoint_ref_corr_points.shape :  (1240, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1240, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1240, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1240])
best_index :  759
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1240, 3)
transformed_src_superpoints.shape :  torch.Size([1240, 3])
residual.shape :  torch.Size([1240])
batch_inlier_masks.shape :  torch.Size([1240])
batch_outlier_masks.shape :  torch.Size([1240])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1228])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01391578  0.01675878  0.15010107]
 [-0.01399213  0.00854559  0.13858329]
 [-0.01865778  0.01165662  0.13484003]]
len(transformed_superpoints_pcd) :  1264
copy_superpoint_src_corr_points.shape :  (1228, 3)
mask.shape :  (1228,)
copy_superpoint_src_corr_points.shape :  (1217, 3)
copy_superpoint_ref_corr_points.shape :  (1217, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1217, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1217, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1217])
best_index :  880
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1217, 3)
transformed_src_superpoints.shape :  torch.Size([1217, 3])
residual.shape :  torch.Size([1217])
batch_inlier_masks.shape :  torch.Size([1217])
batch_outlier_masks.shape :  torch.Size([1217])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1205])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00636756  0.0592529  -0.08328653]
 [-0.01038375  0.05669438 -0.08487516]
 [-0.00936419  0.05310973 -0.08837946]]
len(transformed_superpoints_pcd) :  1276
copy_superpoint_src_corr_points.shape :  (1205, 3)
mask.shape :  (1205,)
copy_superpoint_src_corr_points.shape :  (1205, 3)
copy_superpoint_ref_corr_points.shape :  (1205, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1205, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1205, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1205])
best_index :  1484
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1205, 3)
transformed_src_superpoints.shape :  torch.Size([1205, 3])
residual.shape :  torch.Size([1205])
batch_inlier_masks.shape :  torch.Size([1205])
batch_outlier_masks.shape :  torch.Size([1205])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1193])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01374405  0.01077697  0.14136988]
 [-0.01374405  0.01077697  0.14136988]
 [-0.01464023  0.0179652   0.15180361]]
len(transformed_superpoints_pcd) :  1288
copy_superpoint_src_corr_points.shape :  (1193, 3)
mask.shape :  (1193,)
copy_superpoint_src_corr_points.shape :  (1189, 3)
copy_superpoint_ref_corr_points.shape :  (1189, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1189, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1189, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1189])
best_index :  1534
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1189, 3)
transformed_src_superpoints.shape :  torch.Size([1189, 3])
residual.shape :  torch.Size([1189])
batch_inlier_masks.shape :  torch.Size([1189])
batch_outlier_masks.shape :  torch.Size([1189])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1177])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00909657  0.016558    0.14985561]
 [-0.0118763   0.01450388  0.14577335]
 [-0.0151239   0.01039781  0.14460343]]
len(transformed_superpoints_pcd) :  1300
copy_superpoint_src_corr_points.shape :  (1177, 3)
mask.shape :  (1177,)
copy_superpoint_src_corr_points.shape :  (1171, 3)
copy_superpoint_ref_corr_points.shape :  (1171, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1171, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1171, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1171])
best_index :  1942
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1171, 3)
transformed_src_superpoints.shape :  torch.Size([1171, 3])
residual.shape :  torch.Size([1171])
batch_inlier_masks.shape :  torch.Size([1171])
batch_outlier_masks.shape :  torch.Size([1171])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([1159])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.02412875 -0.03270097  0.09260179]
 [ 0.01913668 -0.03411365  0.08346304]
 [ 0.02887674 -0.03485419  0.08400411]]
len(transformed_superpoints_pcd) :  1312
copy_superpoint_src_corr_points.shape :  (1159, 3)
mask.shape :  (1159,)
copy_superpoint_src_corr_points.shape :  (1159, 3)
copy_superpoint_ref_corr_points.shape :  (1159, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1159, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1159, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1159])
best_index :  1182
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1159, 3)
transformed_src_superpoints.shape :  torch.Size([1159, 3])
residual.shape :  torch.Size([1159])
batch_inlier_masks.shape :  torch.Size([1159])
batch_outlier_masks.shape :  torch.Size([1159])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([1148])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00333787 -0.04369549  0.02679595]
 [-0.02059823 -0.0450324   0.02956728]
 [-0.02059823 -0.0450324   0.02956728]]
len(transformed_superpoints_pcd) :  1323
copy_superpoint_src_corr_points.shape :  (1148, 3)
mask.shape :  (1148,)
copy_superpoint_src_corr_points.shape :  (1028, 3)
copy_superpoint_ref_corr_points.shape :  (1028, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1028, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1028, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1028])
best_index :  1264
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1028, 3)
transformed_src_superpoints.shape :  torch.Size([1028, 3])
residual.shape :  torch.Size([1028])
batch_inlier_masks.shape :  torch.Size([1028])
batch_outlier_masks.shape :  torch.Size([1028])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([1017])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00555007  0.05569734 -0.08751114]
 [-0.01100047  0.054073   -0.08678278]
 [-0.01100047  0.054073   -0.08678278]]
len(transformed_superpoints_pcd) :  1334
copy_superpoint_src_corr_points.shape :  (1017, 3)
mask.shape :  (1017,)
copy_superpoint_src_corr_points.shape :  (1017, 3)
copy_superpoint_ref_corr_points.shape :  (1017, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1017, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1017, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1017])
best_index :  1339
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1017, 3)
transformed_src_superpoints.shape :  torch.Size([1017, 3])
residual.shape :  torch.Size([1017])
batch_inlier_masks.shape :  torch.Size([1017])
batch_outlier_masks.shape :  torch.Size([1017])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([1006])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.02102197 -0.09465336 -0.07883584]
 [ 0.01955075 -0.09572294 -0.08392451]
 [ 0.01466814 -0.09662127 -0.08291895]]
len(transformed_superpoints_pcd) :  1345
copy_superpoint_src_corr_points.shape :  (1006, 3)
mask.shape :  (1006,)
copy_superpoint_src_corr_points.shape :  (1006, 3)
copy_superpoint_ref_corr_points.shape :  (1006, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1006, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1006, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1006])
best_index :  1641
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1006, 3)
transformed_src_superpoints.shape :  torch.Size([1006, 3])
residual.shape :  torch.Size([1006])
batch_inlier_masks.shape :  torch.Size([1006])
batch_outlier_masks.shape :  torch.Size([1006])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([995])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00927406  0.05541264 -0.08067259]
 [-0.00091347  0.05492853 -0.07995896]
 [-0.00685837  0.06130394 -0.07966707]]
len(transformed_superpoints_pcd) :  1356
copy_superpoint_src_corr_points.shape :  (995, 3)
mask.shape :  (995,)
copy_superpoint_src_corr_points.shape :  (908, 3)
copy_superpoint_ref_corr_points.shape :  (908, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([908, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 908, 3])
batch_inlier_masks.shape :  torch.Size([2000, 908])
best_index :  1741
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (908, 3)
transformed_src_superpoints.shape :  torch.Size([908, 3])
residual.shape :  torch.Size([908])
batch_inlier_masks.shape :  torch.Size([908])
batch_outlier_masks.shape :  torch.Size([908])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([897])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00524735  0.03153972 -0.09695172]
 [-0.00707902  0.03720786 -0.09479234]
 [-0.01276655  0.03649274 -0.09544227]]
len(transformed_superpoints_pcd) :  1367
copy_superpoint_src_corr_points.shape :  (897, 3)
mask.shape :  (897,)
copy_superpoint_src_corr_points.shape :  (887, 3)
copy_superpoint_ref_corr_points.shape :  (887, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([887, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 887, 3])
batch_inlier_masks.shape :  torch.Size([2000, 887])
best_index :  1882
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (887, 3)
transformed_src_superpoints.shape :  torch.Size([887, 3])
residual.shape :  torch.Size([887])
batch_inlier_masks.shape :  torch.Size([887])
batch_outlier_masks.shape :  torch.Size([887])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([876])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00839682  0.00388949  0.10737368]
 [-0.00878843  0.00479043  0.11313896]
 [-0.00253684  0.00463014  0.11247299]]
len(transformed_superpoints_pcd) :  1378
copy_superpoint_src_corr_points.shape :  (876, 3)
mask.shape :  (876,)
copy_superpoint_src_corr_points.shape :  (875, 3)
copy_superpoint_ref_corr_points.shape :  (875, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([875, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 875, 3])
batch_inlier_masks.shape :  torch.Size([2000, 875])
best_index :  489
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (875, 3)
transformed_src_superpoints.shape :  torch.Size([875, 3])
residual.shape :  torch.Size([875])
batch_inlier_masks.shape :  torch.Size([875])
batch_outlier_masks.shape :  torch.Size([875])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([865])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01202412 -0.03831375  0.04215041]
 [-0.01642632 -0.03729354  0.03549884]
 [-0.01642632 -0.03729354  0.03549884]]
len(transformed_superpoints_pcd) :  1388
copy_superpoint_src_corr_points.shape :  (865, 3)
mask.shape :  (865,)
copy_superpoint_src_corr_points.shape :  (777, 3)
copy_superpoint_ref_corr_points.shape :  (777, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([777, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 777, 3])
batch_inlier_masks.shape :  torch.Size([2000, 777])
best_index :  1697
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (777, 3)
transformed_src_superpoints.shape :  torch.Size([777, 3])
residual.shape :  torch.Size([777])
batch_inlier_masks.shape :  torch.Size([777])
batch_outlier_masks.shape :  torch.Size([777])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([767])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.0213402  -0.04407239  0.0238594 ]
 [-0.02403046 -0.03732664  0.0286622 ]
 [-0.02403046 -0.03732664  0.0286622 ]]
len(transformed_superpoints_pcd) :  1398
copy_superpoint_src_corr_points.shape :  (767, 3)
mask.shape :  (767,)
copy_superpoint_src_corr_points.shape :  (753, 3)
copy_superpoint_ref_corr_points.shape :  (753, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([753, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 753, 3])
batch_inlier_masks.shape :  torch.Size([2000, 753])
best_index :  1709
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (753, 3)
transformed_src_superpoints.shape :  torch.Size([753, 3])
residual.shape :  torch.Size([753])
batch_inlier_masks.shape :  torch.Size([753])
batch_outlier_masks.shape :  torch.Size([753])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([743])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01734392 -0.09560956 -0.08350976]
 [ 0.02113573 -0.09543115 -0.07922016]
 [ 0.01736825 -0.09572619 -0.08861209]]
len(transformed_superpoints_pcd) :  1408
copy_superpoint_src_corr_points.shape :  (743, 3)
mask.shape :  (743,)
copy_superpoint_src_corr_points.shape :  (742, 3)
copy_superpoint_ref_corr_points.shape :  (742, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([742, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 742, 3])
batch_inlier_masks.shape :  torch.Size([2000, 742])
best_index :  1944
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (742, 3)
transformed_src_superpoints.shape :  torch.Size([742, 3])
residual.shape :  torch.Size([742])
batch_inlier_masks.shape :  torch.Size([742])
batch_outlier_masks.shape :  torch.Size([742])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([732])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.0789851   0.01271959  0.02221475]
 [ 0.08363219  0.01436063  0.0267754 ]
 [ 0.07954399  0.00412301  0.02825196]]
len(transformed_superpoints_pcd) :  1418
copy_superpoint_src_corr_points.shape :  (732, 3)
mask.shape :  (732,)
copy_superpoint_src_corr_points.shape :  (731, 3)
copy_superpoint_ref_corr_points.shape :  (731, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([731, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 731, 3])
batch_inlier_masks.shape :  torch.Size([2000, 731])
best_index :  320
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (731, 3)
transformed_src_superpoints.shape :  torch.Size([731, 3])
residual.shape :  torch.Size([731])
batch_inlier_masks.shape :  torch.Size([731])
batch_outlier_masks.shape :  torch.Size([731])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([722])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.0184361  -0.00118714 -0.09085695]
 [-0.00456055 -0.03283035  0.03788085]
 [-0.00456055 -0.03283035  0.03788085]]
len(transformed_superpoints_pcd) :  1427
copy_superpoint_src_corr_points.shape :  (722, 3)
mask.shape :  (722,)
copy_superpoint_src_corr_points.shape :  (575, 3)
copy_superpoint_ref_corr_points.shape :  (575, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([575, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 575, 3])
batch_inlier_masks.shape :  torch.Size([2000, 575])
best_index :  1325
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (575, 3)
transformed_src_superpoints.shape :  torch.Size([575, 3])
residual.shape :  torch.Size([575])
batch_inlier_masks.shape :  torch.Size([575])
batch_outlier_masks.shape :  torch.Size([575])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([566])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01645663 -0.09557183 -0.0818136 ]
 [ 0.02059822 -0.09808994 -0.07728958]
 [ 0.01645663 -0.09557183 -0.0818136 ]]
len(transformed_superpoints_pcd) :  1436
copy_superpoint_src_corr_points.shape :  (566, 3)
mask.shape :  (566,)
copy_superpoint_src_corr_points.shape :  (566, 3)
copy_superpoint_ref_corr_points.shape :  (566, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([566, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 566, 3])
batch_inlier_masks.shape :  torch.Size([2000, 566])
best_index :  1863
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (566, 3)
transformed_src_superpoints.shape :  torch.Size([566, 3])
residual.shape :  torch.Size([566])
batch_inlier_masks.shape :  torch.Size([566])
batch_outlier_masks.shape :  torch.Size([566])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([557])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03887291  0.02629442  0.06908529]
 [ 0.04097072  0.0178457   0.07595101]
 [ 0.03646624  0.02631021  0.0777141 ]]
len(transformed_superpoints_pcd) :  1445
copy_superpoint_src_corr_points.shape :  (557, 3)
mask.shape :  (557,)
copy_superpoint_src_corr_points.shape :  (557, 3)
copy_superpoint_ref_corr_points.shape :  (557, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([557, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 557, 3])
batch_inlier_masks.shape :  torch.Size([2000, 557])
best_index :  374
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (557, 3)
transformed_src_superpoints.shape :  torch.Size([557, 3])
residual.shape :  torch.Size([557])
batch_inlier_masks.shape :  torch.Size([557])
batch_outlier_masks.shape :  torch.Size([557])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([549])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03371693  0.03497982  0.06674412]
 [ 0.0358482   0.03041779  0.06753805]
 [ 0.03371693  0.03497982  0.06674412]]
len(transformed_superpoints_pcd) :  1453
copy_superpoint_src_corr_points.shape :  (549, 3)
mask.shape :  (549,)
copy_superpoint_src_corr_points.shape :  (492, 3)
copy_superpoint_ref_corr_points.shape :  (492, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([492, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 492, 3])
batch_inlier_masks.shape :  torch.Size([2000, 492])
best_index :  296
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (492, 3)
transformed_src_superpoints.shape :  torch.Size([492, 3])
residual.shape :  torch.Size([492])
batch_inlier_masks.shape :  torch.Size([492])
batch_outlier_masks.shape :  torch.Size([492])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([485])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01568669 -0.04065298  0.02801166]
 [-0.01568669 -0.04065298  0.02801166]
 [-0.01568669 -0.04065298  0.02801166]]
len(transformed_superpoints_pcd) :  1460
copy_superpoint_src_corr_points.shape :  (485, 3)
mask.shape :  (485,)
copy_superpoint_src_corr_points.shape :  (426, 3)
copy_superpoint_ref_corr_points.shape :  (426, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([426, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 426, 3])
batch_inlier_masks.shape :  torch.Size([2000, 426])
best_index :  373
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (426, 3)
transformed_src_superpoints.shape :  torch.Size([426, 3])
residual.shape :  torch.Size([426])
batch_inlier_masks.shape :  torch.Size([426])
batch_outlier_masks.shape :  torch.Size([426])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([419])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.00365122 -0.06793625 -0.10716942]
 [ 0.00291842 -0.07444004 -0.10171079]
 [ 0.00291842 -0.07444004 -0.10171079]]
len(transformed_superpoints_pcd) :  1467
copy_superpoint_src_corr_points.shape :  (419, 3)
mask.shape :  (419,)
copy_superpoint_src_corr_points.shape :  (353, 3)
copy_superpoint_ref_corr_points.shape :  (353, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([353, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 353, 3])
batch_inlier_masks.shape :  torch.Size([2000, 353])
best_index :  1631
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (353, 3)
transformed_src_superpoints.shape :  torch.Size([353, 3])
residual.shape :  torch.Size([353])
batch_inlier_masks.shape :  torch.Size([353])
batch_outlier_masks.shape :  torch.Size([353])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([346])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03754784  0.02638267  0.07500392]
 [ 0.03754784  0.02638267  0.07500392]
 [ 0.03787575  0.02742955  0.07004681]]
len(transformed_superpoints_pcd) :  1474
copy_superpoint_src_corr_points.shape :  (346, 3)
mask.shape :  (346,)
copy_superpoint_src_corr_points.shape :  (345, 3)
copy_superpoint_ref_corr_points.shape :  (345, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([345, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 345, 3])
batch_inlier_masks.shape :  torch.Size([2000, 345])
best_index :  165
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (345, 3)
transformed_src_superpoints.shape :  torch.Size([345, 3])
residual.shape :  torch.Size([345])
batch_inlier_masks.shape :  torch.Size([345])
batch_outlier_masks.shape :  torch.Size([345])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([339])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.0156177  -0.03517818  0.06114139]
 [-0.0156177  -0.03517818  0.06114139]
 [-0.0156177  -0.03517818  0.06114139]]
len(transformed_superpoints_pcd) :  1480
copy_superpoint_src_corr_points.shape :  (339, 3)
mask.shape :  (339,)
copy_superpoint_src_corr_points.shape :  (221, 3)
copy_superpoint_ref_corr_points.shape :  (221, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([221, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 221, 3])
batch_inlier_masks.shape :  torch.Size([2000, 221])
best_index :  100
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (221, 3)
transformed_src_superpoints.shape :  torch.Size([221, 3])
residual.shape :  torch.Size([221])
batch_inlier_masks.shape :  torch.Size([221])
batch_outlier_masks.shape :  torch.Size([221])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([216])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.00709307  0.01045455  0.13987091]
 [-0.00709307  0.01045455  0.13987091]
 [-0.00723648  0.0152492   0.13289957]]
len(transformed_superpoints_pcd) :  1485
copy_superpoint_src_corr_points.shape :  (216, 3)
mask.shape :  (216,)
copy_superpoint_src_corr_points.shape :  (211, 3)
copy_superpoint_ref_corr_points.shape :  (211, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([211, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 211, 3])
batch_inlier_masks.shape :  torch.Size([2000, 211])
best_index :  375
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (211, 3)
transformed_src_superpoints.shape :  torch.Size([211, 3])
residual.shape :  torch.Size([211])
batch_inlier_masks.shape :  torch.Size([211])
batch_outlier_masks.shape :  torch.Size([211])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([206])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.02775116 -0.03306977  0.0694257 ]
 [-0.02775116 -0.03306977  0.0694257 ]
 [-0.02557867 -0.03182966  0.07455099]]
len(transformed_superpoints_pcd) :  1490
copy_superpoint_src_corr_points.shape :  (206, 3)
mask.shape :  (206,)
copy_superpoint_src_corr_points.shape :  (202, 3)
copy_superpoint_ref_corr_points.shape :  (202, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([202, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 202, 3])
batch_inlier_masks.shape :  torch.Size([2000, 202])
best_index :  1569
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (202, 3)
transformed_src_superpoints.shape :  torch.Size([202, 3])
residual.shape :  torch.Size([202])
batch_inlier_masks.shape :  torch.Size([202])
batch_outlier_masks.shape :  torch.Size([202])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([197])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01729253  0.0192748   0.1458718 ]
 [-0.022959    0.02098197  0.14720707]
 [-0.02121132  0.01596536  0.15276143]]
len(transformed_superpoints_pcd) :  1495
copy_superpoint_src_corr_points.shape :  (197, 3)
mask.shape :  (197,)
copy_superpoint_src_corr_points.shape :  (197, 3)
copy_superpoint_ref_corr_points.shape :  (197, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([197, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 197, 3])
batch_inlier_masks.shape :  torch.Size([2000, 197])
best_index :  1872
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (197, 3)
transformed_src_superpoints.shape :  torch.Size([197, 3])
residual.shape :  torch.Size([197])
batch_inlier_masks.shape :  torch.Size([197])
batch_outlier_masks.shape :  torch.Size([197])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([192])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03241386  0.03971465  0.07056579]
 [ 0.03241386  0.03971465  0.07056579]
 [ 0.03241386  0.03971465  0.07056579]]
len(transformed_superpoints_pcd) :  1500
copy_superpoint_src_corr_points.shape :  (192, 3)
mask.shape :  (192,)
copy_superpoint_src_corr_points.shape :  (181, 3)
copy_superpoint_ref_corr_points.shape :  (181, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([181, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 181, 3])
batch_inlier_masks.shape :  torch.Size([2000, 181])
best_index :  602
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (181, 3)
transformed_src_superpoints.shape :  torch.Size([181, 3])
residual.shape :  torch.Size([181])
batch_inlier_masks.shape :  torch.Size([181])
batch_outlier_masks.shape :  torch.Size([181])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([177])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.03103548  0.02992859  0.07370284]
 [ 0.03103548  0.02992859  0.07370284]
 [ 0.04078112  0.02376512  0.05984274]]
len(transformed_superpoints_pcd) :  1504
copy_superpoint_src_corr_points.shape :  (177, 3)
mask.shape :  (177,)
copy_superpoint_src_corr_points.shape :  (174, 3)
copy_superpoint_ref_corr_points.shape :  (174, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([174, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 174, 3])
batch_inlier_masks.shape :  torch.Size([2000, 174])
best_index :  621
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (174, 3)
transformed_src_superpoints.shape :  torch.Size([174, 3])
residual.shape :  torch.Size([174])
batch_inlier_masks.shape :  torch.Size([174])
batch_outlier_masks.shape :  torch.Size([174])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([170])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01293596  0.01151656  0.14282244]
 [-0.01934261  0.01178602  0.14384983]
 [-0.01054582  0.00562728  0.11927333]]
len(transformed_superpoints_pcd) :  1508
copy_superpoint_src_corr_points.shape :  (170, 3)
mask.shape :  (170,)
copy_superpoint_src_corr_points.shape :  (152, 3)
copy_superpoint_ref_corr_points.shape :  (152, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([152, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 152, 3])
batch_inlier_masks.shape :  torch.Size([2000, 152])
best_index :  1549
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (152, 3)
transformed_src_superpoints.shape :  torch.Size([152, 3])
residual.shape :  torch.Size([152])
batch_inlier_masks.shape :  torch.Size([152])
batch_outlier_masks.shape :  torch.Size([152])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([148])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [-0.01827407  0.02054675  0.14832103]
 [-0.0198231   0.01566282  0.14863539]
 [-0.0141878   0.01710858  0.14573666]]
len(transformed_superpoints_pcd) :  1512
copy_superpoint_src_corr_points.shape :  (148, 3)
mask.shape :  (148,)
copy_superpoint_src_corr_points.shape :  (148, 3)
copy_superpoint_ref_corr_points.shape :  (148, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([148, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 148, 3])
batch_inlier_masks.shape :  torch.Size([2000, 148])
best_index :  1568
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (148, 3)
transformed_src_superpoints.shape :  torch.Size([148, 3])
residual.shape :  torch.Size([148])
batch_inlier_masks.shape :  torch.Size([148])
batch_outlier_masks.shape :  torch.Size([148])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([144])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.014695   -0.09844694 -0.07696581]
 [ 0.014695   -0.09844694 -0.07696581]
 [ 0.014695   -0.09844694 -0.07696581]]
len(transformed_superpoints_pcd) :  1516
copy_superpoint_src_corr_points.shape :  (144, 3)
mask.shape :  (144,)
copy_superpoint_src_corr_points.shape :  (143, 3)
copy_superpoint_ref_corr_points.shape :  (143, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([143, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 143, 3])
batch_inlier_masks.shape :  torch.Size([2000, 143])
best_index :  1916
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (143, 3)
transformed_src_superpoints.shape :  torch.Size([143, 3])
residual.shape :  torch.Size([143])
batch_inlier_masks.shape :  torch.Size([143])
batch_outlier_masks.shape :  torch.Size([143])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([139])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.00371847 -0.02995096  0.0863049 ]
 [ 0.00371847 -0.02995096  0.0863049 ]
 [ 0.00371847 -0.02995096  0.0863049 ]]
len(transformed_superpoints_pcd) :  1520
copy_superpoint_src_corr_points.shape :  (139, 3)
mask.shape :  (139,)
copy_superpoint_src_corr_points.shape :  (139, 3)
copy_superpoint_ref_corr_points.shape :  (139, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([139, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 139, 3])
batch_inlier_masks.shape :  torch.Size([2000, 139])
best_index :  7
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (139, 3)
transformed_src_superpoints.shape :  torch.Size([139, 3])
residual.shape :  torch.Size([139])
batch_inlier_masks.shape :  torch.Size([139])
batch_outlier_masks.shape :  torch.Size([139])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([136])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01367194 -0.06492601 -0.1124684 ]
 [ 0.01367194 -0.06492601 -0.1124684 ]
 [ 0.01367194 -0.06492601 -0.1124684 ]]
len(transformed_superpoints_pcd) :  1523
copy_superpoint_src_corr_points.shape :  (136, 3)
mask.shape :  (136,)
copy_superpoint_src_corr_points.shape :  (123, 3)
copy_superpoint_ref_corr_points.shape :  (123, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([123, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 123, 3])
batch_inlier_masks.shape :  torch.Size([2000, 123])
best_index :  13
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (123, 3)
transformed_src_superpoints.shape :  torch.Size([123, 3])
residual.shape :  torch.Size([123])
batch_inlier_masks.shape :  torch.Size([123])
batch_outlier_masks.shape :  torch.Size([123])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([120])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[ 0.01454462 -0.0313906   0.09557208]
 [-0.01055267 -0.04078798  0.02868165]
 [-0.00435487 -0.04144198  0.03011582]
 ...
 [ 0.01367195 -0.06492607 -0.11246848]
 [ 0.01367195 -0.06492607 -0.11246848]
 [ 0.01367195 -0.06492607 -0.11246848]]
len(transformed_superpoints_pcd) :  1526
copy_superpoint_src_corr_points.shape :  (120, 3)
mask.shape :  (120,)
copy_superpoint_src_corr_points.shape :  (99, 3)
copy_superpoint_ref_corr_points.shape :  (99, 3)
number of unique points in pcd :  610
number of rotations used :  71
transformed_superpoints_pcd.shape :  (1625, 3)
Line set updated
116
src_points :  [[-0.06054738  0.01598621  0.00649796]
 [-0.05888807  0.02101956  0.00677015]
 [-0.05744153  0.02674964  0.00548222]
 ...
 [-0.03007121  0.03278228 -0.00571643]
 [-0.05977324  0.04011372 -0.00932015]
 [-0.00944392  0.09090971 -0.01951953]]
ref_points :  [[-0.0480451   0.01114142  0.03649884]
 [-0.04662967  0.01694856  0.03538411]
 [-0.04599096  0.02202017  0.03206855]
 ...
 [-0.05288431  0.03137596  0.01505829]
 [-0.01888511  0.08953187 -0.01455678]
 [-0.01531088  0.09004635 -0.0232492 ]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([3034, 3])
lengths :  tensor([1514, 1520])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([1803, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([544, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([278, 3])
ref_points_f.shape :  torch.Size([1514, 3])
src_points_c.shape :  torch.Size([266, 3])
src_points_f.shape :  torch.Size([1520, 3])
ref_node_masks.shape :  torch.Size([278])
ref_node_knn_indices.shape :  torch.Size([278, 5])
ref_node_knn_masks.shape :  torch.Size([278, 5])
src_node_masks.shape :  torch.Size([266])
src_node_knn_indices.shape :  torch.Size([266, 5])
src_node_knn_masks.shape :  torch.Size([266, 5])
ref_node_knn_points.shape :  torch.Size([278, 5, 3])
src_node_knn_points.shape :  torch.Size([266, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([544, 512])
feats_f :  torch.Size([3034, 256])
k :  3
omegas.shape :  torch.Size([77284, 128, 1])
omegas.shape :  torch.Size([231852, 128, 1])
k :  3
omegas.shape :  torch.Size([70756, 128, 1])
omegas.shape :  torch.Size([212268, 128, 1])
ref_feats_c.shape :  torch.Size([1, 278, 256])
src_feats_c.shape :  torch.Size([1, 266, 256])
ref_feats_c_norm.shape :  torch.Size([278, 256])
src_feats_c_norm.shape :  torch.Size([266, 256])
ref_node_masks.shape :  torch.Size([278])
src_node_masks.shape :  torch.Size([266])
self.num_correspondences :  2000
matching_scores.numel() :  73948
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([20396])
ref_indices.shape :  torch.Size([20396])
src_indices.shape :  torch.Size([20396])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([2, 3, 3,  ..., 3, 3, 3], device='cuda:0')
src_indices :  tensor([1, 0, 1,  ..., 1, 3, 4], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([20396, 3])
global_src_corr_points.shape :  torch.Size([20396, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([1999, 4, 4])
src_corr_points.shape :  torch.Size([20396, 3])
ref_corr_points.shape :  torch.Size([1, 20396, 3])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 20396, 3])
batch_corr_residuals.shape :  torch.Size([1999, 20396])
batch_inlier_masks.shape :  torch.Size([1999, 20396])
best_index :  tensor(286, device='cuda:0')
len(batch_transforms) :  1999
estimated_transform :  [[ 9.95766938e-01 -9.18799266e-02  2.43101432e-03 -1.68824568e-03]
 [ 9.18425694e-02  9.95694220e-01  1.25744045e-02  5.36181033e-04]
 [-3.57590988e-03 -1.22979134e-02  9.99918044e-01  6.69036526e-04]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000000e+00]]
sorted_indices :  [1570 1864 1991 ...  515 1836  286]
superpoint_src_corr_points.shape :  (20396, 3)
superpoint_ref_corr_points.shape :  (20396, 3)
batch_inlier_masks.shape :  (1999, 20396)
batch_transforms.shape :  (1999, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([20396, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 20396, 3])
batch_inlier_masks.shape :  torch.Size([1999, 20396])
best_index :  1836
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (20396, 3)
transformed_src_superpoints.shape :  torch.Size([20396, 3])
residual.shape :  torch.Size([20396])
batch_inlier_masks.shape :  torch.Size([20396])
batch_outlier_masks.shape :  torch.Size([20396])
indices_inliers.shape :  torch.Size([367])
indices_outliers.shape :  torch.Size([20029])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([367, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.03659064 -0.03469564  0.00966939]
 [-0.03438846 -0.03043276  0.0114096 ]
 [-0.03260043 -0.02369736  0.01074887]]
len(transformed_superpoints_pcd) :  367
copy_superpoint_src_corr_points.shape :  (20029, 3)
mask.shape :  (20029,)
copy_superpoint_src_corr_points.shape :  (13132, 3)
copy_superpoint_ref_corr_points.shape :  (13132, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13132, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 13132, 3])
batch_inlier_masks.shape :  torch.Size([1999, 13132])
best_index :  689
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13132, 3)
transformed_src_superpoints.shape :  torch.Size([13132, 3])
residual.shape :  torch.Size([13132])
batch_inlier_masks.shape :  torch.Size([13132])
batch_outlier_masks.shape :  torch.Size([13132])
indices_inliers.shape :  torch.Size([190])
indices_outliers.shape :  torch.Size([12942])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([190, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.04806074 -0.05025732  0.01272871]
 [-0.04512647 -0.05221198  0.01655953]
 [-0.04806074 -0.05025732  0.01272871]]
len(transformed_superpoints_pcd) :  557
copy_superpoint_src_corr_points.shape :  (12942, 3)
mask.shape :  (12942,)
copy_superpoint_src_corr_points.shape :  (9847, 3)
copy_superpoint_ref_corr_points.shape :  (9847, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9847, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 9847, 3])
batch_inlier_masks.shape :  torch.Size([1999, 9847])
best_index :  1490
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9847, 3)
transformed_src_superpoints.shape :  torch.Size([9847, 3])
residual.shape :  torch.Size([9847])
batch_inlier_masks.shape :  torch.Size([9847])
batch_outlier_masks.shape :  torch.Size([9847])
indices_inliers.shape :  torch.Size([131])
indices_outliers.shape :  torch.Size([9716])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([131, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.03412662  0.05269955 -0.01864615]
 [-0.03591169  0.04911657 -0.014362  ]
 [-0.03438498  0.048572   -0.00793603]]
len(transformed_superpoints_pcd) :  688
copy_superpoint_src_corr_points.shape :  (9716, 3)
mask.shape :  (9716,)
copy_superpoint_src_corr_points.shape :  (7952, 3)
copy_superpoint_ref_corr_points.shape :  (7952, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7952, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 7952, 3])
batch_inlier_masks.shape :  torch.Size([1999, 7952])
best_index :  253
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7952, 3)
transformed_src_superpoints.shape :  torch.Size([7952, 3])
residual.shape :  torch.Size([7952])
batch_inlier_masks.shape :  torch.Size([7952])
batch_outlier_masks.shape :  torch.Size([7952])
indices_inliers.shape :  torch.Size([82])
indices_outliers.shape :  torch.Size([7870])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([82, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.01020719 -0.02438643  0.02440728]
 [-0.00428563 -0.02747919  0.02575135]
 [-0.01020719 -0.02438643  0.02440728]]
len(transformed_superpoints_pcd) :  770
copy_superpoint_src_corr_points.shape :  (7870, 3)
mask.shape :  (7870,)
copy_superpoint_src_corr_points.shape :  (6319, 3)
copy_superpoint_ref_corr_points.shape :  (6319, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6319, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 6319, 3])
batch_inlier_masks.shape :  torch.Size([1999, 6319])
best_index :  513
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6319, 3)
transformed_src_superpoints.shape :  torch.Size([6319, 3])
residual.shape :  torch.Size([6319])
batch_inlier_masks.shape :  torch.Size([6319])
batch_outlier_masks.shape :  torch.Size([6319])
indices_inliers.shape :  torch.Size([71])
indices_outliers.shape :  torch.Size([6248])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([71, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.01756261 -0.08430465  0.00989822]
 [-0.01709448 -0.08072183  0.00569347]
 [-0.01709448 -0.08072183  0.00569347]]
len(transformed_superpoints_pcd) :  841
copy_superpoint_src_corr_points.shape :  (6248, 3)
mask.shape :  (6248,)
copy_superpoint_src_corr_points.shape :  (5309, 3)
copy_superpoint_ref_corr_points.shape :  (5309, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5309, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 5309, 3])
batch_inlier_masks.shape :  torch.Size([1999, 5309])
best_index :  1605
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5309, 3)
transformed_src_superpoints.shape :  torch.Size([5309, 3])
residual.shape :  torch.Size([5309])
batch_inlier_masks.shape :  torch.Size([5309])
batch_outlier_masks.shape :  torch.Size([5309])
indices_inliers.shape :  torch.Size([64])
indices_outliers.shape :  torch.Size([5245])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([64, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.03070259  0.07753468 -0.02988666]
 [-0.03330072  0.0606838  -0.03591562]
 [-0.03008715  0.06653684 -0.04163427]]
len(transformed_superpoints_pcd) :  905
copy_superpoint_src_corr_points.shape :  (5245, 3)
mask.shape :  (5245,)
copy_superpoint_src_corr_points.shape :  (4935, 3)
copy_superpoint_ref_corr_points.shape :  (4935, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4935, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 4935, 3])
batch_inlier_masks.shape :  torch.Size([1999, 4935])
best_index :  661
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4935, 3)
transformed_src_superpoints.shape :  torch.Size([4935, 3])
residual.shape :  torch.Size([4935])
batch_inlier_masks.shape :  torch.Size([4935])
batch_outlier_masks.shape :  torch.Size([4935])
indices_inliers.shape :  torch.Size([56])
indices_outliers.shape :  torch.Size([4879])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([56, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.03620555  0.06740931 -0.00781343]
 [-0.0320894   0.07712997 -0.01018498]
 [-0.03255436  0.06675443 -0.01526728]]
len(transformed_superpoints_pcd) :  961
copy_superpoint_src_corr_points.shape :  (4879, 3)
mask.shape :  (4879,)
copy_superpoint_src_corr_points.shape :  (4138, 3)
copy_superpoint_ref_corr_points.shape :  (4138, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4138, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 4138, 3])
batch_inlier_masks.shape :  torch.Size([1999, 4138])
best_index :  17
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4138, 3)
transformed_src_superpoints.shape :  torch.Size([4138, 3])
residual.shape :  torch.Size([4138])
batch_inlier_masks.shape :  torch.Size([4138])
batch_outlier_masks.shape :  torch.Size([4138])
indices_inliers.shape :  torch.Size([51])
indices_outliers.shape :  torch.Size([4087])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([51, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.06118781 -0.00255911  0.0200496 ]
 [-0.06118781 -0.00255911  0.0200496 ]
 [ 0.00796248 -0.0139957   0.0179618 ]]
len(transformed_superpoints_pcd) :  1012
copy_superpoint_src_corr_points.shape :  (4087, 3)
mask.shape :  (4087,)
copy_superpoint_src_corr_points.shape :  (3135, 3)
copy_superpoint_ref_corr_points.shape :  (3135, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3135, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 3135, 3])
batch_inlier_masks.shape :  torch.Size([1999, 3135])
best_index :  697
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3135, 3)
transformed_src_superpoints.shape :  torch.Size([3135, 3])
residual.shape :  torch.Size([3135])
batch_inlier_masks.shape :  torch.Size([3135])
batch_outlier_masks.shape :  torch.Size([3135])
indices_inliers.shape :  torch.Size([47])
indices_outliers.shape :  torch.Size([3088])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([47, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.06460284 -0.00516491  0.02471916]
 [-0.06032141  0.00138376  0.02695864]
 [-0.06001591 -0.0035447   0.02817624]]
len(transformed_superpoints_pcd) :  1059
copy_superpoint_src_corr_points.shape :  (3088, 3)
mask.shape :  (3088,)
copy_superpoint_src_corr_points.shape :  (2561, 3)
copy_superpoint_ref_corr_points.shape :  (2561, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2561, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 2561, 3])
batch_inlier_masks.shape :  torch.Size([1999, 2561])
best_index :  1333
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2561, 3)
transformed_src_superpoints.shape :  torch.Size([2561, 3])
residual.shape :  torch.Size([2561])
batch_inlier_masks.shape :  torch.Size([2561])
batch_outlier_masks.shape :  torch.Size([2561])
indices_inliers.shape :  torch.Size([37])
indices_outliers.shape :  torch.Size([2524])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([37, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.0551749  -0.05572187  0.01077398]
 [-0.05476423 -0.05090706  0.00790665]
 [-0.05587903 -0.06087274  0.00766467]]
len(transformed_superpoints_pcd) :  1096
copy_superpoint_src_corr_points.shape :  (2524, 3)
mask.shape :  (2524,)
copy_superpoint_src_corr_points.shape :  (2383, 3)
copy_superpoint_ref_corr_points.shape :  (2383, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2383, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 2383, 3])
batch_inlier_masks.shape :  torch.Size([1999, 2383])
best_index :  1464
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2383, 3)
transformed_src_superpoints.shape :  torch.Size([2383, 3])
residual.shape :  torch.Size([2383])
batch_inlier_masks.shape :  torch.Size([2383])
batch_outlier_masks.shape :  torch.Size([2383])
indices_inliers.shape :  torch.Size([36])
indices_outliers.shape :  torch.Size([2347])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([36, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.01379017  0.05946202 -0.0454701 ]
 [ 0.00088168  0.05290714 -0.04668535]
 [-0.00354755  0.05037209 -0.04738469]]
len(transformed_superpoints_pcd) :  1132
copy_superpoint_src_corr_points.shape :  (2347, 3)
mask.shape :  (2347,)
copy_superpoint_src_corr_points.shape :  (2071, 3)
copy_superpoint_ref_corr_points.shape :  (2071, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2071, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 2071, 3])
batch_inlier_masks.shape :  torch.Size([1999, 2071])
best_index :  1624
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2071, 3)
transformed_src_superpoints.shape :  torch.Size([2071, 3])
residual.shape :  torch.Size([2071])
batch_inlier_masks.shape :  torch.Size([2071])
batch_outlier_masks.shape :  torch.Size([2071])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([2043])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.01708938  0.07081199 -0.05072555]
 [-0.01811599  0.06484076 -0.05014607]
 [-0.01346355  0.06571364 -0.05207028]]
len(transformed_superpoints_pcd) :  1160
copy_superpoint_src_corr_points.shape :  (2043, 3)
mask.shape :  (2043,)
copy_superpoint_src_corr_points.shape :  (1867, 3)
copy_superpoint_ref_corr_points.shape :  (1867, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1867, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1867, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1867])
best_index :  1886
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1867, 3)
transformed_src_superpoints.shape :  torch.Size([1867, 3])
residual.shape :  torch.Size([1867])
batch_inlier_masks.shape :  torch.Size([1867])
batch_outlier_masks.shape :  torch.Size([1867])
indices_inliers.shape :  torch.Size([25])
indices_outliers.shape :  torch.Size([1842])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([25, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.01948563 -0.05712623 -0.00642662]
 [ 0.01556163 -0.0587269  -0.01057143]
 [ 0.01948563 -0.05712623 -0.00642662]]
len(transformed_superpoints_pcd) :  1185
copy_superpoint_src_corr_points.shape :  (1842, 3)
mask.shape :  (1842,)
copy_superpoint_src_corr_points.shape :  (1556, 3)
copy_superpoint_ref_corr_points.shape :  (1556, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1556, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1556, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1556])
best_index :  75
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1556, 3)
transformed_src_superpoints.shape :  torch.Size([1556, 3])
residual.shape :  torch.Size([1556])
batch_inlier_masks.shape :  torch.Size([1556])
batch_outlier_masks.shape :  torch.Size([1556])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([1534])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.03896198  0.00244629 -0.02221175]
 [-0.03813648  0.00901532 -0.0231972 ]
 [-0.04252591  0.01021491 -0.02011533]]
len(transformed_superpoints_pcd) :  1207
copy_superpoint_src_corr_points.shape :  (1534, 3)
mask.shape :  (1534,)
copy_superpoint_src_corr_points.shape :  (1327, 3)
copy_superpoint_ref_corr_points.shape :  (1327, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1327, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1327, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1327])
best_index :  1153
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1327, 3)
transformed_src_superpoints.shape :  torch.Size([1327, 3])
residual.shape :  torch.Size([1327])
batch_inlier_masks.shape :  torch.Size([1327])
batch_outlier_masks.shape :  torch.Size([1327])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([1306])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.03981283 -0.08091606  0.00778272]
 [-0.07762923  0.00377221  0.02031013]
 [-0.07789952  0.00455315  0.02531577]]
len(transformed_superpoints_pcd) :  1228
copy_superpoint_src_corr_points.shape :  (1306, 3)
mask.shape :  (1306,)
copy_superpoint_src_corr_points.shape :  (1290, 3)
copy_superpoint_ref_corr_points.shape :  (1290, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1290, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1290, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1290])
best_index :  93
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1290, 3)
transformed_src_superpoints.shape :  torch.Size([1290, 3])
residual.shape :  torch.Size([1290])
batch_inlier_masks.shape :  torch.Size([1290])
batch_outlier_masks.shape :  torch.Size([1290])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([1270])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.01682921  0.07293167 -0.04635624]
 [ 0.01360602  0.08123204 -0.04363082]
 [ 0.01230648  0.08255981 -0.04958674]]
len(transformed_superpoints_pcd) :  1248
copy_superpoint_src_corr_points.shape :  (1270, 3)
mask.shape :  (1270,)
copy_superpoint_src_corr_points.shape :  (1180, 3)
copy_superpoint_ref_corr_points.shape :  (1180, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1180, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 1180, 3])
batch_inlier_masks.shape :  torch.Size([1999, 1180])
best_index :  748
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1180, 3)
transformed_src_superpoints.shape :  torch.Size([1180, 3])
residual.shape :  torch.Size([1180])
batch_inlier_masks.shape :  torch.Size([1180])
batch_outlier_masks.shape :  torch.Size([1180])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([1162])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.02051714  0.04985997 -0.04829575]
 [-0.01109593  0.05672118 -0.05060947]
 [-0.00224757  0.0640808  -0.05087526]]
len(transformed_superpoints_pcd) :  1266
copy_superpoint_src_corr_points.shape :  (1162, 3)
mask.shape :  (1162,)
copy_superpoint_src_corr_points.shape :  (989, 3)
copy_superpoint_ref_corr_points.shape :  (989, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([989, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 989, 3])
batch_inlier_masks.shape :  torch.Size([1999, 989])
best_index :  1626
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (989, 3)
transformed_src_superpoints.shape :  torch.Size([989, 3])
residual.shape :  torch.Size([989])
batch_inlier_masks.shape :  torch.Size([989])
batch_outlier_masks.shape :  torch.Size([989])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([972])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.06583247 -0.00165346  0.0218719 ]
 [-0.0646532  -0.00093068  0.01606985]
 [-0.06129998 -0.0030297   0.02024926]]
len(transformed_superpoints_pcd) :  1283
copy_superpoint_src_corr_points.shape :  (972, 3)
mask.shape :  (972,)
copy_superpoint_src_corr_points.shape :  (898, 3)
copy_superpoint_ref_corr_points.shape :  (898, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([898, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 898, 3])
batch_inlier_masks.shape :  torch.Size([1999, 898])
best_index :  1900
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (898, 3)
transformed_src_superpoints.shape :  torch.Size([898, 3])
residual.shape :  torch.Size([898])
batch_inlier_masks.shape :  torch.Size([898])
batch_outlier_masks.shape :  torch.Size([898])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([883])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.0094547  -0.05792344 -0.00584402]
 [ 0.00608383 -0.05527826 -0.00964626]
 [ 0.00383647 -0.05747992 -0.00570766]]
len(transformed_superpoints_pcd) :  1298
copy_superpoint_src_corr_points.shape :  (883, 3)
mask.shape :  (883,)
copy_superpoint_src_corr_points.shape :  (825, 3)
copy_superpoint_ref_corr_points.shape :  (825, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([825, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 825, 3])
batch_inlier_masks.shape :  torch.Size([1999, 825])
best_index :  1988
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (825, 3)
transformed_src_superpoints.shape :  torch.Size([825, 3])
residual.shape :  torch.Size([825])
batch_inlier_masks.shape :  torch.Size([825])
batch_outlier_masks.shape :  torch.Size([825])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([810])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.00742344 -0.03576435  0.02505027]
 [-0.00444553 -0.04351146  0.0257116 ]
 [-0.01032218 -0.04615828  0.02448175]]
len(transformed_superpoints_pcd) :  1313
copy_superpoint_src_corr_points.shape :  (810, 3)
mask.shape :  (810,)
copy_superpoint_src_corr_points.shape :  (776, 3)
copy_superpoint_ref_corr_points.shape :  (776, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([776, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 776, 3])
batch_inlier_masks.shape :  torch.Size([1999, 776])
best_index :  1904
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (776, 3)
transformed_src_superpoints.shape :  torch.Size([776, 3])
residual.shape :  torch.Size([776])
batch_inlier_masks.shape :  torch.Size([776])
batch_outlier_masks.shape :  torch.Size([776])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([762])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.02439105 -0.00352155  0.01931567]
 [ 0.02407734 -0.00815281  0.01590518]
 [ 0.02439105 -0.00352155  0.01931567]]
len(transformed_superpoints_pcd) :  1327
copy_superpoint_src_corr_points.shape :  (762, 3)
mask.shape :  (762,)
copy_superpoint_src_corr_points.shape :  (574, 3)
copy_superpoint_ref_corr_points.shape :  (574, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([574, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 574, 3])
batch_inlier_masks.shape :  torch.Size([1999, 574])
best_index :  1711
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (574, 3)
transformed_src_superpoints.shape :  torch.Size([574, 3])
residual.shape :  torch.Size([574])
batch_inlier_masks.shape :  torch.Size([574])
batch_outlier_masks.shape :  torch.Size([574])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([561])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.01185301 -0.02783267  0.02428102]
 [-0.01116865 -0.02062856  0.02202214]
 [-0.01648718 -0.021531    0.02141244]]
len(transformed_superpoints_pcd) :  1340
copy_superpoint_src_corr_points.shape :  (561, 3)
mask.shape :  (561,)
copy_superpoint_src_corr_points.shape :  (538, 3)
copy_superpoint_ref_corr_points.shape :  (538, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([538, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 538, 3])
batch_inlier_masks.shape :  torch.Size([1999, 538])
best_index :  286
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (538, 3)
transformed_src_superpoints.shape :  torch.Size([538, 3])
residual.shape :  torch.Size([538])
batch_inlier_masks.shape :  torch.Size([538])
batch_outlier_masks.shape :  torch.Size([538])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([527])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.01377149  0.07321562 -0.03452389]
 [ 0.01377149  0.07321562 -0.03452389]
 [ 0.01377149  0.07321562 -0.03452389]]
len(transformed_superpoints_pcd) :  1351
copy_superpoint_src_corr_points.shape :  (527, 3)
mask.shape :  (527,)
copy_superpoint_src_corr_points.shape :  (482, 3)
copy_superpoint_ref_corr_points.shape :  (482, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([482, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 482, 3])
batch_inlier_masks.shape :  torch.Size([1999, 482])
best_index :  655
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (482, 3)
transformed_src_superpoints.shape :  torch.Size([482, 3])
residual.shape :  torch.Size([482])
batch_inlier_masks.shape :  torch.Size([482])
batch_outlier_masks.shape :  torch.Size([482])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([471])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.00987026 -0.00712343  0.02561033]
 [ 0.00987026 -0.00712343  0.02561033]
 [ 0.00987026 -0.00712343  0.02561033]]
len(transformed_superpoints_pcd) :  1362
copy_superpoint_src_corr_points.shape :  (471, 3)
mask.shape :  (471,)
copy_superpoint_src_corr_points.shape :  (344, 3)
copy_superpoint_ref_corr_points.shape :  (344, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([344, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 344, 3])
batch_inlier_masks.shape :  torch.Size([1999, 344])
best_index :  1748
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (344, 3)
transformed_src_superpoints.shape :  torch.Size([344, 3])
residual.shape :  torch.Size([344])
batch_inlier_masks.shape :  torch.Size([344])
batch_outlier_masks.shape :  torch.Size([344])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([333])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.02817177 -0.08401296  0.01033091]
 [-0.02594396 -0.08519786  0.01504831]
 [-0.02082887 -0.08361942  0.01125309]]
len(transformed_superpoints_pcd) :  1373
copy_superpoint_src_corr_points.shape :  (333, 3)
mask.shape :  (333,)
copy_superpoint_src_corr_points.shape :  (279, 3)
copy_superpoint_ref_corr_points.shape :  (279, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([279, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 279, 3])
batch_inlier_masks.shape :  torch.Size([1999, 279])
best_index :  1783
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (279, 3)
transformed_src_superpoints.shape :  torch.Size([279, 3])
residual.shape :  torch.Size([279])
batch_inlier_masks.shape :  torch.Size([279])
batch_outlier_masks.shape :  torch.Size([279])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([269])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.02546742 -0.08166575  0.04085312]
 [-0.02140807 -0.0819639   0.03737199]
 [-0.02357625 -0.08198266  0.03013273]]
len(transformed_superpoints_pcd) :  1383
copy_superpoint_src_corr_points.shape :  (269, 3)
mask.shape :  (269,)
copy_superpoint_src_corr_points.shape :  (267, 3)
copy_superpoint_ref_corr_points.shape :  (267, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([267, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 267, 3])
batch_inlier_masks.shape :  torch.Size([1999, 267])
best_index :  1864
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (267, 3)
transformed_src_superpoints.shape :  torch.Size([267, 3])
residual.shape :  torch.Size([267])
batch_inlier_masks.shape :  torch.Size([267])
batch_outlier_masks.shape :  torch.Size([267])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([257])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.01229993  0.0905955  -0.02690422]
 [ 0.01577177  0.08994105 -0.02286964]
 [ 0.01346457  0.09095383 -0.01725568]]
len(transformed_superpoints_pcd) :  1393
copy_superpoint_src_corr_points.shape :  (257, 3)
mask.shape :  (257,)
copy_superpoint_src_corr_points.shape :  (256, 3)
copy_superpoint_ref_corr_points.shape :  (256, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([256, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 256, 3])
batch_inlier_masks.shape :  torch.Size([1999, 256])
best_index :  1877
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (256, 3)
transformed_src_superpoints.shape :  torch.Size([256, 3])
residual.shape :  torch.Size([256])
batch_inlier_masks.shape :  torch.Size([256])
batch_outlier_masks.shape :  torch.Size([256])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([246])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.00520286  0.05376507 -0.04911431]
 [-0.00520286  0.05376507 -0.04911431]
 [-0.00520286  0.05376507 -0.04911431]]
len(transformed_superpoints_pcd) :  1403
copy_superpoint_src_corr_points.shape :  (246, 3)
mask.shape :  (246,)
copy_superpoint_src_corr_points.shape :  (212, 3)
copy_superpoint_ref_corr_points.shape :  (212, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([212, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 212, 3])
batch_inlier_masks.shape :  torch.Size([1999, 212])
best_index :  1913
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (212, 3)
transformed_src_superpoints.shape :  torch.Size([212, 3])
residual.shape :  torch.Size([212])
batch_inlier_masks.shape :  torch.Size([212])
batch_outlier_masks.shape :  torch.Size([212])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([202])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.01961334  0.08869317 -0.02029978]
 [ 0.01457429  0.0900743  -0.02294322]
 [ 0.01961334  0.08869317 -0.02029978]]
len(transformed_superpoints_pcd) :  1413
copy_superpoint_src_corr_points.shape :  (202, 3)
mask.shape :  (202,)
copy_superpoint_src_corr_points.shape :  (202, 3)
copy_superpoint_ref_corr_points.shape :  (202, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([202, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 202, 3])
batch_inlier_masks.shape :  torch.Size([1999, 202])
best_index :  715
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (202, 3)
transformed_src_superpoints.shape :  torch.Size([202, 3])
residual.shape :  torch.Size([202])
batch_inlier_masks.shape :  torch.Size([202])
batch_outlier_masks.shape :  torch.Size([202])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([194])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.05543133 -0.08218393  0.01110758]
 [-0.05360938 -0.07354856  0.01635087]
 [-0.05543133 -0.08218393  0.01110758]]
len(transformed_superpoints_pcd) :  1421
copy_superpoint_src_corr_points.shape :  (194, 3)
mask.shape :  (194,)
copy_superpoint_src_corr_points.shape :  (177, 3)
copy_superpoint_ref_corr_points.shape :  (177, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([177, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 177, 3])
batch_inlier_masks.shape :  torch.Size([1999, 177])
best_index :  1380
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (177, 3)
transformed_src_superpoints.shape :  torch.Size([177, 3])
residual.shape :  torch.Size([177])
batch_inlier_masks.shape :  torch.Size([177])
batch_outlier_masks.shape :  torch.Size([177])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([169])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.01745189  0.07438105 -0.04879134]
 [-0.02219366  0.07219311 -0.04730605]
 [-0.02149988  0.06679706 -0.04952738]]
len(transformed_superpoints_pcd) :  1429
copy_superpoint_src_corr_points.shape :  (169, 3)
mask.shape :  (169,)
copy_superpoint_src_corr_points.shape :  (169, 3)
copy_superpoint_ref_corr_points.shape :  (169, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([169, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 169, 3])
batch_inlier_masks.shape :  torch.Size([1999, 169])
best_index :  1852
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (169, 3)
transformed_src_superpoints.shape :  torch.Size([169, 3])
residual.shape :  torch.Size([169])
batch_inlier_masks.shape :  torch.Size([169])
batch_outlier_masks.shape :  torch.Size([169])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([162])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.0649917  -0.00090112  0.02479298]
 [-0.06143313 -0.00252888  0.0216259 ]
 [-0.06143313 -0.00252888  0.0216259 ]]
len(transformed_superpoints_pcd) :  1436
copy_superpoint_src_corr_points.shape :  (162, 3)
mask.shape :  (162,)
copy_superpoint_src_corr_points.shape :  (162, 3)
copy_superpoint_ref_corr_points.shape :  (162, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([162, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 162, 3])
batch_inlier_masks.shape :  torch.Size([1999, 162])
best_index :  766
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (162, 3)
transformed_src_superpoints.shape :  torch.Size([162, 3])
residual.shape :  torch.Size([162])
batch_inlier_masks.shape :  torch.Size([162])
batch_outlier_masks.shape :  torch.Size([162])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([156])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.00921179  0.07416095 -0.04949192]
 [-0.01346201  0.07017456 -0.05002256]
 [-0.00426754  0.07574701 -0.04965374]]
len(transformed_superpoints_pcd) :  1442
copy_superpoint_src_corr_points.shape :  (156, 3)
mask.shape :  (156,)
copy_superpoint_src_corr_points.shape :  (155, 3)
copy_superpoint_ref_corr_points.shape :  (155, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([155, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 155, 3])
batch_inlier_masks.shape :  torch.Size([1999, 155])
best_index :  1738
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (155, 3)
transformed_src_superpoints.shape :  torch.Size([155, 3])
residual.shape :  torch.Size([155])
batch_inlier_masks.shape :  torch.Size([155])
batch_outlier_masks.shape :  torch.Size([155])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([149])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [-0.04535594  0.00071923  0.02868045]
 [-0.04869061 -0.00257698  0.02359449]
 [-0.05202787  0.00115532  0.03334421]]
len(transformed_superpoints_pcd) :  1448
copy_superpoint_src_corr_points.shape :  (149, 3)
mask.shape :  (149,)
copy_superpoint_src_corr_points.shape :  (149, 3)
copy_superpoint_ref_corr_points.shape :  (149, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([149, 3])
batch_transforms.shape :  torch.Size([1999, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1999, 149, 3])
batch_inlier_masks.shape :  torch.Size([1999, 149])
best_index :  86
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (149, 3)
transformed_src_superpoints.shape :  torch.Size([149, 3])
residual.shape :  torch.Size([149])
batch_inlier_masks.shape :  torch.Size([149])
batch_outlier_masks.shape :  torch.Size([149])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([144])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.03065356  0.0762555  -0.00879822]
 [ 0.03902935 -0.06178811  0.0139033 ]
 [ 0.04422914 -0.06240073  0.01461651]
 ...
 [ 0.07045438  0.02516379 -0.00274345]
 [ 0.07045438  0.02516379 -0.00274345]
 [ 0.07045438  0.02516379 -0.00274345]]
len(transformed_superpoints_pcd) :  1453
copy_superpoint_src_corr_points.shape :  (144, 3)
mask.shape :  (144,)
copy_superpoint_src_corr_points.shape :  (99, 3)
copy_superpoint_ref_corr_points.shape :  (99, 3)
number of unique points in pcd :  562
number of rotations used :  35
transformed_superpoints_pcd.shape :  (1552, 3)
Line set updated
141
src_points :  [[-0.05293699  0.01662981  0.0182388 ]
 [-0.05118053  0.02279839  0.01754269]
 [-0.05059354  0.02822653  0.01402483]
 ...
 [ 0.02240003 -0.01054785  0.03316263]
 [-0.03500549  0.0615927   0.0141695 ]
 [-0.06209932  0.03428762  0.00609506]]
ref_points :  [[-0.06418657 -0.03410733  0.04392322]
 [-0.06400143 -0.02953398  0.03995408]
 [-0.06462297 -0.0267048   0.03509647]
 ...
 [-0.02960998  0.08006739 -0.0038896 ]
 [-0.04285831  0.01067285 -0.02171329]
 [-0.05325413  0.01137404 -0.02130202]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([3432, 3])
lengths :  tensor([1706, 1726])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([2074, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([618, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([301, 3])
ref_points_f.shape :  torch.Size([1706, 3])
src_points_c.shape :  torch.Size([317, 3])
src_points_f.shape :  torch.Size([1726, 3])
ref_node_masks.shape :  torch.Size([301])
ref_node_knn_indices.shape :  torch.Size([301, 5])
ref_node_knn_masks.shape :  torch.Size([301, 5])
src_node_masks.shape :  torch.Size([317])
src_node_knn_indices.shape :  torch.Size([317, 5])
src_node_knn_masks.shape :  torch.Size([317, 5])
ref_node_knn_points.shape :  torch.Size([301, 5, 3])
src_node_knn_points.shape :  torch.Size([317, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([618, 512])
feats_f :  torch.Size([3432, 256])
k :  3
omegas.shape :  torch.Size([90601, 128, 1])
omegas.shape :  torch.Size([271803, 128, 1])
k :  3
omegas.shape :  torch.Size([100489, 128, 1])
omegas.shape :  torch.Size([301467, 128, 1])
ref_feats_c.shape :  torch.Size([1, 301, 256])
src_feats_c.shape :  torch.Size([1, 317, 256])
ref_feats_c_norm.shape :  torch.Size([301, 256])
src_feats_c_norm.shape :  torch.Size([317, 256])
ref_node_masks.shape :  torch.Size([301])
src_node_masks.shape :  torch.Size([317])
self.num_correspondences :  2000
matching_scores.numel() :  95417
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([21027])
ref_indices.shape :  torch.Size([21027])
src_indices.shape :  torch.Size([21027])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 3, 3, 4], device='cuda:0')
src_indices :  tensor([0, 1, 2,  ..., 2, 3, 0], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([21027, 3])
global_src_corr_points.shape :  torch.Size([21027, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([1996, 4, 4])
src_corr_points.shape :  torch.Size([21027, 3])
ref_corr_points.shape :  torch.Size([1, 21027, 3])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 21027, 3])
batch_corr_residuals.shape :  torch.Size([1996, 21027])
batch_inlier_masks.shape :  torch.Size([1996, 21027])
best_index :  tensor(563, device='cuda:0')
len(batch_transforms) :  1996
estimated_transform :  [[ 9.9990839e-01 -1.3644174e-03 -1.3470143e-02  2.6157778e-04]
 [ 2.5679469e-03  9.9596208e-01  8.9735672e-02  7.6806485e-03]
 [ 1.3293311e-02 -8.9762032e-02  9.9587452e-01 -1.9114725e-03]
 [ 0.0000000e+00  0.0000000e+00  0.0000000e+00  1.0000000e+00]]
sorted_indices :  [1661  851 1596 ... 1125  194  563]
superpoint_src_corr_points.shape :  (21027, 3)
superpoint_ref_corr_points.shape :  (21027, 3)
batch_inlier_masks.shape :  (1996, 21027)
batch_transforms.shape :  (1996, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([21027, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 21027, 3])
batch_inlier_masks.shape :  torch.Size([1996, 21027])
best_index :  194
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (21027, 3)
transformed_src_superpoints.shape :  torch.Size([21027, 3])
residual.shape :  torch.Size([21027])
batch_inlier_masks.shape :  torch.Size([21027])
batch_outlier_masks.shape :  torch.Size([21027])
indices_inliers.shape :  torch.Size([291])
indices_outliers.shape :  torch.Size([20736])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([291, 3])
transformed_superpoints_pcd :  [[-5.50551862e-02 -6.47352487e-02  2.08626278e-02]
 [-5.22378050e-02 -6.31482452e-02  2.48176921e-02]
 [-5.50551862e-02 -6.47352487e-02  2.08626278e-02]
 [-5.22378050e-02 -6.31482452e-02  2.48176921e-02]
 [-5.99648394e-02 -6.35516271e-02  2.03605965e-02]
 [-5.50551862e-02 -6.47352487e-02  2.08626278e-02]
 [-5.99648394e-02 -6.35516271e-02  2.03605965e-02]
 [-4.95579876e-02 -6.46119788e-02  2.06489600e-02]
 [-5.49581759e-02 -6.10129535e-02  2.88242921e-02]
 [-5.75300753e-02 -6.26427233e-02  2.47725844e-02]
 [-5.75300753e-02 -6.26427233e-02  2.47725844e-02]
 [-6.45298213e-02 -6.08368665e-02  2.13389471e-02]
 [-5.75300753e-02 -6.26427233e-02  2.47725844e-02]
 [-6.15274012e-02 -6.00760505e-02  2.66104154e-02]
 [-6.60821497e-02  4.15571779e-02 -1.34167634e-02]
 [-6.25989735e-02  4.63271886e-02 -1.29935313e-02]
 [-6.25989735e-02  4.63271886e-02 -1.29935313e-02]
 [-5.99648394e-02 -6.35516271e-02  2.03605965e-02]
 [-5.50551862e-02 -6.47352487e-02  2.08626278e-02]
 [-5.99648394e-02 -6.35516271e-02  2.03605965e-02]
 [ 4.04828601e-02 -4.12698090e-03 -2.46569980e-02]
 [ 4.18788306e-02 -1.44255981e-02 -2.56387070e-02]
 [ 4.26660590e-02 -9.47815925e-03 -2.40447819e-02]
 [ 3.87328714e-02 -1.04904156e-02 -2.80793067e-02]
 [ 4.34513763e-02 -1.87577959e-03 -2.10435372e-02]
 [ 4.26660590e-02 -9.47815925e-03 -2.40447819e-02]
 [ 4.18788306e-02 -1.44255981e-02 -2.56387070e-02]
 [ 3.87328714e-02 -1.04904156e-02 -2.80793067e-02]
 [ 4.34513763e-02 -1.87577959e-03 -2.10435372e-02]
 [ 4.26660590e-02 -9.47815925e-03 -2.40447819e-02]
 [ 4.34513763e-02 -1.87577959e-03 -2.10435372e-02]
 [ 5.09959161e-02 -2.46099588e-02 -1.80344116e-02]
 [ 5.09959161e-02 -2.46099588e-02 -1.80344116e-02]
 [ 5.30634150e-02 -1.86074190e-02 -1.51918242e-02]
 [ 5.19861355e-02 -1.37073305e-02 -1.40815210e-02]
 [ 3.43415104e-02 -8.09055194e-03 -3.07157151e-02]
 [ 3.11472490e-02 -4.03791666e-03 -3.14077288e-02]
 [-5.28646484e-02  4.58828732e-02 -3.79555300e-03]
 [-4.72619198e-02  4.48587686e-02 -9.07033868e-03]
 [ 6.13539591e-02 -2.34369989e-02 -3.85937328e-03]
 [ 5.85165694e-02 -2.91146506e-02 -8.75567365e-03]
 [ 5.84364869e-02 -1.98443308e-02 -7.84721412e-03]
 [ 5.84364869e-02 -1.98443308e-02 -7.84721412e-03]
 [ 5.57973236e-02 -2.31181737e-02 -1.27808191e-02]
 [ 5.54862320e-02 -1.60270315e-02 -1.01904962e-02]
 [ 5.85165694e-02 -2.91146506e-02 -8.75567365e-03]
 [ 5.84364869e-02 -1.98443308e-02 -7.84721412e-03]
 [ 5.57973236e-02 -2.31181737e-02 -1.27808191e-02]
 [ 5.54862320e-02 -1.60270315e-02 -1.01904962e-02]
 [-1.15576768e-02 -5.73186427e-02 -8.40613805e-03]
 [-6.62012119e-03 -5.98627180e-02 -7.31204171e-03]
 [-6.61511868e-02  4.37031612e-02 -8.89670104e-03]
 [-6.60821497e-02  4.15571779e-02 -1.34167634e-02]
 [-6.25989735e-02  4.63271886e-02 -1.29935313e-02]
 [-6.61511868e-02  4.37031612e-02 -8.89670104e-03]
 [-6.60821497e-02  4.15571779e-02 -1.34167634e-02]
 [-6.64661303e-02 -2.72065382e-02  2.78966874e-02]
 [-7.15709552e-02 -3.11319772e-02  2.63859443e-02]
 [-6.82460964e-02 -2.58795675e-02  2.04144251e-02]
 [-7.15709552e-02 -3.11319772e-02  2.63859443e-02]
 [-7.08079785e-02 -2.88865473e-02  1.64040159e-02]
 [-6.82460964e-02 -2.58795675e-02  2.04144251e-02]
 [-6.64661303e-02 -2.72065382e-02  2.78966874e-02]
 [-6.82460964e-02 -2.58795675e-02  2.04144251e-02]
 [-7.08079785e-02 -2.88865473e-02  1.64040159e-02]
 [-7.15709552e-02 -3.11319772e-02  2.63859443e-02]
 [ 6.14519194e-02 -2.86226440e-02 -4.04806016e-03]
 [ 4.24469188e-02 -1.96679980e-02 -2.48907134e-02]
 [ 4.54482809e-02 -2.28080060e-02 -2.23989915e-02]
 [ 4.63993177e-02  7.29132444e-04 -1.60547942e-02]
 [ 4.65767309e-02  4.60992847e-03 -1.17211891e-02]
 [-5.69067933e-02  4.79105487e-02 -7.69585650e-03]
 [-5.32984845e-02  4.64878008e-02 -1.30331246e-02]
 [-5.32984845e-02  4.64878008e-02 -1.30331246e-02]
 [-4.72619198e-02  4.48587686e-02 -9.07033868e-03]
 [-5.69067933e-02  4.79105487e-02 -7.69585650e-03]
 [ 4.64670099e-02 -5.50393946e-03 -1.87373701e-02]
 [ 4.90578450e-02 -9.87282023e-03 -1.64144859e-02]
 [ 4.64670099e-02 -5.50393946e-03 -1.87373701e-02]
 [ 4.90578450e-02 -9.87282023e-03 -1.64144859e-02]
 [ 4.90578450e-02 -9.87282023e-03 -1.64144859e-02]
 [ 4.64670099e-02 -5.50393946e-03 -1.87373701e-02]
 [ 4.90578450e-02 -9.87282023e-03 -1.64144859e-02]
 [ 4.63993177e-02  7.29132444e-04 -1.60547942e-02]
 [ 4.64670099e-02 -5.50393946e-03 -1.87373701e-02]
 [-4.89212945e-03 -5.77483624e-02  4.84731980e-04]
 [ 5.42503335e-02 -1.12087801e-02 -7.58667896e-03]
 [-4.03128378e-02  5.43685034e-02 -4.62485105e-03]
 [-6.46412447e-02  3.58111635e-02 -1.79817639e-02]
 [-6.30155504e-02  4.05654833e-02 -1.76534820e-02]
 [-5.82621396e-02  4.33146954e-02 -1.82753541e-02]
 [-6.46412447e-02  3.58111635e-02 -1.79817639e-02]
 [-6.09589666e-02  3.32877748e-02 -2.05789469e-02]
 [-6.53034747e-02  3.07725593e-02 -1.71625260e-02]
 [-6.46412447e-02  3.58111635e-02 -1.79817639e-02]
 [-6.09589666e-02  3.32877748e-02 -2.05789469e-02]
 [-6.53034747e-02  3.07725593e-02 -1.71625260e-02]
 [ 4.92793396e-02 -1.64355729e-02 -1.92349032e-02]
 [ 5.30634150e-02 -1.86074190e-02 -1.51918242e-02]
 [ 4.92793396e-02 -1.64355729e-02 -1.92349032e-02]
 [ 4.92793396e-02 -1.64355729e-02 -1.92349032e-02]
 [-4.69024219e-02  4.42949906e-02 -1.42203514e-02]
 [-4.19474132e-02  4.30382788e-02 -1.25553282e-02]
 [-7.34291449e-02 -3.41107771e-02  2.21827030e-02]
 [ 5.11930287e-02 -8.12645070e-03 -1.14512816e-02]
 [ 5.42503335e-02 -1.12087801e-02 -7.58667896e-03]
 [ 5.11930287e-02 -8.12645070e-03 -1.14512816e-02]
 [ 4.26660590e-02 -9.47815925e-03 -2.40447819e-02]
 [ 4.26660590e-02 -9.47815925e-03 -2.40447819e-02]
 [ 4.04828601e-02 -4.12698090e-03 -2.46569980e-02]
 [ 2.68055797e-02 -1.23104136e-02  2.29559094e-02]
 [ 2.50817519e-02 -1.94227509e-02  2.42291577e-02]
 [ 2.68055797e-02 -1.23104136e-02  2.29559094e-02]
 [ 5.57973236e-02 -2.31181737e-02 -1.27808191e-02]
 [-2.85202023e-02  6.86753988e-02  5.76302782e-03]
 [-3.18797678e-02  6.44366145e-02  3.14711314e-03]
 [-3.16501968e-02  6.96012378e-02  6.73979521e-05]
 [-3.18797678e-02  6.44366145e-02  3.14711314e-03]
 [-3.16501968e-02  6.96012378e-02  6.73979521e-05]
 [-2.73206066e-02  7.33229369e-02  2.27555633e-03]
 [-2.85202023e-02  6.86753988e-02  5.76302782e-03]
 [-3.16501968e-02  6.96012378e-02  6.73979521e-05]
 [-7.49682188e-02 -4.02007550e-02  1.96287148e-02]
 [-4.69024219e-02  4.42949906e-02 -1.42203514e-02]
 [-5.13809845e-02  4.35515642e-02 -1.92244686e-02]
 [-4.69024219e-02  4.42949906e-02 -1.42203514e-02]
 [-6.36092871e-02 -2.40614619e-02  2.48271916e-02]
 [-6.82460964e-02 -2.58795675e-02  2.04144251e-02]
 [ 5.47100566e-02 -2.99046431e-02 -1.34181175e-02]
 [ 5.05126826e-02 -3.03221922e-02 -1.69633962e-02]
 [-7.08079785e-02 -2.88865473e-02  1.64040159e-02]
 [-6.82460964e-02 -2.58795675e-02  2.04144251e-02]
 [-7.08079785e-02 -2.88865473e-02  1.64040159e-02]
 [ 2.50817519e-02 -1.94227509e-02  2.42291577e-02]
 [ 1.88918803e-02 -1.68347899e-02  2.47118920e-02]
 [ 2.50817519e-02 -1.94227509e-02  2.42291577e-02]
 [ 2.07714010e-02 -1.01409983e-02  2.33972147e-02]
 [ 4.24469188e-02 -1.96679980e-02 -2.48907134e-02]
 [ 4.54482809e-02 -2.28080060e-02 -2.23989915e-02]
 [-6.58425093e-02 -4.35731634e-02  1.93223171e-03]
 [-6.57700524e-02 -3.75188664e-02 -2.45405361e-04]
 [-6.58425093e-02 -4.35731634e-02  1.93223171e-03]
 [-6.57486618e-02 -4.85014021e-02  4.24225628e-03]
 [-5.13809845e-02  4.35515642e-02 -1.92244686e-02]
 [ 5.47597930e-02 -1.13068558e-02  1.01183485e-02]
 [-6.09589666e-02  3.32877748e-02 -2.05789469e-02]
 [-8.81864503e-03 -1.22331604e-02  2.24178918e-02]
 [ 3.53714898e-02 -3.59576419e-02 -2.48360001e-02]
 [ 3.99934798e-02 -3.41143683e-02 -2.26679556e-02]
 [ 3.53714898e-02 -3.59576419e-02 -2.48360001e-02]
 [ 3.61720473e-02 -2.58526523e-02 -2.84957699e-02]
 [ 4.02461961e-02 -2.43431684e-02 -2.57134661e-02]
 [ 5.84364869e-02 -1.98443308e-02 -7.84721412e-03]
 [ 6.13539591e-02 -2.34369989e-02 -3.85937328e-03]
 [ 5.84364869e-02 -1.98443308e-02 -7.84721412e-03]
 [-4.64141555e-02  4.40548286e-02 -3.16094887e-03]
 [-2.73206066e-02  7.33229369e-02  2.27555633e-03]
 [-2.78617889e-02  7.39372224e-02 -2.81341095e-03]
 [-5.82621396e-02  4.33146954e-02 -1.82753541e-02]
 [ 7.24372501e-03 -5.88361174e-02 -1.81397405e-02]
 [ 1.12388190e-03 -6.02860600e-02 -1.72294788e-02]
 [ 9.80182365e-03 -6.07770160e-02 -1.26336943e-02]
 [ 7.24372501e-03 -5.88361174e-02 -1.81397405e-02]
 [ 7.24372501e-03 -5.88361174e-02 -1.81397405e-02]
 [ 1.12388190e-03 -6.02860600e-02 -1.72294788e-02]
 [ 2.07165303e-03 -6.18176162e-02 -1.13306325e-02]
 [ 1.12388190e-03 -6.02860600e-02 -1.72294788e-02]
 [ 9.80182365e-03 -6.07770160e-02 -1.26336943e-02]
 [-5.82621396e-02  4.33146954e-02 -1.82753541e-02]
 [-7.02366084e-02 -3.99401560e-02  7.54885748e-03]
 [-7.13202059e-02 -3.49712670e-02  1.04733203e-02]
 [-6.93099871e-02 -3.40996757e-02  5.96521329e-03]
 [-7.02366084e-02 -3.99401560e-02  7.54885748e-03]
 [-7.35729486e-02 -4.07858714e-02  1.45649761e-02]
 [-7.13202059e-02 -3.49712670e-02  1.04733203e-02]
 [-6.86569810e-02 -4.45691273e-02  6.05505146e-03]
 [ 2.59787366e-02 -5.44107333e-03 -3.41536552e-02]
 [ 3.11472490e-02 -4.03791666e-03 -3.14077288e-02]
 [ 2.81234384e-02  4.73754480e-04 -3.20986509e-02]
 [ 2.59787366e-02 -5.44107333e-03 -3.41536552e-02]
 [ 2.92310920e-02 -9.85176861e-03 -3.34364437e-02]
 [ 3.43415104e-02 -8.09055194e-03 -3.07157151e-02]
 [ 2.81234384e-02  4.73754480e-04 -3.20986509e-02]
 [-7.15709552e-02 -3.11319772e-02  2.63859443e-02]
 [-6.82460964e-02 -2.58795675e-02  2.04144251e-02]
 [-7.08079785e-02 -2.88865473e-02  1.64040159e-02]
 [-7.15709552e-02 -3.11319772e-02  2.63859443e-02]
 [-5.82621396e-02  4.33146954e-02 -1.82753541e-02]
 [-5.82621396e-02  4.33146954e-02 -1.82753541e-02]
 [-5.69067933e-02  4.79105487e-02 -7.69585650e-03]
 [-5.69067933e-02  4.79105487e-02 -7.69585650e-03]
 [-5.32984845e-02  4.64878008e-02 -1.30331246e-02]
 [-4.72619198e-02  4.48587686e-02 -9.07033868e-03]
 [ 6.39646202e-02 -2.78753061e-02  2.70616263e-04]
 [ 6.14519194e-02 -2.86226440e-02 -4.04806016e-03]
 [ 6.32694960e-02 -2.14476679e-02  8.79809726e-04]
 [ 6.14519194e-02 -2.86226440e-02 -4.04806016e-03]
 [ 6.32694960e-02 -2.14476679e-02  8.79809726e-04]
 [ 6.39646202e-02 -2.78753061e-02  2.70616263e-04]
 [ 6.14519194e-02 -2.86226440e-02 -4.04806016e-03]
 [ 6.32694960e-02 -2.14476679e-02  8.79809726e-04]
 [-6.03556409e-02 -2.81174425e-02 -8.51051509e-03]
 [-6.09933659e-02 -2.21053082e-02 -7.86497816e-03]
 [-5.81426658e-02 -2.01726556e-02 -1.19069675e-02]
 [-6.09933659e-02 -2.21053082e-02 -7.86497816e-03]
 [-6.03556409e-02 -2.81174425e-02 -8.51051509e-03]
 [-2.97934599e-02  6.10143542e-02  6.65649772e-03]
 [-3.30067873e-02  6.02357462e-02 -8.12271610e-05]
 [-6.93099871e-02 -3.40996757e-02  5.96521329e-03]
 [-7.02366084e-02 -3.99401560e-02  7.54885748e-03]
 [-7.13202059e-02 -3.49712670e-02  1.04733203e-02]
 [-6.93099871e-02 -3.40996757e-02  5.96521329e-03]
 [-7.13202059e-02 -3.49712670e-02  1.04733203e-02]
 [-6.93099871e-02 -3.40996757e-02  5.96521329e-03]
 [-4.32556085e-02 -3.56627777e-02  4.31831405e-02]
 [-4.15875390e-02 -4.15904522e-02  4.38202284e-02]
 [-4.15875390e-02 -4.15904522e-02  4.38202284e-02]
 [-4.68795635e-02 -3.92089561e-02  4.45919074e-02]
 [-4.95526604e-02 -3.41263488e-02  4.33397703e-02]
 [-4.32556085e-02 -3.56627777e-02  4.31831405e-02]
 [-4.15875390e-02 -4.15904522e-02  4.38202284e-02]
 [-3.81376892e-02 -3.87366265e-02  4.10405658e-02]
 [-4.68795635e-02 -3.92089561e-02  4.45919074e-02]
 [-7.98167288e-03 -2.12679040e-02  2.32377890e-02]
 [-1.37323551e-02 -2.28118878e-02  2.21205615e-02]
 [-7.98167288e-03 -2.12679040e-02  2.32377890e-02]
 [-1.37323551e-02 -2.28118878e-02  2.21205615e-02]
 [-5.81426658e-02 -2.01726556e-02 -1.19069675e-02]
 [-5.59507385e-02 -2.46499311e-02 -1.43159954e-02]
 [ 4.13736105e-02  1.21350456e-02 -1.61364898e-02]
 [ 4.41563241e-02  5.54781314e-03 -1.67586021e-02]
 [ 4.13736105e-02  1.21350456e-02 -1.61364898e-02]
 [ 4.43003178e-02  9.12004896e-03 -1.24429399e-02]
 [ 3.06713637e-02 -3.75865698e-02 -2.73910500e-02]
 [ 3.14305238e-02 -3.16968262e-02 -2.98346151e-02]
 [ 3.06713637e-02 -3.75865698e-02 -2.73910500e-02]
 [ 3.14305238e-02 -3.16968262e-02 -2.98346151e-02]
 [-6.58425093e-02 -4.35731634e-02  1.93223171e-03]
 [-6.58425093e-02 -4.35731634e-02  1.93223171e-03]
 [-6.20475039e-02 -3.77963856e-02 -4.18867823e-03]
 [-6.58425093e-02 -4.35731634e-02  1.93223171e-03]
 [-6.57486618e-02 -4.85014021e-02  4.24225628e-03]
 [-6.20475039e-02 -3.77963856e-02 -4.18867823e-03]
 [-6.20475039e-02 -3.77963856e-02 -4.18867823e-03]
 [-6.57700524e-02 -3.75188664e-02 -2.45405361e-04]
 [-3.18797678e-02  6.44366145e-02  3.14711314e-03]
 [-4.71116090e-03 -5.98833635e-02 -1.76533461e-02]
 [-3.93171655e-03 -6.14677593e-02 -1.17665380e-02]
 [-4.71116090e-03 -5.98833635e-02 -1.76533461e-02]
 [-4.71116090e-03 -5.98833635e-02 -1.76533461e-02]
 [ 5.66667616e-02 -4.71426770e-02 -1.74786663e-03]
 [ 5.61740696e-02 -5.12767658e-02  2.07341835e-03]
 [-4.68795635e-02 -3.92089561e-02  4.45919074e-02]
 [-4.95526604e-02 -3.41263488e-02  4.33397703e-02]
 [ 2.59787366e-02 -5.44107333e-03 -3.41536552e-02]
 [ 2.81234384e-02  4.73754480e-04 -3.20986509e-02]
 [ 1.74121223e-02 -5.23134321e-02 -2.34309956e-02]
 [ 1.74121223e-02 -5.23134321e-02 -2.34309956e-02]
 [ 2.34111845e-02 -4.64140624e-02 -2.66081616e-02]
 [-7.49682188e-02 -4.02007550e-02  1.96287148e-02]
 [-7.48610422e-02 -4.36834320e-02  2.38015670e-02]
 [-7.48610422e-02 -4.36834320e-02  2.38015670e-02]
 [-7.40444362e-02 -4.41385433e-02  2.87570395e-02]
 [-7.51681924e-02 -3.84868607e-02  2.43337341e-02]
 [-7.34291449e-02 -3.41107771e-02  2.21827030e-02]
 [-7.51681924e-02 -3.84868607e-02  2.43337341e-02]
 [-7.49682188e-02 -4.02007550e-02  1.96287148e-02]
 [-7.34291449e-02 -3.41107771e-02  2.21827030e-02]
 [-7.51681924e-02 -3.84868607e-02  2.43337341e-02]
 [-7.34291449e-02 -3.41107771e-02  2.21827030e-02]
 [-4.64141555e-02  4.40548286e-02 -3.16094887e-03]
 [ 6.34006709e-02 -1.87612008e-02  1.31413862e-02]
 [ 5.95136248e-02 -1.55338235e-02  1.22406986e-02]
 [ 6.34006709e-02 -1.87612008e-02  1.31413862e-02]
 [-6.03556409e-02 -2.81174425e-02 -8.51051509e-03]
 [-6.15274012e-02 -6.00760505e-02  2.66104154e-02]
 [-6.61872998e-02 -5.78812510e-02  2.52186824e-02]
 [-5.75300753e-02 -6.26427233e-02  2.47725844e-02]
 [-6.45298213e-02 -6.08368665e-02  2.13389471e-02]
 [-6.61872998e-02 -5.78812510e-02  2.52186824e-02]
 [-6.15274012e-02 -6.00760505e-02  2.66104154e-02]
 [-6.45298213e-02 -6.08368665e-02  2.13389471e-02]
 [-6.61872998e-02 -5.78812510e-02  2.52186824e-02]
 [-2.81931683e-02  6.55562133e-02 -3.50509062e-02]
 [-6.93099871e-02 -3.40996757e-02  5.96521329e-03]
 [-7.02366084e-02 -3.99401560e-02  7.54885748e-03]
 [-7.13202059e-02 -3.49712670e-02  1.04733203e-02]
 [-6.93099871e-02 -3.40996757e-02  5.96521329e-03]
 [-7.02366084e-02 -3.99401560e-02  7.54885748e-03]
 [-6.93099871e-02 -3.40996757e-02  5.96521329e-03]
 [ 6.13539591e-02 -2.34369989e-02 -3.85937328e-03]]
len(transformed_superpoints_pcd) :  291
copy_superpoint_src_corr_points.shape :  (20736, 3)
mask.shape :  (20736,)
copy_superpoint_src_corr_points.shape :  (13617, 3)
copy_superpoint_ref_corr_points.shape :  (13617, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13617, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 13617, 3])
batch_inlier_masks.shape :  torch.Size([1996, 13617])
best_index :  1541
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13617, 3)
transformed_src_superpoints.shape :  torch.Size([13617, 3])
residual.shape :  torch.Size([13617])
batch_inlier_masks.shape :  torch.Size([13617])
batch_outlier_masks.shape :  torch.Size([13617])
indices_inliers.shape :  torch.Size([154])
indices_outliers.shape :  torch.Size([13463])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([154, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.04986626  0.04254305 -0.01831146]
 [-0.04986626  0.04254305 -0.01831146]
 [-0.01985064 -0.04956646 -0.02756161]]
len(transformed_superpoints_pcd) :  445
copy_superpoint_src_corr_points.shape :  (13463, 3)
mask.shape :  (13463,)
copy_superpoint_src_corr_points.shape :  (10629, 3)
copy_superpoint_ref_corr_points.shape :  (10629, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([10629, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 10629, 3])
batch_inlier_masks.shape :  torch.Size([1996, 10629])
best_index :  300
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (10629, 3)
transformed_src_superpoints.shape :  torch.Size([10629, 3])
residual.shape :  torch.Size([10629])
batch_inlier_masks.shape :  torch.Size([10629])
batch_outlier_masks.shape :  torch.Size([10629])
indices_inliers.shape :  torch.Size([104])
indices_outliers.shape :  torch.Size([10525])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([104, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.03459406 -0.02712338 -0.02455315]
 [-0.06167899  0.00939335  0.01012112]
 [ 0.05979868 -0.01399049 -0.00038882]]
len(transformed_superpoints_pcd) :  549
copy_superpoint_src_corr_points.shape :  (10525, 3)
mask.shape :  (10525,)
copy_superpoint_src_corr_points.shape :  (8432, 3)
copy_superpoint_ref_corr_points.shape :  (8432, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8432, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 8432, 3])
batch_inlier_masks.shape :  torch.Size([1996, 8432])
best_index :  333
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8432, 3)
transformed_src_superpoints.shape :  torch.Size([8432, 3])
residual.shape :  torch.Size([8432])
batch_inlier_masks.shape :  torch.Size([8432])
batch_outlier_masks.shape :  torch.Size([8432])
indices_inliers.shape :  torch.Size([90])
indices_outliers.shape :  torch.Size([8342])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([90, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.022582   -0.06093626 -0.03103694]
 [-0.022582   -0.06093626 -0.03103694]
 [-0.022582   -0.06093626 -0.03103694]]
len(transformed_superpoints_pcd) :  639
copy_superpoint_src_corr_points.shape :  (8342, 3)
mask.shape :  (8342,)
copy_superpoint_src_corr_points.shape :  (6528, 3)
copy_superpoint_ref_corr_points.shape :  (6528, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6528, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 6528, 3])
batch_inlier_masks.shape :  torch.Size([1996, 6528])
best_index :  673
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6528, 3)
transformed_src_superpoints.shape :  torch.Size([6528, 3])
residual.shape :  torch.Size([6528])
batch_inlier_masks.shape :  torch.Size([6528])
batch_outlier_masks.shape :  torch.Size([6528])
indices_inliers.shape :  torch.Size([69])
indices_outliers.shape :  torch.Size([6459])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([69, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.05367298  0.04163788 -0.02114001]
 [-0.05374858  0.04198792 -0.0272921 ]
 [-0.05374858  0.04198792 -0.0272921 ]]
len(transformed_superpoints_pcd) :  708
copy_superpoint_src_corr_points.shape :  (6459, 3)
mask.shape :  (6459,)
copy_superpoint_src_corr_points.shape :  (5259, 3)
copy_superpoint_ref_corr_points.shape :  (5259, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5259, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 5259, 3])
batch_inlier_masks.shape :  torch.Size([1996, 5259])
best_index :  1816
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5259, 3)
transformed_src_superpoints.shape :  torch.Size([5259, 3])
residual.shape :  torch.Size([5259])
batch_inlier_masks.shape :  torch.Size([5259])
batch_outlier_masks.shape :  torch.Size([5259])
indices_inliers.shape :  torch.Size([56])
indices_outliers.shape :  torch.Size([5203])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([56, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.00992304 -0.0034356   0.02780278]
 [ 0.00511399 -0.00380372  0.03060761]
 [ 0.01445981 -0.00588181  0.02698293]]
len(transformed_superpoints_pcd) :  764
copy_superpoint_src_corr_points.shape :  (5203, 3)
mask.shape :  (5203,)
copy_superpoint_src_corr_points.shape :  (4542, 3)
copy_superpoint_ref_corr_points.shape :  (4542, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4542, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 4542, 3])
batch_inlier_masks.shape :  torch.Size([1996, 4542])
best_index :  830
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4542, 3)
transformed_src_superpoints.shape :  torch.Size([4542, 3])
residual.shape :  torch.Size([4542])
batch_inlier_masks.shape :  torch.Size([4542])
batch_outlier_masks.shape :  torch.Size([4542])
indices_inliers.shape :  torch.Size([47])
indices_outliers.shape :  torch.Size([4495])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([47, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.03294774 -0.00694339 -0.01962202]
 [-0.03143622 -0.00246152 -0.02200964]
 [-0.03578555  0.05038837 -0.00518154]]
len(transformed_superpoints_pcd) :  811
copy_superpoint_src_corr_points.shape :  (4495, 3)
mask.shape :  (4495,)
copy_superpoint_src_corr_points.shape :  (3976, 3)
copy_superpoint_ref_corr_points.shape :  (3976, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3976, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 3976, 3])
batch_inlier_masks.shape :  torch.Size([1996, 3976])
best_index :  308
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3976, 3)
transformed_src_superpoints.shape :  torch.Size([3976, 3])
residual.shape :  torch.Size([3976])
batch_inlier_masks.shape :  torch.Size([3976])
batch_outlier_masks.shape :  torch.Size([3976])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([3938])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.00073634  0.06483735  0.01698055]
 [-0.00576796  0.06702545  0.01793259]
 [-0.004092    0.07101171  0.01395404]]
len(transformed_superpoints_pcd) :  849
copy_superpoint_src_corr_points.shape :  (3938, 3)
mask.shape :  (3938,)
copy_superpoint_src_corr_points.shape :  (3698, 3)
copy_superpoint_ref_corr_points.shape :  (3698, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3698, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 3698, 3])
batch_inlier_masks.shape :  torch.Size([1996, 3698])
best_index :  1225
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3698, 3)
transformed_src_superpoints.shape :  torch.Size([3698, 3])
residual.shape :  torch.Size([3698])
batch_inlier_masks.shape :  torch.Size([3698])
batch_outlier_masks.shape :  torch.Size([3698])
indices_inliers.shape :  torch.Size([37])
indices_outliers.shape :  torch.Size([3661])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([37, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.02393578  0.07267664 -0.02892067]
 [-0.02393578  0.07267664 -0.02892067]
 [-0.02635974  0.07678574 -0.02639145]]
len(transformed_superpoints_pcd) :  886
copy_superpoint_src_corr_points.shape :  (3661, 3)
mask.shape :  (3661,)
copy_superpoint_src_corr_points.shape :  (3200, 3)
copy_superpoint_ref_corr_points.shape :  (3200, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3200, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 3200, 3])
batch_inlier_masks.shape :  torch.Size([1996, 3200])
best_index :  897
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3200, 3)
transformed_src_superpoints.shape :  torch.Size([3200, 3])
residual.shape :  torch.Size([3200])
batch_inlier_masks.shape :  torch.Size([3200])
batch_outlier_masks.shape :  torch.Size([3200])
indices_inliers.shape :  torch.Size([35])
indices_outliers.shape :  torch.Size([3165])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([35, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.03120959 -0.02886824 -0.03295124]
 [ 0.02679869 -0.02853339 -0.02952962]
 [-0.04121744  0.00497205 -0.00648957]]
len(transformed_superpoints_pcd) :  921
copy_superpoint_src_corr_points.shape :  (3165, 3)
mask.shape :  (3165,)
copy_superpoint_src_corr_points.shape :  (2738, 3)
copy_superpoint_ref_corr_points.shape :  (2738, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2738, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 2738, 3])
batch_inlier_masks.shape :  torch.Size([1996, 2738])
best_index :  1755
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2738, 3)
transformed_src_superpoints.shape :  torch.Size([2738, 3])
residual.shape :  torch.Size([2738])
batch_inlier_masks.shape :  torch.Size([2738])
batch_outlier_masks.shape :  torch.Size([2738])
indices_inliers.shape :  torch.Size([35])
indices_outliers.shape :  torch.Size([2703])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([35, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.03814179  0.04182317 -0.05075622]
 [ 0.03175154  0.04589786 -0.05123559]
 [ 0.03172867  0.03705992 -0.04995113]]
len(transformed_superpoints_pcd) :  956
copy_superpoint_src_corr_points.shape :  (2703, 3)
mask.shape :  (2703,)
copy_superpoint_src_corr_points.shape :  (2536, 3)
copy_superpoint_ref_corr_points.shape :  (2536, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2536, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 2536, 3])
batch_inlier_masks.shape :  torch.Size([1996, 2536])
best_index :  1830
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2536, 3)
transformed_src_superpoints.shape :  torch.Size([2536, 3])
residual.shape :  torch.Size([2536])
batch_inlier_masks.shape :  torch.Size([2536])
batch_outlier_masks.shape :  torch.Size([2536])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([2505])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.00262107 -0.06879282 -0.01789784]
 [-0.0089403  -0.06757277 -0.01629389]
 [ 0.07005081 -0.02439306 -0.00454937]]
len(transformed_superpoints_pcd) :  987
copy_superpoint_src_corr_points.shape :  (2505, 3)
mask.shape :  (2505,)
copy_superpoint_src_corr_points.shape :  (2268, 3)
copy_superpoint_ref_corr_points.shape :  (2268, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2268, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 2268, 3])
batch_inlier_masks.shape :  torch.Size([1996, 2268])
best_index :  1791
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2268, 3)
transformed_src_superpoints.shape :  torch.Size([2268, 3])
residual.shape :  torch.Size([2268])
batch_inlier_masks.shape :  torch.Size([2268])
batch_outlier_masks.shape :  torch.Size([2268])
indices_inliers.shape :  torch.Size([29])
indices_outliers.shape :  torch.Size([2239])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([29, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.03655438 -0.01036214  0.0055397 ]
 [ 0.0326865  -0.01313224  0.00963214]
 [ 0.03655438 -0.01036214  0.0055397 ]]
len(transformed_superpoints_pcd) :  1016
copy_superpoint_src_corr_points.shape :  (2239, 3)
mask.shape :  (2239,)
copy_superpoint_src_corr_points.shape :  (1925, 3)
copy_superpoint_ref_corr_points.shape :  (1925, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1925, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 1925, 3])
batch_inlier_masks.shape :  torch.Size([1996, 1925])
best_index :  1732
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1925, 3)
transformed_src_superpoints.shape :  torch.Size([1925, 3])
residual.shape :  torch.Size([1925])
batch_inlier_masks.shape :  torch.Size([1925])
batch_outlier_masks.shape :  torch.Size([1925])
indices_inliers.shape :  torch.Size([27])
indices_outliers.shape :  torch.Size([1898])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([27, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.05551911 -0.05776353 -0.00612374]
 [ 0.04646562 -0.05351686 -0.00761558]
 [ 0.05605344 -0.05228331 -0.00560195]]
len(transformed_superpoints_pcd) :  1043
copy_superpoint_src_corr_points.shape :  (1898, 3)
mask.shape :  (1898,)
copy_superpoint_src_corr_points.shape :  (1775, 3)
copy_superpoint_ref_corr_points.shape :  (1775, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1775, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 1775, 3])
batch_inlier_masks.shape :  torch.Size([1996, 1775])
best_index :  1401
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1775, 3)
transformed_src_superpoints.shape :  torch.Size([1775, 3])
residual.shape :  torch.Size([1775])
batch_inlier_masks.shape :  torch.Size([1775])
batch_outlier_masks.shape :  torch.Size([1775])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([1753])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.05238758 -0.00936499 -0.019797  ]
 [ 0.05527328 -0.01296743 -0.0164055 ]
 [ 0.05102345 -0.00379114 -0.01936854]]
len(transformed_superpoints_pcd) :  1065
copy_superpoint_src_corr_points.shape :  (1753, 3)
mask.shape :  (1753,)
copy_superpoint_src_corr_points.shape :  (1563, 3)
copy_superpoint_ref_corr_points.shape :  (1563, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1563, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 1563, 3])
batch_inlier_masks.shape :  torch.Size([1996, 1563])
best_index :  1186
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1563, 3)
transformed_src_superpoints.shape :  torch.Size([1563, 3])
residual.shape :  torch.Size([1563])
batch_inlier_masks.shape :  torch.Size([1563])
batch_outlier_masks.shape :  torch.Size([1563])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([1542])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.00661955 -0.03558077  0.02340247]
 [ 0.00661955 -0.03558077  0.02340247]
 [ 0.00661955 -0.03558077  0.02340247]]
len(transformed_superpoints_pcd) :  1086
copy_superpoint_src_corr_points.shape :  (1542, 3)
mask.shape :  (1542,)
copy_superpoint_src_corr_points.shape :  (1402, 3)
copy_superpoint_ref_corr_points.shape :  (1402, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1402, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 1402, 3])
batch_inlier_masks.shape :  torch.Size([1996, 1402])
best_index :  549
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1402, 3)
transformed_src_superpoints.shape :  torch.Size([1402, 3])
residual.shape :  torch.Size([1402])
batch_inlier_masks.shape :  torch.Size([1402])
batch_outlier_masks.shape :  torch.Size([1402])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([1382])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.00764209  0.04095893  0.02991614]
 [-0.00158744  0.0428668   0.03216868]
 [ 0.04781041 -0.02901139  0.01785603]]
len(transformed_superpoints_pcd) :  1106
copy_superpoint_src_corr_points.shape :  (1382, 3)
mask.shape :  (1382,)
copy_superpoint_src_corr_points.shape :  (1148, 3)
copy_superpoint_ref_corr_points.shape :  (1148, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1148, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 1148, 3])
batch_inlier_masks.shape :  torch.Size([1996, 1148])
best_index :  554
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1148, 3)
transformed_src_superpoints.shape :  torch.Size([1148, 3])
residual.shape :  torch.Size([1148])
batch_inlier_masks.shape :  torch.Size([1148])
batch_outlier_masks.shape :  torch.Size([1148])
indices_inliers.shape :  torch.Size([20])
indices_outliers.shape :  torch.Size([1128])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([20, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.06769644 -0.07512327  0.02943249]
 [ 0.04580015 -0.02748641  0.01478503]
 [ 0.04580015 -0.02748641  0.01478503]]
len(transformed_superpoints_pcd) :  1126
copy_superpoint_src_corr_points.shape :  (1128, 3)
mask.shape :  (1128,)
copy_superpoint_src_corr_points.shape :  (803, 3)
copy_superpoint_ref_corr_points.shape :  (803, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([803, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 803, 3])
batch_inlier_masks.shape :  torch.Size([1996, 803])
best_index :  1645
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (803, 3)
transformed_src_superpoints.shape :  torch.Size([803, 3])
residual.shape :  torch.Size([803])
batch_inlier_masks.shape :  torch.Size([803])
batch_outlier_masks.shape :  torch.Size([803])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([784])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.0372936   0.00094339  0.01632299]
 [ 0.04144257  0.00114335  0.01304441]
 [ 0.0372936   0.00094339  0.01632299]]
len(transformed_superpoints_pcd) :  1145
copy_superpoint_src_corr_points.shape :  (784, 3)
mask.shape :  (784,)
copy_superpoint_src_corr_points.shape :  (773, 3)
copy_superpoint_ref_corr_points.shape :  (773, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([773, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 773, 3])
batch_inlier_masks.shape :  torch.Size([1996, 773])
best_index :  1574
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (773, 3)
transformed_src_superpoints.shape :  torch.Size([773, 3])
residual.shape :  torch.Size([773])
batch_inlier_masks.shape :  torch.Size([773])
batch_outlier_masks.shape :  torch.Size([773])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([756])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.06709376 -0.06218747  0.01939106]
 [-0.06851415 -0.03849347  0.00727758]
 [-0.06851415 -0.03849347  0.00727758]]
len(transformed_superpoints_pcd) :  1162
copy_superpoint_src_corr_points.shape :  (756, 3)
mask.shape :  (756,)
copy_superpoint_src_corr_points.shape :  (647, 3)
copy_superpoint_ref_corr_points.shape :  (647, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([647, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 647, 3])
batch_inlier_masks.shape :  torch.Size([1996, 647])
best_index :  872
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (647, 3)
transformed_src_superpoints.shape :  torch.Size([647, 3])
residual.shape :  torch.Size([647])
batch_inlier_masks.shape :  torch.Size([647])
batch_outlier_masks.shape :  torch.Size([647])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([632])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.04581282  0.00854089 -0.00122787]
 [-0.04581282  0.00854089 -0.00122787]
 [-0.04946965  0.01327201 -0.0022856 ]]
len(transformed_superpoints_pcd) :  1177
copy_superpoint_src_corr_points.shape :  (632, 3)
mask.shape :  (632,)
copy_superpoint_src_corr_points.shape :  (482, 3)
copy_superpoint_ref_corr_points.shape :  (482, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([482, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 482, 3])
batch_inlier_masks.shape :  torch.Size([1996, 482])
best_index :  1517
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (482, 3)
transformed_src_superpoints.shape :  torch.Size([482, 3])
residual.shape :  torch.Size([482])
batch_inlier_masks.shape :  torch.Size([482])
batch_outlier_masks.shape :  torch.Size([482])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([469])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.05314173 -0.01590538 -0.01428516]
 [ 0.04951756 -0.01177299 -0.01414984]
 [ 0.05727157 -0.01514954 -0.01118083]]
len(transformed_superpoints_pcd) :  1190
copy_superpoint_src_corr_points.shape :  (469, 3)
mask.shape :  (469,)
copy_superpoint_src_corr_points.shape :  (433, 3)
copy_superpoint_ref_corr_points.shape :  (433, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([433, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 433, 3])
batch_inlier_masks.shape :  torch.Size([1996, 433])
best_index :  1498
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (433, 3)
transformed_src_superpoints.shape :  torch.Size([433, 3])
residual.shape :  torch.Size([433])
batch_inlier_masks.shape :  torch.Size([433])
batch_outlier_masks.shape :  torch.Size([433])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([421])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.04881393  0.02607166 -0.02364188]
 [-0.05543439  0.02207691 -0.01928357]
 [-0.06051754  0.01711375 -0.02151351]]
len(transformed_superpoints_pcd) :  1202
copy_superpoint_src_corr_points.shape :  (421, 3)
mask.shape :  (421,)
copy_superpoint_src_corr_points.shape :  (417, 3)
copy_superpoint_ref_corr_points.shape :  (417, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([417, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 417, 3])
batch_inlier_masks.shape :  torch.Size([1996, 417])
best_index :  1769
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (417, 3)
transformed_src_superpoints.shape :  torch.Size([417, 3])
residual.shape :  torch.Size([417])
batch_inlier_masks.shape :  torch.Size([417])
batch_outlier_masks.shape :  torch.Size([417])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([406])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.02478195 -0.03002277 -0.03476104]
 [ 0.03403389 -0.02630536 -0.0291645 ]
 [ 0.03397342 -0.03187113 -0.02773147]]
len(transformed_superpoints_pcd) :  1213
copy_superpoint_src_corr_points.shape :  (406, 3)
mask.shape :  (406,)
copy_superpoint_src_corr_points.shape :  (386, 3)
copy_superpoint_ref_corr_points.shape :  (386, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([386, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 386, 3])
batch_inlier_masks.shape :  torch.Size([1996, 386])
best_index :  1699
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (386, 3)
transformed_src_superpoints.shape :  torch.Size([386, 3])
residual.shape :  torch.Size([386])
batch_inlier_masks.shape :  torch.Size([386])
batch_outlier_masks.shape :  torch.Size([386])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([376])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.04648451 -0.00989428 -0.02044   ]
 [ 0.04648451 -0.00989428 -0.02044   ]
 [ 0.04985192 -0.0178054  -0.01957677]]
len(transformed_superpoints_pcd) :  1223
copy_superpoint_src_corr_points.shape :  (376, 3)
mask.shape :  (376,)
copy_superpoint_src_corr_points.shape :  (361, 3)
copy_superpoint_ref_corr_points.shape :  (361, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([361, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 361, 3])
batch_inlier_masks.shape :  torch.Size([1996, 361])
best_index :  1772
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (361, 3)
transformed_src_superpoints.shape :  torch.Size([361, 3])
residual.shape :  torch.Size([361])
batch_inlier_masks.shape :  torch.Size([361])
batch_outlier_masks.shape :  torch.Size([361])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([351])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.05646352 -0.0679739   0.02901444]
 [-0.0559497  -0.06947461  0.02399725]
 [-0.06090827 -0.06691652  0.02221158]]
len(transformed_superpoints_pcd) :  1233
copy_superpoint_src_corr_points.shape :  (351, 3)
mask.shape :  (351,)
copy_superpoint_src_corr_points.shape :  (350, 3)
copy_superpoint_ref_corr_points.shape :  (350, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([350, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 350, 3])
batch_inlier_masks.shape :  torch.Size([1996, 350])
best_index :  1195
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (350, 3)
transformed_src_superpoints.shape :  torch.Size([350, 3])
residual.shape :  torch.Size([350])
batch_inlier_masks.shape :  torch.Size([350])
batch_outlier_masks.shape :  torch.Size([350])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([341])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.02775649  0.04703422  0.02183094]
 [-0.02365454  0.04839331  0.02501266]
 [-0.02365454  0.04839331  0.02501266]]
len(transformed_superpoints_pcd) :  1242
copy_superpoint_src_corr_points.shape :  (341, 3)
mask.shape :  (341,)
copy_superpoint_src_corr_points.shape :  (320, 3)
copy_superpoint_ref_corr_points.shape :  (320, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([320, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 320, 3])
batch_inlier_masks.shape :  torch.Size([1996, 320])
best_index :  1688
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (320, 3)
transformed_src_superpoints.shape :  torch.Size([320, 3])
residual.shape :  torch.Size([320])
batch_inlier_masks.shape :  torch.Size([320])
batch_outlier_masks.shape :  torch.Size([320])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([311])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.03521658  0.01775557 -0.01590786]
 [-0.03521658  0.01775557 -0.01590786]
 [-0.04870687  0.01464607 -0.02780547]]
len(transformed_superpoints_pcd) :  1251
copy_superpoint_src_corr_points.shape :  (311, 3)
mask.shape :  (311,)
copy_superpoint_src_corr_points.shape :  (277, 3)
copy_superpoint_ref_corr_points.shape :  (277, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([277, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 277, 3])
batch_inlier_masks.shape :  torch.Size([1996, 277])
best_index :  1776
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (277, 3)
transformed_src_superpoints.shape :  torch.Size([277, 3])
residual.shape :  torch.Size([277])
batch_inlier_masks.shape :  torch.Size([277])
batch_outlier_masks.shape :  torch.Size([277])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([268])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.0704542   0.03236914 -0.02607425]
 [-0.06856863  0.03317881 -0.02006681]
 [-0.0704542   0.03236914 -0.02607425]]
len(transformed_superpoints_pcd) :  1260
copy_superpoint_src_corr_points.shape :  (268, 3)
mask.shape :  (268,)
copy_superpoint_src_corr_points.shape :  (268, 3)
copy_superpoint_ref_corr_points.shape :  (268, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([268, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 268, 3])
batch_inlier_masks.shape :  torch.Size([1996, 268])
best_index :  722
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (268, 3)
transformed_src_superpoints.shape :  torch.Size([268, 3])
residual.shape :  torch.Size([268])
batch_inlier_masks.shape :  torch.Size([268])
batch_outlier_masks.shape :  torch.Size([268])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([260])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.0439957  -0.07456183  0.00658308]
 [ 0.03954374 -0.07579385  0.01465734]
 [ 0.03954374 -0.07579385  0.01465734]]
len(transformed_superpoints_pcd) :  1268
copy_superpoint_src_corr_points.shape :  (260, 3)
mask.shape :  (260,)
copy_superpoint_src_corr_points.shape :  (227, 3)
copy_superpoint_ref_corr_points.shape :  (227, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([227, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 227, 3])
batch_inlier_masks.shape :  torch.Size([1996, 227])
best_index :  827
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (227, 3)
transformed_src_superpoints.shape :  torch.Size([227, 3])
residual.shape :  torch.Size([227])
batch_inlier_masks.shape :  torch.Size([227])
batch_outlier_masks.shape :  torch.Size([227])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([219])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.0026434   0.04363448  0.02687302]
 [ 0.00252858  0.03888131  0.02948686]
 [ 0.00252858  0.03888131  0.02948686]]
len(transformed_superpoints_pcd) :  1276
copy_superpoint_src_corr_points.shape :  (219, 3)
mask.shape :  (219,)
copy_superpoint_src_corr_points.shape :  (175, 3)
copy_superpoint_ref_corr_points.shape :  (175, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([175, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 175, 3])
batch_inlier_masks.shape :  torch.Size([1996, 175])
best_index :  1603
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (175, 3)
transformed_src_superpoints.shape :  torch.Size([175, 3])
residual.shape :  torch.Size([175])
batch_inlier_masks.shape :  torch.Size([175])
batch_outlier_masks.shape :  torch.Size([175])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([167])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.05450454 -0.06745778  0.02163709]
 [-0.05879512 -0.06800665  0.02686571]
 [-0.05981475 -0.06831623  0.02181992]]
len(transformed_superpoints_pcd) :  1284
copy_superpoint_src_corr_points.shape :  (167, 3)
mask.shape :  (167,)
copy_superpoint_src_corr_points.shape :  (167, 3)
copy_superpoint_ref_corr_points.shape :  (167, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([167, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 167, 3])
batch_inlier_masks.shape :  torch.Size([1996, 167])
best_index :  1670
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (167, 3)
transformed_src_superpoints.shape :  torch.Size([167, 3])
residual.shape :  torch.Size([167])
batch_inlier_masks.shape :  torch.Size([167])
batch_outlier_masks.shape :  torch.Size([167])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([159])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.05320963 -0.06953859  0.04264263]
 [ 0.05645707 -0.0703477   0.03812589]
 [ 0.06087358 -0.07110548  0.03511118]]
len(transformed_superpoints_pcd) :  1292
copy_superpoint_src_corr_points.shape :  (159, 3)
mask.shape :  (159,)
copy_superpoint_src_corr_points.shape :  (155, 3)
copy_superpoint_ref_corr_points.shape :  (155, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([155, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 155, 3])
batch_inlier_masks.shape :  torch.Size([1996, 155])
best_index :  652
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (155, 3)
transformed_src_superpoints.shape :  torch.Size([155, 3])
residual.shape :  torch.Size([155])
batch_inlier_masks.shape :  torch.Size([155])
batch_outlier_masks.shape :  torch.Size([155])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([148])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.04946446 -0.01759787 -0.01983493]
 [ 0.05141173 -0.01442702 -0.01628191]
 [ 0.04946446 -0.01759787 -0.01983493]]
len(transformed_superpoints_pcd) :  1299
copy_superpoint_src_corr_points.shape :  (148, 3)
mask.shape :  (148,)
copy_superpoint_src_corr_points.shape :  (132, 3)
copy_superpoint_ref_corr_points.shape :  (132, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([132, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 132, 3])
batch_inlier_masks.shape :  torch.Size([1996, 132])
best_index :  1877
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (132, 3)
transformed_src_superpoints.shape :  torch.Size([132, 3])
residual.shape :  torch.Size([132])
batch_inlier_masks.shape :  torch.Size([132])
batch_outlier_masks.shape :  torch.Size([132])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([126])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [-0.04406319  0.05383224 -0.00564573]
 [-0.04406319  0.05383224 -0.00564573]
 [-0.04645539  0.06446408 -0.00990971]]
len(transformed_superpoints_pcd) :  1305
copy_superpoint_src_corr_points.shape :  (126, 3)
mask.shape :  (126,)
copy_superpoint_src_corr_points.shape :  (120, 3)
copy_superpoint_ref_corr_points.shape :  (120, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([120, 3])
batch_transforms.shape :  torch.Size([1996, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([1996, 120, 3])
batch_inlier_masks.shape :  torch.Size([1996, 120])
best_index :  13
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (120, 3)
transformed_src_superpoints.shape :  torch.Size([120, 3])
residual.shape :  torch.Size([120])
batch_inlier_masks.shape :  torch.Size([120])
batch_outlier_masks.shape :  torch.Size([120])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([115])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.05505519 -0.06473525  0.02086263]
 [-0.0522378  -0.06314825  0.02481769]
 [-0.05505519 -0.06473525  0.02086263]
 ...
 [ 0.03454374 -0.05336763  0.00693238]
 [ 0.03454374 -0.05336763  0.00693238]
 [ 0.03454374 -0.05336763  0.00693238]]
len(transformed_superpoints_pcd) :  1310
copy_superpoint_src_corr_points.shape :  (115, 3)
mask.shape :  (115,)
copy_superpoint_src_corr_points.shape :  (96, 3)
copy_superpoint_ref_corr_points.shape :  (96, 3)
number of unique points in pcd :  572
number of rotations used :  36
transformed_superpoints_pcd.shape :  (1406, 3)
Line set updated
166
src_points :  [[-0.05687482  0.01201603  0.03214117]
 [-0.05594372  0.01464146  0.02625049]
 [-0.05550798  0.01576874  0.02051836]
 ...
 [ 0.0275542  -0.08876125 -0.02714027]
 [-0.00951113 -0.10228862  0.00958512]
 [-0.07372413  0.05420882  0.07404988]]
ref_points :  [[-0.06220728 -0.00155948  0.01008936]
 [-0.06116041 -0.00057828  0.01573657]
 [-0.06052081  0.0020541   0.0200327 ]
 ...
 [ 0.00564422 -0.02482744 -0.0158377 ]
 [-0.05403534  0.01245777  0.02825206]
 [-0.01943854  0.00521087  0.0853874 ]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([3342, 3])
lengths :  tensor([1659, 1683])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([1990, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([604, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([299, 3])
ref_points_f.shape :  torch.Size([1659, 3])
src_points_c.shape :  torch.Size([305, 3])
src_points_f.shape :  torch.Size([1683, 3])
ref_node_masks.shape :  torch.Size([299])
ref_node_knn_indices.shape :  torch.Size([299, 5])
ref_node_knn_masks.shape :  torch.Size([299, 5])
src_node_masks.shape :  torch.Size([305])
src_node_knn_indices.shape :  torch.Size([305, 5])
src_node_knn_masks.shape :  torch.Size([305, 5])
ref_node_knn_points.shape :  torch.Size([299, 5, 3])
src_node_knn_points.shape :  torch.Size([305, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([604, 512])
feats_f :  torch.Size([3342, 256])
k :  3
omegas.shape :  torch.Size([89401, 128, 1])
omegas.shape :  torch.Size([268203, 128, 1])
k :  3
omegas.shape :  torch.Size([93025, 128, 1])
omegas.shape :  torch.Size([279075, 128, 1])
ref_feats_c.shape :  torch.Size([1, 299, 256])
src_feats_c.shape :  torch.Size([1, 305, 256])
ref_feats_c_norm.shape :  torch.Size([299, 256])
src_feats_c_norm.shape :  torch.Size([305, 256])
ref_node_masks.shape :  torch.Size([299])
src_node_masks.shape :  torch.Size([305])
self.num_correspondences :  2000
matching_scores.numel() :  91195
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([21108])
ref_indices.shape :  torch.Size([21108])
src_indices.shape :  torch.Size([21108])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 1,  ..., 2, 3, 4], device='cuda:0')
src_indices :  tensor([0, 2, 1,  ..., 4, 4, 0], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([21108, 3])
global_src_corr_points.shape :  torch.Size([21108, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([2000, 4, 4])
src_corr_points.shape :  torch.Size([21108, 3])
ref_corr_points.shape :  torch.Size([1, 21108, 3])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 21108, 3])
batch_corr_residuals.shape :  torch.Size([2000, 21108])
batch_inlier_masks.shape :  torch.Size([2000, 21108])
best_index :  tensor(49, device='cuda:0')
len(batch_transforms) :  2000
estimated_transform :  [[ 0.9970733  -0.07149668 -0.02707637 -0.00437939]
 [ 0.07174833  0.99738693  0.00843862  0.00712586]
 [ 0.02640237 -0.01035669  0.9995978   0.00594304]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [ 831 1975 1772 ... 1780  679   49]
superpoint_src_corr_points.shape :  (21108, 3)
superpoint_ref_corr_points.shape :  (21108, 3)
batch_inlier_masks.shape :  (2000, 21108)
batch_transforms.shape :  (2000, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([21108, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 21108, 3])
batch_inlier_masks.shape :  torch.Size([2000, 21108])
best_index :  41
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (21108, 3)
transformed_src_superpoints.shape :  torch.Size([21108, 3])
residual.shape :  torch.Size([21108])
batch_inlier_masks.shape :  torch.Size([21108])
batch_outlier_masks.shape :  torch.Size([21108])
indices_inliers.shape :  torch.Size([395])
indices_outliers.shape :  torch.Size([20713])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([395, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03411244 -0.00664601 -0.07094622]
 [-0.03816848 -0.00164137 -0.07575633]
 [-0.04146636 -0.00728318 -0.07900536]]
len(transformed_superpoints_pcd) :  395
copy_superpoint_src_corr_points.shape :  (20713, 3)
mask.shape :  (20713,)
copy_superpoint_src_corr_points.shape :  (12733, 3)
copy_superpoint_ref_corr_points.shape :  (12733, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([12733, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 12733, 3])
batch_inlier_masks.shape :  torch.Size([2000, 12733])
best_index :  609
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (12733, 3)
transformed_src_superpoints.shape :  torch.Size([12733, 3])
residual.shape :  torch.Size([12733])
batch_inlier_masks.shape :  torch.Size([12733])
batch_outlier_masks.shape :  torch.Size([12733])
indices_inliers.shape :  torch.Size([156])
indices_outliers.shape :  torch.Size([12577])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([156, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.02817364  0.03359812  0.05046837]
 [ 0.01760804  0.03414541  0.05224333]
 [ 0.021449    0.02980998  0.05333843]]
len(transformed_superpoints_pcd) :  551
copy_superpoint_src_corr_points.shape :  (12577, 3)
mask.shape :  (12577,)
copy_superpoint_src_corr_points.shape :  (9543, 3)
copy_superpoint_ref_corr_points.shape :  (9543, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([9543, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 9543, 3])
batch_inlier_masks.shape :  torch.Size([2000, 9543])
best_index :  66
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (9543, 3)
transformed_src_superpoints.shape :  torch.Size([9543, 3])
residual.shape :  torch.Size([9543])
batch_inlier_masks.shape :  torch.Size([9543])
batch_outlier_masks.shape :  torch.Size([9543])
indices_inliers.shape :  torch.Size([129])
indices_outliers.shape :  torch.Size([9414])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([129, 3])
transformed_superpoints_pcd :  [[-6.4285778e-02  6.7463145e-04 -7.1455643e-02]
 [-5.4395944e-02  1.2622146e-02 -6.2095277e-02]
 [-5.6442291e-02  7.6691061e-03 -5.5133559e-02]
 ...
 [ 3.4868352e-02  9.0524647e-04  6.2192228e-02]
 [ 3.8796641e-02 -2.7195551e-05  6.5431982e-02]
 [ 3.4868352e-02  9.0524647e-04  6.2192228e-02]]
len(transformed_superpoints_pcd) :  680
copy_superpoint_src_corr_points.shape :  (9414, 3)
mask.shape :  (9414,)
copy_superpoint_src_corr_points.shape :  (7467, 3)
copy_superpoint_ref_corr_points.shape :  (7467, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7467, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7467, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7467])
best_index :  1774
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7467, 3)
transformed_src_superpoints.shape :  torch.Size([7467, 3])
residual.shape :  torch.Size([7467])
batch_inlier_masks.shape :  torch.Size([7467])
batch_outlier_masks.shape :  torch.Size([7467])
indices_inliers.shape :  torch.Size([111])
indices_outliers.shape :  torch.Size([7356])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([111, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.00100852 -0.04167936  0.06490412]
 [ 0.00433931 -0.04756504  0.05892394]
 [ 0.00127717 -0.04922044  0.05096798]]
len(transformed_superpoints_pcd) :  791
copy_superpoint_src_corr_points.shape :  (7356, 3)
mask.shape :  (7356,)
copy_superpoint_src_corr_points.shape :  (6349, 3)
copy_superpoint_ref_corr_points.shape :  (6349, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([6349, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 6349, 3])
batch_inlier_masks.shape :  torch.Size([2000, 6349])
best_index :  402
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (6349, 3)
transformed_src_superpoints.shape :  torch.Size([6349, 3])
residual.shape :  torch.Size([6349])
batch_inlier_masks.shape :  torch.Size([6349])
batch_outlier_masks.shape :  torch.Size([6349])
indices_inliers.shape :  torch.Size([96])
indices_outliers.shape :  torch.Size([6253])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([96, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03274686  0.01698437 -0.06005528]
 [-0.03274686  0.01698437 -0.06005528]
 [-0.04052701  0.01761431 -0.06153747]]
len(transformed_superpoints_pcd) :  887
copy_superpoint_src_corr_points.shape :  (6253, 3)
mask.shape :  (6253,)
copy_superpoint_src_corr_points.shape :  (4885, 3)
copy_superpoint_ref_corr_points.shape :  (4885, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4885, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4885, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4885])
best_index :  0
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4885, 3)
transformed_src_superpoints.shape :  torch.Size([4885, 3])
residual.shape :  torch.Size([4885])
batch_inlier_masks.shape :  torch.Size([4885])
batch_outlier_masks.shape :  torch.Size([4885])
indices_inliers.shape :  torch.Size([75])
indices_outliers.shape :  torch.Size([4810])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([75, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.00337234 -0.03944988  0.05742279]
 [-0.01084028 -0.03519594  0.06609473]
 [-0.01234541 -0.03009968  0.03090617]]
len(transformed_superpoints_pcd) :  962
copy_superpoint_src_corr_points.shape :  (4810, 3)
mask.shape :  (4810,)
copy_superpoint_src_corr_points.shape :  (4106, 3)
copy_superpoint_ref_corr_points.shape :  (4106, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4106, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4106, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4106])
best_index :  541
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4106, 3)
transformed_src_superpoints.shape :  torch.Size([4106, 3])
residual.shape :  torch.Size([4106])
batch_inlier_masks.shape :  torch.Size([4106])
batch_outlier_masks.shape :  torch.Size([4106])
indices_inliers.shape :  torch.Size([50])
indices_outliers.shape :  torch.Size([4056])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([50, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.03669009  0.01466686  0.05508673]
 [ 0.03698735  0.02019178  0.05832847]
 [ 0.03669009  0.01466686  0.05508673]]
len(transformed_superpoints_pcd) :  1012
copy_superpoint_src_corr_points.shape :  (4056, 3)
mask.shape :  (4056,)
copy_superpoint_src_corr_points.shape :  (3439, 3)
copy_superpoint_ref_corr_points.shape :  (3439, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3439, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3439, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3439])
best_index :  963
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3439, 3)
transformed_src_superpoints.shape :  torch.Size([3439, 3])
residual.shape :  torch.Size([3439])
batch_inlier_masks.shape :  torch.Size([3439])
batch_outlier_masks.shape :  torch.Size([3439])
indices_inliers.shape :  torch.Size([45])
indices_outliers.shape :  torch.Size([3394])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([45, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03985428  0.02953586 -0.03302517]
 [-0.06286117 -0.04247233 -0.05024506]
 [-0.06286117 -0.04247233 -0.05024506]]
len(transformed_superpoints_pcd) :  1057
copy_superpoint_src_corr_points.shape :  (3394, 3)
mask.shape :  (3394,)
copy_superpoint_src_corr_points.shape :  (2935, 3)
copy_superpoint_ref_corr_points.shape :  (2935, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2935, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2935, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2935])
best_index :  1416
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2935, 3)
transformed_src_superpoints.shape :  torch.Size([2935, 3])
residual.shape :  torch.Size([2935])
batch_inlier_masks.shape :  torch.Size([2935])
batch_outlier_masks.shape :  torch.Size([2935])
indices_inliers.shape :  torch.Size([37])
indices_outliers.shape :  torch.Size([2898])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([37, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.02521108  0.02863888  0.05546071]
 [ 0.02527151  0.02619315  0.05102252]
 [ 0.02142809  0.03132659  0.05787198]]
len(transformed_superpoints_pcd) :  1094
copy_superpoint_src_corr_points.shape :  (2898, 3)
mask.shape :  (2898,)
copy_superpoint_src_corr_points.shape :  (2588, 3)
copy_superpoint_ref_corr_points.shape :  (2588, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2588, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2588, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2588])
best_index :  1082
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2588, 3)
transformed_src_superpoints.shape :  torch.Size([2588, 3])
residual.shape :  torch.Size([2588])
batch_inlier_masks.shape :  torch.Size([2588])
batch_outlier_masks.shape :  torch.Size([2588])
indices_inliers.shape :  torch.Size([34])
indices_outliers.shape :  torch.Size([2554])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([34, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.0251698   0.02198569  0.02419877]
 [ 0.0251698   0.02198569  0.02419877]
 [ 0.02279356  0.02129777  0.03272911]]
len(transformed_superpoints_pcd) :  1128
copy_superpoint_src_corr_points.shape :  (2554, 3)
mask.shape :  (2554,)
copy_superpoint_src_corr_points.shape :  (2307, 3)
copy_superpoint_ref_corr_points.shape :  (2307, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2307, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2307, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2307])
best_index :  511
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2307, 3)
transformed_src_superpoints.shape :  torch.Size([2307, 3])
residual.shape :  torch.Size([2307])
batch_inlier_masks.shape :  torch.Size([2307])
batch_outlier_masks.shape :  torch.Size([2307])
indices_inliers.shape :  torch.Size([31])
indices_outliers.shape :  torch.Size([2276])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([31, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.0491276   0.01801002 -0.05006064]
 [-0.0529277   0.01545555 -0.05420109]
 [-0.04891144  0.01889306 -0.05558078]]
len(transformed_superpoints_pcd) :  1159
copy_superpoint_src_corr_points.shape :  (2276, 3)
mask.shape :  (2276,)
copy_superpoint_src_corr_points.shape :  (2202, 3)
copy_superpoint_ref_corr_points.shape :  (2202, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2202, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2202, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2202])
best_index :  1929
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2202, 3)
transformed_src_superpoints.shape :  torch.Size([2202, 3])
residual.shape :  torch.Size([2202])
batch_inlier_masks.shape :  torch.Size([2202])
batch_outlier_masks.shape :  torch.Size([2202])
indices_inliers.shape :  torch.Size([29])
indices_outliers.shape :  torch.Size([2173])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([29, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.06767462 -0.00569753  0.03258874]
 [ 0.07591826 -0.01170653  0.02923795]
 [ 0.07591826 -0.01170653  0.02923795]]
len(transformed_superpoints_pcd) :  1188
copy_superpoint_src_corr_points.shape :  (2173, 3)
mask.shape :  (2173,)
copy_superpoint_src_corr_points.shape :  (2109, 3)
copy_superpoint_ref_corr_points.shape :  (2109, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2109, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2109, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2109])
best_index :  1626
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2109, 3)
transformed_src_superpoints.shape :  torch.Size([2109, 3])
residual.shape :  torch.Size([2109])
batch_inlier_masks.shape :  torch.Size([2109])
batch_outlier_masks.shape :  torch.Size([2109])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([2081])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.04702709  0.02046675 -0.05830394]
 [-0.04730988  0.0166231  -0.06164841]
 [-0.03903612  0.01629923 -0.06220264]]
len(transformed_superpoints_pcd) :  1216
copy_superpoint_src_corr_points.shape :  (2081, 3)
mask.shape :  (2081,)
copy_superpoint_src_corr_points.shape :  (1917, 3)
copy_superpoint_ref_corr_points.shape :  (1917, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1917, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1917, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1917])
best_index :  1780
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1917, 3)
transformed_src_superpoints.shape :  torch.Size([1917, 3])
residual.shape :  torch.Size([1917])
batch_inlier_masks.shape :  torch.Size([1917])
batch_outlier_masks.shape :  torch.Size([1917])
indices_inliers.shape :  torch.Size([28])
indices_outliers.shape :  torch.Size([1889])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([28, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.03045289  0.03889205 -0.03456928]
 [ 0.04333404  0.01944803  0.0623244 ]
 [ 0.03165607  0.02483483  0.03459268]]
len(transformed_superpoints_pcd) :  1244
copy_superpoint_src_corr_points.shape :  (1889, 3)
mask.shape :  (1889,)
copy_superpoint_src_corr_points.shape :  (1783, 3)
copy_superpoint_ref_corr_points.shape :  (1783, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1783, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1783, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1783])
best_index :  830
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1783, 3)
transformed_src_superpoints.shape :  torch.Size([1783, 3])
residual.shape :  torch.Size([1783])
batch_inlier_masks.shape :  torch.Size([1783])
batch_outlier_masks.shape :  torch.Size([1783])
indices_inliers.shape :  torch.Size([27])
indices_outliers.shape :  torch.Size([1756])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([27, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.0686274  -0.01829753  0.00622209]
 [ 0.07214834 -0.01734504  0.01118276]
 [ 0.05855629 -0.02214416  0.01985049]]
len(transformed_superpoints_pcd) :  1271
copy_superpoint_src_corr_points.shape :  (1756, 3)
mask.shape :  (1756,)
copy_superpoint_src_corr_points.shape :  (1524, 3)
copy_superpoint_ref_corr_points.shape :  (1524, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1524, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1524, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1524])
best_index :  1704
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1524, 3)
transformed_src_superpoints.shape :  torch.Size([1524, 3])
residual.shape :  torch.Size([1524])
batch_inlier_masks.shape :  torch.Size([1524])
batch_outlier_masks.shape :  torch.Size([1524])
indices_inliers.shape :  torch.Size([23])
indices_outliers.shape :  torch.Size([1501])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([23, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.01100396 -0.04019874  0.06029715]
 [-0.00399792 -0.04153588  0.06135055]
 [-0.00877671 -0.04194709  0.05530018]]
len(transformed_superpoints_pcd) :  1294
copy_superpoint_src_corr_points.shape :  (1501, 3)
mask.shape :  (1501,)
copy_superpoint_src_corr_points.shape :  (1369, 3)
copy_superpoint_ref_corr_points.shape :  (1369, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1369, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1369, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1369])
best_index :  961
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1369, 3)
transformed_src_superpoints.shape :  torch.Size([1369, 3])
residual.shape :  torch.Size([1369])
batch_inlier_masks.shape :  torch.Size([1369])
batch_outlier_masks.shape :  torch.Size([1369])
indices_inliers.shape :  torch.Size([21])
indices_outliers.shape :  torch.Size([1348])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([21, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.04848611  0.01682167 -0.06036495]
 [-0.04930067  0.01922031 -0.05599829]
 [-0.05392743  0.01469455 -0.05433223]]
len(transformed_superpoints_pcd) :  1315
copy_superpoint_src_corr_points.shape :  (1348, 3)
mask.shape :  (1348,)
copy_superpoint_src_corr_points.shape :  (1266, 3)
copy_superpoint_ref_corr_points.shape :  (1266, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1266, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1266, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1266])
best_index :  942
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1266, 3)
transformed_src_superpoints.shape :  torch.Size([1266, 3])
residual.shape :  torch.Size([1266])
batch_inlier_masks.shape :  torch.Size([1266])
batch_outlier_masks.shape :  torch.Size([1266])
indices_inliers.shape :  torch.Size([19])
indices_outliers.shape :  torch.Size([1247])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([19, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03131951  0.0141585   0.0752718 ]
 [-0.02642167  0.01517981  0.07920632]
 [-0.03131951  0.0141585   0.0752718 ]]
len(transformed_superpoints_pcd) :  1334
copy_superpoint_src_corr_points.shape :  (1247, 3)
mask.shape :  (1247,)
copy_superpoint_src_corr_points.shape :  (1188, 3)
copy_superpoint_ref_corr_points.shape :  (1188, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1188, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1188, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1188])
best_index :  1910
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1188, 3)
transformed_src_superpoints.shape :  torch.Size([1188, 3])
residual.shape :  torch.Size([1188])
batch_inlier_masks.shape :  torch.Size([1188])
batch_outlier_masks.shape :  torch.Size([1188])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([1170])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.05330126 -0.01751234  0.00610461]
 [ 0.05529836 -0.0145343   0.01005776]
 [ 0.05440365 -0.0224172   0.01151744]]
len(transformed_superpoints_pcd) :  1352
copy_superpoint_src_corr_points.shape :  (1170, 3)
mask.shape :  (1170,)
copy_superpoint_src_corr_points.shape :  (1138, 3)
copy_superpoint_ref_corr_points.shape :  (1138, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1138, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1138, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1138])
best_index :  1925
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1138, 3)
transformed_src_superpoints.shape :  torch.Size([1138, 3])
residual.shape :  torch.Size([1138])
batch_inlier_masks.shape :  torch.Size([1138])
batch_outlier_masks.shape :  torch.Size([1138])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1121])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03767246 -0.00909878 -0.03334428]
 [-0.03360133 -0.01084561 -0.03583518]
 [-0.03640604 -0.01350946 -0.04512206]]
len(transformed_superpoints_pcd) :  1369
copy_superpoint_src_corr_points.shape :  (1121, 3)
mask.shape :  (1121,)
copy_superpoint_src_corr_points.shape :  (1071, 3)
copy_superpoint_ref_corr_points.shape :  (1071, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1071, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1071, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1071])
best_index :  194
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1071, 3)
transformed_src_superpoints.shape :  torch.Size([1071, 3])
residual.shape :  torch.Size([1071])
batch_inlier_masks.shape :  torch.Size([1071])
batch_outlier_masks.shape :  torch.Size([1071])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1056])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.03337707 -0.00107795  0.06101549]
 [ 0.02798289 -0.00366034  0.06411043]
 [ 0.02798289 -0.00366034  0.06411043]]
len(transformed_superpoints_pcd) :  1384
copy_superpoint_src_corr_points.shape :  (1056, 3)
mask.shape :  (1056,)
copy_superpoint_src_corr_points.shape :  (1014, 3)
copy_superpoint_ref_corr_points.shape :  (1014, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1014, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1014, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1014])
best_index :  1310
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1014, 3)
transformed_src_superpoints.shape :  torch.Size([1014, 3])
residual.shape :  torch.Size([1014])
batch_inlier_masks.shape :  torch.Size([1014])
batch_outlier_masks.shape :  torch.Size([1014])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([999])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.04043221 -0.00596411  0.06207915]
 [-0.04043221 -0.00596411  0.06207915]
 [-0.03573706 -0.01352095  0.05752328]]
len(transformed_superpoints_pcd) :  1399
copy_superpoint_src_corr_points.shape :  (999, 3)
mask.shape :  (999,)
copy_superpoint_src_corr_points.shape :  (936, 3)
copy_superpoint_ref_corr_points.shape :  (936, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([936, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 936, 3])
batch_inlier_masks.shape :  torch.Size([2000, 936])
best_index :  642
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (936, 3)
transformed_src_superpoints.shape :  torch.Size([936, 3])
residual.shape :  torch.Size([936])
batch_inlier_masks.shape :  torch.Size([936])
batch_outlier_masks.shape :  torch.Size([936])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([922])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.06840798 -0.01406522  0.02352498]
 [ 0.07033908 -0.01894376  0.02445719]
 [ 0.06840798 -0.01406522  0.02352498]]
len(transformed_superpoints_pcd) :  1413
copy_superpoint_src_corr_points.shape :  (922, 3)
mask.shape :  (922,)
copy_superpoint_src_corr_points.shape :  (885, 3)
copy_superpoint_ref_corr_points.shape :  (885, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([885, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 885, 3])
batch_inlier_masks.shape :  torch.Size([2000, 885])
best_index :  1773
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (885, 3)
transformed_src_superpoints.shape :  torch.Size([885, 3])
residual.shape :  torch.Size([885])
batch_inlier_masks.shape :  torch.Size([885])
batch_outlier_masks.shape :  torch.Size([885])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([871])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.04273302  0.0075479   0.0551151 ]
 [ 0.03808247  0.00953836  0.05776923]
 [ 0.04081639  0.00371826  0.05846053]]
len(transformed_superpoints_pcd) :  1427
copy_superpoint_src_corr_points.shape :  (871, 3)
mask.shape :  (871,)
copy_superpoint_src_corr_points.shape :  (847, 3)
copy_superpoint_ref_corr_points.shape :  (847, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([847, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 847, 3])
batch_inlier_masks.shape :  torch.Size([2000, 847])
best_index :  248
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (847, 3)
transformed_src_superpoints.shape :  torch.Size([847, 3])
residual.shape :  torch.Size([847])
batch_inlier_masks.shape :  torch.Size([847])
batch_outlier_masks.shape :  torch.Size([847])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([834])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-6.4285778e-02  6.7463145e-04 -7.1455643e-02]
 [-5.4395944e-02  1.2622146e-02 -6.2095277e-02]
 [-5.6442291e-02  7.6691061e-03 -5.5133559e-02]
 ...
 [ 6.8213850e-02 -1.6350018e-02  1.5626449e-02]
 [ 6.2565640e-02 -1.7131198e-02  1.3774401e-02]
 [ 4.3659154e-02 -6.7968909e-03  7.2734430e-05]]
len(transformed_superpoints_pcd) :  1440
copy_superpoint_src_corr_points.shape :  (834, 3)
mask.shape :  (834,)
copy_superpoint_src_corr_points.shape :  (802, 3)
copy_superpoint_ref_corr_points.shape :  (802, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([802, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 802, 3])
batch_inlier_masks.shape :  torch.Size([2000, 802])
best_index :  1521
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (802, 3)
transformed_src_superpoints.shape :  torch.Size([802, 3])
residual.shape :  torch.Size([802])
batch_inlier_masks.shape :  torch.Size([802])
batch_outlier_masks.shape :  torch.Size([802])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([789])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03141682 -0.00861705  0.07138795]
 [-0.03897529 -0.00593972  0.06481867]
 [-0.0384582   0.00052764  0.06795987]]
len(transformed_superpoints_pcd) :  1453
copy_superpoint_src_corr_points.shape :  (789, 3)
mask.shape :  (789,)
copy_superpoint_src_corr_points.shape :  (762, 3)
copy_superpoint_ref_corr_points.shape :  (762, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([762, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 762, 3])
batch_inlier_masks.shape :  torch.Size([2000, 762])
best_index :  212
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (762, 3)
transformed_src_superpoints.shape :  torch.Size([762, 3])
residual.shape :  torch.Size([762])
batch_inlier_masks.shape :  torch.Size([762])
batch_outlier_masks.shape :  torch.Size([762])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([750])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.06940842  0.0012376   0.00700833]
 [-0.06940842  0.0012376   0.00700833]
 [-0.04920197  0.00284622 -0.02212037]]
len(transformed_superpoints_pcd) :  1465
copy_superpoint_src_corr_points.shape :  (750, 3)
mask.shape :  (750,)
copy_superpoint_src_corr_points.shape :  (718, 3)
copy_superpoint_ref_corr_points.shape :  (718, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([718, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 718, 3])
batch_inlier_masks.shape :  torch.Size([2000, 718])
best_index :  1223
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (718, 3)
transformed_src_superpoints.shape :  torch.Size([718, 3])
residual.shape :  torch.Size([718])
batch_inlier_masks.shape :  torch.Size([718])
batch_outlier_masks.shape :  torch.Size([718])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([707])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.00733936  0.03614221  0.01020407]
 [ 0.00750681  0.03847637  0.00493558]
 [ 0.00750681  0.03847637  0.00493558]]
len(transformed_superpoints_pcd) :  1476
copy_superpoint_src_corr_points.shape :  (707, 3)
mask.shape :  (707,)
copy_superpoint_src_corr_points.shape :  (670, 3)
copy_superpoint_ref_corr_points.shape :  (670, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([670, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 670, 3])
batch_inlier_masks.shape :  torch.Size([2000, 670])
best_index :  1700
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (670, 3)
transformed_src_superpoints.shape :  torch.Size([670, 3])
residual.shape :  torch.Size([670])
batch_inlier_masks.shape :  torch.Size([670])
batch_outlier_masks.shape :  torch.Size([670])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([659])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.00192998  0.04738383 -0.02354136]
 [ 0.00899966  0.04590783 -0.02478868]
 [ 0.00868418  0.04553121 -0.03106046]]
len(transformed_superpoints_pcd) :  1487
copy_superpoint_src_corr_points.shape :  (659, 3)
mask.shape :  (659,)
copy_superpoint_src_corr_points.shape :  (649, 3)
copy_superpoint_ref_corr_points.shape :  (649, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([649, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 649, 3])
batch_inlier_masks.shape :  torch.Size([2000, 649])
best_index :  9
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (649, 3)
transformed_src_superpoints.shape :  torch.Size([649, 3])
residual.shape :  torch.Size([649])
batch_inlier_masks.shape :  torch.Size([649])
batch_outlier_masks.shape :  torch.Size([649])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([639])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.03812214  0.01231202  0.07570875]
 [ 0.03284292  0.01445386  0.07634149]
 [ 0.04290158  0.01406234  0.07447907]]
len(transformed_superpoints_pcd) :  1497
copy_superpoint_src_corr_points.shape :  (639, 3)
mask.shape :  (639,)
copy_superpoint_src_corr_points.shape :  (607, 3)
copy_superpoint_ref_corr_points.shape :  (607, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([607, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 607, 3])
batch_inlier_masks.shape :  torch.Size([2000, 607])
best_index :  838
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (607, 3)
transformed_src_superpoints.shape :  torch.Size([607, 3])
residual.shape :  torch.Size([607])
batch_inlier_masks.shape :  torch.Size([607])
batch_outlier_masks.shape :  torch.Size([607])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([597])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.02637323  0.0146929   0.08437093]
 [ 0.01376035  0.01957862  0.09110446]
 [-0.00897367 -0.04640469  0.05134347]]
len(transformed_superpoints_pcd) :  1507
copy_superpoint_src_corr_points.shape :  (597, 3)
mask.shape :  (597,)
copy_superpoint_src_corr_points.shape :  (595, 3)
copy_superpoint_ref_corr_points.shape :  (595, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([595, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 595, 3])
batch_inlier_masks.shape :  torch.Size([2000, 595])
best_index :  1047
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (595, 3)
transformed_src_superpoints.shape :  torch.Size([595, 3])
residual.shape :  torch.Size([595])
batch_inlier_masks.shape :  torch.Size([595])
batch_outlier_masks.shape :  torch.Size([595])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([585])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.01764819 -0.02923962  0.05699382]
 [ 0.01764819 -0.02923962  0.05699382]
 [ 0.01599052 -0.02986823  0.06334937]]
len(transformed_superpoints_pcd) :  1517
copy_superpoint_src_corr_points.shape :  (585, 3)
mask.shape :  (585,)
copy_superpoint_src_corr_points.shape :  (515, 3)
copy_superpoint_ref_corr_points.shape :  (515, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([515, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 515, 3])
batch_inlier_masks.shape :  torch.Size([2000, 515])
best_index :  1465
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (515, 3)
transformed_src_superpoints.shape :  torch.Size([515, 3])
residual.shape :  torch.Size([515])
batch_inlier_masks.shape :  torch.Size([515])
batch_outlier_masks.shape :  torch.Size([515])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([505])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.06248969 -0.02358161  0.01721301]
 [ 0.02106124  0.01821948  0.07168707]
 [ 0.02350469  0.02402226  0.05129747]]
len(transformed_superpoints_pcd) :  1527
copy_superpoint_src_corr_points.shape :  (505, 3)
mask.shape :  (505,)
copy_superpoint_src_corr_points.shape :  (480, 3)
copy_superpoint_ref_corr_points.shape :  (480, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([480, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 480, 3])
batch_inlier_masks.shape :  torch.Size([2000, 480])
best_index :  1901
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (480, 3)
transformed_src_superpoints.shape :  torch.Size([480, 3])
residual.shape :  torch.Size([480])
batch_inlier_masks.shape :  torch.Size([480])
batch_outlier_masks.shape :  torch.Size([480])
indices_inliers.shape :  torch.Size([10])
indices_outliers.shape :  torch.Size([470])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([10, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.05271862 -0.03732084 -0.05428162]
 [-0.04573554 -0.03634196 -0.05468822]
 [-0.05750713 -0.0375853  -0.05220277]]
len(transformed_superpoints_pcd) :  1537
copy_superpoint_src_corr_points.shape :  (470, 3)
mask.shape :  (470,)
copy_superpoint_src_corr_points.shape :  (463, 3)
copy_superpoint_ref_corr_points.shape :  (463, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([463, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 463, 3])
batch_inlier_masks.shape :  torch.Size([2000, 463])
best_index :  1239
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (463, 3)
transformed_src_superpoints.shape :  torch.Size([463, 3])
residual.shape :  torch.Size([463])
batch_inlier_masks.shape :  torch.Size([463])
batch_outlier_masks.shape :  torch.Size([463])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([454])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03697997 -0.00731803  0.06612119]
 [-0.03697997 -0.00731803  0.06612119]
 [-0.03702933 -0.00112387  0.06883852]]
len(transformed_superpoints_pcd) :  1546
copy_superpoint_src_corr_points.shape :  (454, 3)
mask.shape :  (454,)
copy_superpoint_src_corr_points.shape :  (436, 3)
copy_superpoint_ref_corr_points.shape :  (436, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([436, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 436, 3])
batch_inlier_masks.shape :  torch.Size([2000, 436])
best_index :  1403
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (436, 3)
transformed_src_superpoints.shape :  torch.Size([436, 3])
residual.shape :  torch.Size([436])
batch_inlier_masks.shape :  torch.Size([436])
batch_outlier_masks.shape :  torch.Size([436])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([427])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.04890277 -0.03706266 -0.054192  ]
 [-0.05520963 -0.03821565 -0.05535144]
 [-0.04890277 -0.03706266 -0.054192  ]]
len(transformed_superpoints_pcd) :  1555
copy_superpoint_src_corr_points.shape :  (427, 3)
mask.shape :  (427,)
copy_superpoint_src_corr_points.shape :  (421, 3)
copy_superpoint_ref_corr_points.shape :  (421, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([421, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 421, 3])
batch_inlier_masks.shape :  torch.Size([2000, 421])
best_index :  1620
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (421, 3)
transformed_src_superpoints.shape :  torch.Size([421, 3])
residual.shape :  torch.Size([421])
batch_inlier_masks.shape :  torch.Size([421])
batch_outlier_masks.shape :  torch.Size([421])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([412])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.03173162  0.01463495  0.05440946]
 [ 0.03144836  0.01397188  0.04890219]
 [ 0.03173162  0.01463495  0.05440946]]
len(transformed_superpoints_pcd) :  1564
copy_superpoint_src_corr_points.shape :  (412, 3)
mask.shape :  (412,)
copy_superpoint_src_corr_points.shape :  (393, 3)
copy_superpoint_ref_corr_points.shape :  (393, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([393, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 393, 3])
batch_inlier_masks.shape :  torch.Size([2000, 393])
best_index :  1483
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (393, 3)
transformed_src_superpoints.shape :  torch.Size([393, 3])
residual.shape :  torch.Size([393])
batch_inlier_masks.shape :  torch.Size([393])
batch_outlier_masks.shape :  torch.Size([393])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([385])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.0201721   0.02026936  0.07850911]
 [ 0.01934172  0.0166691   0.08624022]
 [ 0.02067455  0.03209692  0.06605366]]
len(transformed_superpoints_pcd) :  1572
copy_superpoint_src_corr_points.shape :  (385, 3)
mask.shape :  (385,)
copy_superpoint_src_corr_points.shape :  (374, 3)
copy_superpoint_ref_corr_points.shape :  (374, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([374, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 374, 3])
batch_inlier_masks.shape :  torch.Size([2000, 374])
best_index :  393
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (374, 3)
transformed_src_superpoints.shape :  torch.Size([374, 3])
residual.shape :  torch.Size([374])
batch_inlier_masks.shape :  torch.Size([374])
batch_outlier_masks.shape :  torch.Size([374])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([367])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.04790771  0.01369349 -0.03532747]
 [-0.04790771  0.01369349 -0.03532747]
 [-0.04790771  0.01369349 -0.03532747]]
len(transformed_superpoints_pcd) :  1579
copy_superpoint_src_corr_points.shape :  (367, 3)
mask.shape :  (367,)
copy_superpoint_src_corr_points.shape :  (309, 3)
copy_superpoint_ref_corr_points.shape :  (309, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([309, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 309, 3])
batch_inlier_masks.shape :  torch.Size([2000, 309])
best_index :  1531
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (309, 3)
transformed_src_superpoints.shape :  torch.Size([309, 3])
residual.shape :  torch.Size([309])
batch_inlier_masks.shape :  torch.Size([309])
batch_outlier_masks.shape :  torch.Size([309])
indices_inliers.shape :  torch.Size([7])
indices_outliers.shape :  torch.Size([302])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([7, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.0318853  -0.00977542  0.06273288]
 [ 0.02996988 -0.00986532  0.06756268]
 [ 0.02942133 -0.01402241  0.06482248]]
len(transformed_superpoints_pcd) :  1586
copy_superpoint_src_corr_points.shape :  (302, 3)
mask.shape :  (302,)
copy_superpoint_src_corr_points.shape :  (301, 3)
copy_superpoint_ref_corr_points.shape :  (301, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([301, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 301, 3])
batch_inlier_masks.shape :  torch.Size([2000, 301])
best_index :  758
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (301, 3)
transformed_src_superpoints.shape :  torch.Size([301, 3])
residual.shape :  torch.Size([301])
batch_inlier_masks.shape :  torch.Size([301])
batch_outlier_masks.shape :  torch.Size([301])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([295])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.06349222 -0.0262887   0.02350359]
 [ 0.06349222 -0.0262887   0.02350359]
 [ 0.06349222 -0.0262887   0.02350359]]
len(transformed_superpoints_pcd) :  1592
copy_superpoint_src_corr_points.shape :  (295, 3)
mask.shape :  (295,)
copy_superpoint_src_corr_points.shape :  (292, 3)
copy_superpoint_ref_corr_points.shape :  (292, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([292, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 292, 3])
batch_inlier_masks.shape :  torch.Size([2000, 292])
best_index :  930
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (292, 3)
transformed_src_superpoints.shape :  torch.Size([292, 3])
residual.shape :  torch.Size([292])
batch_inlier_masks.shape :  torch.Size([292])
batch_outlier_masks.shape :  torch.Size([292])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([286])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.03122291 -0.01273984  0.06902441]
 [ 0.0217142  -0.01567526  0.0662612 ]
 [ 0.02592593 -0.01258899  0.066498  ]]
len(transformed_superpoints_pcd) :  1598
copy_superpoint_src_corr_points.shape :  (286, 3)
mask.shape :  (286,)
copy_superpoint_src_corr_points.shape :  (277, 3)
copy_superpoint_ref_corr_points.shape :  (277, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([277, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 277, 3])
batch_inlier_masks.shape :  torch.Size([2000, 277])
best_index :  1997
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (277, 3)
transformed_src_superpoints.shape :  torch.Size([277, 3])
residual.shape :  torch.Size([277])
batch_inlier_masks.shape :  torch.Size([277])
batch_outlier_masks.shape :  torch.Size([277])
indices_inliers.shape :  torch.Size([6])
indices_outliers.shape :  torch.Size([271])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([6, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.00055746 -0.04419724  0.05762982]
 [-0.00315675 -0.03945466  0.06154862]
 [-0.00055746 -0.04419724  0.05762982]]
len(transformed_superpoints_pcd) :  1604
copy_superpoint_src_corr_points.shape :  (271, 3)
mask.shape :  (271,)
copy_superpoint_src_corr_points.shape :  (271, 3)
copy_superpoint_ref_corr_points.shape :  (271, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([271, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 271, 3])
batch_inlier_masks.shape :  torch.Size([2000, 271])
best_index :  1544
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (271, 3)
transformed_src_superpoints.shape :  torch.Size([271, 3])
residual.shape :  torch.Size([271])
batch_inlier_masks.shape :  torch.Size([271])
batch_outlier_masks.shape :  torch.Size([271])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([266])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.0708113   0.00637114  0.00920769]
 [-0.07481323  0.01005345  0.00571855]
 [-0.0708113   0.00637114  0.00920769]]
len(transformed_superpoints_pcd) :  1609
copy_superpoint_src_corr_points.shape :  (266, 3)
mask.shape :  (266,)
copy_superpoint_src_corr_points.shape :  (254, 3)
copy_superpoint_ref_corr_points.shape :  (254, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([254, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 254, 3])
batch_inlier_masks.shape :  torch.Size([2000, 254])
best_index :  1630
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (254, 3)
transformed_src_superpoints.shape :  torch.Size([254, 3])
residual.shape :  torch.Size([254])
batch_inlier_masks.shape :  torch.Size([254])
batch_outlier_masks.shape :  torch.Size([254])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([249])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.03098625 -0.00046341 -0.07507642]
 [-0.02087431  0.03836789 -0.04902363]
 [-0.02087431  0.03836789 -0.04902363]]
len(transformed_superpoints_pcd) :  1614
copy_superpoint_src_corr_points.shape :  (249, 3)
mask.shape :  (249,)
copy_superpoint_src_corr_points.shape :  (219, 3)
copy_superpoint_ref_corr_points.shape :  (219, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([219, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 219, 3])
batch_inlier_masks.shape :  torch.Size([2000, 219])
best_index :  1675
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (219, 3)
transformed_src_superpoints.shape :  torch.Size([219, 3])
residual.shape :  torch.Size([219])
batch_inlier_masks.shape :  torch.Size([219])
batch_outlier_masks.shape :  torch.Size([219])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([214])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.02441438  0.02317152  0.07661839]
 [ 0.0192746   0.0201041   0.08074101]
 [ 0.0192746   0.0201041   0.08074101]]
len(transformed_superpoints_pcd) :  1619
copy_superpoint_src_corr_points.shape :  (214, 3)
mask.shape :  (214,)
copy_superpoint_src_corr_points.shape :  (211, 3)
copy_superpoint_ref_corr_points.shape :  (211, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([211, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 211, 3])
batch_inlier_masks.shape :  torch.Size([2000, 211])
best_index :  1808
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (211, 3)
transformed_src_superpoints.shape :  torch.Size([211, 3])
residual.shape :  torch.Size([211])
batch_inlier_masks.shape :  torch.Size([211])
batch_outlier_masks.shape :  torch.Size([211])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([206])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.04245624 -0.00740109 -0.00369448]
 [-0.04245624 -0.00740109 -0.00369448]
 [-0.04245624 -0.00740109 -0.00369448]]
len(transformed_superpoints_pcd) :  1624
copy_superpoint_src_corr_points.shape :  (206, 3)
mask.shape :  (206,)
copy_superpoint_src_corr_points.shape :  (182, 3)
copy_superpoint_ref_corr_points.shape :  (182, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([182, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 182, 3])
batch_inlier_masks.shape :  torch.Size([2000, 182])
best_index :  1922
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (182, 3)
transformed_src_superpoints.shape :  torch.Size([182, 3])
residual.shape :  torch.Size([182])
batch_inlier_masks.shape :  torch.Size([182])
batch_outlier_masks.shape :  torch.Size([182])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([177])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.06305715 -0.0362928  -0.05699719]
 [-0.06305715 -0.0362928  -0.05699719]
 [-0.06305715 -0.0362928  -0.05699719]]
len(transformed_superpoints_pcd) :  1629
copy_superpoint_src_corr_points.shape :  (177, 3)
mask.shape :  (177,)
copy_superpoint_src_corr_points.shape :  (151, 3)
copy_superpoint_ref_corr_points.shape :  (151, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([151, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 151, 3])
batch_inlier_masks.shape :  torch.Size([2000, 151])
best_index :  471
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (151, 3)
transformed_src_superpoints.shape :  torch.Size([151, 3])
residual.shape :  torch.Size([151])
batch_inlier_masks.shape :  torch.Size([151])
batch_outlier_masks.shape :  torch.Size([151])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([147])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [ 0.01131056 -0.04692091 -0.01938658]
 [-0.04590851  0.02375638  0.01204285]
 [-0.04590851  0.02375638  0.01204285]]
len(transformed_superpoints_pcd) :  1633
copy_superpoint_src_corr_points.shape :  (147, 3)
mask.shape :  (147,)
copy_superpoint_src_corr_points.shape :  (120, 3)
copy_superpoint_ref_corr_points.shape :  (120, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([120, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 120, 3])
batch_inlier_masks.shape :  torch.Size([2000, 120])
best_index :  769
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (120, 3)
transformed_src_superpoints.shape :  torch.Size([120, 3])
residual.shape :  torch.Size([120])
batch_inlier_masks.shape :  torch.Size([120])
batch_outlier_masks.shape :  torch.Size([120])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([116])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.04129374  0.02754026 -0.03930115]
 [-0.04129374  0.02754026 -0.03930115]
 [-0.04129374  0.02754026 -0.03930115]]
len(transformed_superpoints_pcd) :  1637
copy_superpoint_src_corr_points.shape :  (116, 3)
mask.shape :  (116,)
copy_superpoint_src_corr_points.shape :  (108, 3)
copy_superpoint_ref_corr_points.shape :  (108, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([108, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 108, 3])
batch_inlier_masks.shape :  torch.Size([2000, 108])
best_index :  1068
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (108, 3)
transformed_src_superpoints.shape :  torch.Size([108, 3])
residual.shape :  torch.Size([108])
batch_inlier_masks.shape :  torch.Size([108])
batch_outlier_masks.shape :  torch.Size([108])
indices_inliers.shape :  torch.Size([4])
indices_outliers.shape :  torch.Size([104])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([4, 3])
transformed_superpoints_pcd :  [[-0.06428578  0.00067463 -0.07145564]
 [-0.05439594  0.01262215 -0.06209528]
 [-0.05644229  0.00766911 -0.05513356]
 ...
 [-0.06379186 -0.00138523  0.01049583]
 [-0.05837063 -0.01859467 -0.05383957]
 [-0.05534228 -0.01395998 -0.05090196]]
len(transformed_superpoints_pcd) :  1641
copy_superpoint_src_corr_points.shape :  (104, 3)
mask.shape :  (104,)
copy_superpoint_src_corr_points.shape :  (96, 3)
copy_superpoint_ref_corr_points.shape :  (96, 3)
number of unique points in pcd :  666
number of rotations used :  51
transformed_superpoints_pcd.shape :  (1737, 3)
Line set updated
175
src_points :  [[-0.0561409  -0.06865093 -0.00998425]
 [-0.05413438 -0.07329141 -0.00922741]
 [-0.0551144  -0.07699531 -0.00552938]
 ...
 [ 0.05121687 -0.03328164 -0.01104093]
 [ 0.01486516 -0.06829056 -0.02942919]
 [ 0.00588213 -0.08915967 -0.06097643]]
ref_points :  [[-0.04742106  0.0305889   0.04937431]
 [-0.04703869  0.03598812  0.04577447]
 [-0.04770895  0.03873043  0.03985372]
 ...
 [ 0.03574163  0.12188847 -0.01777128]
 [ 0.01871568  0.11907101 -0.01643766]
 [-0.00637812  0.1320648  -0.02666004]]
Entered into precompute_data_stack_mode
points.shape :  torch.Size([4241, 3])
lengths :  tensor([2101, 2140])
num_stages :  3
voxel_sie :  0.004
radius :  0.01
points.shape :  torch.Size([2683, 3])
lengths.shape :  torch.Size([2])
points.shape :  torch.Size([809, 3])
lengths.shape :  torch.Size([2])
ref_points_c.shape :  torch.Size([400, 3])
ref_points_f.shape :  torch.Size([2101, 3])
src_points_c.shape :  torch.Size([409, 3])
src_points_f.shape :  torch.Size([2140, 3])
ref_node_masks.shape :  torch.Size([400])
ref_node_knn_indices.shape :  torch.Size([400, 5])
ref_node_knn_masks.shape :  torch.Size([400, 5])
src_node_masks.shape :  torch.Size([409])
src_node_knn_indices.shape :  torch.Size([409, 5])
src_node_knn_masks.shape :  torch.Size([409, 5])
ref_node_knn_points.shape :  torch.Size([400, 5, 3])
src_node_knn_points.shape :  torch.Size([409, 5, 3])
len(points_list) :  3
len(neighbors_list) :  3
len(subsampling_list) :  2
len(upsampling_list) :  2
len(feats_list) :  3
feats_c :  torch.Size([809, 512])
feats_f :  torch.Size([4241, 256])
k :  3
omegas.shape :  torch.Size([160000, 128, 1])
omegas.shape :  torch.Size([480000, 128, 1])
k :  3
omegas.shape :  torch.Size([167281, 128, 1])
omegas.shape :  torch.Size([501843, 128, 1])
ref_feats_c.shape :  torch.Size([1, 400, 256])
src_feats_c.shape :  torch.Size([1, 409, 256])
ref_feats_c_norm.shape :  torch.Size([400, 256])
src_feats_c_norm.shape :  torch.Size([409, 256])
ref_node_masks.shape :  torch.Size([400])
src_node_masks.shape :  torch.Size([409])
self.num_correspondences :  2000
matching_scores.numel() :  163600
num_correspondences :  2000
ref_node_corr_indices.shape :  torch.Size([2000])
src_node_corr_indices.shape :  torch.Size([2000])
ref_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
src_node_corr_knn_points.shape :  torch.Size([2000, 5, 3])
ref_node_corr_knn_masks.shape :  torch.Size([2000, 5])
src_node_corr_knn_masks.shape :  torch.Size([2000, 5])
matching_scores.shape :  torch.Size([2000, 5, 5])
node_corr_scores.shape :  torch.Size([2000])
score_mat.shape :  torch.Size([2000, 5, 5])
ref_knn_masks.shape :  torch.Size([2000, 5])
src_knn_masks.shape :  torch.Size([2000, 5])
Inside of compute_correspondence_matrix
self.k :  3
ref_topk_scores.shape:  torch.Size([2000, 5, 3])
self.confidence_threshold :  0.1
Inside local_to_global_registration
ref_knn_points.shape :  torch.Size([2000, 5, 3])
src_knn_points.shape :  torch.Size([2000, 5, 3])
batch_indices.shape :  torch.Size([21837])
ref_indices.shape :  torch.Size([21837])
src_indices.shape :  torch.Size([21837])
batch_indices :  tensor([   0,    0,    0,  ..., 1999, 1999, 1999], device='cuda:0')
ref_indices :  tensor([0, 0, 0,  ..., 3, 3, 3], device='cuda:0')
src_indices :  tensor([1, 2, 3,  ..., 2, 3, 4], device='cuda:0')
global_ref_corr_points.shape :  torch.Size([21837, 3])
global_src_corr_points.shape :  torch.Size([21837, 3])
Superpoints updated
Line set updated
Case when more than one tranformation suggested
batch_transforms.shape :  torch.Size([2000, 4, 4])
src_corr_points.shape :  torch.Size([21837, 3])
ref_corr_points.shape :  torch.Size([1, 21837, 3])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 21837, 3])
batch_corr_residuals.shape :  torch.Size([2000, 21837])
batch_inlier_masks.shape :  torch.Size([2000, 21837])
best_index :  tensor(1527, device='cuda:0')
len(batch_transforms) :  2000
estimated_transform :  [[-0.7005271  -0.12801982 -0.702049   -0.00109261]
 [ 0.5439663  -0.7325669  -0.40920216 -0.02051128]
 [-0.46191195 -0.66854805  0.58282137 -0.0049378 ]
 [ 0.          0.          0.          1.        ]]
sorted_indices :  [1062 1679 1047 ... 1836   13 1527]
superpoint_src_corr_points.shape :  (21837, 3)
superpoint_ref_corr_points.shape :  (21837, 3)
batch_inlier_masks.shape :  (2000, 21837)
batch_transforms.shape :  (2000, 4, 4)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([21837, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 21837, 3])
batch_inlier_masks.shape :  torch.Size([2000, 21837])
best_index :  195
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (21837, 3)
transformed_src_superpoints.shape :  torch.Size([21837, 3])
residual.shape :  torch.Size([21837])
batch_inlier_masks.shape :  torch.Size([21837])
batch_outlier_masks.shape :  torch.Size([21837])
indices_inliers.shape :  torch.Size([138])
indices_outliers.shape :  torch.Size([21699])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([138, 3])
transformed_superpoints_pcd :  [[ 3.96633223e-02 -1.02702275e-01  4.33459431e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 4.34319302e-02 -9.78560299e-02  4.49178629e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.34319302e-02 -9.78560299e-02  4.49178629e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 3.96633223e-02 -1.02702275e-01  4.33459431e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.96633223e-02 -1.02702275e-01  4.33459431e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [-5.64179346e-02 -5.77401370e-02  4.80641611e-03]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 4.38925102e-02 -9.53903049e-02  2.81596556e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 3.99414003e-02 -1.01498023e-01  2.88222954e-02]
 [ 4.04367708e-02 -9.69083980e-02  2.45294794e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 3.99414003e-02 -1.01498023e-01  2.88222954e-02]
 [ 4.04367708e-02 -9.69083980e-02  2.45294794e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 3.99414003e-02 -1.01498023e-01  2.88222954e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [-1.58178192e-02 -1.90329961e-02  4.65150289e-02]
 [-1.21905059e-02 -1.40532795e-02  4.83531840e-02]
 [-1.21905059e-02 -1.40532795e-02  4.83531840e-02]
 [-8.02086294e-03 -1.66418646e-02  4.96671796e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [-1.88111123e-02 -7.89148547e-03  4.41367999e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 2.57676765e-02 -1.06230840e-01  3.06144878e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [ 2.57676765e-02 -1.06230840e-01  3.06144878e-02]
 [ 2.57676765e-02 -1.06230840e-01  3.06144878e-02]
 [ 2.56657824e-02 -1.04195453e-01  2.36271359e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.34319302e-02 -9.78560299e-02  4.49178629e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 2.64310949e-02 -9.40680355e-02  5.11459373e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [-4.85720150e-02 -7.04031587e-02  1.14068566e-02]
 [-4.85720150e-02 -7.04031587e-02  1.14068566e-02]
 [-5.51685616e-02 -6.72345310e-02  4.57803905e-03]
 [-5.21351993e-02 -6.17734157e-02  9.27437562e-03]
 [-5.28301746e-02 -7.25951940e-02  7.35498965e-03]
 [-5.28301746e-02 -7.25951940e-02  7.35498965e-03]
 [-4.85720150e-02 -7.04031587e-02  1.14068566e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 4.38925102e-02 -9.53903049e-02  2.81596556e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 4.71582413e-02 -9.00869071e-02  3.21692117e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 2.26104129e-02  1.06801149e-02 -2.23834515e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 1.70831308e-02  1.71984043e-02 -2.63033304e-02]
 [-1.21905059e-02 -1.40532795e-02  4.83531840e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-1.80389304e-02 -3.94438170e-02  4.01674286e-02]
 [-2.82221008e-02 -3.60833593e-02  3.35263908e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-1.80389304e-02 -3.94438170e-02  4.01674286e-02]
 [-2.82221008e-02 -3.60833593e-02  3.35263908e-02]
 [-2.29396559e-02 -3.35337408e-02  3.88484001e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-1.80389304e-02 -3.94438170e-02  4.01674286e-02]
 [-2.29396559e-02 -3.35337408e-02  3.88484001e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [-2.29270868e-02 -2.78724339e-02  4.03379798e-02]
 [-2.64554005e-02 -2.94224937e-02  3.69302630e-02]
 [-2.81459652e-02 -2.45322809e-02  3.68339494e-02]
 [-2.64554005e-02 -2.94224937e-02  3.69302630e-02]
 [ 2.07455959e-02  1.58465747e-02 -2.18453277e-02]
 [ 2.26104129e-02  1.06801149e-02 -2.23834515e-02]
 [ 1.91611033e-02  2.08309889e-02 -2.14650985e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 1.91611033e-02  2.08309889e-02 -2.14650985e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [-1.40823610e-02 -8.06042179e-03  4.71255556e-02]
 [-1.74927451e-02 -1.30412932e-02  4.53260131e-02]
 [-1.88111123e-02 -7.89148547e-03  4.41367999e-02]
 [-2.19159871e-02 -3.55965598e-03  4.12827879e-02]
 [-1.88111123e-02 -7.89148547e-03  4.41367999e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [-1.40823610e-02 -8.06042179e-03  4.71255556e-02]
 [-1.74927451e-02 -1.30412932e-02  4.53260131e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [-2.82221008e-02 -3.60833593e-02  3.35263908e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 5.42467088e-03 -4.49613482e-03 -4.00703549e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [ 2.24850774e-02  6.27767295e-05 -2.73093916e-02]
 [ 2.52318010e-02  2.00038310e-03 -2.27901880e-02]
 [-2.19159871e-02 -3.55965598e-03  4.12827879e-02]
 [-2.19159871e-02 -3.55965598e-03  4.12827879e-02]
 [ 1.31836515e-02  1.25903413e-02 -3.25467139e-02]]
len(transformed_superpoints_pcd) :  138
copy_superpoint_src_corr_points.shape :  (21699, 3)
mask.shape :  (21699,)
copy_superpoint_src_corr_points.shape :  (18993, 3)
copy_superpoint_ref_corr_points.shape :  (18993, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([18993, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 18993, 3])
batch_inlier_masks.shape :  torch.Size([2000, 18993])
best_index :  1210
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (18993, 3)
transformed_src_superpoints.shape :  torch.Size([18993, 3])
residual.shape :  torch.Size([18993])
batch_inlier_masks.shape :  torch.Size([18993])
batch_outlier_masks.shape :  torch.Size([18993])
indices_inliers.shape :  torch.Size([110])
indices_outliers.shape :  torch.Size([18883])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([110, 3])
transformed_superpoints_pcd :  [[ 3.96633223e-02 -1.02702275e-01  4.33459431e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 4.34319302e-02 -9.78560299e-02  4.49178629e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.34319302e-02 -9.78560299e-02  4.49178629e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 3.96633223e-02 -1.02702275e-01  4.33459431e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.96633223e-02 -1.02702275e-01  4.33459431e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [-5.64179346e-02 -5.77401370e-02  4.80641611e-03]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 4.38925102e-02 -9.53903049e-02  2.81596556e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 3.99414003e-02 -1.01498023e-01  2.88222954e-02]
 [ 4.04367708e-02 -9.69083980e-02  2.45294794e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 3.99414003e-02 -1.01498023e-01  2.88222954e-02]
 [ 4.04367708e-02 -9.69083980e-02  2.45294794e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 3.99414003e-02 -1.01498023e-01  2.88222954e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [-1.58178192e-02 -1.90329961e-02  4.65150289e-02]
 [-1.21905059e-02 -1.40532795e-02  4.83531840e-02]
 [-1.21905059e-02 -1.40532795e-02  4.83531840e-02]
 [-8.02086294e-03 -1.66418646e-02  4.96671796e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [-1.88111123e-02 -7.89148547e-03  4.41367999e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 2.57676765e-02 -1.06230840e-01  3.06144878e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [ 2.57676765e-02 -1.06230840e-01  3.06144878e-02]
 [ 2.57676765e-02 -1.06230840e-01  3.06144878e-02]
 [ 2.56657824e-02 -1.04195453e-01  2.36271359e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.34319302e-02 -9.78560299e-02  4.49178629e-02]
 [ 4.57223505e-02 -9.74097624e-02  3.78763787e-02]
 [ 4.21135351e-02 -1.02113724e-01  3.77117246e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 2.64310949e-02 -9.40680355e-02  5.11459373e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.89395282e-02 -9.93238688e-02  4.72359397e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.37277278e-02 -1.06604040e-01  3.01668197e-02]
 [ 3.01543549e-02 -1.07236557e-01  3.46023105e-02]
 [-4.85720150e-02 -7.04031587e-02  1.14068566e-02]
 [-4.85720150e-02 -7.04031587e-02  1.14068566e-02]
 [-5.51685616e-02 -6.72345310e-02  4.57803905e-03]
 [-5.21351993e-02 -6.17734157e-02  9.27437562e-03]
 [-5.28301746e-02 -7.25951940e-02  7.35498965e-03]
 [-5.28301746e-02 -7.25951940e-02  7.35498965e-03]
 [-4.85720150e-02 -7.04031587e-02  1.14068566e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 4.33813818e-02 -9.99902487e-02  3.23612690e-02]
 [ 4.38925102e-02 -9.53903049e-02  2.81596556e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 3.84616815e-02 -1.05697520e-01  3.15840505e-02]
 [ 4.71582413e-02 -9.00869071e-02  3.21692117e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 2.26104129e-02  1.06801149e-02 -2.23834515e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 1.70831308e-02  1.71984043e-02 -2.63033304e-02]
 [-1.21905059e-02 -1.40532795e-02  4.83531840e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-1.80389304e-02 -3.94438170e-02  4.01674286e-02]
 [-2.82221008e-02 -3.60833593e-02  3.35263908e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-1.80389304e-02 -3.94438170e-02  4.01674286e-02]
 [-2.82221008e-02 -3.60833593e-02  3.35263908e-02]
 [-2.29396559e-02 -3.35337408e-02  3.88484001e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-1.80389304e-02 -3.94438170e-02  4.01674286e-02]
 [-2.29396559e-02 -3.35337408e-02  3.88484001e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [-2.29270868e-02 -2.78724339e-02  4.03379798e-02]
 [-2.64554005e-02 -2.94224937e-02  3.69302630e-02]
 [-2.81459652e-02 -2.45322809e-02  3.68339494e-02]
 [-2.64554005e-02 -2.94224937e-02  3.69302630e-02]
 [ 2.07455959e-02  1.58465747e-02 -2.18453277e-02]
 [ 2.26104129e-02  1.06801149e-02 -2.23834515e-02]
 [ 1.91611033e-02  2.08309889e-02 -2.14650985e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 1.91611033e-02  2.08309889e-02 -2.14650985e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [-1.40823610e-02 -8.06042179e-03  4.71255556e-02]
 [-1.74927451e-02 -1.30412932e-02  4.53260131e-02]
 [-1.88111123e-02 -7.89148547e-03  4.41367999e-02]
 [-2.19159871e-02 -3.55965598e-03  4.12827879e-02]
 [-1.88111123e-02 -7.89148547e-03  4.41367999e-02]
 [-1.53423827e-02 -3.21032014e-03  4.58931476e-02]
 [-1.40823610e-02 -8.06042179e-03  4.71255556e-02]
 [-1.74927451e-02 -1.30412932e-02  4.53260131e-02]
 [ 3.11545655e-02 -9.86518934e-02  4.95328307e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 2.62850672e-02 -1.00657165e-01  4.78000343e-02]
 [ 3.39648724e-02 -1.01696230e-01  4.64983694e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [-2.82221008e-02 -3.60833593e-02  3.35263908e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [-2.16714367e-02 -4.19094041e-02  3.60580608e-02]
 [-2.49730628e-02 -4.37319018e-02  3.24092843e-02]
 [ 1.91814024e-02  1.18710510e-02 -2.68254653e-02]
 [ 5.42467088e-03 -4.49613482e-03 -4.00703549e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [ 1.11552719e-02  4.19421457e-02 -1.42912781e-02]
 [ 2.24850774e-02  6.27767295e-05 -2.73093916e-02]
 [ 2.52318010e-02  2.00038310e-03 -2.27901880e-02]
 [-2.19159871e-02 -3.55965598e-03  4.12827879e-02]
 [-2.19159871e-02 -3.55965598e-03  4.12827879e-02]
 [ 1.31836515e-02  1.25903413e-02 -3.25467139e-02]
 [ 3.31541859e-02 -8.02413374e-02  5.32863662e-02]
 [ 3.46295498e-02 -8.53474215e-02  4.84689996e-02]
 [ 3.25553417e-02 -9.11525860e-02  5.21490574e-02]
 [ 3.25553417e-02 -9.11525860e-02  5.21490574e-02]
 [ 3.06202099e-02 -8.23707655e-02  5.74866533e-02]
 [ 3.31541859e-02 -8.02413374e-02  5.32863662e-02]
 [ 3.46295498e-02 -8.53474215e-02  4.84689996e-02]
 [ 2.89764330e-02 -9.86586213e-02  4.65539768e-02]
 [ 2.97492668e-02 -9.65722576e-02  5.10797724e-02]
 [ 3.45710702e-02 -8.00613537e-02  4.82129231e-02]
 [ 2.89764330e-02 -9.86586213e-02  4.65539768e-02]
 [ 2.52083763e-02 -9.99202579e-02  5.38845509e-02]
 [ 2.89764330e-02 -9.86586213e-02  4.65539768e-02]
 [ 2.97492668e-02 -9.65722576e-02  5.10797724e-02]
 [ 2.52083763e-02 -9.99202579e-02  5.38845509e-02]
 [ 3.41694988e-02 -7.97864124e-02  4.31297272e-02]
 [-1.69615000e-02 -5.43670096e-02  3.05010062e-02]
 [-1.40206823e-02 -4.67768647e-02  3.37568149e-02]
 [-4.83079068e-03 -1.22642769e-02  4.62668985e-02]
 [-4.83079068e-03 -1.22642769e-02  4.62668985e-02]
 [-6.79128710e-03 -6.94396067e-03  4.63243574e-02]
 [-6.79128710e-03 -6.94396067e-03  4.63243574e-02]
 [-6.79128710e-03 -6.94396067e-03  4.63243574e-02]
 [-1.79892108e-02 -3.37472111e-02  3.21780592e-02]
 [-1.79892108e-02 -3.37472111e-02  3.21780592e-02]
 [-1.87760405e-02 -2.75211409e-02  3.27662528e-02]
 [-1.79892108e-02 -3.37472111e-02  3.21780592e-02]
 [-1.87760405e-02 -2.75211409e-02  3.27662528e-02]
 [-1.79892108e-02 -3.37472111e-02  3.21780592e-02]
 [-1.33563252e-02 -3.97001430e-02  3.45830694e-02]
 [ 2.89764330e-02 -9.86586213e-02  4.65539768e-02]
 [ 2.18208842e-02 -1.03356585e-01  4.88657728e-02]
 [ 2.18208842e-02 -1.03356585e-01  4.88657728e-02]
 [-1.05961850e-02  3.17369848e-02  3.95842791e-02]
 [-1.87760405e-02 -2.75211409e-02  3.27662528e-02]
 [-1.53930588e-02 -2.54731048e-02  3.63631397e-02]
 [-1.53930588e-02 -2.54731048e-02  3.63631397e-02]
 [-1.53930588e-02 -2.54731048e-02  3.63631397e-02]
 [ 4.71972525e-02 -1.97160011e-03 -1.98444221e-02]
 [ 2.97492668e-02 -9.65722576e-02  5.10797724e-02]
 [ 3.07240970e-02 -9.59725082e-02  3.99781466e-02]
 [ 3.07240970e-02 -9.59725082e-02  3.99781466e-02]
 [ 2.54048146e-02 -1.02106594e-01  4.25273702e-02]
 [-2.18711719e-02 -4.31155898e-02  2.72143502e-02]
 [ 1.73777286e-02  3.32355276e-02 -2.38137003e-02]
 [ 2.26825327e-02  3.06816902e-02 -2.12469008e-02]
 [ 3.46295498e-02 -8.53474215e-02  4.84689996e-02]
 [ 3.22388560e-02 -8.81114230e-03 -3.13804820e-02]
 [ 2.28006728e-02  3.55491266e-02 -1.77313741e-02]
 [ 1.67062301e-02  3.92849967e-02 -2.09764857e-02]
 [ 1.99077874e-02  4.04945910e-02 -1.66815352e-02]
 [ 1.67062301e-02  3.92849967e-02 -2.09764857e-02]
 [ 1.99077874e-02  4.04945910e-02 -1.66815352e-02]
 [ 1.73777286e-02  3.32355276e-02 -2.38137003e-02]
 [ 1.67062301e-02  3.92849967e-02 -2.09764857e-02]
 [ 2.26825327e-02  3.06816902e-02 -2.12469008e-02]
 [ 2.28006728e-02  3.55491266e-02 -1.77313741e-02]
 [ 1.99077874e-02  4.04945910e-02 -1.66815352e-02]
 [ 3.16221379e-02  1.44646550e-02 -2.35961583e-02]
 [ 3.60596366e-02  9.45528038e-03 -2.19398383e-02]
 [ 3.16221379e-02  1.44646550e-02 -2.35961583e-02]
 [ 3.19463275e-02 -6.70768023e-02  3.64829227e-02]
 [-6.79128710e-03 -6.94396067e-03  4.63243574e-02]
 [ 4.66335416e-02 -5.85189601e-03 -2.39255577e-02]
 [ 4.66335416e-02 -5.85189601e-03 -2.39255577e-02]
 [ 2.76856981e-02 -9.75621492e-02  3.21598500e-02]
 [ 2.76856981e-02 -9.75621492e-02  3.21598500e-02]
 [ 2.42235810e-02 -1.01319939e-01  3.31398174e-02]
 [ 2.70825066e-02 -1.00308724e-01  3.78443822e-02]
 [ 2.70825066e-02 -1.00308724e-01  3.78443822e-02]
 [ 4.05053645e-02  4.56782430e-03 -2.05597505e-02]
 [ 4.60482016e-02  3.53578385e-03 -1.50021184e-02]
 [ 4.05053645e-02  4.56782430e-03 -2.05597505e-02]
 [-8.77943076e-03 -1.80801973e-02  4.32171300e-02]
 [-3.46625410e-03 -1.99163724e-02  4.49516997e-02]
 [ 1.99077874e-02  4.04945910e-02 -1.66815352e-02]
 [ 3.60596366e-02  9.45528038e-03 -2.19398383e-02]
 [ 3.16221379e-02  1.44646550e-02 -2.35961583e-02]
 [ 3.60596366e-02  9.45528038e-03 -2.19398383e-02]
 [ 3.16221379e-02  1.44646550e-02 -2.35961583e-02]
 [ 3.60596366e-02  9.45528038e-03 -2.19398383e-02]
 [ 5.39392978e-03  5.23671173e-02 -1.53579917e-02]
 [ 2.08051540e-02  1.10897338e-02 -3.30678299e-02]
 [ 2.82789208e-02  9.07433219e-03 -2.85074525e-02]
 [ 2.82789208e-02  9.07433219e-03 -2.85074525e-02]
 [ 2.43207552e-02  7.27070589e-03 -3.15235108e-02]
 [ 2.82789208e-02  9.07433219e-03 -2.85074525e-02]
 [ 3.62851098e-02  3.60486424e-03 -2.45367065e-02]
 [ 3.26474421e-02  1.56731845e-03 -2.78169867e-02]
 [ 3.62839587e-02 -1.91385392e-03 -2.67957821e-02]
 [ 4.26510386e-02 -1.09666609e-04 -2.18296293e-02]
 [ 3.62851098e-02  3.60486424e-03 -2.45367065e-02]
 [ 2.50279382e-02  2.52993293e-02 -2.32379101e-02]
 [ 2.50279382e-02  2.52993293e-02 -2.32379101e-02]
 [ 1.53403264e-02  1.33738304e-02 -3.52288559e-02]
 [ 2.07550973e-02  1.68131851e-02 -3.12170144e-02]
 [-2.18711719e-02 -4.31155898e-02  2.72143502e-02]
 [-1.89361721e-02 -4.71724011e-02  2.96037812e-02]
 [-1.80815086e-02 -4.11559269e-02  3.09995953e-02]
 [-1.89361721e-02 -4.71724011e-02  2.96037812e-02]
 [-1.80815086e-02 -4.11559269e-02  3.09995953e-02]
 [-2.18711719e-02 -4.31155898e-02  2.72143502e-02]
 [-1.89361721e-02 -4.71724011e-02  2.96037812e-02]
 [-1.80815086e-02 -4.11559269e-02  3.09995953e-02]
 [ 3.07240970e-02 -9.59725082e-02  3.99781466e-02]
 [ 2.54048146e-02 -1.02106594e-01  4.25273702e-02]
 [ 2.70825066e-02 -1.00308724e-01  3.78443822e-02]
 [ 2.54048146e-02 -1.02106594e-01  4.25273702e-02]
 [ 2.70825066e-02 -1.00308724e-01  3.78443822e-02]
 [ 2.54048146e-02 -1.02106594e-01  4.25273702e-02]]
len(transformed_superpoints_pcd) :  248
copy_superpoint_src_corr_points.shape :  (18883, 3)
mask.shape :  (18883,)
copy_superpoint_src_corr_points.shape :  (16159, 3)
copy_superpoint_ref_corr_points.shape :  (16159, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([16159, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 16159, 3])
batch_inlier_masks.shape :  torch.Size([2000, 16159])
best_index :  364
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (16159, 3)
transformed_src_superpoints.shape :  torch.Size([16159, 3])
residual.shape :  torch.Size([16159])
batch_inlier_masks.shape :  torch.Size([16159])
batch_outlier_masks.shape :  torch.Size([16159])
indices_inliers.shape :  torch.Size([106])
indices_outliers.shape :  torch.Size([16053])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([106, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00491938  0.00883022 -0.03593166]
 [ 0.01052473  0.01219523 -0.03336333]
 [ 0.00727589  0.01747824 -0.02904708]]
len(transformed_superpoints_pcd) :  354
copy_superpoint_src_corr_points.shape :  (16053, 3)
mask.shape :  (16053,)
copy_superpoint_src_corr_points.shape :  (13537, 3)
copy_superpoint_ref_corr_points.shape :  (13537, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([13537, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 13537, 3])
batch_inlier_masks.shape :  torch.Size([2000, 13537])
best_index :  1249
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (13537, 3)
transformed_src_superpoints.shape :  torch.Size([13537, 3])
residual.shape :  torch.Size([13537])
batch_inlier_masks.shape :  torch.Size([13537])
batch_outlier_masks.shape :  torch.Size([13537])
indices_inliers.shape :  torch.Size([82])
indices_outliers.shape :  torch.Size([13455])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([82, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.02299952  0.0163285  -0.03312747]
 [ 0.02299952  0.0163285  -0.03312747]
 [ 0.02035244  0.01213847 -0.03453587]]
len(transformed_superpoints_pcd) :  436
copy_superpoint_src_corr_points.shape :  (13455, 3)
mask.shape :  (13455,)
copy_superpoint_src_corr_points.shape :  (11100, 3)
copy_superpoint_ref_corr_points.shape :  (11100, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([11100, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 11100, 3])
batch_inlier_masks.shape :  torch.Size([2000, 11100])
best_index :  1902
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (11100, 3)
transformed_src_superpoints.shape :  torch.Size([11100, 3])
residual.shape :  torch.Size([11100])
batch_inlier_masks.shape :  torch.Size([11100])
batch_outlier_masks.shape :  torch.Size([11100])
indices_inliers.shape :  torch.Size([76])
indices_outliers.shape :  torch.Size([11024])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([76, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00996283  0.04019612  0.0359664 ]
 [ 0.01086253  0.04587766  0.0371751 ]
 [ 0.00996283  0.04019612  0.0359664 ]]
len(transformed_superpoints_pcd) :  512
copy_superpoint_src_corr_points.shape :  (11024, 3)
mask.shape :  (11024,)
copy_superpoint_src_corr_points.shape :  (8878, 3)
copy_superpoint_ref_corr_points.shape :  (8878, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([8878, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 8878, 3])
batch_inlier_masks.shape :  torch.Size([2000, 8878])
best_index :  1142
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (8878, 3)
transformed_src_superpoints.shape :  torch.Size([8878, 3])
residual.shape :  torch.Size([8878])
batch_inlier_masks.shape :  torch.Size([8878])
batch_outlier_masks.shape :  torch.Size([8878])
indices_inliers.shape :  torch.Size([58])
indices_outliers.shape :  torch.Size([8820])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([58, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.02971965  0.00281494 -0.02769824]
 [ 0.03207131  0.00309552 -0.03239207]
 [ 0.02392074  0.00241007 -0.02824596]]
len(transformed_superpoints_pcd) :  570
copy_superpoint_src_corr_points.shape :  (8820, 3)
mask.shape :  (8820,)
copy_superpoint_src_corr_points.shape :  (7336, 3)
copy_superpoint_ref_corr_points.shape :  (7336, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7336, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7336, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7336])
best_index :  1883
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7336, 3)
transformed_src_superpoints.shape :  torch.Size([7336, 3])
residual.shape :  torch.Size([7336])
batch_inlier_masks.shape :  torch.Size([7336])
batch_outlier_masks.shape :  torch.Size([7336])
indices_inliers.shape :  torch.Size([58])
indices_outliers.shape :  torch.Size([7278])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([58, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.04652487 -0.0831141   0.04072265]
 [ 0.04573313 -0.0796762   0.04595768]
 [ 0.04277958 -0.09629444  0.04724672]]
len(transformed_superpoints_pcd) :  628
copy_superpoint_src_corr_points.shape :  (7278, 3)
mask.shape :  (7278,)
copy_superpoint_src_corr_points.shape :  (7040, 3)
copy_superpoint_ref_corr_points.shape :  (7040, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([7040, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 7040, 3])
batch_inlier_masks.shape :  torch.Size([2000, 7040])
best_index :  1503
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (7040, 3)
transformed_src_superpoints.shape :  torch.Size([7040, 3])
residual.shape :  torch.Size([7040])
batch_inlier_masks.shape :  torch.Size([7040])
batch_outlier_masks.shape :  torch.Size([7040])
indices_inliers.shape :  torch.Size([50])
indices_outliers.shape :  torch.Size([6990])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([50, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [-0.0454943  -0.08117343 -0.00548291]
 [-0.04822277 -0.07893896 -0.00991923]
 [-0.0454943  -0.08117343 -0.00548291]]
len(transformed_superpoints_pcd) :  678
copy_superpoint_src_corr_points.shape :  (6990, 3)
mask.shape :  (6990,)
copy_superpoint_src_corr_points.shape :  (5974, 3)
copy_superpoint_ref_corr_points.shape :  (5974, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5974, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5974, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5974])
best_index :  1862
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5974, 3)
transformed_src_superpoints.shape :  torch.Size([5974, 3])
residual.shape :  torch.Size([5974])
batch_inlier_masks.shape :  torch.Size([5974])
batch_outlier_masks.shape :  torch.Size([5974])
indices_inliers.shape :  torch.Size([45])
indices_outliers.shape :  torch.Size([5929])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([45, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [-0.03184636 -0.00878739  0.0391984 ]
 [ 0.03848094 -0.00029118 -0.02183731]
 [ 0.04087775 -0.00337826 -0.01811237]]
len(transformed_superpoints_pcd) :  723
copy_superpoint_src_corr_points.shape :  (5929, 3)
mask.shape :  (5929,)
copy_superpoint_src_corr_points.shape :  (5259, 3)
copy_superpoint_ref_corr_points.shape :  (5259, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([5259, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 5259, 3])
batch_inlier_masks.shape :  torch.Size([2000, 5259])
best_index :  1970
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (5259, 3)
transformed_src_superpoints.shape :  torch.Size([5259, 3])
residual.shape :  torch.Size([5259])
batch_inlier_masks.shape :  torch.Size([5259])
batch_outlier_masks.shape :  torch.Size([5259])
indices_inliers.shape :  torch.Size([39])
indices_outliers.shape :  torch.Size([5220])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([39, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00803852  0.02614436 -0.02956871]
 [ 0.00889172  0.03177764 -0.02589238]
 [ 0.00398976  0.03169205 -0.02766664]]
len(transformed_superpoints_pcd) :  762
copy_superpoint_src_corr_points.shape :  (5220, 3)
mask.shape :  (5220,)
copy_superpoint_src_corr_points.shape :  (4262, 3)
copy_superpoint_ref_corr_points.shape :  (4262, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([4262, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 4262, 3])
batch_inlier_masks.shape :  torch.Size([2000, 4262])
best_index :  1370
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (4262, 3)
transformed_src_superpoints.shape :  torch.Size([4262, 3])
residual.shape :  torch.Size([4262])
batch_inlier_masks.shape :  torch.Size([4262])
batch_outlier_masks.shape :  torch.Size([4262])
indices_inliers.shape :  torch.Size([38])
indices_outliers.shape :  torch.Size([4224])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([38, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.02650212 -0.06623816 -0.00541721]
 [ 0.04107961 -0.09359908  0.0063088 ]
 [ 0.04107961 -0.09359908  0.0063088 ]]
len(transformed_superpoints_pcd) :  800
copy_superpoint_src_corr_points.shape :  (4224, 3)
mask.shape :  (4224,)
copy_superpoint_src_corr_points.shape :  (3820, 3)
copy_superpoint_ref_corr_points.shape :  (3820, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3820, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3820, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3820])
best_index :  1766
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3820, 3)
transformed_src_superpoints.shape :  torch.Size([3820, 3])
residual.shape :  torch.Size([3820])
batch_inlier_masks.shape :  torch.Size([3820])
batch_outlier_masks.shape :  torch.Size([3820])
indices_inliers.shape :  torch.Size([32])
indices_outliers.shape :  torch.Size([3788])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([32, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.01631314  0.03933775  0.03816535]
 [ 0.01132389  0.03749     0.04016335]
 [ 0.01631314  0.03933775  0.03816535]]
len(transformed_superpoints_pcd) :  832
copy_superpoint_src_corr_points.shape :  (3788, 3)
mask.shape :  (3788,)
copy_superpoint_src_corr_points.shape :  (3072, 3)
copy_superpoint_ref_corr_points.shape :  (3072, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([3072, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 3072, 3])
batch_inlier_masks.shape :  torch.Size([2000, 3072])
best_index :  523
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (3072, 3)
transformed_src_superpoints.shape :  torch.Size([3072, 3])
residual.shape :  torch.Size([3072])
batch_inlier_masks.shape :  torch.Size([3072])
batch_outlier_masks.shape :  torch.Size([3072])
indices_inliers.shape :  torch.Size([27])
indices_outliers.shape :  torch.Size([3045])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([27, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.0520264  -0.00297501 -0.01495863]
 [ 0.0520264  -0.00297501 -0.01495863]
 [ 0.01384872  0.00444733 -0.04206231]]
len(transformed_superpoints_pcd) :  859
copy_superpoint_src_corr_points.shape :  (3045, 3)
mask.shape :  (3045,)
copy_superpoint_src_corr_points.shape :  (2725, 3)
copy_superpoint_ref_corr_points.shape :  (2725, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2725, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2725, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2725])
best_index :  786
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2725, 3)
transformed_src_superpoints.shape :  torch.Size([2725, 3])
residual.shape :  torch.Size([2725])
batch_inlier_masks.shape :  torch.Size([2725])
batch_outlier_masks.shape :  torch.Size([2725])
indices_inliers.shape :  torch.Size([22])
indices_outliers.shape :  torch.Size([2703])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([22, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.02693968  0.03867809 -0.01365144]
 [ 0.02929716  0.04173997 -0.00960445]
 [ 0.0318567   0.04565047 -0.00625604]]
len(transformed_superpoints_pcd) :  881
copy_superpoint_src_corr_points.shape :  (2703, 3)
mask.shape :  (2703,)
copy_superpoint_src_corr_points.shape :  (2343, 3)
copy_superpoint_ref_corr_points.shape :  (2343, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2343, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2343, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2343])
best_index :  561
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2343, 3)
transformed_src_superpoints.shape :  torch.Size([2343, 3])
residual.shape :  torch.Size([2343])
batch_inlier_masks.shape :  torch.Size([2343])
batch_outlier_masks.shape :  torch.Size([2343])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([2325])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [-0.04653903 -0.06672866  0.01017099]
 [-0.04296728 -0.0651103   0.01349838]
 [-0.04653903 -0.06672866  0.01017099]]
len(transformed_superpoints_pcd) :  899
copy_superpoint_src_corr_points.shape :  (2325, 3)
mask.shape :  (2325,)
copy_superpoint_src_corr_points.shape :  (2144, 3)
copy_superpoint_ref_corr_points.shape :  (2144, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([2144, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 2144, 3])
batch_inlier_masks.shape :  torch.Size([2000, 2144])
best_index :  1610
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (2144, 3)
transformed_src_superpoints.shape :  torch.Size([2144, 3])
residual.shape :  torch.Size([2144])
batch_inlier_masks.shape :  torch.Size([2144])
batch_outlier_masks.shape :  torch.Size([2144])
indices_inliers.shape :  torch.Size([18])
indices_outliers.shape :  torch.Size([2126])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([18, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.04846859 -0.08545817  0.04263203]
 [ 0.04474381 -0.08326302  0.04657934]
 [ 0.04494306 -0.07910655  0.0430049 ]]
len(transformed_superpoints_pcd) :  917
copy_superpoint_src_corr_points.shape :  (2126, 3)
mask.shape :  (2126,)
copy_superpoint_src_corr_points.shape :  (1870, 3)
copy_superpoint_ref_corr_points.shape :  (1870, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1870, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1870, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1870])
best_index :  536
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1870, 3)
transformed_src_superpoints.shape :  torch.Size([1870, 3])
residual.shape :  torch.Size([1870])
batch_inlier_masks.shape :  torch.Size([1870])
batch_outlier_masks.shape :  torch.Size([1870])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1853])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.01477599  0.04304761 -0.01976337]
 [ 0.00195866  0.0391242  -0.0233337 ]
 [-0.00333762  0.03991239 -0.02397412]]
len(transformed_superpoints_pcd) :  934
copy_superpoint_src_corr_points.shape :  (1853, 3)
mask.shape :  (1853,)
copy_superpoint_src_corr_points.shape :  (1695, 3)
copy_superpoint_ref_corr_points.shape :  (1695, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1695, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1695, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1695])
best_index :  1981
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1695, 3)
transformed_src_superpoints.shape :  torch.Size([1695, 3])
residual.shape :  torch.Size([1695])
batch_inlier_masks.shape :  torch.Size([1695])
batch_outlier_masks.shape :  torch.Size([1695])
indices_inliers.shape :  torch.Size([17])
indices_outliers.shape :  torch.Size([1678])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([17, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.04627908 -0.03020478 -0.01516043]
 [ 0.04587296 -0.0362647  -0.01549264]
 [ 0.04217632 -0.02649276 -0.01969732]]
len(transformed_superpoints_pcd) :  951
copy_superpoint_src_corr_points.shape :  (1678, 3)
mask.shape :  (1678,)
copy_superpoint_src_corr_points.shape :  (1668, 3)
copy_superpoint_ref_corr_points.shape :  (1668, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1668, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1668, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1668])
best_index :  771
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1668, 3)
transformed_src_superpoints.shape :  torch.Size([1668, 3])
residual.shape :  torch.Size([1668])
batch_inlier_masks.shape :  torch.Size([1668])
batch_outlier_masks.shape :  torch.Size([1668])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1653])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.0206657   0.01293885 -0.03083603]
 [ 0.0206657   0.01293885 -0.03083603]
 [ 0.0206657   0.01293885 -0.03083603]]
len(transformed_superpoints_pcd) :  966
copy_superpoint_src_corr_points.shape :  (1653, 3)
mask.shape :  (1653,)
copy_superpoint_src_corr_points.shape :  (1365, 3)
copy_superpoint_ref_corr_points.shape :  (1365, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1365, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1365, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1365])
best_index :  1489
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1365, 3)
transformed_src_superpoints.shape :  torch.Size([1365, 3])
residual.shape :  torch.Size([1365])
batch_inlier_masks.shape :  torch.Size([1365])
batch_outlier_masks.shape :  torch.Size([1365])
indices_inliers.shape :  torch.Size([15])
indices_outliers.shape :  torch.Size([1350])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([15, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.04037797 -0.0693242  -0.00699813]
 [ 0.04282561 -0.06485446 -0.00908398]
 [ 0.03811917 -0.06577325 -0.01072469]]
len(transformed_superpoints_pcd) :  981
copy_superpoint_src_corr_points.shape :  (1350, 3)
mask.shape :  (1350,)
copy_superpoint_src_corr_points.shape :  (1288, 3)
copy_superpoint_ref_corr_points.shape :  (1288, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1288, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1288, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1288])
best_index :  1390
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1288, 3)
transformed_src_superpoints.shape :  torch.Size([1288, 3])
residual.shape :  torch.Size([1288])
batch_inlier_masks.shape :  torch.Size([1288])
batch_outlier_masks.shape :  torch.Size([1288])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1274])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.05026584 -0.00631535 -0.00644775]
 [ 0.04992941 -0.00755106 -0.01232537]
 [ 0.05026584 -0.00631535 -0.00644775]]
len(transformed_superpoints_pcd) :  995
copy_superpoint_src_corr_points.shape :  (1274, 3)
mask.shape :  (1274,)
copy_superpoint_src_corr_points.shape :  (1078, 3)
copy_superpoint_ref_corr_points.shape :  (1078, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1078, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1078, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1078])
best_index :  1535
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1078, 3)
transformed_src_superpoints.shape :  torch.Size([1078, 3])
residual.shape :  torch.Size([1078])
batch_inlier_masks.shape :  torch.Size([1078])
batch_outlier_masks.shape :  torch.Size([1078])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([1064])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.01223272  0.04445773 -0.01968988]
 [ 0.01294644  0.03869452 -0.02149131]
 [ 0.01223272  0.04445773 -0.01968988]]
len(transformed_superpoints_pcd) :  1009
copy_superpoint_src_corr_points.shape :  (1064, 3)
mask.shape :  (1064,)
copy_superpoint_src_corr_points.shape :  (1011, 3)
copy_superpoint_ref_corr_points.shape :  (1011, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([1011, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 1011, 3])
batch_inlier_masks.shape :  torch.Size([2000, 1011])
best_index :  1565
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (1011, 3)
transformed_src_superpoints.shape :  torch.Size([1011, 3])
residual.shape :  torch.Size([1011])
batch_inlier_masks.shape :  torch.Size([1011])
batch_outlier_masks.shape :  torch.Size([1011])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([997])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.0287624   0.02435569 -0.02112162]
 [ 0.0287624   0.02435569 -0.02112162]
 [ 0.02410308  0.01914863 -0.0298475 ]]
len(transformed_superpoints_pcd) :  1023
copy_superpoint_src_corr_points.shape :  (997, 3)
mask.shape :  (997,)
copy_superpoint_src_corr_points.shape :  (730, 3)
copy_superpoint_ref_corr_points.shape :  (730, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([730, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 730, 3])
batch_inlier_masks.shape :  torch.Size([2000, 730])
best_index :  1608
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (730, 3)
transformed_src_superpoints.shape :  torch.Size([730, 3])
residual.shape :  torch.Size([730])
batch_inlier_masks.shape :  torch.Size([730])
batch_outlier_masks.shape :  torch.Size([730])
indices_inliers.shape :  torch.Size([14])
indices_outliers.shape :  torch.Size([716])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([14, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00868217  0.03508426 -0.02514453]
 [ 0.01191622  0.03840387 -0.02269903]
 [ 0.00868217  0.03508426 -0.02514453]]
len(transformed_superpoints_pcd) :  1037
copy_superpoint_src_corr_points.shape :  (716, 3)
mask.shape :  (716,)
copy_superpoint_src_corr_points.shape :  (678, 3)
copy_superpoint_ref_corr_points.shape :  (678, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([678, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 678, 3])
batch_inlier_masks.shape :  torch.Size([2000, 678])
best_index :  703
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (678, 3)
transformed_src_superpoints.shape :  torch.Size([678, 3])
residual.shape :  torch.Size([678])
batch_inlier_masks.shape :  torch.Size([678])
batch_outlier_masks.shape :  torch.Size([678])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([665])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00507052  0.03984214  0.04008353]
 [ 0.00507052  0.03984214  0.04008353]
 [ 0.00775369  0.09028185  0.02769398]]
len(transformed_superpoints_pcd) :  1050
copy_superpoint_src_corr_points.shape :  (665, 3)
mask.shape :  (665,)
copy_superpoint_src_corr_points.shape :  (567, 3)
copy_superpoint_ref_corr_points.shape :  (567, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([567, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 567, 3])
batch_inlier_masks.shape :  torch.Size([2000, 567])
best_index :  1645
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (567, 3)
transformed_src_superpoints.shape :  torch.Size([567, 3])
residual.shape :  torch.Size([567])
batch_inlier_masks.shape :  torch.Size([567])
batch_outlier_masks.shape :  torch.Size([567])
indices_inliers.shape :  torch.Size([13])
indices_outliers.shape :  torch.Size([554])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([13, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00218758 -0.06996763 -0.11657044]
 [ 0.00105425 -0.0705872  -0.12191617]
 [-0.00339396 -0.06700273 -0.11336806]]
len(transformed_superpoints_pcd) :  1063
copy_superpoint_src_corr_points.shape :  (554, 3)
mask.shape :  (554,)
copy_superpoint_src_corr_points.shape :  (537, 3)
copy_superpoint_ref_corr_points.shape :  (537, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([537, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 537, 3])
batch_inlier_masks.shape :  torch.Size([2000, 537])
best_index :  260
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (537, 3)
transformed_src_superpoints.shape :  torch.Size([537, 3])
residual.shape :  torch.Size([537])
batch_inlier_masks.shape :  torch.Size([537])
batch_outlier_masks.shape :  torch.Size([537])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([525])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [-0.0065838  -0.00304859  0.04080089]
 [ 0.00374554  0.03421995  0.03579023]
 [ 0.00385907  0.0444361   0.0361288 ]]
len(transformed_superpoints_pcd) :  1075
copy_superpoint_src_corr_points.shape :  (525, 3)
mask.shape :  (525,)
copy_superpoint_src_corr_points.shape :  (379, 3)
copy_superpoint_ref_corr_points.shape :  (379, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([379, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 379, 3])
batch_inlier_masks.shape :  torch.Size([2000, 379])
best_index :  1912
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (379, 3)
transformed_src_superpoints.shape :  torch.Size([379, 3])
residual.shape :  torch.Size([379])
batch_inlier_masks.shape :  torch.Size([379])
batch_outlier_masks.shape :  torch.Size([379])
indices_inliers.shape :  torch.Size([12])
indices_outliers.shape :  torch.Size([367])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([12, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.03020816 -0.00308051 -0.03097722]
 [ 0.02401324 -0.0051282  -0.03468123]
 [ 0.03598893 -0.00805189 -0.03057004]]
len(transformed_superpoints_pcd) :  1087
copy_superpoint_src_corr_points.shape :  (367, 3)
mask.shape :  (367,)
copy_superpoint_src_corr_points.shape :  (329, 3)
copy_superpoint_ref_corr_points.shape :  (329, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([329, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 329, 3])
batch_inlier_masks.shape :  torch.Size([2000, 329])
best_index :  310
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (329, 3)
transformed_src_superpoints.shape :  torch.Size([329, 3])
residual.shape :  torch.Size([329])
batch_inlier_masks.shape :  torch.Size([329])
batch_outlier_masks.shape :  torch.Size([329])
indices_inliers.shape :  torch.Size([11])
indices_outliers.shape :  torch.Size([318])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([11, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.04017515 -0.09893844  0.04578654]
 [ 0.03559139 -0.10107738  0.04738458]
 [ 0.03559139 -0.10107738  0.04738458]]
len(transformed_superpoints_pcd) :  1098
copy_superpoint_src_corr_points.shape :  (318, 3)
mask.shape :  (318,)
copy_superpoint_src_corr_points.shape :  (307, 3)
copy_superpoint_ref_corr_points.shape :  (307, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([307, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 307, 3])
batch_inlier_masks.shape :  torch.Size([2000, 307])
best_index :  1756
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (307, 3)
transformed_src_superpoints.shape :  torch.Size([307, 3])
residual.shape :  torch.Size([307])
batch_inlier_masks.shape :  torch.Size([307])
batch_outlier_masks.shape :  torch.Size([307])
indices_inliers.shape :  torch.Size([9])
indices_outliers.shape :  torch.Size([298])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([9, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.03800568  0.0341411  -0.00317776]
 [ 0.03525949  0.03220881 -0.01034133]
 [ 0.02972887  0.03300172 -0.01572909]]
len(transformed_superpoints_pcd) :  1107
copy_superpoint_src_corr_points.shape :  (298, 3)
mask.shape :  (298,)
copy_superpoint_src_corr_points.shape :  (255, 3)
copy_superpoint_ref_corr_points.shape :  (255, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([255, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 255, 3])
batch_inlier_masks.shape :  torch.Size([2000, 255])
best_index :  1202
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (255, 3)
transformed_src_superpoints.shape :  torch.Size([255, 3])
residual.shape :  torch.Size([255])
batch_inlier_masks.shape :  torch.Size([255])
batch_outlier_masks.shape :  torch.Size([255])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([247])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00178503  0.0400721   0.03856593]
 [ 0.00700982  0.04417054  0.03698051]
 [ 0.00178503  0.0400721   0.03856593]]
len(transformed_superpoints_pcd) :  1115
copy_superpoint_src_corr_points.shape :  (247, 3)
mask.shape :  (247,)
copy_superpoint_src_corr_points.shape :  (185, 3)
copy_superpoint_ref_corr_points.shape :  (185, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([185, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 185, 3])
batch_inlier_masks.shape :  torch.Size([2000, 185])
best_index :  1733
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (185, 3)
transformed_src_superpoints.shape :  torch.Size([185, 3])
residual.shape :  torch.Size([185])
batch_inlier_masks.shape :  torch.Size([185])
batch_outlier_masks.shape :  torch.Size([185])
indices_inliers.shape :  torch.Size([8])
indices_outliers.shape :  torch.Size([177])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([8, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.04064328  0.03024951 -0.0080394 ]
 [ 0.03576504  0.03272974 -0.00617769]
 [ 0.03355075  0.03560653 -0.01273554]]
len(transformed_superpoints_pcd) :  1123
copy_superpoint_src_corr_points.shape :  (177, 3)
mask.shape :  (177,)
copy_superpoint_src_corr_points.shape :  (175, 3)
copy_superpoint_ref_corr_points.shape :  (175, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([175, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 175, 3])
batch_inlier_masks.shape :  torch.Size([2000, 175])
best_index :  450
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (175, 3)
transformed_src_superpoints.shape :  torch.Size([175, 3])
residual.shape :  torch.Size([175])
batch_inlier_masks.shape :  torch.Size([175])
batch_outlier_masks.shape :  torch.Size([175])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([170])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.02443347  0.04032203 -0.01483212]
 [ 0.02443347  0.04032203 -0.01483212]
 [ 0.02443347  0.04032203 -0.01483212]]
len(transformed_superpoints_pcd) :  1128
copy_superpoint_src_corr_points.shape :  (170, 3)
mask.shape :  (170,)
copy_superpoint_src_corr_points.shape :  (107, 3)
copy_superpoint_ref_corr_points.shape :  (107, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([107, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 107, 3])
batch_inlier_masks.shape :  torch.Size([2000, 107])
best_index :  1632
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (107, 3)
transformed_src_superpoints.shape :  torch.Size([107, 3])
residual.shape :  torch.Size([107])
batch_inlier_masks.shape :  torch.Size([107])
batch_outlier_masks.shape :  torch.Size([107])
indices_inliers.shape :  torch.Size([5])
indices_outliers.shape :  torch.Size([102])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([5, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.00670388  0.04973038  0.03904955]
 [ 0.01051737  0.05803951  0.03970359]
 [ 0.00670388  0.04973038  0.03904955]]
len(transformed_superpoints_pcd) :  1133
copy_superpoint_src_corr_points.shape :  (102, 3)
mask.shape :  (102,)
copy_superpoint_src_corr_points.shape :  (101, 3)
copy_superpoint_ref_corr_points.shape :  (101, 3)
Inside of compute_best_transform
torch.tensor(superpoint_src_corr_points).shape :  torch.Size([101, 3])
batch_transforms.shape :  torch.Size([2000, 4, 4])
batch_aligned_src_corr_points.shape :  torch.Size([2000, 101, 3])
batch_inlier_masks.shape :  torch.Size([2000, 101])
best_index :  652
transform.shape :  (4, 4)
copy_superpoint_src_corr_points.shape :  (101, 3)
transformed_src_superpoints.shape :  torch.Size([101, 3])
residual.shape :  torch.Size([101])
batch_inlier_masks.shape :  torch.Size([101])
batch_outlier_masks.shape :  torch.Size([101])
indices_inliers.shape :  torch.Size([3])
indices_outliers.shape :  torch.Size([98])
transformed_inliers.dim() :  2
transformed_inliers.shape :  torch.Size([3, 3])
transformed_superpoints_pcd :  [[ 0.03966332 -0.10270227  0.04334594]
 [ 0.03893953 -0.09932387  0.04723594]
 [ 0.04343193 -0.09785603  0.04491786]
 ...
 [ 0.01740253  0.02436064 -0.02663669]
 [ 0.01740253  0.02436064 -0.02663669]
 [ 0.01740253  0.02436064 -0.02663669]]
len(transformed_superpoints_pcd) :  1136
copy_superpoint_src_corr_points.shape :  (98, 3)
mask.shape :  (98,)
copy_superpoint_src_corr_points.shape :  (96, 3)
copy_superpoint_ref_corr_points.shape :  (96, 3)
number of unique points in pcd :  461
number of rotations used :  35
transformed_superpoints_pcd.shape :  (1232, 3)
Line set updated
